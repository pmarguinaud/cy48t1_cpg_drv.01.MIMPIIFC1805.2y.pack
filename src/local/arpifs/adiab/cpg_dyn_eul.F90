SUBROUTINE CPG_DYN_EUL (YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDCPG_TND, YDCPG_MISC, YDCPG_DYN0, YDCPG_DYN9, &
                      & YDVARS, YDGMV, YDMODEL, PGFL, PGFLPC, PGMV, PGMVS, PB2, PGMVT1, PGMVT1S, PGFLT1)

USE PARKIND1, ONLY : JPIM, JPRB

USE GEOMETRY_MOD , ONLY : GEOMETRY
USE CPG_OPTS_TYPE_MOD, ONLY : CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY : CPG_DYN_TYPE, CPG_MISC_TYPE, CPG_TND_TYPE
USE FIELD_VARIABLES_MOD,ONLY : FIELD_VARIABLES
USE YOMGMV   , ONLY : TGMV
USE TYPE_MODEL   , ONLY : MODEL


IMPLICIT NONE

TYPE(GEOMETRY)       ,INTENT(IN)    :: YDGEOMETRY
TYPE(CPG_BNDS_TYPE)   ,INTENT(IN)   :: YDCPG_BNDS
TYPE(CPG_OPTS_TYPE)   ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_TND_TYPE)   ,INTENT(INOUT) :: YDCPG_TND
TYPE(CPG_MISC_TYPE)  ,INTENT(INOUT) :: YDCPG_MISC
TYPE(CPG_DYN_TYPE)   ,INTENT(INOUT) :: YDCPG_DYN0
TYPE(CPG_DYN_TYPE)   ,INTENT(INOUT) :: YDCPG_DYN9
TYPE(FIELD_VARIABLES),INTENT(INOUT) :: YDVARS
TYPE(TGMV)           ,INTENT(INOUT) :: YDGMV
TYPE(MODEL)          ,INTENT(INOUT) :: YDMODEL
REAL(KIND=JPRB)      ,INTENT(IN)    :: PGFL(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YDMODEL%YRML_GCONF%YGFL%NDIM)
REAL(KIND=JPRB)      ,INTENT(INOUT) :: PGFLPC(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YDMODEL%YRML_GCONF%YGFL%NDIMPC)
REAL(KIND=JPRB)      ,INTENT(INOUT) :: PGMV(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YDGMV%NDIMGMV)
REAL(KIND=JPRB)      ,INTENT(INOUT) :: PGMVS(YDGEOMETRY%YRDIM%NPROMA,YDGMV%NDIMGMVS)
REAL(KIND=JPRB)      ,INTENT(INOUT) :: PB2(YDGEOMETRY%YRDIM%NPROMA,YDMODEL%YRML_DYN%YRPTRSLB2%NFLDSLB2)
REAL(KIND=JPRB)      ,INTENT(INOUT) :: PGMVT1(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YDGMV%YT1%NDIM)
REAL(KIND=JPRB)      ,INTENT(INOUT) :: PGMVT1S(YDGEOMETRY%YRDIM%NPROMA,YDGMV%YT1%NDIMS)
REAL(KIND=JPRB)      ,INTENT(INOUT) :: PGFLT1(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YDMODEL%YRML_GCONF%YGFL%NDIM1)

#include "cpeuldyn.intfb.h"
#include "vdiflcz.intfb.h"

!*       3.1   Dynamics with Eulerian advection treatment 

CALL CPEULDYN(YDGEOMETRY, YDGMV, YDMODEL%YRML_PHY_EC%YREPHY, YDMODEL%YRML_GCONF%YGFL, YDMODEL%YRML_DYN, YDMODEL%YRML_PHY_MF%YRPHY, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, &
& YDCPG_OPTS%ZBETADT, YDCPG_OPTS%ZDT, YDCPG_BNDS%KBL, PGFL, YDCPG_MISC%TSOL, YDCPG_MISC%QSOL, YDCPG_DYN0%NHX, YDCPG_DYN0%KENE,    &
& YDCPG_DYN0%CTY%ZVIEW, YDCPG_DYN0%PRE, YDCPG_DYN0%XYB%RDELP, YDCPG_TND%ZVIEW, YDCPG_DYN9%NHX,              &
& PGFLT1, PGMVT1, PGMVT1S, PGFLPC, PGMV, PGMVS, PB2(1, 1))

!*       3.2   Simple physics.

IF ((.NOT.(YDMODEL%YRML_PHY_MF%YRPHY%LMPHYS.OR.YDMODEL%YRML_PHY_EC%YREPHY%LEPHYS)).AND.YDMODEL%YRML_PHY_SLIN%YRPHLC%LSPHLC) THEN
  CALL VDIFLCZ(YDMODEL%YRML_PHY_G%YRVDF, YDGEOMETRY%YRVAB, YDMODEL%YRML_PHY_SLIN%YRPHLC, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG, YDCPG_OPTS%ZDT, YDCPG_MISC%LSM,  &
  & YDCPG_DYN0%PHI, YDCPG_DYN0%PHIF, YDCPG_DYN0%RCP%CP, YDCPG_DYN0%RCP%R, YDCPG_DYN0%XYB%RDELP, YDVARS%U%T0,   &
  & YDVARS%V%T0, YDVARS%T%T0, YDCPG_DYN0%PRE, YDVARS%U%T9, YDVARS%V%T9, YDVARS%T%T9, YDVARS%U%T1, YDVARS%V%T1, &
  & YDVARS%T%T1)
ENDIF

END SUBROUTINE
