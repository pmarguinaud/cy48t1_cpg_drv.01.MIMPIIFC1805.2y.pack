!OCL  NOEVAL
SUBROUTINE GPCTY(YDVFE,KPROMA,KD,KF,KFLEV,LDRUBC,YDVAB,YDVETA,&
 & PU,PV,PD,PEVT,PXYB,PSPL,PSPM,PRPREF,PCTY,PDPHYCTY)

!**** *GPCTY* - Computes vertical velocities.

USE YOMVERT   , ONLY : TVFE, TVAB, TVETA
USE PARKIND1  , ONLY : JPIM, JPRB
USE YOMHOOK   , ONLY : LHOOK, DR_HOOK
USE YOMCVER   , ONLY : LVERTFE
USE INTDYN_MOD, ONLY : YYTCTY, YYTXYB

!     ------------------------------------------------------------------

IMPLICIT NONE

TYPE(TVFE)        ,INTENT(IN)    :: YDVFE
INTEGER(KIND=JPIM),INTENT(IN)    :: KPROMA
INTEGER(KIND=JPIM),INTENT(IN)    :: KFLEV
INTEGER(KIND=JPIM),INTENT(IN)    :: KD
INTEGER(KIND=JPIM),INTENT(IN)    :: KF
LOGICAL           ,INTENT(IN)    :: LDRUBC
TYPE(TVAB)        ,INTENT(IN)    :: YDVAB
TYPE(TVETA)       ,INTENT(IN)    :: YDVETA
REAL(KIND=JPRB)   ,INTENT(IN)    :: PU(KPROMA,KFLEV)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PV(KPROMA,KFLEV)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PD(KPROMA,KFLEV)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PEVT(KPROMA)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PXYB(KPROMA,KFLEV,YYTXYB%NDIM)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PSPL(KPROMA)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PSPM(KPROMA)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PRPREF(KPROMA,KFLEV)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PCTY(KPROMA,0:KFLEV,YYTCTY%NDIM)
REAL(KIND=JPRB),OPTIONAL,INTENT(IN) :: PDPHYCTY(KPROMA,KFLEV)

!     ------------------------------------------------------------------

REAL(KIND=JPRB) :: ZHOOK_HANDLE

!     ------------------------------------------------------------------

#include "gpcty_expl.intfb.h"

!     ------------------------------------------------------------------

IF (LHOOK) CALL DR_HOOK('GPCTY',0,ZHOOK_HANDLE)

CALL GPCTY_EXPL(LVERTFE, YDVFE,KPROMA,KD,KF,KFLEV,LDRUBC,YDVAB,YDVETA,&
 & PU,PV,PD,PEVT,PSPL,PSPM,PRPREF,PDPHYCTY,&
 & PXYB (:,:,YYTXYB%M_DELP ), PXYB (:,:,YYTXYB%M_LNPR ), &
 & PXYB (:,:,YYTXYB%M_RDELP), PXYB (:,:,YYTXYB%M_ALPH ), &
 & PXYB (:,:,YYTXYB%M_RTGR ), PXYB (:,:,YYTXYB%M_RPRE ), &
 & PXYB (:,:,YYTXYB%M_RPP  ), PCTY(:,:,YYTCTY%M_EVEL),   &
 & PCTY(:,:,YYTCTY%M_VVEL),   PCTY(:,:,YYTCTY%M_PSDIV),  &
 & PCTY(:,:,YYTCTY%M_PSDVBC), PCTY(:,:,YYTCTY%M_DIVDP))


IF (LHOOK) CALL DR_HOOK('GPCTY',1,ZHOOK_HANDLE)

END SUBROUTINE GPCTY

