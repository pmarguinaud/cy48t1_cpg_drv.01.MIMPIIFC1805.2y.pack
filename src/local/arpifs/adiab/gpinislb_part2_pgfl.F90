SUBROUTINE GPINISLB_PART2_PGFL (LDSLAG, LDTWOTL, YDGEOMETRY, YGFL, YDDYN, KST, KEN, PTE, PGFL, PGFLT1)

USE PARKIND1, ONLY : JPIM, JPRB

USE GEOMETRY_MOD , ONLY : GEOMETRY
USE YOM_YGFL     , ONLY : TYPE_GFLD
USE YOMDYN       , ONLY : TDYN


IMPLICIT NONE

LOGICAL, INTENT (IN) :: LDSLAG
LOGICAL, INTENT (IN) :: LDTWOTL
TYPE(GEOMETRY)    ,INTENT(IN)    :: YDGEOMETRY
TYPE(TYPE_GFLD)   ,INTENT(IN)    :: YGFL
TYPE(TDYN)        ,INTENT(IN)    :: YDDYN
INTEGER(KIND=JPIM),INTENT(IN)    :: KST
INTEGER(KIND=JPIM),INTENT(IN)    :: KEN
REAL(KIND=JPRB)   ,INTENT(IN)    :: PTE
REAL(KIND=JPRB)   ,INTENT(IN)    :: PGFL(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YGFL%NDIM)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PGFLT1(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YGFL%NDIM1)


INTEGER (KIND=JPIM) :: JGFL


IF (LDSLAG.AND.LDTWOTL) THEN
  DO JGFL=1,YGFL%NUMFLDS
    IF(YGFL%YCOMP(JGFL)%LADV) THEN
      PGFLT1(KST:KEN,1:YDGEOMETRY%YRDIMV%NFLEVG,YGFL%YCOMP(JGFL)%MP1) = 0.0_JPRB
    ELSEIF(YGFL%YCOMP(JGFL)%LT1) THEN
      PGFLT1(KST:KEN,1:YDGEOMETRY%YRDIMV%NFLEVG,YGFL%YCOMP(JGFL)%MP1) =&
       & PGFL(KST:KEN,1:YDGEOMETRY%YRDIMV%NFLEVG,YGFL%YCOMP(JGFL)%MP)*PTE  
    ENDIF
  ENDDO
ELSEIF(LDSLAG.AND.(.NOT.LDTWOTL)) THEN
  DO JGFL=1,YGFL%NUMFLDS
    IF(YGFL%YCOMP(JGFL)%LADV) THEN
      PGFLT1(KST:KEN,1:YDGEOMETRY%YRDIMV%NFLEVG,YGFL%YCOMP(JGFL)%MP1) = 0.0_JPRB
    ELSEIF(YGFL%YCOMP(JGFL)%LT1) THEN
      PGFLT1(KST:KEN,1:YDGEOMETRY%YRDIMV%NFLEVG,YGFL%YCOMP(JGFL)%MP1) =&
       & PGFL(KST:KEN,1:YDGEOMETRY%YRDIMV%NFLEVG,YGFL%YCOMP(JGFL)%MP9)*PTE  
    ENDIF
  ENDDO
ELSE !Eularian
  IF( YDDYN%NCURRENT_ITER == 0 )THEN
    DO JGFL=1,YGFL%NUMFLDS
      IF(YGFL%YCOMP(JGFL)%LT1) THEN
        PGFLT1(KST:KEN,1:YDGEOMETRY%YRDIMV%NFLEVG,YGFL%YCOMP(JGFL)%MP1)=&
         & PGFL(KST:KEN,1:YDGEOMETRY%YRDIMV%NFLEVG,YGFL%YCOMP(JGFL)%MP9)*PTE  
      ENDIF
    ENDDO
  ELSE
    DO JGFL=1,YGFL%NUMFLDS
      IF(YGFL%YCOMP(JGFL)%LT1) THEN
        PGFLT1(KST:KEN,1:YDGEOMETRY%YRDIMV%NFLEVG,YGFL%YCOMP(JGFL)%MP1)=0.0_JPRB
      ENDIF
    ENDDO
  ENDIF
ENDIF

END SUBROUTINE
