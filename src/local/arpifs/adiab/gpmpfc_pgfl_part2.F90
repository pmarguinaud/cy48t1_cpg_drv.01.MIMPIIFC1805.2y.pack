SUBROUTINE GPMPFC_PGFL_PART2 (YDML_GCONF, KPROMA, KFLEV, KST, KEN, PGM, PGFL)

USE PARKIND1, ONLY : JPIM, JPRB

USE MODEL_GENERAL_CONF_MOD , ONLY : MODEL_GENERAL_CONF_TYPE


IMPLICIT NONE

TYPE(MODEL_GENERAL_CONF_TYPE),INTENT(IN):: YDML_GCONF
INTEGER(KIND=JPIM),INTENT(IN)    :: KPROMA
INTEGER(KIND=JPIM),INTENT(IN)    :: KFLEV
INTEGER(KIND=JPIM),INTENT(IN)    :: KST
INTEGER(KIND=JPIM),INTENT(IN)    :: KEN
REAL(KIND=JPRB),INTENT(IN) :: PGM(KPROMA)
REAL(KIND=JPRB),INTENT(INOUT) :: PGFL(KPROMA,KFLEV,YDML_GCONF%YGFL%NDIM)


INTEGER (KIND=JPIM) :: JGFL
INTEGER (KIND=JPIM) :: JLEV
INTEGER (KIND=JPIM) :: JROF


! * GFL:

DO JGFL=1,YDML_GCONF%YGFL%NUMFLDS
  IF(YDML_GCONF%YGFL%YCOMP(JGFL)%LCDERS) THEN
    DO JLEV=1,KFLEV
      DO JROF=KST,KEN
        PGFL(JROF,JLEV,YDML_GCONF%YGFL%YCOMP(JGFL)%MPL)=PGFL(JROF,JLEV,YDML_GCONF%YGFL%YCOMP(JGFL)%MPL)*PGM(JROF)  
        PGFL(JROF,JLEV,YDML_GCONF%YGFL%YCOMP(JGFL)%MPM)=PGFL(JROF,JLEV,YDML_GCONF%YGFL%YCOMP(JGFL)%MPM)*PGM(JROF)  
      ENDDO
    ENDDO
  ENDIF
ENDDO



END SUBROUTINE
