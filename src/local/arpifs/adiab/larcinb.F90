#ifdef RS6K
@PROCESS NOCHECK
#endif
SUBROUTINE LARCINB(YDGEOMETRY,YDGMV,&
 ! --- INPUT ----------------------------------------------------------
 & YDLDDH,YDMDDH,YDML_GCONF,YDML_DYN,KST,KPROF,KASLB1,KHVI,LDSLPHY,LD2TLFF1,&
 & KL0,KLH0,PLSCAW,PRSCAW,PB1,KNOWENO,&
 ! --- INOUT ----------------------------------------------------------
 & PGMVTNDSL,PGFLTNDSL,PGMVTNDSI,&
 ! --- OUTPUT --------------------------------------------------------
 & PGMVF,PGMVF_SI,PGMVF_NL,PDP,PGFLF,PCF,PCF_SI,PCF_NL,&
 & PUFZ,PVFZ,PUPF,PVPF,PTPF,PGFLPF,PDBBCF,PDPHIF,PGWSF)

!**** *LARCINB    -  semi-LAgrangian scheme:(Interpolation)

!     Purpose.
!     --------
!       Does the interpolations necessary in the semi-Lagrangian scheme.

!**   Interface.
!     ----------
!        *CALL* *LARCINB(......)

!        Explicit arguments :
!        --------------------

!        INPUT:
!          KST         - first element where computations are performed.
!          KPROF       - depth of work.
!          KASLB1      - horizontal dimension of SL fields
!          KHVI        - 1/0: Cubic Hermite vert. interp. are needed/not needed
!          LDSLPHY     - split physics in semi lagrangian mode.
!          LD2TLFF1    - .T./.F.: Refined treatement of (2*Omega Vec r) at
!                        the origin point when there is t-dt (or t in SL2TL)
!                        physics / Other cases.
!          KL0         - index of the four western points
!                        of the 16 points interpolation grid.
!          KLH0        - second value of index of the four western points
!                        of the 16 points interpolation grid if needed.
!          PLSCAW      - linear weights (distances) for interpolations.
!          PRSCAW      - non-linear weights for interpolations.
!          PB1         - "SLBUF1" buffer for interpolations.
!          KNOWENO     - boundary condition treatment for WENO

!        INOUT:
!          PGMVTNDSL   - cf. GMVTNDSL_DDH in YOMGPDDH
!          PGFLTNDSL   - cf. GFLTNDSL_DDH in YOMGPDDH
!          PGMVTNDSI   - cf. GMVTNDSI_DDH in YOMGPDDH

!        OUTPUT:
!          PGMVF       - Interpolated quantity at O for GMV.
!          PGMVF_SI    - interpolated separate linear terms at O for GMV.
!          PGMVF_NL    - interpolated NL term useful for SETTLS/PC scheme
!          PDP         - Interpolated 2D term at O for continuity equation.
!          PGFLF       - Interpolated quantity at O in the GFL fields.
!          PCF         - Interpolated 3D quantity at O in the cont. eqn.
!          PCF_SI      - Interpolated 3D quantity at O in the cont. eqn (SI).
!          PCF_NL      - Interpolated 3D quantity at O in the cont. eqn (LSETTLS/LPC_CHEAP).
!          PUFZ and PVFZ for SL2TL scheme:
!          PUFZ        - Interpolated U-wind at O for L2TLFF=.T. option.
!          PVFZ        - Interpolated V-wind at O for L2TLFF=.T. option.
!          PUPF        - Interpolated quantity at O in U-wind eqn
!                        for split physics (if LDSLPHY=.T. only).
!          PVPF        - Interpolated quantity at O in V-wind eqn
!                        for split physics (if LDSLPHY=.T. only).
!          PTPF        - Interpolated quantity at O in T eqn
!                        for split physics (if LDSLPHY=.T. only).
!          PGFLPF      - Interpolated quantity at O in 
!                        unified_treatment grid-point fields.
!          PDBBCF      - interpolated "(dGw_s/dt)/(pressure depth)_L" term at O.
!          PDPHIF      - interpolated "(p/m Rd T)_L" term at O.
!          PGWSF       - interpolated "(Gw_s)" term at O(L).

!        Implicit arguments :
!        --------------------

!     Method.
!     -------
!        See documentation

!     Externals.
!     ----------

!        Called by LAPINEB.
!        Calls LAITLI,LAIDDI,
!              LAITRE_GMV,LAITRE_GFL

!     Reference.
!     ----------

!     Author.
!     -------
!      K. YESSAD, after the subroutine LAGINT0 written by Maurice IMBARD
!      Alain CRAPLET and Michel ROCHAS  METEO FRANCE/EERM/CRMD
!      Original : JUNE 1991.

! Modifications
! -------------
!   N. Wedi and K. Yessad (Jan 2008): different dev for NH model and PC scheme
!   30-Jun-2008 J. Masek   Dataflow for new SLHD interpolators.
!   17-Sep-2008 F. Vana  updating arguments for LAITRE_GFL
!   K. Yessad Nov 2008: rationalisation of dummy argument interfaces
!   K. Yessad Nov 2008: interpolation routines: merge QM with not-QM version.
!   F. Vana  15-Oct-2009: option NSPLTHOI
!   K. Yessad Nov 2009: rationalisation of dummy argument interfaces: PGMVF
!   K. Yessad (Nov 2009): prune lpc_old.
!   K. Yessad (Oct 2010): remove useless LFINDVSEP calculations.
!   K. Yessad (Jan 2011): introduce INTDYN_MOD structures.
!   F. Vana  21-Feb-2011: horiz. turbulence, gp diff to physics (NSPLTHOI=1), N[x]LAG=4 and LTDIABLIN.
!   G. Mozdzynski (Jan 2011): OOPS cleaning, use of derived type SL_STRUCT
!   M. Diamantakis (Jun 2012): extra argument for quasi-monotone mass fixer
!   S. Malardel (Nov 2013): COMAD weights for SL interpolations
!   K. Yessad (July 2014): Rename some variables.
!   F. Vana  13-Feb-2014 Distinguish between momentum and heat variables in SLHD.
!   K. Yessad (Dec 2016): Prune obsolete options.
!   K. Yessad (June 2017): Introduce NHQE model.
!   K. Yessad (June 2017): alternate "cheap" FULL PC.
!   K. Yessad (Feb 2018): remove deep-layer formulations.
!   M. Diamantakis (June 2018): Don't interpolate GFL variable advected on Atlas grid 
!   J. Vivoda (July 2018): LSETTLS with LPC_CHEAP.
!   F. Vana (Oct-2018): Better control on SLPHYS
!   F. Vana 20-Feb-2019: Vertical quintic interpolation
! End Modifications
!------------------------------------------------------------------------------

USE MODEL_DYNAMICS_MOD     , ONLY : MODEL_DYNAMICS_TYPE
USE MODEL_GENERAL_CONF_MOD , ONLY : MODEL_GENERAL_CONF_TYPE
USE GEOMETRY_MOD           , ONLY : GEOMETRY
USE YOMGMV                 , ONLY : TGMV
USE PARKIND1               , ONLY : JPIM, JPRB
USE YOMHOOK                , ONLY : LHOOK, DR_HOOK
USE YOMCT0                 , ONLY : LNHDYN, LNHEE
USE YOMCVER                , ONLY : LVFE_GW

USE YOMLDDH                , ONLY : TLDDH
USE YOMMDDH                , ONLY : TMDDH

!     ------------------------------------------------------------------

IMPLICIT NONE

TYPE(GEOMETRY)    ,INTENT(IN)    :: YDGEOMETRY
TYPE(TGMV)        ,INTENT(INOUT) :: YDGMV
TYPE(TLDDH)       ,INTENT(IN)    :: YDLDDH
TYPE(TMDDH)       ,INTENT(IN)    :: YDMDDH
TYPE(MODEL_DYNAMICS_TYPE),INTENT(IN):: YDML_DYN
TYPE(MODEL_GENERAL_CONF_TYPE),INTENT(IN):: YDML_GCONF
INTEGER(KIND=JPIM),INTENT(IN)    :: KHVI 
INTEGER(KIND=JPIM),INTENT(IN)    :: KST 
INTEGER(KIND=JPIM),INTENT(IN)    :: KPROF 
INTEGER(KIND=JPIM),INTENT(IN)    :: KASLB1
LOGICAL           ,INTENT(IN)    :: LDSLPHY 
LOGICAL           ,INTENT(IN)    :: LD2TLFF1 
INTEGER(KIND=JPIM),INTENT(IN)    :: KL0(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,0:3) 
INTEGER(KIND=JPIM),INTENT(IN)    :: KLH0(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,0:3) 
REAL(KIND=JPRB)   ,INTENT(IN)    :: PLSCAW(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YDML_DYN%YYTLSCAW%NDIM)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PRSCAW(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YDML_DYN%YYTRSCAW%NDIM)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PB1(KASLB1,YDML_DYN%YRPTRSLB1%NFLDSLB1)
INTEGER(KIND=JPIM),INTENT(IN)    :: KNOWENO(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB)   ,INTENT(INOUT) :: PGMVTNDSL(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,2+YDML_GCONF%YRDIMF%NFTHER)
REAL(KIND=JPRB)   ,INTENT(INOUT) :: PGFLTNDSL(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YDML_GCONF%YGFL%NUMFLDS)
REAL(KIND=JPRB)   ,INTENT(INOUT) :: PGMVTNDSI(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YDMDDH%NDIMSIGMV)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PGMVF(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YDGMV%YGP%NDIM) 
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PGMVF_SI(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YDGMV%YGP%NDIM)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PGMVF_NL(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YDGMV%YGP%NDIM)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PDP(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG) 
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PGFLF(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YDML_GCONF%YGFL%NUMFLDS) 
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PCF(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG) 
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PCF_SI(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG) 
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PCF_NL(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PUFZ(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG) 
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PVFZ(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG) 
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PUPF(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG) 
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PVPF(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG) 
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PTPF(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG) 
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PGFLPF(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG,YDML_GCONF%YGFL%NUMFLDS) 
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PDBBCF(YDGEOMETRY%YRDIM%NPROMA) 
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PDPHIF(YDGEOMETRY%YRDIM%NPROMA) 
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PGWSF(YDGEOMETRY%YRDIM%NPROMA) 
!     ------------------------------------------------------------------
REAL(KIND=JPRB) :: ZGMVF(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),ALLOCATABLE :: ZGFLF(:,:)
REAL(KIND=JPRB) :: ZWCLA(YDGEOMETRY%YRDIM%NPROMA,3),ZWCLO(YDGEOMETRY%YRDIM%NPROMA,3,2)
REAL(KIND=JPRB) :: ZWDLO(YDGEOMETRY%YRDIM%NPROMA,0:3),ZWDLAT(YDGEOMETRY%YRDIM%NPROMA),ZWDVER(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB) :: ZWCLAMAD(YDGEOMETRY%YRDIM%NPROMA,3),ZWCLOMAD(YDGEOMETRY%YRDIM%NPROMA,3,2)
REAL(KIND=JPRB) :: ZWDLOMAD(YDGEOMETRY%YRDIM%NPROMA,0:3),ZWDLAMAD(YDGEOMETRY%YRDIM%NPROMA),ZWDVERMAD(YDGEOMETRY%YRDIM%NPROMA)

INTEGER(KIND=JPIM) :: JLEV, JROF, JGFL, JF 
INTEGER(KIND=JPIM) :: IWK, IWNT, IWKM, IWKH, IWKGFL

LOGICAL :: LLTDIABLIN,LLHORTURB,LLCOMAD
LOGICAL :: LLNOSLHD, LLHOI2
LOGICAL :: LL1,LL2,LL3,LLMOM,LL_LIN

CHARACTER(LEN=12) :: CLINT

REAL(KIND=JPRB) :: ZHOOK_HANDLE

!     ------------------------------------------------------------------

#include "laiddi.intfb.h"
#include "laitli.intfb.h"
#include "laitre_gmv.intfb.h"
#include "laitre_gfl.intfb.h"

!     ------------------------------------------------------------------

IF (LHOOK) CALL DR_HOOK('LARCINB',0,ZHOOK_HANDLE)
ASSOCIATE(YDDIM=>YDGEOMETRY%YRDIM,YDDIMV=>YDGEOMETRY%YRDIMV,YDDYN=>YDML_DYN%YRDYN,YDPTRSLB1=>YDML_DYN%YRPTRSLB1,&
& YGFL=>YDML_GCONF%YGFL,    YDDIMF=>YDML_GCONF%YRDIMF,YDTLSCAW=>YDML_DYN%YYTLSCAW,YDTRSCAW=>YDML_DYN%YYTRSCAW   &
& )

ASSOCIATE(NUMFLDS=>YGFL%NUMFLDS, YCOMP=>YGFL%YCOMP,   NUMFLDS_SL1=>YGFL%NUMFLDS_SL1, NUMFLDS_SPL=>YGFL%NUMFLDS_SPL,               &
& NPROMA=>YDDIM%NPROMA,   NFLEN=>YDDIMV%NFLEN, NFLEVG=>YDDIMV%NFLEVG, NFLSA=>YDDIMV%NFLSA,   LQMHP=>YDDYN%LQMHP,                  &
& LQMHPD=>YDDYN%LQMHPD,   LQMHT=>YDDYN%LQMHT, LQMHVD=>YDDYN%LQMHVD, LQMHW=>YDDYN%LQMHW,   LQMP=>YDDYN%LQMP,                       &
& LQMPD=>YDDYN%LQMPD, LQMT=>YDDYN%LQMT, LQMVD=>YDDYN%LQMVD,   LQMW=>YDDYN%LQMW, LSPLTHOIGFL=>YDDYN%LSPLTHOIGFL,                   &
& LVWENO_W=>YDDYN%LVWENO_W,LVWENO_T=>YDDYN%LVWENO_T,LVWENO_SP=>YDDYN%LVWENO_SP,   LVWENO_SPD=>YDDYN%LVWENO_SPD,                   &
& LVWENO_SVD=>YDDYN%LVWENO_SVD,   WENO_ALPHA_W=>YDDYN%WENO_ALPHA_W,WENO_ALPHA_T=>YDDYN%WENO_ALPHA_T,                              &
& WENO_ALPHA_SP=>YDDYN%WENO_ALPHA_SP,   WENO_ALPHA_SPD=>YDDYN%WENO_ALPHA_SPD,WENO_ALPHA_SVD=>YDDYN%WENO_ALPHA_SVD,                &
& NCURRENT_ITER=>YDDYN%NCURRENT_ITER, NSITER=>YDDYN%NSITER,   NSLDIMK=>YDDYN%NSLDIMK, NSPDLAG=>YDDYN%NSPDLAG,                     &
& NSPLTHOI=>YDDYN%NSPLTHOI,   NSVDLAG=>YDDYN%NSVDLAG, NTLAG=>YDDYN%NTLAG, NVLAG=>YDDYN%NVLAG,   NWLAG=>YDDYN%NWLAG,               &
& LSLHDHEAT=>YDDYN%LSLHDHEAT,   YGP=>YDGMV%YGP,   LRSIDDH=>YDLDDH%LRSIDDH, LRSLDDH=>YDLDDH%LRSLDDH,                               &
& MSIDDH_PD0=>YDMDDH%MSIDDH_PD0, MSIDDH_T0=>YDMDDH%MSIDDH_T0,   MSIDDH_U0=>YDMDDH%MSIDDH_U0, MSIDDH_V0=>YDMDDH%MSIDDH_V0,         &
& MSIDDH_VD0=>YDMDDH%MSIDDH_VD0, MSLDDH_NHX=>YDMDDH%MSLDDH_NHX,   MSLDDH_T=>YDMDDH%MSLDDH_T, MSLDDH_U=>YDMDDH%MSLDDH_U,           &
& MSLDDH_V=>YDMDDH%MSLDDH_V, MSLDDH_VD=>YDMDDH%MSLDDH_VD,   MSLB1C9=>YDPTRSLB1%MSLB1C9, MSLB1C9_SI=>YDPTRSLB1%MSLB1C9_SI,         &
& MSLB1DBBC9=>YDPTRSLB1%MSLB1DBBC9, MSLB1DPHI9=>YDPTRSLB1%MSLB1DPHI9,   MSLB1GFL9=>YDPTRSLB1%MSLB1GFL9,                           &
& MSLB1GFLF9=>YDPTRSLB1%MSLB1GFLF9,   MSLB1GFLP9=>YDPTRSLB1%MSLB1GFLP9, MSLB1GFLSP9=>YDPTRSLB1%MSLB1GFLSP9,                       &
& MSLB1GFLSPF9=>YDPTRSLB1%MSLB1GFLSPF9, MSLB1GWS9=>YDPTRSLB1%MSLB1GWS9,   MSLB1NHX9=>YDPTRSLB1%MSLB1NHX9,                         &
& MSLB1PD0=>YDPTRSLB1%MSLB1PD0,   MSLB1PD9=>YDPTRSLB1%MSLB1PD9, MSLB1PD9_SI=>YDPTRSLB1%MSLB1PD9_SI,                               &
& MSLB1SP9=>YDPTRSLB1%MSLB1SP9,   MSLB1T0=>YDPTRSLB1%MSLB1T0, MSLB1T9=>YDPTRSLB1%MSLB1T9,   MSLB1T9_SI=>YDPTRSLB1%MSLB1T9_SI,     &
& MSLB1TF9=>YDPTRSLB1%MSLB1TF9,   MSLB1TP9=>YDPTRSLB1%MSLB1TP9, MSLB1U0=>YDPTRSLB1%MSLB1U0,   MSLB1U9=>YDPTRSLB1%MSLB1U9,         &
& MSLB1U9_SI=>YDPTRSLB1%MSLB1U9_SI,   MSLB1UF9=>YDPTRSLB1%MSLB1UF9, MSLB1UP9=>YDPTRSLB1%MSLB1UP9,   MSLB1UR9=>YDPTRSLB1%MSLB1UR9, &
& MSLB1V0=>YDPTRSLB1%MSLB1V0,   MSLB1V9=>YDPTRSLB1%MSLB1V9, MSLB1V9_SI=>YDPTRSLB1%MSLB1V9_SI,   MSLB1VD0=>YDPTRSLB1%MSLB1VD0,     &
& MSLB1VD9=>YDPTRSLB1%MSLB1VD9,   MSLB1VD9_SI=>YDPTRSLB1%MSLB1VD9_SI, MSLB1VDF9=>YDPTRSLB1%MSLB1VDF9,                             &
& MSLB1VF9=>YDPTRSLB1%MSLB1VF9, MSLB1VP9=>YDPTRSLB1%MSLB1VP9,   MSLB1VR9=>YDPTRSLB1%MSLB1VR9, MSLB1C9_NL=>YDPTRSLB1%MSLB1C9_NL,   &
& MSLB1PD9_NL=>YDPTRSLB1%MSLB1PD9_NL,   MSLB1T9_NL=>YDPTRSLB1%MSLB1T9_NL, MSLB1U9_NL=>YDPTRSLB1%MSLB1U9_NL,                       &
& MSLB1V9_NL=>YDPTRSLB1%MSLB1V9_NL, MSLB1VD9_NL=>YDPTRSLB1%MSLB1VD9_NL)
!     ------------------------------------------------------------------

!*       1.    PRELIMINARY INITIALISATIONS + ALLOCATIONS.
!              ------------------------------------------

! * switch for GMV fields where SLHD is not applied
LLNOSLHD=.FALSE.

! * Pointers for interpolation weights controlling the horizontal part of 3D turbulence
!   IWNT - for those quantities being never subject to 3D turb
!   IWKM - momentum variables
!   IWKH - heat variables (for the moment all scalar variables)
IWNT=1
IWKGFL=1
IF (YDML_DYN%YRDYNA%L3DTURB) THEN
  IWKM=2
  IWKH=3
ELSE
  IWKM=1
  IWKH=1
ENDIF

IF (YDML_DYN%YRDYNA%LPC_FULL.AND.YDML_DYN%YRDYNA%LPC_CHEAP2.AND.(NCURRENT_ITER<NSITER)) THEN
  LL_LIN=.TRUE.
ELSE
  LL_LIN=.FALSE.
ENDIF

!     ------------------------------------------------------------------

!*       2.    ORIGIN POINT INTERPOLATIONS FOR GMV VARIABLES.
!              ----------------------------------------------

! * U-Momentum equation:

LLMOM=.TRUE.

! --- part of the RHS requiring a "high order" interpolation:
CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,IWKM,&
 & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_W,YDML_DYN%YRDYNA%LSLHD_W,LVWENO_W,WENO_ALPHA_W,LLMOM,LQMW,LQMHW,KNOWENO,KL0,PLSCAW,PRSCAW,&
 & PB1(1,MSLB1U9),PGMVF(1,1,YGP%MU))

IF (LRSLDDH) THEN
  DO JLEV=1,NFLEVG
    DO JROF=KST,KPROF
      PGMVTNDSL(JROF,JLEV,MSLDDH_U)=PGMVTNDSL(JROF,JLEV,MSLDDH_U)&
      & +PGMVF(JROF,JLEV,YGP%MU)
    ENDDO
  ENDDO
ENDIF

IF ((NSPLTHOI /= 0).AND.(NWLAG < 4)) THEN
  ! --- part of the RHS requiring special "high order" interpolation
  IF (NSPLTHOI == 1) THEN
    LLHOI2=LLNOSLHD
    IWK=NSLDIMK
  ELSE
    LLHOI2=YDML_DYN%YRDYNA%LSLHD_W
    IWK=IWKM
  ENDIF
  CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,IWK,&
   & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_W,LLHOI2,LVWENO_W,WENO_ALPHA_W,LLMOM,LQMW,LQMHW,KNOWENO,KL0,PLSCAW,PRSCAW,&
   & PB1(1,MSLB1UF9),ZGMVF)
  DO JLEV=1,NFLEVG
    DO JROF=KST,KPROF
      PGMVF(JROF,JLEV,YGP%MU)=PGMVF(JROF,JLEV,YGP%MU)+ZGMVF(JROF,JLEV)
    ENDDO
  ENDDO
ENDIF

IF(NWLAG >= 3) THEN

  ! --- save U in some cases:
  IF (LD2TLFF1) THEN
    ! Interpolate U at the origin point and use PUFZ
    ! to store the interpolated quantities.
    CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,IWKM,&
     & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_W,YDML_DYN%YRDYNA%LSLHD_W,LVWENO_W,WENO_ALPHA_W,LLMOM,LQMW,LQMHW,KNOWENO,KL0,PLSCAW,PRSCAW,&
     & PB1(1,MSLB1UR9),PUFZ)
  ELSE
    ! Save PGMVF(.,.,YGP%MU) in case of refined treatment of
    ! Coriolis term and lagged physics in 2TL scheme:
    PUFZ(KST:KPROF,1:NFLEVG)=PGMVF(KST:KPROF,1:NFLEVG,YGP%MU)
  ENDIF

  ! --- part of the RHS requiring a trilinear interpolation:
  IF (YDML_DYN%YRDYNA%LCOMAD_W) THEN
    CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
     & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
     & PB1(1,MSLB1U0),ZGMVF)  
  ELSE
    CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
     & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
     & PB1(1,MSLB1U0),ZGMVF)  
  ENDIF
  DO JLEV=1,NFLEVG
    DO JROF=KST,KPROF
      PGMVF(JROF,JLEV,YGP%MU)=PGMVF(JROF,JLEV,YGP%MU)+ZGMVF(JROF,JLEV)
    ENDDO
  ENDDO

  IF (LRSIDDH) THEN
    ! Linear terms interpolated separately for DDH.
    IF (YDML_DYN%YRDYNA%LCOMAD_W) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1U9_SI),ZGMVF)
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1U9_SI),ZGMVF)
    ENDIF
    DO JLEV=1,NFLEVG
      DO JROF=KST,KPROF
        PGMVTNDSI(JROF,JLEV,MSIDDH_U0)=PGMVTNDSI(JROF,JLEV,MSIDDH_U0)+ZGMVF(JROF,JLEV)
      ENDDO
    ENDDO
  ENDIF

  IF (YDML_DYN%YRDYNA%LSLINL .AND. NCURRENT_ITER == 0) THEN
    ! Linear terms interpolated separately when required.
    IF (YDML_DYN%YRDYNA%LCOMAD_W) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1U9_SI),PGMVF_SI(1,1,YGP%MU))  
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1U9_SI),PGMVF_SI(1,1,YGP%MU))  
    ENDIF
  ENDIF

  IF (YDML_DYN%YRDYNA%LSETTLS .AND. YDML_DYN%YRDYNA%LPC_CHEAP .AND. NCURRENT_ITER == 0) THEN
    IF (YDML_DYN%YRDYNA%LCOMAD_W) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1U9_NL),PGMVF_NL(1,1,YGP%MU))  
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1U9_NL),PGMVF_NL(1,1,YGP%MU))  
    ENDIF
  ENDIF

  ! --- Split physics requiring a trilinear interpolation:
  IF(LDSLPHY) THEN
    IF (YDML_DYN%YRDYNA%LCOMAD_W) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1UP9),PUPF) 
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1UP9),PUPF)   
    ENDIF   
  ENDIF

ENDIF
   
! * V-Momentum equation:

LLMOM=.TRUE.

! --- part of the RHS requiring a "high order" interpolation:
CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,IWKM,&
 & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_W,YDML_DYN%YRDYNA%LSLHD_W,LVWENO_W,WENO_ALPHA_W,LLMOM,LQMW,LQMHW,KNOWENO,KL0,PLSCAW,PRSCAW,&
 & PB1(1,MSLB1V9),PGMVF(1,1,YGP%MV))

IF (LRSLDDH) THEN
  DO JLEV=1,NFLEVG
    DO JROF=KST,KPROF
      PGMVTNDSL(JROF,JLEV,MSLDDH_V)=PGMVTNDSL(JROF,JLEV,MSLDDH_V)&
      & +PGMVF(JROF,JLEV,YGP%MV)
    ENDDO
  ENDDO
ENDIF

IF ((NSPLTHOI /= 0).AND.(NWLAG < 4)) THEN
  ! --- part of the RHS requiring special "high order" interpolation
  IF (NSPLTHOI == 1) THEN
    LLHOI2=LLNOSLHD
    IWK=NSLDIMK
  ELSE
    LLHOI2=YDML_DYN%YRDYNA%LSLHD_W
    IWK=IWKM
  ENDIF
  CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,IWK,&
   & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_W,LLHOI2,LVWENO_W,WENO_ALPHA_W,LLMOM,LQMW,LQMHW,KNOWENO,KL0,PLSCAW,PRSCAW,&
   & PB1(1,MSLB1VF9),ZGMVF)
  DO JLEV=1,NFLEVG
    DO JROF=KST,KPROF
      PGMVF(JROF,JLEV,YGP%MV)=PGMVF(JROF,JLEV,YGP%MV)+ZGMVF(JROF,JLEV)
    ENDDO
  ENDDO
ENDIF

IF(NWLAG >= 3) THEN

  ! --- save V in some cases:
  IF (LD2TLFF1) THEN
    ! Interpolate V at the origin point and use PVFZ
    ! to store the interpolated quantities.
    CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,IWKM,&
     & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_W,YDML_DYN%YRDYNA%LSLHD_W,LVWENO_W,WENO_ALPHA_W,LLMOM,LQMW,LQMHW,KNOWENO,KL0,PLSCAW,PRSCAW,&
     & PB1(1,MSLB1VR9),PVFZ)
  ELSE
    ! Save PGMVF(.,.,YGP%MV) in case of refined treatment of
    ! Coriolis term and lagged physics in 2TL scheme:
    PVFZ(KST:KPROF,1:NFLEVG)=PGMVF(KST:KPROF,1:NFLEVG,YGP%MV)
  ENDIF

  ! --- part of the RHS requiring a trilinear interpolation:
  IF (YDML_DYN%YRDYNA%LCOMAD_W) THEN
    CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
     & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
     & PB1(1,MSLB1V0),ZGMVF)
  ELSE
    CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
     & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
     & PB1(1,MSLB1V0),ZGMVF)
  ENDIF  
  DO JLEV=1,NFLEVG
    DO JROF=KST,KPROF
      PGMVF(JROF,JLEV,YGP%MV)=PGMVF(JROF,JLEV,YGP%MV)+ZGMVF(JROF,JLEV)
    ENDDO
  ENDDO

  IF (LRSIDDH) THEN
    ! Linear terms interpolated separately for DDH.
    IF (YDML_DYN%YRDYNA%LCOMAD_W) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1V9_SI),ZGMVF)
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1V9_SI),ZGMVF)
    ENDIF  
    DO JLEV=1,NFLEVG
      DO JROF=KST,KPROF
        PGMVTNDSI(JROF,JLEV,MSIDDH_V0)=PGMVTNDSI(JROF,JLEV,MSIDDH_V0)+ZGMVF(JROF,JLEV)
      ENDDO
    ENDDO
  ENDIF

  IF (YDML_DYN%YRDYNA%LSLINL .AND. NCURRENT_ITER == 0) THEN
    ! Linear terms interpolated separately when required.
    IF (YDML_DYN%YRDYNA%LCOMAD_W) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1V9_SI),PGMVF_SI(1,1,YGP%MV)) 
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1V9_SI),PGMVF_SI(1,1,YGP%MV)) 
    ENDIF  
  ENDIF

  IF (YDML_DYN%YRDYNA%LSETTLS .AND. YDML_DYN%YRDYNA%LPC_CHEAP .AND. NCURRENT_ITER == 0) THEN
    IF (YDML_DYN%YRDYNA%LCOMAD_W) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1V9_NL),PGMVF_NL(1,1,YGP%MV)) 
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1V9_NL),PGMVF_NL(1,1,YGP%MV)) 
    ENDIF  
  ENDIF

  ! --- Split physics requiring a trilinear interpolation:
  IF(LDSLPHY) THEN
    IF (YDML_DYN%YRDYNA%LCOMAD_W) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1VP9),PVPF)
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1VP9),PVPF)
    ENDIF                
  ENDIF

ENDIF

! * Temperature equation:

LLMOM=.FALSE. .OR. (.NOT.LSLHDHEAT)

! --- part of the RHS requiring a "high order" interpolation:
CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,IWKH,&
 & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_T,YDML_DYN%YRDYNA%LSLHD_T,LVWENO_T,WENO_ALPHA_T,LLMOM,LQMT,LQMHT,KNOWENO,KL0,PLSCAW,PRSCAW,&
 & PB1(1,MSLB1T9),PGMVF(1,1,YGP%MT))

IF (LRSLDDH) THEN
  DO JLEV=1,NFLEVG
    DO JROF=KST,KPROF
      PGMVTNDSL(JROF,JLEV,MSLDDH_T)=PGMVTNDSL(JROF,JLEV,MSLDDH_T)&
      & +PGMVF(JROF,JLEV,YGP%MT)
    ENDDO
  ENDDO
ENDIF

IF ((NSPLTHOI /= 0).AND.(NTLAG < 4)) THEN
  ! --- part of the RHS requiring special "high order" interpolation
  IF (NSPLTHOI == 1) THEN
    LLHOI2=LLNOSLHD
    IWK=NSLDIMK
  ELSE
    LLHOI2=YDML_DYN%YRDYNA%LSLHD_T
    IWK=IWKH
  ENDIF
  CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,IWK,&
   & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_T,LLHOI2,LVWENO_T,WENO_ALPHA_T,LLMOM,LQMT,LQMHT,KNOWENO,KL0,PLSCAW,PRSCAW,&
   & PB1(1,MSLB1TF9),ZGMVF)
  DO JLEV=1,NFLEVG
    DO JROF=KST,KPROF
      PGMVF(JROF,JLEV,YGP%MT)=PGMVF(JROF,JLEV,YGP%MT)+ZGMVF(JROF,JLEV)
    ENDDO
  ENDDO
ENDIF

IF(NTLAG >= 3) THEN

  ! --- part of the RHS requiring a trilinear interpolation:
  IF (YDML_DYN%YRDYNA%LCOMAD_T) THEN
    CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
     & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
     & PB1(1,MSLB1T0),ZGMVF)
  ELSE
    CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
     & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
     & PB1(1,MSLB1T0),ZGMVF)
  ENDIF  
  DO JLEV=1,NFLEVG
    DO JROF=KST,KPROF
      PGMVF(JROF,JLEV,YGP%MT)=PGMVF(JROF,JLEV,YGP%MT)+ZGMVF(JROF,JLEV)
    ENDDO
  ENDDO

  IF (LRSIDDH) THEN
    ! Linear terms interpolated separately for DDH.
    IF (YDML_DYN%YRDYNA%LCOMAD_T) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1T9_SI),ZGMVF)
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1T9_SI),ZGMVF)
    ENDIF
    DO JLEV=1,NFLEVG
      DO JROF=KST,KPROF
        PGMVTNDSI(JROF,JLEV,MSIDDH_T0)=PGMVTNDSI(JROF,JLEV,MSIDDH_T0)+ZGMVF(JROF,JLEV)
      ENDDO
    ENDDO
  ENDIF

  IF (YDML_DYN%YRDYNA%LSLINL .AND. NCURRENT_ITER == 0) THEN
    ! Linear terms interpolated separately when required.
    IF (YDML_DYN%YRDYNA%LCOMAD_T) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1T9_SI),PGMVF_SI(1,1,YGP%MT)) 
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1T9_SI),PGMVF_SI(1,1,YGP%MT))  
    ENDIF
  ENDIF

  IF (YDML_DYN%YRDYNA%LSETTLS .AND. YDML_DYN%YRDYNA%LPC_CHEAP .AND. NCURRENT_ITER == 0) THEN
    IF (YDML_DYN%YRDYNA%LCOMAD_T) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1T9_NL),PGMVF_NL(1,1,YGP%MT)) 
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1T9_NL),PGMVF_NL(1,1,YGP%MT))  
    ENDIF
  ENDIF

  ! --- Split physics requiring a trilinear interpolation:
  IF(LDSLPHY) THEN
    IF (YDML_DYN%YRDYNA%LCOMAD_T) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1TP9),PTPF)
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1TP9),PTPF)
    ENDIF
  ENDIF

ENDIF

! * Pressure departure variable equation (NH model):

IF (LNHEE) THEN

  LLMOM=.TRUE.

  ! --- part of the RHS requiring a "high order" interpolation:
  CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,IWNT,&
   & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_SPD,YDML_DYN%YRDYNA%LSLHD_SPD,LVWENO_SPD,WENO_ALPHA_SPD,LLMOM,LQMPD,LQMHPD,KNOWENO,KL0,PLSCAW,PRSCAW,&
   & PB1(1,MSLB1PD9),PGMVF(1,1,YGP%MSPD))

  ! diabatic tendency is 0 for the time being in this equation;
  ! some code must be activated here in the future when the non-zero
  ! diabatic tendency will be coded.
  !later IF (LRSLDDH) THEN
  !later   PGMVTNDSL(KST:KPROF,1:NFLEVG,MSLDDH_PD)=PGMVTNDSL(KST:KPROF,1:NFLEVG,MSLDDH_PD) &
  !later    & +PGMVF(KST:KPROF,1:NFLEVG,YGP%MSPD)
  !later ENDIF

  !later IF ((NSPLTHOI /= 0).AND.(NSPDLAG < 4)) THEN
  !later   ...
  !later ENDIF

  !later IF(NSPDLAG >= 3) THEN
  IF(NSPDLAG == 3) THEN

    ! --- part of the RHS requiring a trilinear interpolation:
    IF (YDML_DYN%YRDYNA%LCOMAD_SPD) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1PD0),ZGMVF)
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1PD0),ZGMVF)
    ENDIF  
    DO JLEV=1,NFLEVG
      DO JROF=KST,KPROF
        PGMVF(JROF,JLEV,YGP%MSPD)=PGMVF(JROF,JLEV,YGP%MSPD)+ZGMVF(JROF,JLEV)
      ENDDO
    ENDDO

    IF (LRSIDDH) THEN
      ! Linear terms interpolated separately for DDH.
      IF (YDML_DYN%YRDYNA%LCOMAD_SPD) THEN
        CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
         & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
         & PB1(1,MSLB1PD9_SI),ZGMVF)
      ELSE
        CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
         & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
         & PB1(1,MSLB1PD9_SI),ZGMVF)
      ENDIF
      DO JLEV=1,NFLEVG
        DO JROF=KST,KPROF
          PGMVTNDSI(JROF,JLEV,MSIDDH_PD0)=PGMVTNDSI(JROF,JLEV,MSIDDH_PD0)+ZGMVF(JROF,JLEV)
        ENDDO
      ENDDO
    ENDIF

    IF (YDML_DYN%YRDYNA%LSLINL .AND. NCURRENT_ITER == 0) THEN
      ! Linear terms interpolated separately when required.
      IF (YDML_DYN%YRDYNA%LCOMAD_SPD) THEN
        CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
         & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
         & PB1(1,MSLB1PD9_SI),PGMVF_SI(1,1,YGP%MSPD))  
      ELSE
        CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
         & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
         & PB1(1,MSLB1PD9_SI),PGMVF_SI(1,1,YGP%MSPD))  
      ENDIF
    ENDIF

    IF (YDML_DYN%YRDYNA%LSETTLS .AND. YDML_DYN%YRDYNA%LPC_CHEAP .AND. NCURRENT_ITER == 0) THEN
      IF (YDML_DYN%YRDYNA%LCOMAD_SPD) THEN
        CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
         & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
         & PB1(1,MSLB1PD9_NL),PGMVF_NL(1,1,YGP%MSPD))  
      ELSE
        CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
         & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
         & PB1(1,MSLB1PD9_NL),PGMVF_NL(1,1,YGP%MSPD))  
      ENDIF
    ENDIF

  ENDIF

ENDIF

! * Vertical divergence equation (NH model):
!   Valid for:
!   - case LGWADV=F.
!   - case (LGWADV,LVFE_GW)=T,T.

IF (LNHDYN) THEN

  LLMOM=.TRUE.
  LL1=.NOT.YDML_DYN%YRDYNA%LGWADV
  LL2=YDML_DYN%YRDYNA%LGWADV.AND.LVFE_GW
  LL3=YDML_DYN%YRDYNA%LGWADV.AND.(YDML_DYN%YRDYNA%ND4SYS == 2).AND.(NCURRENT_ITER < NSITER)

  ! --- part of the RHS requiring a "high order" interpolation:
  IF (LL1.OR.LL2) THEN
    CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,IWKM,&
     & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_SVD,YDML_DYN%YRDYNA%LSLHD_SVD,LVWENO_SVD,WENO_ALPHA_SVD,LLMOM,LQMVD,LQMHVD,KNOWENO,KL0,PLSCAW,PRSCAW,&
     & PB1(1,MSLB1VD9),PGMVF(1,1,YGP%MSVD))
  ENDIF

  IF (LRSLDDH) THEN
    DO JLEV=1,NFLEVG
      DO JROF=KST,KPROF
        PGMVTNDSL(JROF,JLEV,MSLDDH_VD)=PGMVTNDSL(JROF,JLEV,MSLDDH_VD)&
        & +PGMVF(JROF,JLEV,YGP%MSVD)
      ENDDO
    ENDDO
  ENDIF

  IF ((NSPLTHOI /= 0).AND.(NSVDLAG < 4)) THEN
    ! --- part of the RHS requiring special "high order" interpolation
    IF (NSPLTHOI == 1) THEN
      LLHOI2=LLNOSLHD
      IWK=NSLDIMK
    ELSE
      LLHOI2=YDML_DYN%YRDYNA%LSLHD_SVD
      IWK=IWKM
    ENDIF
    CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,IWK,&
     & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_SVD,LLHOI2,LVWENO_SVD,WENO_ALPHA_SVD,LLMOM,LQMVD,LQMHVD,KNOWENO,KL0,PLSCAW,PRSCAW,&
     & PB1(1,MSLB1VDF9),ZGMVF)
    DO JLEV=1,NFLEVG
      DO JROF=KST,KPROF
        PGMVF(JROF,JLEV,YGP%MSVD)=PGMVF(JROF,JLEV,YGP%MSVD)+ZGMVF(JROF,JLEV)
      ENDDO
    ENDDO
  ENDIF

  ! --- "X" variable requiring a "high order" interpolation,
  !     present only if NVDVAR=4 or 5 (the SLHD interpolation is never
  !     applied to this quantity):
  IF ((LL1.OR.LL3).AND.(YDML_DYN%YRDYNA%NVDVAR == 4 .OR. YDML_DYN%YRDYNA%NVDVAR == 5)) THEN
    CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,IWNT,&
     & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_SVD,LLNOSLHD,LVWENO_SVD,WENO_ALPHA_SVD,LLMOM,LQMVD,LQMHVD,KNOWENO,KL0,PLSCAW,PRSCAW,&
     & PB1(1,MSLB1NHX9),PGMVF(1,1,YGP%MNHX))
    IF (LRSLDDH) THEN
      DO JLEV=1,NFLEVG
        DO JROF=KST,KPROF
          PGMVTNDSL(JROF,JLEV,MSLDDH_NHX)=PGMVTNDSL(JROF,JLEV,MSLDDH_NHX)+PGMVF(JROF,JLEV,YGP%MNHX)
        ENDDO
      ENDDO
    ENDIF
  ENDIF

  IF(NSVDLAG >= 3) THEN

    ! --- part of the RHS requiring a trilinear interpolation:
    IF(LL1.OR.LL2) THEN
      IF (YDML_DYN%YRDYNA%LCOMAD_SVD) THEN
        CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
         & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
         & PB1(1,MSLB1VD0),ZGMVF)
      ELSE
        CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
         & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
         & PB1(1,MSLB1VD0),ZGMVF)
      ENDIF  
      DO JLEV=1,NFLEVG
        DO JROF=KST,KPROF
          PGMVF(JROF,JLEV,YGP%MSVD)=PGMVF(JROF,JLEV,YGP%MSVD)+ZGMVF(JROF,JLEV)
        ENDDO
      ENDDO

      IF (YDML_DYN%YRDYNA%LSETTLS .AND. YDML_DYN%YRDYNA%LPC_CHEAP .AND. NCURRENT_ITER == 0) THEN
        IF (YDML_DYN%YRDYNA%LCOMAD_SVD) THEN
          CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
           & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
           & PB1(1,MSLB1VD9_NL),PGMVF_NL(1,1,YGP%MSVD))
        ELSE
          CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
           & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
           & PB1(1,MSLB1VD9_NL),PGMVF_NL(1,1,YGP%MSVD))  
        ENDIF
      ENDIF
    ENDIF

    IF (LRSIDDH) THEN
      ! Linear terms interpolated separately when required.
      IF (YDML_DYN%YRDYNA%LCOMAD_SVD) THEN
        CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
         & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
         & PB1(1,MSLB1VD9_SI),ZGMVF)
      ELSE
        CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
         & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
         & PB1(1,MSLB1VD9_SI),ZGMVF)
      ENDIF
      DO JLEV=1,NFLEVG
        DO JROF=KST,KPROF
          PGMVTNDSI(JROF,JLEV,MSIDDH_VD0)=PGMVTNDSI(JROF,JLEV,MSIDDH_VD0)+ZGMVF(JROF,JLEV)
        ENDDO
      ENDDO
    ENDIF

    IF (YDML_DYN%YRDYNA%LSLINL .AND. NCURRENT_ITER == 0) THEN
      ! Linear terms interpolated separately when required.
      IF (YDML_DYN%YRDYNA%LCOMAD_SVD) THEN
        CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
         & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
         & PB1(1,MSLB1VD9_SI),PGMVF_SI(1,1,YGP%MSVD))
      ELSE
        CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
         & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
         & PB1(1,MSLB1VD9_SI),PGMVF_SI(1,1,YGP%MSVD))  
      ENDIF
    ENDIF

  ENDIF

ENDIF

!     ------------------------------------------------------------------

!*       3.    ORIGIN POINT INTERPOLATIONS FOR GFL VARIABLES.
!              ----------------------------------------------

! * Allocation:
IF ((NSPLTHOI /= 0).OR.LSPLTHOIGFL) ALLOCATE (ZGFLF(NPROMA,NFLEVG))

! * The interpolations are tri-dimensional ones.

DO JGFL=1,NUMFLDS

  IF (YCOMP(JGFL)%LADV.AND.(.NOT.YCOMP(JGFL)%LMGRID)) THEN

    IF (TRIM(YCOMP(JGFL)%CNAME) == 'TKE' ) THEN
      LLMOM=.TRUE.
    ELSE
      LLMOM=.FALSE. .OR. (.NOT.LSLHDHEAT)
    ENDIF

    IF (YDML_DYN%YRDYNA%L3DTURB) THEN
      LLHORTURB=YCOMP(JGFL)%LHORTURB
      IF(LLHORTURB) THEN
        IWKGFL=IWKH
        IF (TRIM(YCOMP(JGFL)%CNAME) == 'TKE' ) IWKGFL=IWKM
      ELSE
        IWKGFL=1
      ENDIF
    ELSE
      IWKGFL=1
    ENDIF
      
    ! --- part of the RHS requiring a "high order" interpolation or a linear one
    !     according to the value of YCOMP(JGFL)%CSLINT:
    IF (YCOMP(JGFL)%CSLINT == 'LIN(MAD)    ') THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1GFL9+(YCOMP(JGFL)%MP_SL1-1)*(NFLEN-NFLSA+1)),PGFLF(1,1,JGFL))
    ELSEIF (YCOMP(JGFL)%CSLINT == 'LIN         ') THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1GFL9+(YCOMP(JGFL)%MP_SL1-1)*(NFLEN-NFLSA+1)),PGFLF(1,1,JGFL))
    ELSE
      ! --- GFL requiring a "high order" interpolation:
      IF (NUMFLDS_SL1 > 0 .AND. NUMFLDS_SPL > 0 .AND. YCOMP(JGFL)%CSLINT == 'LAITVSPCQM  ') THEN
        CALL LAITRE_GFL(YDGEOMETRY,YGFL,YDML_DYN,JGFL,KASLB1, &
         & NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,KHVI,IWKGFL,&
         & YCOMP(JGFL)%CSLINT,YCOMP(JGFL)%WENO_ALPHA,LLMOM,KNOWENO,KL0,PLSCAW,PRSCAW,&
         & PB1(1,MSLB1GFL9+(YCOMP(JGFL)%MP_SL1-1)*(NFLEN-NFLSA+1)),&
         & PGFLF(1,1,JGFL), &
         & PXSPSL=PB1(1,MSLB1GFLSP9+(YCOMP(JGFL)%MP_SPL-1)*(NFLEN-NFLSA+1)))
      ELSE 
        CALL LAITRE_GFL(YDGEOMETRY,YGFL,YDML_DYN,JGFL,KASLB1, &
         & NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,KHVI,IWKGFL,&
         & YCOMP(JGFL)%CSLINT,YCOMP(JGFL)%WENO_ALPHA,LLMOM,KNOWENO,KL0,PLSCAW,PRSCAW,&
         & PB1(1,MSLB1GFL9+(YCOMP(JGFL)%MP_SL1-1)*(NFLEN-NFLSA+1)),&
         & PGFLF(1,1,JGFL))
      ENDIF
    ENDIF

    IF (LRSLDDH) THEN
      DO JLEV=1,NFLEVG
        DO JROF=KST,KPROF
          PGFLTNDSL(JROF,JLEV,JGFL)=PGFLTNDSL(JROF,JLEV,JGFL)&
          & +PGFLF(JROF,JLEV,JGFL)
        ENDDO
      ENDDO
    ENDIF

    LLTDIABLIN=YCOMP(JGFL)%LTDIABLIN
    IF ((NSPLTHOI /= 0).AND.(.NOT.LLTDIABLIN)) THEN
      ! --- part of the RHS requiring special "high order" interpolation
      IF (NSPLTHOI == 1) THEN
        ! Deactivate SLHD in case it is active
        SELECT CASE (YCOMP(JGFL)%CSLINT)
          CASE ('LAITQM(SLD) ')
            CLINT='LAITQM      '
          CASE ('LAITQMH(SLD)')
            CLINT='LAITQMH     '
          CASE ('LAITRI(SLD) ')
            CLINT='LAITRI      '
          CASE DEFAULT
            CLINT=YCOMP(JGFL)%CSLINT
        END SELECT
        IWK=NSLDIMK
      ELSE
        CLINT=YCOMP(JGFL)%CSLINT
        IWK=IWKGFL
      ENDIF
      CALL LAITRE_GFL(YDGEOMETRY,YGFL,YDML_DYN,JGFL,KASLB1, &
       & NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,KHVI,IWK,&
       & CLINT,YCOMP(JGFL)%WENO_ALPHA,LLMOM,KNOWENO,KL0,PLSCAW,PRSCAW,&
       & PB1(1,MSLB1GFLF9+(YCOMP(JGFL)%MP_SL1-1)*(NFLEN-NFLSA+1)),&
       & ZGFLF, &
       & PB1(1,MSLB1GFLSPF9+(YCOMP(JGFL)%MP_SPL-1)*(NFLEN-NFLSA+1)))
      DO JLEV=1,NFLEVG
        DO JROF=KST,KPROF
          PGFLF(JROF,JLEV,JGFL)= PGFLF(JROF,JLEV,JGFL) + ZGFLF(JROF,JLEV)
        ENDDO
      ENDDO
    ENDIF

    ! --- Split physics requiring a trilinear interpolation:
    !  This time the same but for different purpose (and different physics). 
    !  Unlike in previous case, here the useless computation is not performed.
    LLTDIABLIN=YCOMP(JGFL)%LTDIABLIN

    LLCOMAD=(YCOMP(JGFL)%CSLINT == 'LIN(MAD)    ') .OR.&
     &      (YCOMP(JGFL)%CSLINT == 'LAITQM(MAD) ') .OR.&
     &      (YCOMP(JGFL)%CSLINT == 'LAITQMH(MAD)') .OR.&
     &      (YCOMP(JGFL)%CSLINT == 'LAITRI(MAD) ') 

    IF(LLTDIABLIN) THEN
      IF (LLCOMAD ) THEN
        CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
         & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
         & PB1(1,MSLB1GFLF9+(YCOMP(JGFL)%MP_SL1-1)*(NFLEN-NFLSA+1)),ZGFLF)
      ELSE
        CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
         & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
         & PB1(1,MSLB1GFLF9+(YCOMP(JGFL)%MP_SL1-1)*(NFLEN-NFLSA+1)),ZGFLF)
      ENDIF
      DO JLEV=1,NFLEVG
        DO JROF=KST,KPROF
          PGFLF(JROF,JLEV,JGFL)=PGFLF(JROF,JLEV,JGFL)+ZGFLF(JROF,JLEV)
        ENDDO
      ENDDO
    ENDIF

  ENDIF ! YCOMP(JGFL)%LADV

  ! --- Split physics requiring a trilinear interpolation:
  IF(YCOMP(JGFL)%LPHY.AND.LDSLPHY) THEN
    ! The numbering of GFL fields in PGFLSLP should be consistent with
    !  what is done in GPADDSLPHY and SUSLB.
    ! For the time being fields in interpolation buffer are counted even
    !  if they are useless.
    LLCOMAD=(YCOMP(JGFL)%CSLINT == 'LIN(MAD)    ') .OR.&
     &      (YCOMP(JGFL)%CSLINT == 'LAITQM(MAD) ') .OR.&
     &      (YCOMP(JGFL)%CSLINT == 'LAITQMH(MAD)') .OR.&
     &      (YCOMP(JGFL)%CSLINT == 'LAITRI(MAD) ') 
    IF (LLCOMAD ) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1GFLP9+(JGFL-1)*(NFLEN-NFLSA+1)),PGFLPF(1,1,JGFL))
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1GFLP9+(JGFL-1)*(NFLEN-NFLSA+1)),PGFLPF(1,1,JGFL))
    ENDIF  
  ENDIF

ENDDO

! Deallocation
IF (ALLOCATED(ZGFLF)) DEALLOCATE(ZGFLF)

!     ------------------------------------------------------------------

!*       4.    ORIGIN POINT INTERPOLATIONS FOR GMVS VARIABLES.
!              -----------------------------------------------

LLMOM=.TRUE.

! * The interpolations are tri-dimensional and 2D ones.
!   Remark: 
!   The available 2D "high order" interpolator is LAIDDI.
!   The SLHD interpolator is never applied to continuity equation.

! * Continuity equation:

! --- 3D part of the RHS requiring a "high order" interpolation:
IF(NVLAG == 2) THEN
  CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,IWNT,&
   & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_SP,LLNOSLHD,LVWENO_SP,WENO_ALPHA_SP,LLMOM,LQMP,LQMHP,KNOWENO,KL0,PLSCAW,PRSCAW,&
   & PB1(1,MSLB1C9),PCF)
ENDIF

! --- 3D part of the RHS requiring a trilinear interpolation:
IF(NVLAG == 3) THEN
  IF (YDML_DYN%YRDYNA%LCOMAD_SP) THEN
    CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
     & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
     & PB1(1,MSLB1C9),PCF)
  ELSE
    CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
     & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
     & PB1(1,MSLB1C9),PCF)
  ENDIF  
  IF (YDML_DYN%YRDYNA%LSLINLC2.AND. NCURRENT_ITER == 0) THEN
    IF (YDML_DYN%YRDYNA%LCOMAD_SP) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1C9_SI),PCF_SI)
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1C9_SI),PCF_SI)
    ENDIF
  ENDIF
  IF (YDML_DYN%YRDYNA%LSETTLS .AND. YDML_DYN%YRDYNA%LPC_CHEAP .AND. NCURRENT_ITER == 0) THEN
    IF (YDML_DYN%YRDYNA%LCOMAD_SP) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAMAD),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVERMAD),&
       & PB1(1,MSLB1C9_NL),PCF_NL)
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,&
       & PLSCAW(1,1,YDTLSCAW%M_WDLAT),PLSCAW(1,1,YDTLSCAW%M_WDLO+1),KL0(1,1,1),PLSCAW(1,1,YDTLSCAW%M_WDVER),&
       & PB1(1,MSLB1C9_NL),PCF_NL)
    ENDIF
  ENDIF
ENDIF

! --- 2D part of the RHS requiring a "high order" interpolation:
IF(.NOT.LQMP.AND..NOT.LQMHP) THEN
  IF (YDML_DYN%YRDYNA%LCOMAD_SP) THEN
    CALL LAIDDI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,0,&
     & PRSCAW(1,1,YDTRSCAW%M_WCLAMAD(IWNT)),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD),PRSCAW(1,1,YDTRSCAW%M_WCLOMAD(IWNT)),KLH0,&
     & PB1(1,MSLB1SP9),PDP)
  ELSE
    CALL LAIDDI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,0,&
     & PRSCAW(1,1,YDTRSCAW%M_WCLA(IWNT)),PLSCAW(1,1,YDTLSCAW%M_WDLO),PRSCAW(1,1,YDTRSCAW%M_WCLO(IWNT)),KLH0,&
     & PB1(1,MSLB1SP9),PDP)
  ENDIF
ELSE
  IF (YDML_DYN%YRDYNA%LCOMAD_SP) THEN
    CALL LAIDDI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,1,&
     & PRSCAW(1,1,YDTRSCAW%M_WCLAMAD(IWNT)),PLSCAW(1,1,YDTLSCAW%M_WDLOMAD),PRSCAW(1,1,YDTRSCAW%M_WCLOMAD(IWNT)),KLH0,&
     & PB1(1,MSLB1SP9),PDP)
  ELSE
    CALL LAIDDI(KASLB1,NPROMA,KST,KPROF,NFLEVG,NFLSA,NFLEN,1,&
     & PRSCAW(1,1,YDTRSCAW%M_WCLA(IWNT)),PLSCAW(1,1,YDTLSCAW%M_WDLO),PRSCAW(1,1,YDTRSCAW%M_WCLO(IWNT)),KLH0,&
     & PB1(1,MSLB1SP9),PDP)
  ENDIF
ENDIF

!     ------------------------------------------------------------------

!*       5.    ORIGIN POINT INTERPOLATIONS FOR SOME MISCELLANEOUS VARIABLES.
!              -------------------------------------------------------------

! * The interpolations are tri-dimensional ones (excepted for
!   the horizontal quantity "GWD" which requires a horizontal interpolation).
!   Remark: the available 3D "high order" interpolators are
!   LAITRI, LAITQM and LAITQMH (called via LAITRE_GMV and LAITRE_GFL);
!   the 3D trilinear interpolator is LAITLI;
!   the available 2D "high order" interpolator is LAIDDI.
!   The SLHD interpolator is never applied on these variables.

! * Additional terms required for diagnostic BBC in NH model.
!   - Quantity "GWS" requires a 2D horizontal "high order" interpolation.
!   - If NSVDLAG=2, quantities "DBBC" and "DPHI" requires a "high order"
!     interpolation (SLHD interpolations, vertical Hermite cubic and
!     vertical spline cubic interpolations are not coded for these quantities).
!   - If NSVDLAG=3, quantities "DBBC" and "DPHI" requires a trilinear interpolation.
!   - Note that the calculation which is done for "DBBC" and "DPHI"
!     only provides the interpolated value for the bottom full layer.

IF (LNHDYN.AND.YDML_DYN%YRDYNA%LRDBBC) THEN

  DO JF=1,3
    DO JROF=KST,KPROF
      ZWCLA(JROF,JF)=PRSCAW(JROF,NFLEVG,YDTRSCAW%M_WCLA(IWNT)+JF-1)
      ZWCLO(JROF,JF,1)=PRSCAW(JROF,NFLEVG,YDTRSCAW%M_WCLO(IWNT)+JF-1)
      ZWCLO(JROF,JF,2)=PRSCAW(JROF,NFLEVG,YDTRSCAW%M_WCLO(IWNT)+JF+2)
      ZWCLAMAD(JROF,JF)=PRSCAW(JROF,NFLEVG,YDTRSCAW%M_WCLAMAD(IWNT)+JF-1)
      ZWCLOMAD(JROF,JF,1)=PRSCAW(JROF,NFLEVG,YDTRSCAW%M_WCLOMAD(IWNT)+JF-1)
      ZWCLOMAD(JROF,JF,2)=PRSCAW(JROF,NFLEVG,YDTRSCAW%M_WCLOMAD(IWNT)+JF+2)
    ENDDO
  ENDDO
  DO JROF=KST,KPROF
    ZWDLO(JROF,0)=PLSCAW(JROF,NFLEVG,YDTLSCAW%M_WDLO)
    ZWDLO(JROF,1)=PLSCAW(JROF,NFLEVG,YDTLSCAW%M_WDLO+1)
    ZWDLO(JROF,2)=PLSCAW(JROF,NFLEVG,YDTLSCAW%M_WDLO+2)
    ZWDLO(JROF,3)=PLSCAW(JROF,NFLEVG,YDTLSCAW%M_WDLO+3)
    ZWDLAT(JROF)=PLSCAW(JROF,NFLEVG,YDTLSCAW%M_WDLAT)
    ZWDVER(JROF)=PLSCAW(JROF,NFLEVG,YDTLSCAW%M_WDVER)
    ZWDLOMAD(JROF,0)=PLSCAW(JROF,NFLEVG,YDTLSCAW%M_WDLOMAD)
    ZWDLOMAD(JROF,1)=PLSCAW(JROF,NFLEVG,YDTLSCAW%M_WDLOMAD+1)
    ZWDLOMAD(JROF,2)=PLSCAW(JROF,NFLEVG,YDTLSCAW%M_WDLOMAD+2)
    ZWDLOMAD(JROF,3)=PLSCAW(JROF,NFLEVG,YDTLSCAW%M_WDLOMAD+3)
    ZWDLAMAD(JROF)=PLSCAW(JROF,NFLEVG,YDTLSCAW%M_WDLAMAD)
    ZWDVERMAD(JROF)=PLSCAW(JROF,NFLEVG,YDTLSCAW%M_WDVERMAD)
  ENDDO

  IF(.NOT.LQMHVD.AND..NOT.LQMVD) THEN
    IF (YDML_DYN%YRDYNA%LCOMAD_SVD) THEN
      CALL LAIDDI(KASLB1,NPROMA,KST,KPROF,1,NFLSA,NFLEN,0,&
       & ZWCLAMAD,ZWDLOMAD,ZWCLOMAD,KLH0(1:NPROMA,NFLEVG,0:3),&
       & PB1(1,MSLB1GWS9),PGWSF)
    ELSE
      CALL LAIDDI(KASLB1,NPROMA,KST,KPROF,1,NFLSA,NFLEN,0,&
       & ZWCLA,ZWDLO,ZWCLO,KLH0(1:NPROMA,NFLEVG,0:3),&
       & PB1(1,MSLB1GWS9),PGWSF)
    ENDIF
  ELSE
    IF (YDML_DYN%YRDYNA%LCOMAD_SVD) THEN
      CALL LAIDDI(KASLB1,NPROMA,KST,KPROF,1,NFLSA,NFLEN,1,&
       & ZWCLAMAD,ZWDLOMAD,ZWCLOMAD,KLH0(1:NPROMA,NFLEVG,0:3),&
       & PB1(1,MSLB1GWS9),PGWSF)
    ELSE
      CALL LAIDDI(KASLB1,NPROMA,KST,KPROF,1,NFLSA,NFLEN,1,&
       & ZWCLA,ZWDLO,ZWCLO,KLH0(1:NPROMA,NFLEVG,0:3),&
       & PB1(1,MSLB1GWS9),PGWSF)
    ENDIF
  ENDIF

  IF (NSVDLAG == 2) THEN
    CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,1,NFLSA,NFLEN,IWNT,&
     & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_SVD,LLNOSLHD,LVWENO_SVD,WENO_ALPHA_SVD,LLMOM,LQMVD,LQMHVD,KNOWENO,KL0(1:NPROMA,NFLEVG,0:3),&
     & PLSCAW(1:NPROMA,NFLEVG,1:YDTLSCAW%NDIM),PRSCAW(1:NPROMA,NFLEVG,1:YDTRSCAW%NDIM),&
     & PB1(1,MSLB1DBBC9),PDBBCF)
    CALL LAITRE_GMV(YDML_DYN,KASLB1,NPROMA,KST,KPROF,1,NFLSA,NFLEN,IWNT,&
     & LL_LIN,YDML_DYN%YRDYNA%LCOMAD_SVD,LLNOSLHD,LVWENO_SVD,WENO_ALPHA_SVD,LLMOM,LQMVD,LQMHVD,KNOWENO,KL0(1:NPROMA,NFLEVG,0:3),&
     & PLSCAW(1:NPROMA,NFLEVG,1:YDTLSCAW%NDIM),PRSCAW(1:NPROMA,NFLEVG,1:YDTRSCAW%NDIM),&
     & PB1(1,MSLB1DPHI9),PDPHIF)
  ELSEIF (NSVDLAG >= 3) THEN
    IF (YDML_DYN%YRDYNA%LCOMAD_SVD) THEN
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,1,NFLSA,NFLEN,&
       & ZWDLAMAD,ZWDLOMAD(1,1),KL0(1:NPROMA,NFLEVG,1:2),ZWDVERMAD,&
       & PB1(1,MSLB1DBBC9),PDBBCF)  
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,1,NFLSA,NFLEN,&
       & ZWDLAMAD,ZWDLOMAD(1,1),KL0(1:NPROMA,NFLEVG,1:2),ZWDVERMAD,&
       & PB1(1,MSLB1DPHI9),PDPHIF)  
    ELSE
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,1,NFLSA,NFLEN,&
       & ZWDLAT,ZWDLO(1,1),KL0(1:NPROMA,NFLEVG,1:2),ZWDVER,&
       & PB1(1,MSLB1DBBC9),PDBBCF)  
      CALL LAITLI(KASLB1,NPROMA,KST,KPROF,1,NFLSA,NFLEN,&
       & ZWDLAT,ZWDLO(1,1),KL0(1:NPROMA,NFLEVG,1:2),ZWDVER,&
       & PB1(1,MSLB1DPHI9),PDPHIF) 
    ENDIF
  ENDIF

ENDIF

!     ------------------------------------------------------------------

END ASSOCIATE
END ASSOCIATE
IF (LHOOK) CALL DR_HOOK('LARCINB',1,ZHOOK_HANDLE)
END SUBROUTINE LARCINB
