





MODULE CPG_DYN_TYPE_MOD

USE FIELD_MODULE
USE FIELD_REGISTRY_MOD
USE PARKIND1, ONLY : JPRB, JPIM

IMPLICIT NONE



TYPE CPG_DYN_XYB_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER :: ZDATA (:,:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER :: ZVIEW (:,:,:) => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DELP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DELP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RDELP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RDELP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LNPR (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_LNPR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ALPH (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_ALPH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RTGR (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RTGR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RPRE (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RPRE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RPP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RPP => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_DYN_XYB_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_DYN_XYB_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_DYN_XYB_TYPE_FINAL
END TYPE 

TYPE CPG_DYN_HWIND_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER :: ZDATA (:,:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER :: ZVIEW (:,:,:) => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UH (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_UH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VH (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_VH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WWI (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_WWI => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_DYN_HWIND_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_DYN_HWIND_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_DYN_HWIND_TYPE_FINAL
END TYPE 

TYPE CPG_DYN_RCP_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER :: ZDATA (:,:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER :: ZVIEW (:,:,:) => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_CP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: R (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_R => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_KAP => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_DYN_RCP_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_DYN_RCP_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_DYN_RCP_TYPE_FINAL
END TYPE 

TYPE CPG_DYN_CTY_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER :: ZDATA (:,:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER :: ZVIEW (:,:,:) => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EVEL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_EVEL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VVEL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_VVEL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PSDIV (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PSDIV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PSDVBC (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PSDVBC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIVDP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DIVDP => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_DYN_CTY_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_DYN_CTY_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_DYN_CTY_TYPE_FINAL
END TYPE 

TYPE CPG_DYN_TYPE

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PHI (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PHI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PRE (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PRE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PHIF (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PHIF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREF (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PREF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WRL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_WRL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREL (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_PREL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREM (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_PREM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHY (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHY => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PRE_PHY (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PRE_PHY => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWFT (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GWFT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KENE (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_KENE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHX (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHX => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PHIFL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PHIFL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PHIFM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PHIFM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREF_PHY (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PREF_PHY => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RTL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RTL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RTM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RTM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREHYD_PHY (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PREHYD_PHY => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREHYDF_PHY (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PREHYDF_PHY => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WL_PHY (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_WL_PHY => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WM_PHY (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_WM_PHY => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: W_PHY (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_W_PHY => NULL ()
  TYPE (CPG_DYN_RCP_TYPE) :: RCP
  TYPE (CPG_DYN_CTY_TYPE) :: CTY
  TYPE (CPG_DYN_HWIND_TYPE) :: UVH
  TYPE (CPG_DYN_XYB_TYPE) :: XYB
  TYPE (CPG_DYN_XYB_TYPE) :: XYB_PHY
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DBBC (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_DBBC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWS (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_GWS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWFL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GWFL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWFM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GWFM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWT (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GWT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHPREF (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHPREF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHPREH (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHPREH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QCHAL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_QCHAL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QCHAM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_QCHAM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RDPHI (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RDPHI => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_DYN_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_DYN_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_DYN_TYPE_FINAL
END TYPE

CONTAINS








SUBROUTINE CPG_DYN_XYB_TYPE_INIT (SELF, REGISTRY, NLEV, YDTXYB, PERSISTENT, PXYB)

USE INTDYN_MOD, ONLY : TXYB

CLASS (CPG_DYN_XYB_TYPE)                      :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TXYB),                   INTENT (IN)    :: YDTXYB
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PXYB (:, :, :, :)

IF (PRESENT (PXYB)) THEN
  SELF%ZDATA => PXYB
  SELF%LOWNED = .FALSE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%NPROMA, NLEV, YDTXYB%NDIM, REGISTRY%NBLOCKS))
  SELF%LOWNED = .TRUE.
ENDIF

 IF (YDTXYB%M_DELP > 0) THEN
   SELF%F_DELP => CREATE_FIELD_WRAP ('DELP', SELF%ZDATA (:, :, YDTXYB%M_DELP, :))
 ENDIF
 IF (YDTXYB%M_RDELP > 0) THEN
   SELF%F_RDELP => CREATE_FIELD_WRAP ('RDELP', SELF%ZDATA (:, :, YDTXYB%M_RDELP, :))
 ENDIF
 IF (YDTXYB%M_LNPR > 0) THEN
   SELF%F_LNPR => CREATE_FIELD_WRAP ('LNPR', SELF%ZDATA (:, :, YDTXYB%M_LNPR, :))
 ENDIF
 IF (YDTXYB%M_ALPH > 0) THEN
   SELF%F_ALPH => CREATE_FIELD_WRAP ('ALPH', SELF%ZDATA (:, :, YDTXYB%M_ALPH, :))
 ENDIF
 IF (YDTXYB%M_RTGR > 0) THEN
   SELF%F_RTGR => CREATE_FIELD_WRAP ('RTGR', SELF%ZDATA (:, :, YDTXYB%M_RTGR, :))
 ENDIF
 IF (YDTXYB%M_RPRE > 0) THEN
   SELF%F_RPRE => CREATE_FIELD_WRAP ('RPRE', SELF%ZDATA (:, :, YDTXYB%M_RPRE, :))
 ENDIF
 IF (YDTXYB%M_RPP > 0) THEN
   SELF%F_RPP => CREATE_FIELD_WRAP ('RPP', SELF%ZDATA (:, :, YDTXYB%M_RPP, :))
 ENDIF


END SUBROUTINE

SUBROUTINE CPG_DYN_XYB_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_DYN_XYB_TYPE)     :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

SELF%ZVIEW => SELF%ZDATA (:,:,:,BLOCK_INDEX)

IF (ASSOCIATED (SELF%F_DELP)) SELF%DELP  => SELF%F_DELP%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_RDELP)) SELF%RDELP  => SELF%F_RDELP%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_LNPR)) SELF%LNPR  => SELF%F_LNPR%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_ALPH)) SELF%ALPH  => SELF%F_ALPH%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_RTGR)) SELF%RTGR  => SELF%F_RTGR%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_RPRE)) SELF%RPRE  => SELF%F_RPRE%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_RPP)) SELF%RPP  => SELF%F_RPP%GET_VIEW (BLOCK_INDEX)

END SUBROUTINE

SUBROUTINE CPG_DYN_XYB_TYPE_FINAL (SELF)
CLASS (CPG_DYN_XYB_TYPE)          :: SELF

IF (SELF%LOWNED) DEALLOCATE (SELF%ZDATA)
SELF%ZDATA => NULL ()

IF (ASSOCIATED (SELF%F_DELP)) CALL DELETE_TEMPORARY (SELF%F_DELP) 
IF (ASSOCIATED (SELF%F_RDELP)) CALL DELETE_TEMPORARY (SELF%F_RDELP) 
IF (ASSOCIATED (SELF%F_LNPR)) CALL DELETE_TEMPORARY (SELF%F_LNPR) 
IF (ASSOCIATED (SELF%F_ALPH)) CALL DELETE_TEMPORARY (SELF%F_ALPH) 
IF (ASSOCIATED (SELF%F_RTGR)) CALL DELETE_TEMPORARY (SELF%F_RTGR) 
IF (ASSOCIATED (SELF%F_RPRE)) CALL DELETE_TEMPORARY (SELF%F_RPRE) 
IF (ASSOCIATED (SELF%F_RPP)) CALL DELETE_TEMPORARY (SELF%F_RPP) 

END SUBROUTINE 

SUBROUTINE CPG_DYN_HWIND_TYPE_INIT (SELF, REGISTRY, NLEV, YDTHWIND, PERSISTENT, PHWIND)

USE INTDYN_MOD, ONLY : THWIND

CLASS (CPG_DYN_HWIND_TYPE)                      :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (THWIND),                   INTENT (IN)    :: YDTHWIND
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PHWIND (:, :, :, :)

IF (PRESENT (PHWIND)) THEN
  SELF%ZDATA => PHWIND
  SELF%LOWNED = .FALSE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%NPROMA, NLEV, YDTHWIND%NDIM, REGISTRY%NBLOCKS))
  SELF%LOWNED = .TRUE.
ENDIF

 IF (YDTHWIND%M_UH > 0) THEN
   SELF%F_UH => CREATE_FIELD_WRAP ('UH', SELF%ZDATA (:, :, YDTHWIND%M_UH, :))
 ENDIF
 IF (YDTHWIND%M_VH > 0) THEN
   SELF%F_VH => CREATE_FIELD_WRAP ('VH', SELF%ZDATA (:, :, YDTHWIND%M_VH, :))
 ENDIF
 IF (YDTHWIND%M_WWI > 0) THEN
   SELF%F_WWI => CREATE_FIELD_WRAP ('WWI', SELF%ZDATA (:, :, YDTHWIND%M_WWI, :))
 ENDIF


END SUBROUTINE

SUBROUTINE CPG_DYN_HWIND_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_DYN_HWIND_TYPE)     :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

SELF%ZVIEW => SELF%ZDATA (:,:,:,BLOCK_INDEX)

IF (ASSOCIATED (SELF%F_UH)) SELF%UH (1:,0:) => SELF%F_UH%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_VH)) SELF%VH (1:,0:) => SELF%F_VH%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_WWI)) SELF%WWI (1:,0:) => SELF%F_WWI%GET_VIEW (BLOCK_INDEX)

END SUBROUTINE

SUBROUTINE CPG_DYN_HWIND_TYPE_FINAL (SELF)
CLASS (CPG_DYN_HWIND_TYPE)          :: SELF

IF (SELF%LOWNED) DEALLOCATE (SELF%ZDATA)
SELF%ZDATA => NULL ()

IF (ASSOCIATED (SELF%F_UH)) CALL DELETE_TEMPORARY (SELF%F_UH) 
IF (ASSOCIATED (SELF%F_VH)) CALL DELETE_TEMPORARY (SELF%F_VH) 
IF (ASSOCIATED (SELF%F_WWI)) CALL DELETE_TEMPORARY (SELF%F_WWI) 

END SUBROUTINE 

SUBROUTINE CPG_DYN_RCP_TYPE_INIT (SELF, REGISTRY, NLEV, YDTRCP, PERSISTENT, PRCP)

USE INTDYN_MOD, ONLY : TRCP

CLASS (CPG_DYN_RCP_TYPE)                      :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TRCP),                   INTENT (IN)    :: YDTRCP
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PRCP (:, :, :, :)

IF (PRESENT (PRCP)) THEN
  SELF%ZDATA => PRCP
  SELF%LOWNED = .FALSE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%NPROMA, NLEV, YDTRCP%NDIM, REGISTRY%NBLOCKS))
  SELF%LOWNED = .TRUE.
ENDIF

 IF (YDTRCP%M_CP > 0) THEN
   SELF%F_CP => CREATE_FIELD_WRAP ('CP', SELF%ZDATA (:, :, YDTRCP%M_CP, :))
 ENDIF
 IF (YDTRCP%M_R > 0) THEN
   SELF%F_R => CREATE_FIELD_WRAP ('R', SELF%ZDATA (:, :, YDTRCP%M_R, :))
 ENDIF
 IF (YDTRCP%M_KAP > 0) THEN
   SELF%F_KAP => CREATE_FIELD_WRAP ('KAP', SELF%ZDATA (:, :, YDTRCP%M_KAP, :))
 ENDIF


END SUBROUTINE

SUBROUTINE CPG_DYN_RCP_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_DYN_RCP_TYPE)     :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

SELF%ZVIEW => SELF%ZDATA (:,:,:,BLOCK_INDEX)

IF (ASSOCIATED (SELF%F_CP)) SELF%CP  => SELF%F_CP%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_R)) SELF%R  => SELF%F_R%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_KAP)) SELF%KAP  => SELF%F_KAP%GET_VIEW (BLOCK_INDEX)

END SUBROUTINE

SUBROUTINE CPG_DYN_RCP_TYPE_FINAL (SELF)
CLASS (CPG_DYN_RCP_TYPE)          :: SELF

IF (SELF%LOWNED) DEALLOCATE (SELF%ZDATA)
SELF%ZDATA => NULL ()

IF (ASSOCIATED (SELF%F_CP)) CALL DELETE_TEMPORARY (SELF%F_CP) 
IF (ASSOCIATED (SELF%F_R)) CALL DELETE_TEMPORARY (SELF%F_R) 
IF (ASSOCIATED (SELF%F_KAP)) CALL DELETE_TEMPORARY (SELF%F_KAP) 

END SUBROUTINE 

SUBROUTINE CPG_DYN_CTY_TYPE_INIT (SELF, REGISTRY, NLEV, YDTCTY, PERSISTENT, PCTY)

USE INTDYN_MOD, ONLY : TCTY

CLASS (CPG_DYN_CTY_TYPE)                      :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TCTY),                   INTENT (IN)    :: YDTCTY
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PCTY (:, :, :, :)

IF (PRESENT (PCTY)) THEN
  SELF%ZDATA => PCTY
  SELF%LOWNED = .FALSE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%NPROMA, NLEV, YDTCTY%NDIM, REGISTRY%NBLOCKS))
  SELF%LOWNED = .TRUE.
ENDIF

 IF (YDTCTY%M_EVEL > 0) THEN
   SELF%F_EVEL => CREATE_FIELD_WRAP ('EVEL', SELF%ZDATA (:, :, YDTCTY%M_EVEL, :))
 ENDIF
 IF (YDTCTY%M_VVEL > 0) THEN
   SELF%F_VVEL => CREATE_FIELD_WRAP ('VVEL', SELF%ZDATA (:, :, YDTCTY%M_VVEL, :))
 ENDIF
 IF (YDTCTY%M_PSDIV > 0) THEN
   SELF%F_PSDIV => CREATE_FIELD_WRAP ('PSDIV', SELF%ZDATA (:, :, YDTCTY%M_PSDIV, :))
 ENDIF
 IF (YDTCTY%M_PSDVBC > 0) THEN
   SELF%F_PSDVBC => CREATE_FIELD_WRAP ('PSDVBC', SELF%ZDATA (:, :, YDTCTY%M_PSDVBC, :))
 ENDIF
 IF (YDTCTY%M_DIVDP > 0) THEN
   SELF%F_DIVDP => CREATE_FIELD_WRAP ('DIVDP', SELF%ZDATA (:, :, YDTCTY%M_DIVDP, :))
 ENDIF


END SUBROUTINE

SUBROUTINE CPG_DYN_CTY_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_DYN_CTY_TYPE)     :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

SELF%ZVIEW => SELF%ZDATA (:,:,:,BLOCK_INDEX)

IF (ASSOCIATED (SELF%F_EVEL)) SELF%EVEL (1:,0:) => SELF%F_EVEL%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_VVEL)) SELF%VVEL (1:,0:) => SELF%F_VVEL%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_PSDIV)) SELF%PSDIV (1:,0:) => SELF%F_PSDIV%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_PSDVBC)) SELF%PSDVBC (1:,0:) => SELF%F_PSDVBC%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_DIVDP)) SELF%DIVDP (1:,0:) => SELF%F_DIVDP%GET_VIEW (BLOCK_INDEX)

END SUBROUTINE

SUBROUTINE CPG_DYN_CTY_TYPE_FINAL (SELF)
CLASS (CPG_DYN_CTY_TYPE)          :: SELF

IF (SELF%LOWNED) DEALLOCATE (SELF%ZDATA)
SELF%ZDATA => NULL ()

IF (ASSOCIATED (SELF%F_EVEL)) CALL DELETE_TEMPORARY (SELF%F_EVEL) 
IF (ASSOCIATED (SELF%F_VVEL)) CALL DELETE_TEMPORARY (SELF%F_VVEL) 
IF (ASSOCIATED (SELF%F_PSDIV)) CALL DELETE_TEMPORARY (SELF%F_PSDIV) 
IF (ASSOCIATED (SELF%F_PSDVBC)) CALL DELETE_TEMPORARY (SELF%F_PSDVBC) 
IF (ASSOCIATED (SELF%F_DIVDP)) CALL DELETE_TEMPORARY (SELF%F_DIVDP) 

END SUBROUTINE 

SUBROUTINE CPG_DYN_TYPE_INIT (SELF, KT, REGISTRY, NLEV, PERSISTENT, LDMF_PHYS &
                           &, PHIF &
                           &, PREF &
                           &, PWRL &
                           &, PRCP &
                           &, PCTY &
                           &)

USE INTDYN_MOD, ONLY : YYTCTY0, YYTRCP0, YYTHW0, YYTXYB0, YYTXYB0_PHY
USE INTDYN_MOD, ONLY :          YYTRCP9, YYTHW9, YYTXYB9, YYTXYB9_PHY
USE INTDYN_MOD, ONLY : TRCP, TCTY, THWIND, TXYB
USE YOMCT0    , ONLY : LNHDYN

CLASS (CPG_DYN_TYPE)                         :: SELF
INTEGER(KIND=JPIM),           INTENT (IN)    :: KT
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),          INTENT (IN)    :: NLEV
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PHIF(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PREF(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PWRL(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PRCP(:, :, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PCTY(:, :, :, :)
LOGICAL :: LLT0, LLMF_PHYS

TYPE (TRCP)   , POINTER :: YLTRCP     
TYPE (TCTY)   , POINTER :: YLTCTY     
TYPE (THWIND) , POINTER :: YLTHW     
TYPE (TXYB)   , POINTER :: YLTXYB     
TYPE (TXYB)   , POINTER :: YLTXYB_PHY

TYPE (TCTY),   TARGET :: YLTCTY0 
TYPE (THWIND), TARGET :: YLTHW0, YLTHW9 
TYPE (TRCP),   TARGET :: YLTRCP0, YLTRCP9 
TYPE (TXYB),   TARGET :: YLTXYB0, YLTXYB0_PHY, YLTXYB9, YLTXYB9_PHY

YLTCTY0     = YYTCTY0 
YLTHW0      = YYTHW0 
YLTHW9      = YYTHW9 
YLTRCP0     = YYTRCP0 
YLTRCP9     = YYTRCP9 
YLTXYB0     = YYTXYB0 
YLTXYB0_PHY = YYTXYB0_PHY 
YLTXYB9     = YYTXYB9 
YLTXYB9_PHY = YYTXYB9_PHY

LLT0 = KT == 0

YLTRCP     => NULL ()
YLTCTY     => NULL ()
YLTHW      => NULL ()
YLTXYB     => NULL ()
YLTXYB_PHY => NULL ()

IF (KT == 0) THEN
  YLTRCP     => YLTRCP0
  YLTCTY     => YLTCTY0
  YLTHW      => YLTHW0
  YLTXYB     => YLTXYB0
  YLTXYB_PHY => YLTXYB0_PHY
ELSEIF (KT == 9) THEN
  YLTRCP     => YLTRCP9
  YLTCTY     => NULL ()
  YLTHW      => YLTHW9
  YLTXYB     => YLTXYB9
  YLTXYB_PHY => YLTXYB9_PHY
ENDIF

LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

SELF%F_PHI => CREATE_TEMPORARY ("PHI", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)

SELF%F_PRE => CREATE_TEMPORARY ("PRE", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)

IF (PRESENT (PHIF)) THEN
  SELF%F_PHIF => CREATE_FIELD_WRAP ('PHIF', PHIF)
ELSE
  SELF%F_PHIF => CREATE_TEMPORARY ("PHIF", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (PRESENT (PREF)) THEN
  SELF%F_PREF => CREATE_FIELD_WRAP ('PREF', PREF)
ELSE
  SELF%F_PREF => CREATE_TEMPORARY ("PREF", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (PRESENT (PWRL)) THEN
  SELF%F_WRL => CREATE_FIELD_WRAP ('WRL', PWRL)
ENDIF

SELF%F_PREL => CREATE_TEMPORARY ("PREL", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_PREM => CREATE_TEMPORARY ("PREM", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_NHY => CREATE_TEMPORARY ("NHY", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)

SELF%F_PRE_PHY => CREATE_TEMPORARY ("PRE_PHY", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)

SELF%F_GWFT => CREATE_TEMPORARY ("GWFT", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)

IF (LLT0) THEN
  SELF%F_KENE => CREATE_TEMPORARY ("KENE", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

SELF%F_NHX => CREATE_TEMPORARY ("NHX", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)

IF (LLT0) THEN
  SELF%F_PHIFL => CREATE_TEMPORARY ("PHIFL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_PHIFM => CREATE_TEMPORARY ("PHIFM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

SELF%F_PREF_PHY => CREATE_TEMPORARY ("PREF_PHY", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)

IF (LLT0) THEN
  SELF%F_RTL => CREATE_TEMPORARY ("RTL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_RTM => CREATE_TEMPORARY ("RTM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_PREHYD_PHY => CREATE_TEMPORARY ("PREHYD_PHY", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_PREHYDF_PHY => CREATE_TEMPORARY ("PREHYDF_PHY", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_WL_PHY => CREATE_TEMPORARY ("WL_PHY", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_WM_PHY => CREATE_TEMPORARY ("WM_PHY", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_W_PHY => CREATE_TEMPORARY ("W_PHY", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

CALL SELF%RCP%INIT (REGISTRY, NLEV, YLTRCP, PERSISTENT, PRCP)

IF (LLT0) THEN
  CALL SELF%CTY%INIT (REGISTRY, NLEV, YLTCTY, PERSISTENT, PCTY)
ENDIF

IF (LLT0) THEN
  CALL SELF%UVH%INIT (REGISTRY, NLEV, YLTHW, PERSISTENT)
ENDIF

CALL SELF%XYB%INIT (REGISTRY, NLEV, YLTXYB, PERSISTENT)

IF (LLMF_PHYS) THEN
  CALL SELF%XYB_PHY%INIT (REGISTRY, NLEV, YLTXYB_PHY, PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_DBBC => CREATE_TEMPORARY ("DBBC", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_GWS => CREATE_TEMPORARY ("GWS", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_GWFL => CREATE_TEMPORARY ("GWFL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_GWFM => CREATE_TEMPORARY ("GWFM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN) THEN
  SELF%F_GWT => CREATE_TEMPORARY ("GWT", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN) THEN
  SELF%F_NHPREF => CREATE_TEMPORARY ("NHPREF", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN) THEN
  SELF%F_NHPREH => CREATE_TEMPORARY ("NHPREH", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_QCHAL => CREATE_TEMPORARY ("QCHAL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_QCHAM => CREATE_TEMPORARY ("QCHAM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_RDPHI => CREATE_TEMPORARY ("RDPHI", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF


END SUBROUTINE

SUBROUTINE CPG_DYN_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_DYN_TYPE)              :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_PHI)) SELF%PHI (1:,0:) => SELF%F_PHI%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_PRE)) SELF%PRE (1:,0:) => SELF%F_PRE%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_PHIF)) SELF%PHIF  => SELF%F_PHIF%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_PREF)) SELF%PREF  => SELF%F_PREF%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_WRL)) SELF%WRL  => SELF%F_WRL%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_PREL)) SELF%PREL  => SELF%F_PREL%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_PREM)) SELF%PREM  => SELF%F_PREM%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_NHY)) SELF%NHY (1:,0:) => SELF%F_NHY%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_PRE_PHY)) SELF%PRE_PHY (1:,0:) => SELF%F_PRE_PHY%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_GWFT)) SELF%GWFT  => SELF%F_GWFT%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_KENE)) SELF%KENE  => SELF%F_KENE%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_NHX)) SELF%NHX  => SELF%F_NHX%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_PHIFL)) SELF%PHIFL  => SELF%F_PHIFL%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_PHIFM)) SELF%PHIFM  => SELF%F_PHIFM%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_PREF_PHY)) SELF%PREF_PHY  => SELF%F_PREF_PHY%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_RTL)) SELF%RTL  => SELF%F_RTL%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_RTM)) SELF%RTM  => SELF%F_RTM%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_PREHYD_PHY)) SELF%PREHYD_PHY (1:,0:) => SELF%F_PREHYD_PHY%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_PREHYDF_PHY)) SELF%PREHYDF_PHY  => SELF%F_PREHYDF_PHY%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_WL_PHY)) SELF%WL_PHY  => SELF%F_WL_PHY%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_WM_PHY)) SELF%WM_PHY  => SELF%F_WM_PHY%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_W_PHY)) SELF%W_PHY  => SELF%F_W_PHY%GET_VIEW (BLOCK_INDEX)
CALL SELF%RCP%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%CTY%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%UVH%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%XYB%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%XYB_PHY%UPDATE_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_DBBC)) SELF%DBBC  => SELF%F_DBBC%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_GWS)) SELF%GWS  => SELF%F_GWS%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_GWFL)) SELF%GWFL  => SELF%F_GWFL%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_GWFM)) SELF%GWFM  => SELF%F_GWFM%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_GWT)) SELF%GWT  => SELF%F_GWT%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_NHPREF)) SELF%NHPREF  => SELF%F_NHPREF%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_NHPREH)) SELF%NHPREH  => SELF%F_NHPREH%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_QCHAL)) SELF%QCHAL  => SELF%F_QCHAL%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_QCHAM)) SELF%QCHAM  => SELF%F_QCHAM%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_RDPHI)) SELF%RDPHI  => SELF%F_RDPHI%GET_VIEW (BLOCK_INDEX)

END SUBROUTINE

SUBROUTINE CPG_DYN_TYPE_FINAL (SELF)
CLASS (CPG_DYN_TYPE)              :: SELF

IF (ASSOCIATED (SELF%F_PHI)) CALL DELETE_TEMPORARY (SELF%F_PHI) 
IF (ASSOCIATED (SELF%F_PRE)) CALL DELETE_TEMPORARY (SELF%F_PRE) 
IF (ASSOCIATED (SELF%F_PHIF)) CALL DELETE_TEMPORARY (SELF%F_PHIF) 
IF (ASSOCIATED (SELF%F_PREF)) CALL DELETE_TEMPORARY (SELF%F_PREF) 
IF (ASSOCIATED (SELF%F_WRL)) CALL DELETE_TEMPORARY (SELF%F_WRL) 
IF (ASSOCIATED (SELF%F_PREL)) CALL DELETE_TEMPORARY (SELF%F_PREL) 
IF (ASSOCIATED (SELF%F_PREM)) CALL DELETE_TEMPORARY (SELF%F_PREM) 
IF (ASSOCIATED (SELF%F_NHY)) CALL DELETE_TEMPORARY (SELF%F_NHY) 
IF (ASSOCIATED (SELF%F_PRE_PHY)) CALL DELETE_TEMPORARY (SELF%F_PRE_PHY) 
IF (ASSOCIATED (SELF%F_GWFT)) CALL DELETE_TEMPORARY (SELF%F_GWFT) 
IF (ASSOCIATED (SELF%F_KENE)) CALL DELETE_TEMPORARY (SELF%F_KENE) 
IF (ASSOCIATED (SELF%F_NHX)) CALL DELETE_TEMPORARY (SELF%F_NHX) 
IF (ASSOCIATED (SELF%F_PHIFL)) CALL DELETE_TEMPORARY (SELF%F_PHIFL) 
IF (ASSOCIATED (SELF%F_PHIFM)) CALL DELETE_TEMPORARY (SELF%F_PHIFM) 
IF (ASSOCIATED (SELF%F_PREF_PHY)) CALL DELETE_TEMPORARY (SELF%F_PREF_PHY) 
IF (ASSOCIATED (SELF%F_RTL)) CALL DELETE_TEMPORARY (SELF%F_RTL) 
IF (ASSOCIATED (SELF%F_RTM)) CALL DELETE_TEMPORARY (SELF%F_RTM) 
IF (ASSOCIATED (SELF%F_PREHYD_PHY)) CALL DELETE_TEMPORARY (SELF%F_PREHYD_PHY) 
IF (ASSOCIATED (SELF%F_PREHYDF_PHY)) CALL DELETE_TEMPORARY (SELF%F_PREHYDF_PHY) 
IF (ASSOCIATED (SELF%F_WL_PHY)) CALL DELETE_TEMPORARY (SELF%F_WL_PHY) 
IF (ASSOCIATED (SELF%F_WM_PHY)) CALL DELETE_TEMPORARY (SELF%F_WM_PHY) 
IF (ASSOCIATED (SELF%F_W_PHY)) CALL DELETE_TEMPORARY (SELF%F_W_PHY) 
CALL SELF%RCP%FINAL ()
CALL SELF%CTY%FINAL ()
CALL SELF%UVH%FINAL ()
CALL SELF%XYB%FINAL ()
CALL SELF%XYB_PHY%FINAL ()
IF (ASSOCIATED (SELF%F_DBBC)) CALL DELETE_TEMPORARY (SELF%F_DBBC) 
IF (ASSOCIATED (SELF%F_GWS)) CALL DELETE_TEMPORARY (SELF%F_GWS) 
IF (ASSOCIATED (SELF%F_GWFL)) CALL DELETE_TEMPORARY (SELF%F_GWFL) 
IF (ASSOCIATED (SELF%F_GWFM)) CALL DELETE_TEMPORARY (SELF%F_GWFM) 
IF (ASSOCIATED (SELF%F_GWT)) CALL DELETE_TEMPORARY (SELF%F_GWT) 
IF (ASSOCIATED (SELF%F_NHPREF)) CALL DELETE_TEMPORARY (SELF%F_NHPREF) 
IF (ASSOCIATED (SELF%F_NHPREH)) CALL DELETE_TEMPORARY (SELF%F_NHPREH) 
IF (ASSOCIATED (SELF%F_QCHAL)) CALL DELETE_TEMPORARY (SELF%F_QCHAL) 
IF (ASSOCIATED (SELF%F_QCHAM)) CALL DELETE_TEMPORARY (SELF%F_QCHAM) 
IF (ASSOCIATED (SELF%F_RDPHI)) CALL DELETE_TEMPORARY (SELF%F_RDPHI) 

END SUBROUTINE 

END MODULE CPG_DYN_TYPE_MOD

