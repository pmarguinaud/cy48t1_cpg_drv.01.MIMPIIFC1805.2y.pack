MODULE CPG_TYPE_MOD

USE FIELD_MODULE
USE FIELD_REGISTRY_MOD
USE PARKIND1, ONLY : JPRB, JPIM

IMPLICIT NONE

TYPE CPG_XYBDER_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LNPRL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_LNPRL => NULL ()
  INTEGER (KIND=JPIM) :: I_LNPRL = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LNPRM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_LNPRM => NULL ()
  INTEGER (KIND=JPIM) :: I_LNPRM = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ALPHL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_ALPHL => NULL ()
  INTEGER (KIND=JPIM) :: I_ALPHL = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ALPHM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_ALPHM => NULL ()
  INTEGER (KIND=JPIM) :: I_ALPHM = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ALPHPLL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_ALPHPLL => NULL ()
  INTEGER (KIND=JPIM) :: I_ALPHPLL = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ALPHPLM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_ALPHPLM => NULL ()
  INTEGER (KIND=JPIM) :: I_ALPHPLM = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: COEFD (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_COEFD => NULL ()
  INTEGER (KIND=JPIM) :: I_COEFD = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: COEFA (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_COEFA => NULL ()
  INTEGER (KIND=JPIM) :: I_COEFA = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: COEFAPL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_COEFAPL => NULL ()
  INTEGER (KIND=JPIM) :: I_COEFAPL = -1_JPIM

CONTAINS
  PROCEDURE :: INIT => CPG_XYBDER_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_XYBDER_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_XYBDER_TYPE_FINAL
END TYPE CPG_XYBDER_TYPE

TYPE CPG_XYB_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DELP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DELP => NULL ()
  INTEGER (KIND=JPIM) :: I_DELP = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RDELP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RDELP => NULL ()
  INTEGER (KIND=JPIM) :: I_RDELP = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LNPR (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_LNPR => NULL ()
  INTEGER (KIND=JPIM) :: I_LNPR = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ALPH (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_ALPH => NULL ()
  INTEGER (KIND=JPIM) :: I_ALPH = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RTGR (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RTGR => NULL ()
  INTEGER (KIND=JPIM) :: I_RTGR = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RPRE (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RPRE => NULL ()
  INTEGER (KIND=JPIM) :: I_RPRE = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RPP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RPP => NULL ()
  INTEGER (KIND=JPIM) :: I_RPP = -1_JPIM

CONTAINS
  PROCEDURE :: INIT => CPG_XYB_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_XYB_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_XYB_TYPE_FINAL
END TYPE CPG_XYB_TYPE

TYPE CPG_HWIND_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UH (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_UH => NULL ()
  INTEGER (KIND=JPIM) :: I_UH = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VH (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_VH => NULL ()
  INTEGER (KIND=JPIM) :: I_VH = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WWI (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_WWI => NULL ()
  INTEGER (KIND=JPIM) :: I_WWI = -1_JPIM

CONTAINS
  PROCEDURE :: INIT => CPG_HWIND_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_HWIND_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_HWIND_TYPE_FINAL
END TYPE CPG_HWIND_TYPE

TYPE CPG_RCP_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_CP => NULL ()
  INTEGER (KIND=JPIM) :: I_CP = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: R (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_R => NULL ()
  INTEGER (KIND=JPIM) :: I_R = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_KAP => NULL ()
  INTEGER (KIND=JPIM) :: I_KAP = -1_JPIM

CONTAINS
  PROCEDURE :: INIT => CPG_RCP_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_RCP_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_RCP_TYPE_FINAL
END TYPE CPG_RCP_TYPE

TYPE CPG_CTY_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EVEL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_EVEL => NULL ()
  INTEGER (KIND=JPIM) :: I_EVEL = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VVEL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_VVEL => NULL ()
  INTEGER (KIND=JPIM) :: I_VVEL = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PSDIV (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PSDIV => NULL ()
  INTEGER (KIND=JPIM) :: I_PSDIV = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PSDVBC (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PSDVBC => NULL ()
  INTEGER (KIND=JPIM) :: I_PSDVBC = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIVDP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DIVDP => NULL ()
  INTEGER (KIND=JPIM) :: I_DIVDP = -1_JPIM

CONTAINS
  PROCEDURE :: INIT => CPG_CTY_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_CTY_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_CTY_TYPE_FINAL
END TYPE CPG_CTY_TYPE

TYPE CPG_TND_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDU (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_TNDU => NULL ()
  INTEGER (KIND=JPIM) :: I_TNDU = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDV (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_TNDV => NULL ()
  INTEGER (KIND=JPIM) :: I_TNDV = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDU_NOC (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_TNDU_NOC => NULL ()
  INTEGER (KIND=JPIM) :: I_TNDU_NOC = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDV_NOC (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_TNDV_NOC => NULL ()
  INTEGER (KIND=JPIM) :: I_TNDV_NOC = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDT (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_TNDT => NULL ()
  INTEGER (KIND=JPIM) :: I_TNDT = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDPD (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_TNDPD => NULL ()
  INTEGER (KIND=JPIM) :: I_TNDPD = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDVD (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_TNDVD => NULL ()
  INTEGER (KIND=JPIM) :: I_TNDVD = -1_JPIM
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDGW (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_TNDGW => NULL ()
  INTEGER (KIND=JPIM) :: I_TNDGW = -1_JPIM

CONTAINS
  PROCEDURE :: INIT => CPG_TND_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_TND_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_TND_TYPE_FINAL
END TYPE CPG_TND_TYPE

TYPE CPG_GP_T_TMP_TYPE

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GDW (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GDW => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWHT (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GWHT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: OROGLL (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_OROGLL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: OROGMM (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_OROGMM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: OROGLM (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_OROGLM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DELNHPRE (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DELNHPRE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DPHYCTY (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DPHYCTY => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DVER (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DVER => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DVERL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DVERL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DVERM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DVERM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DVERW (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DVERW => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EIQCHAF (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_EIQCHAF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EQCHAF (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_EQCHAF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EQCHAH (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_EQCHAH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GPHL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GPHL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GPHM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GPHM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWHL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GWHL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWHM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GWHM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAPH (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_KAPH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LNNHPREFL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_LNNHPREFL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LNNHPREFM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_LNNHPREFM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHPPI (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHPPI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHPREL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHPREL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHPREM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHPREM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHXD_T (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHXD_T => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHXS (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHXS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHXS_T (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHXS_T => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHXT (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHXT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PDEP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PDEP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PDEPS (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_PDEPS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PSGRTL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PSGRTL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PSGRTM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PSGRTM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: R0T (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_R0T => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: R9T (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_R9T => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RDT (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RDT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RDTL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RDTL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RDTM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RDTM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RNHPPI (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RNHPPI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RPREF (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RPREF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RRED (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RRED => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RT (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RTR (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RTR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SGRTL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_SGRTL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SGRTM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_SGRTM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SGRTSL (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_SGRTSL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SGRTSM (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_SGRTSM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SVDINCR13 (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_SVDINCR13 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDGWF_LAP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_TNDGWF_LAP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDGWF_OTH (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_TNDGWF_OTH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDGWH_LAP (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_TNDGWH_LAP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDGWH_OTH (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_TNDGWH_OTH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDUS (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_TNDUS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDVS (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_TNDVS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: US (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_US => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: US_L (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_US_L => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: US_M (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_US_M => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VS (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_VS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VS_L (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_VS_L => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VS_M (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_VS_M => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: Z3DIVG (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_Z3DIVG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WH2F (:, :, :) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_WH2F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZERO (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_ZERO => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ONE (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_ONE => NULL ()
  TYPE (CPG_XYBDER_TYPE) :: XYBDER
  TYPE (CPG_HWIND_TYPE) :: UVH

CONTAINS
  PROCEDURE :: INIT => CPG_GP_T_TMP_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_GP_T_TMP_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_GP_T_TMP_TYPE_FINAL
END TYPE CPG_GP_T_TMP_TYPE

TYPE CPG_GP_TMP_TYPE

  TYPE (CPG_GP_T_TMP_TYPE) :: T0
  TYPE (CPG_GP_T_TMP_TYPE) :: T9

CONTAINS
  PROCEDURE :: INIT => CPG_GP_TMP_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_GP_TMP_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_GP_TMP_TYPE_FINAL
END TYPE CPG_GP_TMP_TYPE

TYPE CPG_DYN_TYPE

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: OROGL (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_OROGL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: OROGM (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_OROGM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PHI (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PHI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PRE (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PRE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PHIF (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PHIF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREF (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PREF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WRL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_WRL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREL (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_PREL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREM (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_PREM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHY (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHY => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWFT (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GWFT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KENE (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_KENE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHX (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHX => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PHIFL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PHIFL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PHIFM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PHIFM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RTL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RTL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RTM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RTM => NULL ()
  TYPE (CPG_RCP_TYPE) :: RCP
  TYPE (CPG_CTY_TYPE) :: CTY
  TYPE (CPG_HWIND_TYPE) :: UVH
  TYPE (CPG_XYB_TYPE) :: XYB
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DBBC (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_DBBC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWS (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_GWS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWFL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GWFL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWFM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GWFM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWT (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GWT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHPREF (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHPREF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHPREH (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NHPREH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QCHAL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_QCHAL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QCHAM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_QCHAM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RDPHI (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RDPHI => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_DYN_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_DYN_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_DYN_TYPE_FINAL
END TYPE CPG_DYN_TYPE

TYPE CPG_PHY_TYPE

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PRE (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PRE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREF (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PREF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREHYD (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PREHYD => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREHYDF (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_PREHYDF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WL (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_WL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WM (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_WM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: W (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_W => NULL ()
  TYPE (CPG_XYB_TYPE) :: XYB

CONTAINS
  PROCEDURE :: INIT => CPG_PHY_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_PHY_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_PHY_TYPE_FINAL
END TYPE CPG_PHY_TYPE

TYPE CPG_MISC_TYPE

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NEB (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_NEB => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QLI (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_QLI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QICE (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_QICE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QRAIN (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_QRAIN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QSNOW (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_QSNOW => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RH (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_RH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QS (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_QS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QSOL (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_QSOL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DHSF (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_DHSF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CLCT (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_CLCT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LSM (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_LSM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TSOL (:) => NULL ()
  TYPE (FIELD_2D), POINTER :: F_TSOL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FTCNS (:, :, :) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_FTCNS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KOZO (:, :, :) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_KOZO => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GPAR (:, :) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_GPAR => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_MISC_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_MISC_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_MISC_TYPE_FINAL
END TYPE CPG_MISC_TYPE

TYPE CPG_TMP_TYPE
  TYPE (CPG_GP_TMP_TYPE) :: CPG_GP
CONTAINS
  PROCEDURE :: INIT => CPG_TMP_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_TMP_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_TMP_TYPE_FINAL
END TYPE CPG_TMP_TYPE

TYPE CPG_DDH_TYPE
  REAL(KIND=JPRB), POINTER, CONTIGUOUS :: AUX3D (:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_AUX3D => NULL ()
  
  REAL(KIND=JPRB), POINTER, CONTIGUOUS :: AUX2D (:,:) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_AUX2D => NULL ()

  REAL(KIND=JPRB), POINTER, CONTIGUOUS :: DHCV  (:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_DHCV => NULL ()
  REAL(KIND=JPRB), POINTER, CONTIGUOUS :: AUXSM (:,:,:,:) => NULL ()
  TYPE (FIELD_5D), POINTER :: F_AUXSM => NULL ()
  INTEGER(KIND=JPIM), POINTER, CONTIGUOUS :: DDHI (:) => NULL ()
  TYPE (FIELD_INT2D), POINTER :: F_DDHI => NULL ()
CONTAINS
  PROCEDURE :: INIT => CPG_DDH_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_DDH_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_DDH_TYPE_FINAL
END TYPE CPG_DDH_TYPE




TYPE CPG_SL1_TYPE
  INTEGER (KIND=JPIM) :: NLEV = -1
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: U9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_U9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: V9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_V9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: T9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_T9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PD9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_PD9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VD9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_VD9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHX9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_NHX9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UR0 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_UR0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VR0 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_VR0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZR0 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_ZR0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WR0 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_WR0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UR00 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_UR00
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VR00 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_VR00
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZR00 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_ZR00
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WR00 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_WR00
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WRA (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_WRA
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UR9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_UR9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VR9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_VR9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DBBC9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_DBBC9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DPHI9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_DPHI9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWS9 (:) => NULL ()
  INTEGER (KIND=JPIM) :: I_GWS9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: U0 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_U0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: V0 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_V0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: T0 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_T0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PD0 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_PD0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VD0 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_VD0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: C9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_C9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SP9 (:) => NULL ()
  INTEGER (KIND=JPIM) :: I_SP9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SP0 (:) => NULL ()
  INTEGER (KIND=JPIM) :: I_SP0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: C0 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_C0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UP9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_UP9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VP9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_VP9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TP9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_TP9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: U9_SI (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_U9_SI
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: V9_SI (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_V9_SI
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: T9_SI (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_T9_SI
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PD9_SI (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_PD9_SI
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VD9_SI (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_VD9_SI
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: C9_SI (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_C9_SI
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UF9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_UF9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VF9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_VF9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TF9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_TF9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VDF9 (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_VDF9
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: U9_NL (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_U9_NL
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: V9_NL (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_V9_NL
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: T9_NL (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_T9_NL
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PD9_NL (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_PD9_NL
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VD9_NL (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_VD9_NL
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: C9_NL (:,:) => NULL ()
  INTEGER (KIND=JPIM) :: I_C9_NL
CONTAINS
  PROCEDURE :: INIT => CPG_SL1_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_SL1_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_SL1_TYPE_FINAL
END TYPE CPG_SL1_TYPE

TYPE CPG_SL2_TYPE
  INTEGER (KIND=JPIM) :: NLEV = -1
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DATA => NULL ()
CONTAINS
  PROCEDURE :: INIT => CPG_SL2_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_SL2_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_SL2_TYPE_FINAL
END TYPE CPG_SL2_TYPE

REAL(KIND=JPRB),    PRIVATE, SAVE, TARGET :: ZDUM1 (1), ZDUM2 (1, 1), ZDUM3 (1,1,1)
INTEGER(KIND=JPIM), PRIVATE, SAVE, TARGET :: IDUM1 (1), IDUM2 (1, 1), IDUM3 (1,1,1)

CONTAINS

SUBROUTINE CPG_XYBDER_TYPE_INIT (SELF, REGISTRY, NLEV, YDTXYBDER, PERSISTENT, PTXYBDER)

USE INTDYN_MOD, ONLY : TXYBDER

CLASS (CPG_XYBDER_TYPE)                          :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TXYBDER),                    INTENT (IN)    :: YDTXYBDER
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PTXYBDER (:, :, :, :)

IF (PRESENT (PTXYBDER)) THEN
  SELF%F_DATA => CREATE_FIELD_WRAP ('CPG_XYBDER_TYPE', PTXYBDER (:, :, :, :))
ELSE
  SELF%F_DATA => CREATE_TEMPORARY ('CPG_XYBDER_TYPE', GEOM=REGISTRY%GEOM, NLEV=NLEV, NDIM=YDTXYBDER%NDIM, PERSISTENT=PERSISTENT)
ENDIF

SELF%I_LNPRL = YDTXYBDER%M_LNPRL
SELF%I_LNPRM = YDTXYBDER%M_LNPRM
SELF%I_ALPHL = YDTXYBDER%M_ALPHL
SELF%I_ALPHM = YDTXYBDER%M_ALPHM
SELF%I_ALPHPLL = YDTXYBDER%M_ALPHPLL
SELF%I_ALPHPLM = YDTXYBDER%M_ALPHPLM
SELF%I_COEFD = YDTXYBDER%M_COEFD
SELF%I_COEFA = YDTXYBDER%M_COEFA
SELF%I_COEFAPL = YDTXYBDER%M_COEFAPL


END SUBROUTINE CPG_XYBDER_TYPE_INIT

SUBROUTINE CPG_XYBDER_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_XYBDER_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN

  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)

  IF (SELF%I_LNPRL > 0) THEN
    SELF%LNPRL  => SELF%ZVIEW (:, :, SELF%I_LNPRL)
  ELSE
    SELF%LNPRL  => ZDUM2
  ENDIF
  IF (SELF%I_LNPRM > 0) THEN
    SELF%LNPRM  => SELF%ZVIEW (:, :, SELF%I_LNPRM)
  ELSE
    SELF%LNPRM  => ZDUM2
  ENDIF
  IF (SELF%I_ALPHL > 0) THEN
    SELF%ALPHL  => SELF%ZVIEW (:, :, SELF%I_ALPHL)
  ELSE
    SELF%ALPHL  => ZDUM2
  ENDIF
  IF (SELF%I_ALPHM > 0) THEN
    SELF%ALPHM  => SELF%ZVIEW (:, :, SELF%I_ALPHM)
  ELSE
    SELF%ALPHM  => ZDUM2
  ENDIF
  IF (SELF%I_ALPHPLL > 0) THEN
    SELF%ALPHPLL  => SELF%ZVIEW (:, :, SELF%I_ALPHPLL)
  ELSE
    SELF%ALPHPLL  => ZDUM2
  ENDIF
  IF (SELF%I_ALPHPLM > 0) THEN
    SELF%ALPHPLM  => SELF%ZVIEW (:, :, SELF%I_ALPHPLM)
  ELSE
    SELF%ALPHPLM  => ZDUM2
  ENDIF
  IF (SELF%I_COEFD > 0) THEN
    SELF%COEFD  => SELF%ZVIEW (:, :, SELF%I_COEFD)
  ELSE
    SELF%COEFD  => ZDUM2
  ENDIF
  IF (SELF%I_COEFA > 0) THEN
    SELF%COEFA  => SELF%ZVIEW (:, :, SELF%I_COEFA)
  ELSE
    SELF%COEFA  => ZDUM2
  ENDIF
  IF (SELF%I_COEFAPL > 0) THEN
    SELF%COEFAPL  => SELF%ZVIEW (:, :, SELF%I_COEFAPL)
  ELSE
    SELF%COEFAPL  => ZDUM2
  ENDIF

ELSE

  SELF%ZVIEW => ZDUM3

  SELF%LNPRL  => ZDUM2
  SELF%LNPRM  => ZDUM2
  SELF%ALPHL  => ZDUM2
  SELF%ALPHM  => ZDUM2
  SELF%ALPHPLL  => ZDUM2
  SELF%ALPHPLM  => ZDUM2
  SELF%COEFD  => ZDUM2
  SELF%COEFA  => ZDUM2
  SELF%COEFAPL  => ZDUM2

ENDIF


END SUBROUTINE CPG_XYBDER_TYPE_UPDATE_VIEW

SUBROUTINE CPG_XYBDER_TYPE_FINAL (SELF)
CLASS (CPG_XYBDER_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)

IF (ASSOCIATED (SELF%F_LNPRL)) CALL DELETE_TEMPORARY (SELF%F_LNPRL) 
IF (ASSOCIATED (SELF%F_LNPRM)) CALL DELETE_TEMPORARY (SELF%F_LNPRM) 
IF (ASSOCIATED (SELF%F_ALPHL)) CALL DELETE_TEMPORARY (SELF%F_ALPHL) 
IF (ASSOCIATED (SELF%F_ALPHM)) CALL DELETE_TEMPORARY (SELF%F_ALPHM) 
IF (ASSOCIATED (SELF%F_ALPHPLL)) CALL DELETE_TEMPORARY (SELF%F_ALPHPLL) 
IF (ASSOCIATED (SELF%F_ALPHPLM)) CALL DELETE_TEMPORARY (SELF%F_ALPHPLM) 
IF (ASSOCIATED (SELF%F_COEFD)) CALL DELETE_TEMPORARY (SELF%F_COEFD) 
IF (ASSOCIATED (SELF%F_COEFA)) CALL DELETE_TEMPORARY (SELF%F_COEFA) 
IF (ASSOCIATED (SELF%F_COEFAPL)) CALL DELETE_TEMPORARY (SELF%F_COEFAPL) 

END SUBROUTINE CPG_XYBDER_TYPE_FINAL

SUBROUTINE CPG_XYB_TYPE_INIT (SELF, REGISTRY, NLEV, YDTXYB, PERSISTENT, PTXYB)

USE INTDYN_MOD, ONLY : TXYB

CLASS (CPG_XYB_TYPE)                          :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TXYB),                    INTENT (IN)    :: YDTXYB
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PTXYB (:, :, :, :)

IF (PRESENT (PTXYB)) THEN
  SELF%F_DATA => CREATE_FIELD_WRAP ('CPG_XYB_TYPE', PTXYB (:, :, :, :))
ELSE
  SELF%F_DATA => CREATE_TEMPORARY ('CPG_XYB_TYPE', GEOM=REGISTRY%GEOM, NLEV=NLEV, NDIM=YDTXYB%NDIM, PERSISTENT=PERSISTENT)
ENDIF

SELF%I_DELP = YDTXYB%M_DELP
SELF%I_RDELP = YDTXYB%M_RDELP
SELF%I_LNPR = YDTXYB%M_LNPR
SELF%I_ALPH = YDTXYB%M_ALPH
SELF%I_RTGR = YDTXYB%M_RTGR
SELF%I_RPRE = YDTXYB%M_RPRE
SELF%I_RPP = YDTXYB%M_RPP


END SUBROUTINE CPG_XYB_TYPE_INIT

SUBROUTINE CPG_XYB_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_XYB_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN

  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)

  IF (SELF%I_DELP > 0) THEN
    SELF%DELP  => SELF%ZVIEW (:, :, SELF%I_DELP)
  ELSE
    SELF%DELP  => ZDUM2
  ENDIF
  IF (SELF%I_RDELP > 0) THEN
    SELF%RDELP  => SELF%ZVIEW (:, :, SELF%I_RDELP)
  ELSE
    SELF%RDELP  => ZDUM2
  ENDIF
  IF (SELF%I_LNPR > 0) THEN
    SELF%LNPR  => SELF%ZVIEW (:, :, SELF%I_LNPR)
  ELSE
    SELF%LNPR  => ZDUM2
  ENDIF
  IF (SELF%I_ALPH > 0) THEN
    SELF%ALPH  => SELF%ZVIEW (:, :, SELF%I_ALPH)
  ELSE
    SELF%ALPH  => ZDUM2
  ENDIF
  IF (SELF%I_RTGR > 0) THEN
    SELF%RTGR  => SELF%ZVIEW (:, :, SELF%I_RTGR)
  ELSE
    SELF%RTGR  => ZDUM2
  ENDIF
  IF (SELF%I_RPRE > 0) THEN
    SELF%RPRE  => SELF%ZVIEW (:, :, SELF%I_RPRE)
  ELSE
    SELF%RPRE  => ZDUM2
  ENDIF
  IF (SELF%I_RPP > 0) THEN
    SELF%RPP  => SELF%ZVIEW (:, :, SELF%I_RPP)
  ELSE
    SELF%RPP  => ZDUM2
  ENDIF

ELSE

  SELF%ZVIEW => ZDUM3

  SELF%DELP  => ZDUM2
  SELF%RDELP  => ZDUM2
  SELF%LNPR  => ZDUM2
  SELF%ALPH  => ZDUM2
  SELF%RTGR  => ZDUM2
  SELF%RPRE  => ZDUM2
  SELF%RPP  => ZDUM2

ENDIF


END SUBROUTINE CPG_XYB_TYPE_UPDATE_VIEW

SUBROUTINE CPG_XYB_TYPE_FINAL (SELF)
CLASS (CPG_XYB_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)

IF (ASSOCIATED (SELF%F_DELP)) CALL DELETE_TEMPORARY (SELF%F_DELP) 
IF (ASSOCIATED (SELF%F_RDELP)) CALL DELETE_TEMPORARY (SELF%F_RDELP) 
IF (ASSOCIATED (SELF%F_LNPR)) CALL DELETE_TEMPORARY (SELF%F_LNPR) 
IF (ASSOCIATED (SELF%F_ALPH)) CALL DELETE_TEMPORARY (SELF%F_ALPH) 
IF (ASSOCIATED (SELF%F_RTGR)) CALL DELETE_TEMPORARY (SELF%F_RTGR) 
IF (ASSOCIATED (SELF%F_RPRE)) CALL DELETE_TEMPORARY (SELF%F_RPRE) 
IF (ASSOCIATED (SELF%F_RPP)) CALL DELETE_TEMPORARY (SELF%F_RPP) 

END SUBROUTINE CPG_XYB_TYPE_FINAL

SUBROUTINE CPG_HWIND_TYPE_INIT (SELF, REGISTRY, NLEV, YDTHWIND, PERSISTENT, PTHWIND)

USE INTDYN_MOD, ONLY : THWIND

CLASS (CPG_HWIND_TYPE)                          :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (THWIND),                    INTENT (IN)    :: YDTHWIND
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PTHWIND (:, :, :, :)

IF (PRESENT (PTHWIND)) THEN
  SELF%F_DATA => CREATE_FIELD_WRAP ('CPG_HWIND_TYPE', PTHWIND (:, :, :, :))
ELSE
  SELF%F_DATA => CREATE_TEMPORARY ('CPG_HWIND_TYPE', GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NDIM=YDTHWIND%NDIM, PERSISTENT=PERSISTENT)
ENDIF

SELF%I_UH = YDTHWIND%M_UH
SELF%I_VH = YDTHWIND%M_VH
SELF%I_WWI = YDTHWIND%M_WWI


END SUBROUTINE CPG_HWIND_TYPE_INIT

SUBROUTINE CPG_HWIND_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_HWIND_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN

  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)

  IF (SELF%I_UH > 0) THEN
    SELF%UH (1:,0:) => SELF%ZVIEW (:, :, SELF%I_UH)
  ELSE
    SELF%UH (1:,0:) => ZDUM2
  ENDIF
  IF (SELF%I_VH > 0) THEN
    SELF%VH (1:,0:) => SELF%ZVIEW (:, :, SELF%I_VH)
  ELSE
    SELF%VH (1:,0:) => ZDUM2
  ENDIF
  IF (SELF%I_WWI > 0) THEN
    SELF%WWI (1:,0:) => SELF%ZVIEW (:, :, SELF%I_WWI)
  ELSE
    SELF%WWI (1:,0:) => ZDUM2
  ENDIF

ELSE

  SELF%ZVIEW => ZDUM3

  SELF%UH (1:,0:) => ZDUM2
  SELF%VH (1:,0:) => ZDUM2
  SELF%WWI (1:,0:) => ZDUM2

ENDIF


END SUBROUTINE CPG_HWIND_TYPE_UPDATE_VIEW

SUBROUTINE CPG_HWIND_TYPE_FINAL (SELF)
CLASS (CPG_HWIND_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)

IF (ASSOCIATED (SELF%F_UH)) CALL DELETE_TEMPORARY (SELF%F_UH) 
IF (ASSOCIATED (SELF%F_VH)) CALL DELETE_TEMPORARY (SELF%F_VH) 
IF (ASSOCIATED (SELF%F_WWI)) CALL DELETE_TEMPORARY (SELF%F_WWI) 

END SUBROUTINE CPG_HWIND_TYPE_FINAL

SUBROUTINE CPG_RCP_TYPE_INIT (SELF, REGISTRY, NLEV, YDTRCP, PERSISTENT, PTRCP)

USE INTDYN_MOD, ONLY : TRCP

CLASS (CPG_RCP_TYPE)                          :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TRCP),                    INTENT (IN)    :: YDTRCP
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PTRCP (:, :, :, :)

IF (PRESENT (PTRCP)) THEN
  SELF%F_DATA => CREATE_FIELD_WRAP ('CPG_RCP_TYPE', PTRCP (:, :, :, :))
ELSE
  SELF%F_DATA => CREATE_TEMPORARY ('CPG_RCP_TYPE', GEOM=REGISTRY%GEOM, NLEV=NLEV, NDIM=YDTRCP%NDIM, PERSISTENT=PERSISTENT)
ENDIF

SELF%I_CP = YDTRCP%M_CP
SELF%I_R = YDTRCP%M_R
SELF%I_KAP = YDTRCP%M_KAP


END SUBROUTINE CPG_RCP_TYPE_INIT

SUBROUTINE CPG_RCP_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_RCP_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN

  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)

  IF (SELF%I_CP > 0) THEN
    SELF%CP  => SELF%ZVIEW (:, :, SELF%I_CP)
  ELSE
    SELF%CP  => ZDUM2
  ENDIF
  IF (SELF%I_R > 0) THEN
    SELF%R  => SELF%ZVIEW (:, :, SELF%I_R)
  ELSE
    SELF%R  => ZDUM2
  ENDIF
  IF (SELF%I_KAP > 0) THEN
    SELF%KAP  => SELF%ZVIEW (:, :, SELF%I_KAP)
  ELSE
    SELF%KAP  => ZDUM2
  ENDIF

ELSE

  SELF%ZVIEW => ZDUM3

  SELF%CP  => ZDUM2
  SELF%R  => ZDUM2
  SELF%KAP  => ZDUM2

ENDIF


END SUBROUTINE CPG_RCP_TYPE_UPDATE_VIEW

SUBROUTINE CPG_RCP_TYPE_FINAL (SELF)
CLASS (CPG_RCP_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)

IF (ASSOCIATED (SELF%F_CP)) CALL DELETE_TEMPORARY (SELF%F_CP) 
IF (ASSOCIATED (SELF%F_R)) CALL DELETE_TEMPORARY (SELF%F_R) 
IF (ASSOCIATED (SELF%F_KAP)) CALL DELETE_TEMPORARY (SELF%F_KAP) 

END SUBROUTINE CPG_RCP_TYPE_FINAL

SUBROUTINE CPG_CTY_TYPE_INIT (SELF, REGISTRY, NLEV, YDTCTY, PERSISTENT, PTCTY)

USE INTDYN_MOD, ONLY : TCTY

CLASS (CPG_CTY_TYPE)                          :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TCTY),                    INTENT (IN)    :: YDTCTY
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PTCTY (:, :, :, :)

IF (PRESENT (PTCTY)) THEN
  SELF%F_DATA => CREATE_FIELD_WRAP ('CPG_CTY_TYPE', PTCTY (:, :, :, :))
ELSE
  SELF%F_DATA => CREATE_TEMPORARY ('CPG_CTY_TYPE', GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NDIM=YDTCTY%NDIM, PERSISTENT=PERSISTENT)
ENDIF

SELF%I_EVEL = YDTCTY%M_EVEL
SELF%I_VVEL = YDTCTY%M_VVEL
SELF%I_PSDIV = YDTCTY%M_PSDIV
SELF%I_PSDVBC = YDTCTY%M_PSDVBC
SELF%I_DIVDP = YDTCTY%M_DIVDP


END SUBROUTINE CPG_CTY_TYPE_INIT

SUBROUTINE CPG_CTY_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_CTY_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN

  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)

  IF (SELF%I_EVEL > 0) THEN
    SELF%EVEL (1:,0:) => SELF%ZVIEW (:, :, SELF%I_EVEL)
  ELSE
    SELF%EVEL (1:,0:) => ZDUM2
  ENDIF
  IF (SELF%I_VVEL > 0) THEN
    SELF%VVEL (1:,0:) => SELF%ZVIEW (:, :, SELF%I_VVEL)
  ELSE
    SELF%VVEL (1:,0:) => ZDUM2
  ENDIF
  IF (SELF%I_PSDIV > 0) THEN
    SELF%PSDIV (1:,0:) => SELF%ZVIEW (:, :, SELF%I_PSDIV)
  ELSE
    SELF%PSDIV (1:,0:) => ZDUM2
  ENDIF
  IF (SELF%I_PSDVBC > 0) THEN
    SELF%PSDVBC (1:,0:) => SELF%ZVIEW (:, :, SELF%I_PSDVBC)
  ELSE
    SELF%PSDVBC (1:,0:) => ZDUM2
  ENDIF
  IF (SELF%I_DIVDP > 0) THEN
    SELF%DIVDP (1:,0:) => SELF%ZVIEW (:, :, SELF%I_DIVDP)
  ELSE
    SELF%DIVDP (1:,0:) => ZDUM2
  ENDIF

ELSE

  SELF%ZVIEW => ZDUM3

  SELF%EVEL (1:,0:) => ZDUM2
  SELF%VVEL (1:,0:) => ZDUM2
  SELF%PSDIV (1:,0:) => ZDUM2
  SELF%PSDVBC (1:,0:) => ZDUM2
  SELF%DIVDP (1:,0:) => ZDUM2

ENDIF


END SUBROUTINE CPG_CTY_TYPE_UPDATE_VIEW

SUBROUTINE CPG_CTY_TYPE_FINAL (SELF)
CLASS (CPG_CTY_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)

IF (ASSOCIATED (SELF%F_EVEL)) CALL DELETE_TEMPORARY (SELF%F_EVEL) 
IF (ASSOCIATED (SELF%F_VVEL)) CALL DELETE_TEMPORARY (SELF%F_VVEL) 
IF (ASSOCIATED (SELF%F_PSDIV)) CALL DELETE_TEMPORARY (SELF%F_PSDIV) 
IF (ASSOCIATED (SELF%F_PSDVBC)) CALL DELETE_TEMPORARY (SELF%F_PSDVBC) 
IF (ASSOCIATED (SELF%F_DIVDP)) CALL DELETE_TEMPORARY (SELF%F_DIVDP) 

END SUBROUTINE CPG_CTY_TYPE_FINAL

SUBROUTINE CPG_TND_TYPE_INIT (SELF, REGISTRY, NLEV, YDTTND, PERSISTENT, PTTND)

USE INTDYN_MOD, ONLY : TTND

CLASS (CPG_TND_TYPE)                          :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TTND),                    INTENT (IN)    :: YDTTND
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PTTND (:, :, :, :)

IF (PRESENT (PTTND)) THEN
  SELF%F_DATA => CREATE_FIELD_WRAP ('CPG_TND_TYPE', PTTND (:, :, :, :))
ELSE
  SELF%F_DATA => CREATE_TEMPORARY ('CPG_TND_TYPE', GEOM=REGISTRY%GEOM, NLEV=NLEV, NDIM=YDTTND%NDIM, PERSISTENT=PERSISTENT)
ENDIF

SELF%I_TNDU = YDTTND%M_TNDU
SELF%I_TNDV = YDTTND%M_TNDV
SELF%I_TNDU_NOC = YDTTND%M_TNDU_NOC
SELF%I_TNDV_NOC = YDTTND%M_TNDV_NOC
SELF%I_TNDT = YDTTND%M_TNDT
SELF%I_TNDPD = YDTTND%M_TNDPD
SELF%I_TNDVD = YDTTND%M_TNDVD
SELF%I_TNDGW = YDTTND%M_TNDGW


END SUBROUTINE CPG_TND_TYPE_INIT

SUBROUTINE CPG_TND_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_TND_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN

  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)

  IF (SELF%I_TNDU > 0) THEN
    SELF%TNDU  => SELF%ZVIEW (:, :, SELF%I_TNDU)
  ELSE
    SELF%TNDU  => ZDUM2
  ENDIF
  IF (SELF%I_TNDV > 0) THEN
    SELF%TNDV  => SELF%ZVIEW (:, :, SELF%I_TNDV)
  ELSE
    SELF%TNDV  => ZDUM2
  ENDIF
  IF (SELF%I_TNDU_NOC > 0) THEN
    SELF%TNDU_NOC  => SELF%ZVIEW (:, :, SELF%I_TNDU_NOC)
  ELSE
    SELF%TNDU_NOC  => ZDUM2
  ENDIF
  IF (SELF%I_TNDV_NOC > 0) THEN
    SELF%TNDV_NOC  => SELF%ZVIEW (:, :, SELF%I_TNDV_NOC)
  ELSE
    SELF%TNDV_NOC  => ZDUM2
  ENDIF
  IF (SELF%I_TNDT > 0) THEN
    SELF%TNDT  => SELF%ZVIEW (:, :, SELF%I_TNDT)
  ELSE
    SELF%TNDT  => ZDUM2
  ENDIF
  IF (SELF%I_TNDPD > 0) THEN
    SELF%TNDPD  => SELF%ZVIEW (:, :, SELF%I_TNDPD)
  ELSE
    SELF%TNDPD  => ZDUM2
  ENDIF
  IF (SELF%I_TNDVD > 0) THEN
    SELF%TNDVD  => SELF%ZVIEW (:, :, SELF%I_TNDVD)
  ELSE
    SELF%TNDVD  => ZDUM2
  ENDIF
  IF (SELF%I_TNDGW > 0) THEN
    SELF%TNDGW  => SELF%ZVIEW (:, :, SELF%I_TNDGW)
  ELSE
    SELF%TNDGW  => ZDUM2
  ENDIF

ELSE

  SELF%ZVIEW => ZDUM3

  SELF%TNDU  => ZDUM2
  SELF%TNDV  => ZDUM2
  SELF%TNDU_NOC  => ZDUM2
  SELF%TNDV_NOC  => ZDUM2
  SELF%TNDT  => ZDUM2
  SELF%TNDPD  => ZDUM2
  SELF%TNDVD  => ZDUM2
  SELF%TNDGW  => ZDUM2

ENDIF


END SUBROUTINE CPG_TND_TYPE_UPDATE_VIEW

SUBROUTINE CPG_TND_TYPE_FINAL (SELF)
CLASS (CPG_TND_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)

IF (ASSOCIATED (SELF%F_TNDU)) CALL DELETE_TEMPORARY (SELF%F_TNDU) 
IF (ASSOCIATED (SELF%F_TNDV)) CALL DELETE_TEMPORARY (SELF%F_TNDV) 
IF (ASSOCIATED (SELF%F_TNDU_NOC)) CALL DELETE_TEMPORARY (SELF%F_TNDU_NOC) 
IF (ASSOCIATED (SELF%F_TNDV_NOC)) CALL DELETE_TEMPORARY (SELF%F_TNDV_NOC) 
IF (ASSOCIATED (SELF%F_TNDT)) CALL DELETE_TEMPORARY (SELF%F_TNDT) 
IF (ASSOCIATED (SELF%F_TNDPD)) CALL DELETE_TEMPORARY (SELF%F_TNDPD) 
IF (ASSOCIATED (SELF%F_TNDVD)) CALL DELETE_TEMPORARY (SELF%F_TNDVD) 
IF (ASSOCIATED (SELF%F_TNDGW)) CALL DELETE_TEMPORARY (SELF%F_TNDGW) 

END SUBROUTINE CPG_TND_TYPE_FINAL




SUBROUTINE CPG_GP_T_TMP_TYPE_INIT (SELF &
                                & , KT  &
                                & , REGISTRY &
                                & , NLEV &
                                & , PERSISTENT &
                           &)

USE INTDYN_MOD, ONLY : YYTCTY0, YYTRCP0, YYTHW0, YYTXYB0, YYTXYB0_PHY, YYTXYBDER0
USE INTDYN_MOD, ONLY :          YYTRCP9, YYTHW9, YYTXYB9, YYTXYB9_PHY
USE INTDYN_MOD, ONLY : TRCP, TCTY, THWIND, TXYB, TXYBDER

USE YOMCT0    , ONLY : LNHDYN, LNHEE, LNHQE

CLASS (CPG_GP_T_TMP_TYPE)                    :: SELF
INTEGER(KIND=JPIM),           INTENT (IN)    :: KT
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),          INTENT (IN)    :: NLEV
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT


LOGICAL :: LLT0

TYPE (TRCP)   , POINTER :: YLTRCP     
TYPE (TCTY)   , POINTER :: YLTCTY     
TYPE (THWIND) , POINTER :: YLTHW     
TYPE (TXYB)   , POINTER :: YLTXYB     
TYPE (TXYB)   , POINTER :: YLTXYB_PHY
TYPE (TXYBDER), POINTER :: YLTXYBDER

TYPE (TCTY),   TARGET :: YLTCTY0 
TYPE (THWIND), TARGET :: YLTHW0, YLTHW9 
TYPE (TRCP),   TARGET :: YLTRCP0, YLTRCP9 
TYPE (TXYB),   TARGET :: YLTXYB0, YLTXYB0_PHY, YLTXYB9, YLTXYB9_PHY
TYPE (TXYBDER),TARGET :: YLTXYBDER0

YLTCTY0     = YYTCTY0 
YLTHW0      = YYTHW0 
YLTHW9      = YYTHW9 
YLTRCP0     = YYTRCP0 
YLTRCP9     = YYTRCP9 
YLTXYB0     = YYTXYB0 
YLTXYB0_PHY = YYTXYB0_PHY 
YLTXYB9     = YYTXYB9 
YLTXYB9_PHY = YYTXYB9_PHY
YLTXYBDER0  = YYTXYBDER0

LLT0 = KT == 0

YLTRCP     => NULL ()
YLTCTY     => NULL ()
YLTHW      => NULL ()
YLTXYB     => NULL ()
YLTXYB_PHY => NULL ()
YLTXYBDER  => NULL ()

IF (KT == 0) THEN
  YLTRCP     => YLTRCP0
  YLTCTY     => YLTCTY0
  YLTHW      => YLTHW0
  YLTXYB     => YLTXYB0
  YLTXYB_PHY => YLTXYB0_PHY
  YLTXYBDER  => YLTXYBDER0
ELSEIF (KT == 9) THEN
  YLTRCP     => YLTRCP9
  YLTCTY     => NULL ()
  YLTHW      => YLTHW9
  YLTXYB     => YLTXYB9
  YLTXYB_PHY => YLTXYB9_PHY
ENDIF


IF (LNHDYN) THEN
  SELF%F_GDW => CREATE_TEMPORARY ("GDW", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

SELF%F_GWHT => CREATE_TEMPORARY ("GWHT", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)

IF (LNHDYN.AND.LLT0) THEN
  SELF%F_OROGLL => CREATE_TEMPORARY ("OROGLL", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN.AND.LLT0) THEN
  SELF%F_OROGMM => CREATE_TEMPORARY ("OROGMM", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN.AND.LLT0) THEN
  SELF%F_OROGLM => CREATE_TEMPORARY ("OROGLM", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHEE) THEN
  SELF%F_DELNHPRE => CREATE_TEMPORARY ("DELNHPRE", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.(.NOT.LNHDYN)) THEN
  SELF%F_DPHYCTY => CREATE_TEMPORARY ("DPHYCTY", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

SELF%F_DVER => CREATE_TEMPORARY ("DVER", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_DVERL => CREATE_TEMPORARY ("DVERL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_DVERM => CREATE_TEMPORARY ("DVERM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHEE) THEN
  SELF%F_DVERW => CREATE_TEMPORARY ("DVERW", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHQE) THEN
  SELF%F_EIQCHAF => CREATE_TEMPORARY ("EIQCHAF", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHQE) THEN
  SELF%F_EQCHAF => CREATE_TEMPORARY ("EQCHAF", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHQE) THEN
  SELF%F_EQCHAH => CREATE_TEMPORARY ("EQCHAH", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_GPHL => CREATE_TEMPORARY ("GPHL", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_GPHM => CREATE_TEMPORARY ("GPHM", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_GWHL => CREATE_TEMPORARY ("GWHL", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_GWHM => CREATE_TEMPORARY ("GWHM", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHQE) THEN
  SELF%F_KAPH => CREATE_TEMPORARY ("KAPH", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_LNNHPREFL => CREATE_TEMPORARY ("LNNHPREFL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_LNNHPREFM => CREATE_TEMPORARY ("LNNHPREFM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHEE) THEN
  SELF%F_NHPPI => CREATE_TEMPORARY ("NHPPI", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_NHPREL => CREATE_TEMPORARY ("NHPREL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_NHPREM => CREATE_TEMPORARY ("NHPREM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHQE) THEN
  SELF%F_NHXD_T => CREATE_TEMPORARY ("NHXD_T", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_NHXS => CREATE_TEMPORARY ("NHXS", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHQE) THEN
  SELF%F_NHXS_T => CREATE_TEMPORARY ("NHXS_T", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF ((.NOT.LNHDYN)) THEN
  SELF%F_NHXT => CREATE_TEMPORARY ("NHXT", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHEE) THEN
  SELF%F_PDEP => CREATE_TEMPORARY ("PDEP", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_PDEPS => CREATE_TEMPORARY ("PDEPS", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_PSGRTL => CREATE_TEMPORARY ("PSGRTL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_PSGRTM => CREATE_TEMPORARY ("PSGRTM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (.NOT.LLT0) THEN
  SELF%F_R0T => CREATE_TEMPORARY ("R0T", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF ((.NOT.LLT0).AND.LNHQE) THEN
  SELF%F_R9T => CREATE_TEMPORARY ("R9T", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF ((.NOT.LNHDYN).OR.LNHEE) THEN
  SELF%F_RDT => CREATE_TEMPORARY ("RDT", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_RDTL => CREATE_TEMPORARY ("RDTL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_RDTM => CREATE_TEMPORARY ("RDTM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHEE) THEN
  SELF%F_RNHPPI => CREATE_TEMPORARY ("RNHPPI", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_RPREF => CREATE_TEMPORARY ("RPREF", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHEE) THEN
  SELF%F_RRED => CREATE_TEMPORARY ("RRED", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_RT => CREATE_TEMPORARY ("RT", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_RTR => CREATE_TEMPORARY ("RTR", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_SGRTL => CREATE_TEMPORARY ("SGRTL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_SGRTM => CREATE_TEMPORARY ("SGRTM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_SGRTSL => CREATE_TEMPORARY ("SGRTSL", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_SGRTSM => CREATE_TEMPORARY ("SGRTSM", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_SVDINCR13 => CREATE_TEMPORARY ("SVDINCR13", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_TNDGWF_LAP => CREATE_TEMPORARY ("TNDGWF_LAP", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_TNDGWF_OTH => CREATE_TEMPORARY ("TNDGWF_OTH", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_TNDGWH_LAP => CREATE_TEMPORARY ("TNDGWH_LAP", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_TNDGWH_OTH => CREATE_TEMPORARY ("TNDGWH_OTH", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_TNDUS => CREATE_TEMPORARY ("TNDUS", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_TNDVS => CREATE_TEMPORARY ("TNDVS", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

SELF%F_US => CREATE_TEMPORARY ("US", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_US_L => CREATE_TEMPORARY ("US_L", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_US_M => CREATE_TEMPORARY ("US_M", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

SELF%F_VS => CREATE_TEMPORARY ("VS", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_VS_L => CREATE_TEMPORARY ("VS_L", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_VS_M => CREATE_TEMPORARY ("VS_M", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_Z3DIVG => CREATE_TEMPORARY ("Z3DIVG", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_WH2F => CREATE_TEMPORARY ("WH2F", GEOM=REGISTRY%GEOM, NLEV=NLEV, NDIM=2, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_ZERO => CREATE_TEMPORARY ("ZERO", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHQE) THEN
  SELF%F_ONE => CREATE_TEMPORARY ("ONE", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  CALL SELF%XYBDER%INIT (REGISTRY, NLEV, YLTXYBDER, PERSISTENT)
ENDIF

IF (.NOT.LLT0) THEN
  CALL SELF%UVH%INIT (REGISTRY, NLEV, YLTHW, PERSISTENT)
ENDIF


END SUBROUTINE CPG_GP_T_TMP_TYPE_INIT

SUBROUTINE CPG_GP_T_TMP_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_GP_T_TMP_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_GDW)) THEN
  SELF%GDW  => SELF%F_GDW%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GDW  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GWHT)) THEN
  SELF%GWHT (1:,0:) => SELF%F_GWHT%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWHT (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_OROGLL)) THEN
  SELF%OROGLL  => SELF%F_OROGLL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%OROGLL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_OROGMM)) THEN
  SELF%OROGMM  => SELF%F_OROGMM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%OROGMM  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_OROGLM)) THEN
  SELF%OROGLM  => SELF%F_OROGLM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%OROGLM  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_DELNHPRE)) THEN
  SELF%DELNHPRE  => SELF%F_DELNHPRE%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DELNHPRE  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DPHYCTY)) THEN
  SELF%DPHYCTY  => SELF%F_DPHYCTY%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DPHYCTY  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DVER)) THEN
  SELF%DVER  => SELF%F_DVER%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DVER  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DVERL)) THEN
  SELF%DVERL  => SELF%F_DVERL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DVERL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DVERM)) THEN
  SELF%DVERM  => SELF%F_DVERM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DVERM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DVERW)) THEN
  SELF%DVERW  => SELF%F_DVERW%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DVERW  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_EIQCHAF)) THEN
  SELF%EIQCHAF  => SELF%F_EIQCHAF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%EIQCHAF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_EQCHAF)) THEN
  SELF%EQCHAF  => SELF%F_EQCHAF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%EQCHAF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_EQCHAH)) THEN
  SELF%EQCHAH (1:,0:) => SELF%F_EQCHAH%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%EQCHAH (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GPHL)) THEN
  SELF%GPHL (1:,0:) => SELF%F_GPHL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GPHL (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GPHM)) THEN
  SELF%GPHM (1:,0:) => SELF%F_GPHM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GPHM (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GWHL)) THEN
  SELF%GWHL (1:,0:) => SELF%F_GWHL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWHL (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GWHM)) THEN
  SELF%GWHM (1:,0:) => SELF%F_GWHM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWHM (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_KAPH)) THEN
  SELF%KAPH (1:,0:) => SELF%F_KAPH%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%KAPH (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_LNNHPREFL)) THEN
  SELF%LNNHPREFL  => SELF%F_LNNHPREFL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%LNNHPREFL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_LNNHPREFM)) THEN
  SELF%LNNHPREFM  => SELF%F_LNNHPREFM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%LNNHPREFM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHPPI)) THEN
  SELF%NHPPI  => SELF%F_NHPPI%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHPPI  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHPREL)) THEN
  SELF%NHPREL  => SELF%F_NHPREL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHPREL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHPREM)) THEN
  SELF%NHPREM  => SELF%F_NHPREM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHPREM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHXD_T)) THEN
  SELF%NHXD_T  => SELF%F_NHXD_T%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHXD_T  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHXS)) THEN
  SELF%NHXS  => SELF%F_NHXS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHXS  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHXS_T)) THEN
  SELF%NHXS_T  => SELF%F_NHXS_T%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHXS_T  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHXT)) THEN
  SELF%NHXT  => SELF%F_NHXT%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHXT  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PDEP)) THEN
  SELF%PDEP  => SELF%F_PDEP%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PDEP  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PDEPS)) THEN
  SELF%PDEPS  => SELF%F_PDEPS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PDEPS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_PSGRTL)) THEN
  SELF%PSGRTL  => SELF%F_PSGRTL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PSGRTL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PSGRTM)) THEN
  SELF%PSGRTM  => SELF%F_PSGRTM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PSGRTM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_R0T)) THEN
  SELF%R0T  => SELF%F_R0T%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%R0T  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_R9T)) THEN
  SELF%R9T  => SELF%F_R9T%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%R9T  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RDT)) THEN
  SELF%RDT  => SELF%F_RDT%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RDT  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RDTL)) THEN
  SELF%RDTL  => SELF%F_RDTL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RDTL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RDTM)) THEN
  SELF%RDTM  => SELF%F_RDTM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RDTM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RNHPPI)) THEN
  SELF%RNHPPI  => SELF%F_RNHPPI%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RNHPPI  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RPREF)) THEN
  SELF%RPREF  => SELF%F_RPREF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RPREF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RRED)) THEN
  SELF%RRED  => SELF%F_RRED%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RRED  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RT)) THEN
  SELF%RT  => SELF%F_RT%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RT  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RTR)) THEN
  SELF%RTR  => SELF%F_RTR%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RTR  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_SGRTL)) THEN
  SELF%SGRTL  => SELF%F_SGRTL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%SGRTL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_SGRTM)) THEN
  SELF%SGRTM  => SELF%F_SGRTM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%SGRTM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_SGRTSL)) THEN
  SELF%SGRTSL  => SELF%F_SGRTSL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%SGRTSL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_SGRTSM)) THEN
  SELF%SGRTSM  => SELF%F_SGRTSM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%SGRTSM  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_SVDINCR13)) THEN
  SELF%SVDINCR13  => SELF%F_SVDINCR13%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%SVDINCR13  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_TNDGWF_LAP)) THEN
  SELF%TNDGWF_LAP  => SELF%F_TNDGWF_LAP%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%TNDGWF_LAP  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_TNDGWF_OTH)) THEN
  SELF%TNDGWF_OTH  => SELF%F_TNDGWF_OTH%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%TNDGWF_OTH  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_TNDGWH_LAP)) THEN
  SELF%TNDGWH_LAP (1:,0:) => SELF%F_TNDGWH_LAP%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%TNDGWH_LAP (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_TNDGWH_OTH)) THEN
  SELF%TNDGWH_OTH (1:,0:) => SELF%F_TNDGWH_OTH%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%TNDGWH_OTH (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_TNDUS)) THEN
  SELF%TNDUS  => SELF%F_TNDUS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%TNDUS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_TNDVS)) THEN
  SELF%TNDVS  => SELF%F_TNDVS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%TNDVS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_US)) THEN
  SELF%US  => SELF%F_US%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%US  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_US_L)) THEN
  SELF%US_L  => SELF%F_US_L%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%US_L  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_US_M)) THEN
  SELF%US_M  => SELF%F_US_M%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%US_M  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_VS)) THEN
  SELF%VS  => SELF%F_VS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%VS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_VS_L)) THEN
  SELF%VS_L  => SELF%F_VS_L%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%VS_L  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_VS_M)) THEN
  SELF%VS_M  => SELF%F_VS_M%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%VS_M  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_Z3DIVG)) THEN
  SELF%Z3DIVG  => SELF%F_Z3DIVG%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%Z3DIVG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_WH2F)) THEN
  SELF%WH2F  => SELF%F_WH2F%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%WH2F  => ZDUM3
ENDIF
IF (ASSOCIATED (SELF%F_ZERO)) THEN
  SELF%ZERO  => SELF%F_ZERO%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%ZERO  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_ONE)) THEN
  SELF%ONE  => SELF%F_ONE%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%ONE  => ZDUM2
ENDIF
CALL SELF%XYBDER%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%UVH%UPDATE_VIEW (BLOCK_INDEX)

END SUBROUTINE CPG_GP_T_TMP_TYPE_UPDATE_VIEW

SUBROUTINE CPG_GP_T_TMP_TYPE_FINAL (SELF)
CLASS (CPG_GP_T_TMP_TYPE)         :: SELF

IF (ASSOCIATED (SELF%F_GDW)) CALL DELETE_TEMPORARY (SELF%F_GDW) 
IF (ASSOCIATED (SELF%F_GWHT)) CALL DELETE_TEMPORARY (SELF%F_GWHT) 
IF (ASSOCIATED (SELF%F_OROGLL)) CALL DELETE_TEMPORARY (SELF%F_OROGLL) 
IF (ASSOCIATED (SELF%F_OROGMM)) CALL DELETE_TEMPORARY (SELF%F_OROGMM) 
IF (ASSOCIATED (SELF%F_OROGLM)) CALL DELETE_TEMPORARY (SELF%F_OROGLM) 
IF (ASSOCIATED (SELF%F_DELNHPRE)) CALL DELETE_TEMPORARY (SELF%F_DELNHPRE) 
IF (ASSOCIATED (SELF%F_DPHYCTY)) CALL DELETE_TEMPORARY (SELF%F_DPHYCTY) 
IF (ASSOCIATED (SELF%F_DVER)) CALL DELETE_TEMPORARY (SELF%F_DVER) 
IF (ASSOCIATED (SELF%F_DVERL)) CALL DELETE_TEMPORARY (SELF%F_DVERL) 
IF (ASSOCIATED (SELF%F_DVERM)) CALL DELETE_TEMPORARY (SELF%F_DVERM) 
IF (ASSOCIATED (SELF%F_DVERW)) CALL DELETE_TEMPORARY (SELF%F_DVERW) 
IF (ASSOCIATED (SELF%F_EIQCHAF)) CALL DELETE_TEMPORARY (SELF%F_EIQCHAF) 
IF (ASSOCIATED (SELF%F_EQCHAF)) CALL DELETE_TEMPORARY (SELF%F_EQCHAF) 
IF (ASSOCIATED (SELF%F_EQCHAH)) CALL DELETE_TEMPORARY (SELF%F_EQCHAH) 
IF (ASSOCIATED (SELF%F_GPHL)) CALL DELETE_TEMPORARY (SELF%F_GPHL) 
IF (ASSOCIATED (SELF%F_GPHM)) CALL DELETE_TEMPORARY (SELF%F_GPHM) 
IF (ASSOCIATED (SELF%F_GWHL)) CALL DELETE_TEMPORARY (SELF%F_GWHL) 
IF (ASSOCIATED (SELF%F_GWHM)) CALL DELETE_TEMPORARY (SELF%F_GWHM) 
IF (ASSOCIATED (SELF%F_KAPH)) CALL DELETE_TEMPORARY (SELF%F_KAPH) 
IF (ASSOCIATED (SELF%F_LNNHPREFL)) CALL DELETE_TEMPORARY (SELF%F_LNNHPREFL) 
IF (ASSOCIATED (SELF%F_LNNHPREFM)) CALL DELETE_TEMPORARY (SELF%F_LNNHPREFM) 
IF (ASSOCIATED (SELF%F_NHPPI)) CALL DELETE_TEMPORARY (SELF%F_NHPPI) 
IF (ASSOCIATED (SELF%F_NHPREL)) CALL DELETE_TEMPORARY (SELF%F_NHPREL) 
IF (ASSOCIATED (SELF%F_NHPREM)) CALL DELETE_TEMPORARY (SELF%F_NHPREM) 
IF (ASSOCIATED (SELF%F_NHXD_T)) CALL DELETE_TEMPORARY (SELF%F_NHXD_T) 
IF (ASSOCIATED (SELF%F_NHXS)) CALL DELETE_TEMPORARY (SELF%F_NHXS) 
IF (ASSOCIATED (SELF%F_NHXS_T)) CALL DELETE_TEMPORARY (SELF%F_NHXS_T) 
IF (ASSOCIATED (SELF%F_NHXT)) CALL DELETE_TEMPORARY (SELF%F_NHXT) 
IF (ASSOCIATED (SELF%F_PDEP)) CALL DELETE_TEMPORARY (SELF%F_PDEP) 
IF (ASSOCIATED (SELF%F_PDEPS)) CALL DELETE_TEMPORARY (SELF%F_PDEPS) 
IF (ASSOCIATED (SELF%F_PSGRTL)) CALL DELETE_TEMPORARY (SELF%F_PSGRTL) 
IF (ASSOCIATED (SELF%F_PSGRTM)) CALL DELETE_TEMPORARY (SELF%F_PSGRTM) 
IF (ASSOCIATED (SELF%F_R0T)) CALL DELETE_TEMPORARY (SELF%F_R0T) 
IF (ASSOCIATED (SELF%F_R9T)) CALL DELETE_TEMPORARY (SELF%F_R9T) 
IF (ASSOCIATED (SELF%F_RDT)) CALL DELETE_TEMPORARY (SELF%F_RDT) 
IF (ASSOCIATED (SELF%F_RDTL)) CALL DELETE_TEMPORARY (SELF%F_RDTL) 
IF (ASSOCIATED (SELF%F_RDTM)) CALL DELETE_TEMPORARY (SELF%F_RDTM) 
IF (ASSOCIATED (SELF%F_RNHPPI)) CALL DELETE_TEMPORARY (SELF%F_RNHPPI) 
IF (ASSOCIATED (SELF%F_RPREF)) CALL DELETE_TEMPORARY (SELF%F_RPREF) 
IF (ASSOCIATED (SELF%F_RRED)) CALL DELETE_TEMPORARY (SELF%F_RRED) 
IF (ASSOCIATED (SELF%F_RT)) CALL DELETE_TEMPORARY (SELF%F_RT) 
IF (ASSOCIATED (SELF%F_RTR)) CALL DELETE_TEMPORARY (SELF%F_RTR) 
IF (ASSOCIATED (SELF%F_SGRTL)) CALL DELETE_TEMPORARY (SELF%F_SGRTL) 
IF (ASSOCIATED (SELF%F_SGRTM)) CALL DELETE_TEMPORARY (SELF%F_SGRTM) 
IF (ASSOCIATED (SELF%F_SGRTSL)) CALL DELETE_TEMPORARY (SELF%F_SGRTSL) 
IF (ASSOCIATED (SELF%F_SGRTSM)) CALL DELETE_TEMPORARY (SELF%F_SGRTSM) 
IF (ASSOCIATED (SELF%F_SVDINCR13)) CALL DELETE_TEMPORARY (SELF%F_SVDINCR13) 
IF (ASSOCIATED (SELF%F_TNDGWF_LAP)) CALL DELETE_TEMPORARY (SELF%F_TNDGWF_LAP) 
IF (ASSOCIATED (SELF%F_TNDGWF_OTH)) CALL DELETE_TEMPORARY (SELF%F_TNDGWF_OTH) 
IF (ASSOCIATED (SELF%F_TNDGWH_LAP)) CALL DELETE_TEMPORARY (SELF%F_TNDGWH_LAP) 
IF (ASSOCIATED (SELF%F_TNDGWH_OTH)) CALL DELETE_TEMPORARY (SELF%F_TNDGWH_OTH) 
IF (ASSOCIATED (SELF%F_TNDUS)) CALL DELETE_TEMPORARY (SELF%F_TNDUS) 
IF (ASSOCIATED (SELF%F_TNDVS)) CALL DELETE_TEMPORARY (SELF%F_TNDVS) 
IF (ASSOCIATED (SELF%F_US)) CALL DELETE_TEMPORARY (SELF%F_US) 
IF (ASSOCIATED (SELF%F_US_L)) CALL DELETE_TEMPORARY (SELF%F_US_L) 
IF (ASSOCIATED (SELF%F_US_M)) CALL DELETE_TEMPORARY (SELF%F_US_M) 
IF (ASSOCIATED (SELF%F_VS)) CALL DELETE_TEMPORARY (SELF%F_VS) 
IF (ASSOCIATED (SELF%F_VS_L)) CALL DELETE_TEMPORARY (SELF%F_VS_L) 
IF (ASSOCIATED (SELF%F_VS_M)) CALL DELETE_TEMPORARY (SELF%F_VS_M) 
IF (ASSOCIATED (SELF%F_Z3DIVG)) CALL DELETE_TEMPORARY (SELF%F_Z3DIVG) 
IF (ASSOCIATED (SELF%F_WH2F)) CALL DELETE_TEMPORARY (SELF%F_WH2F) 
IF (ASSOCIATED (SELF%F_ZERO)) CALL DELETE_TEMPORARY (SELF%F_ZERO) 
IF (ASSOCIATED (SELF%F_ONE)) CALL DELETE_TEMPORARY (SELF%F_ONE) 
CALL SELF%XYBDER%FINAL ()
CALL SELF%UVH%FINAL ()

END SUBROUTINE CPG_GP_T_TMP_TYPE_FINAL




SUBROUTINE CPG_GP_TMP_TYPE_INIT (SELF &
                                & , REGISTRY &
                                & , NLEV &
                                & , PERSISTENT &
                           &)



CLASS (CPG_GP_TMP_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),          INTENT (IN)    :: NLEV
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT







CALL SELF%T0%INIT (0, REGISTRY, NLEV, PERSISTENT)

CALL SELF%T9%INIT (9, REGISTRY, NLEV, PERSISTENT)


END SUBROUTINE CPG_GP_TMP_TYPE_INIT

SUBROUTINE CPG_GP_TMP_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_GP_TMP_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

CALL SELF%T0%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%T9%UPDATE_VIEW (BLOCK_INDEX)

END SUBROUTINE CPG_GP_TMP_TYPE_UPDATE_VIEW

SUBROUTINE CPG_GP_TMP_TYPE_FINAL (SELF)
CLASS (CPG_GP_TMP_TYPE)         :: SELF

CALL SELF%T0%FINAL ()
CALL SELF%T9%FINAL ()

END SUBROUTINE CPG_GP_TMP_TYPE_FINAL




SUBROUTINE CPG_DYN_TYPE_INIT (SELF &
                                & , KT  &
                                & , REGISTRY &
                                & , NLEV &
                                & , PERSISTENT &
                           &, PHIF &
                           &, PREF &
                           &, PWRL &
                           &, PRCP &
                           &, PCTY &
                           &)

USE INTDYN_MOD, ONLY : YYTCTY0, YYTRCP0, YYTHW0, YYTXYB0, YYTXYB0_PHY, YYTXYBDER0
USE INTDYN_MOD, ONLY :          YYTRCP9, YYTHW9, YYTXYB9, YYTXYB9_PHY
USE INTDYN_MOD, ONLY : TRCP, TCTY, THWIND, TXYB, TXYBDER

USE YOMCT0    , ONLY : LNHDYN, LNHEE, LNHQE

CLASS (CPG_DYN_TYPE)                    :: SELF
INTEGER(KIND=JPIM),           INTENT (IN)    :: KT
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),          INTENT (IN)    :: NLEV
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT

REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PHIF(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PREF(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PWRL(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PRCP(:, :, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PCTY(:, :, :, :)

LOGICAL :: LLT0

TYPE (TRCP)   , POINTER :: YLTRCP     
TYPE (TCTY)   , POINTER :: YLTCTY     
TYPE (THWIND) , POINTER :: YLTHW     
TYPE (TXYB)   , POINTER :: YLTXYB     
TYPE (TXYB)   , POINTER :: YLTXYB_PHY
TYPE (TXYBDER), POINTER :: YLTXYBDER

TYPE (TCTY),   TARGET :: YLTCTY0 
TYPE (THWIND), TARGET :: YLTHW0, YLTHW9 
TYPE (TRCP),   TARGET :: YLTRCP0, YLTRCP9 
TYPE (TXYB),   TARGET :: YLTXYB0, YLTXYB0_PHY, YLTXYB9, YLTXYB9_PHY
TYPE (TXYBDER),TARGET :: YLTXYBDER0

YLTCTY0     = YYTCTY0 
YLTHW0      = YYTHW0 
YLTHW9      = YYTHW9 
YLTRCP0     = YYTRCP0 
YLTRCP9     = YYTRCP9 
YLTXYB0     = YYTXYB0 
YLTXYB0_PHY = YYTXYB0_PHY 
YLTXYB9     = YYTXYB9 
YLTXYB9_PHY = YYTXYB9_PHY
YLTXYBDER0  = YYTXYBDER0

LLT0 = KT == 0

YLTRCP     => NULL ()
YLTCTY     => NULL ()
YLTHW      => NULL ()
YLTXYB     => NULL ()
YLTXYB_PHY => NULL ()
YLTXYBDER  => NULL ()

IF (KT == 0) THEN
  YLTRCP     => YLTRCP0
  YLTCTY     => YLTCTY0
  YLTHW      => YLTHW0
  YLTXYB     => YLTXYB0
  YLTXYB_PHY => YLTXYB0_PHY
  YLTXYBDER  => YLTXYBDER0
ELSEIF (KT == 9) THEN
  YLTRCP     => YLTRCP9
  YLTCTY     => NULL ()
  YLTHW      => YLTHW9
  YLTXYB     => YLTXYB9
  YLTXYB_PHY => YLTXYB9_PHY
ENDIF


IF (LLT0) THEN
  SELF%F_OROGL => CREATE_TEMPORARY ("OROGL", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_OROGM => CREATE_TEMPORARY ("OROGM", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

SELF%F_PHI => CREATE_TEMPORARY ("PHI", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)

SELF%F_PRE => CREATE_TEMPORARY ("PRE", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)

IF (PRESENT (PHIF)) THEN
  SELF%F_PHIF => CREATE_FIELD_WRAP ('PHIF', PHIF)
ELSE
  SELF%F_PHIF => CREATE_TEMPORARY ("PHIF", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (PRESENT (PREF)) THEN
  SELF%F_PREF => CREATE_FIELD_WRAP ('PREF', PREF)
ELSE
  SELF%F_PREF => CREATE_TEMPORARY ("PREF", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (PRESENT (PWRL)) THEN
  SELF%F_WRL => CREATE_FIELD_WRAP ('WRL', PWRL)
ENDIF

SELF%F_PREL => CREATE_TEMPORARY ("PREL", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_PREM => CREATE_TEMPORARY ("PREM", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_NHY => CREATE_TEMPORARY ("NHY", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)

SELF%F_GWFT => CREATE_TEMPORARY ("GWFT", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)

IF (LLT0) THEN
  SELF%F_KENE => CREATE_TEMPORARY ("KENE", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

SELF%F_NHX => CREATE_TEMPORARY ("NHX", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)

IF (LLT0) THEN
  SELF%F_PHIFL => CREATE_TEMPORARY ("PHIFL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_PHIFM => CREATE_TEMPORARY ("PHIFM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_RTL => CREATE_TEMPORARY ("RTL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_RTM => CREATE_TEMPORARY ("RTM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

CALL SELF%RCP%INIT (REGISTRY, NLEV, YLTRCP, PERSISTENT, PRCP)

IF (LLT0) THEN
  CALL SELF%CTY%INIT (REGISTRY, NLEV, YLTCTY, PERSISTENT, PCTY)
ENDIF

IF (LLT0) THEN
  CALL SELF%UVH%INIT (REGISTRY, NLEV, YLTHW, PERSISTENT)
ENDIF

CALL SELF%XYB%INIT (REGISTRY, NLEV, YLTXYB, PERSISTENT)

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_DBBC => CREATE_TEMPORARY ("DBBC", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_GWS => CREATE_TEMPORARY ("GWS", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_GWFL => CREATE_TEMPORARY ("GWFL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_GWFM => CREATE_TEMPORARY ("GWFM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN) THEN
  SELF%F_GWT => CREATE_TEMPORARY ("GWT", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN) THEN
  SELF%F_NHPREF => CREATE_TEMPORARY ("NHPREF", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN) THEN
  SELF%F_NHPREH => CREATE_TEMPORARY ("NHPREH", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_QCHAL => CREATE_TEMPORARY ("QCHAL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_QCHAM => CREATE_TEMPORARY ("QCHAM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_RDPHI => CREATE_TEMPORARY ("RDPHI", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF


END SUBROUTINE CPG_DYN_TYPE_INIT

SUBROUTINE CPG_DYN_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_DYN_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_OROGL)) THEN
  SELF%OROGL  => SELF%F_OROGL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%OROGL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_OROGM)) THEN
  SELF%OROGM  => SELF%F_OROGM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%OROGM  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_PHI)) THEN
  SELF%PHI (1:,0:) => SELF%F_PHI%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PHI (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PRE)) THEN
  SELF%PRE (1:,0:) => SELF%F_PRE%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PRE (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PHIF)) THEN
  SELF%PHIF  => SELF%F_PHIF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PHIF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PREF)) THEN
  SELF%PREF  => SELF%F_PREF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PREF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_WRL)) THEN
  SELF%WRL  => SELF%F_WRL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%WRL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PREL)) THEN
  SELF%PREL  => SELF%F_PREL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PREL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_PREM)) THEN
  SELF%PREM  => SELF%F_PREM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PREM  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_NHY)) THEN
  SELF%NHY (1:,0:) => SELF%F_NHY%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHY (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GWFT)) THEN
  SELF%GWFT  => SELF%F_GWFT%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWFT  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_KENE)) THEN
  SELF%KENE  => SELF%F_KENE%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%KENE  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHX)) THEN
  SELF%NHX  => SELF%F_NHX%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHX  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PHIFL)) THEN
  SELF%PHIFL  => SELF%F_PHIFL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PHIFL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PHIFM)) THEN
  SELF%PHIFM  => SELF%F_PHIFM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PHIFM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RTL)) THEN
  SELF%RTL  => SELF%F_RTL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RTL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RTM)) THEN
  SELF%RTM  => SELF%F_RTM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RTM  => ZDUM2
ENDIF
CALL SELF%RCP%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%CTY%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%UVH%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%XYB%UPDATE_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_DBBC)) THEN
  SELF%DBBC  => SELF%F_DBBC%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DBBC  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_GWS)) THEN
  SELF%GWS  => SELF%F_GWS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_GWFL)) THEN
  SELF%GWFL  => SELF%F_GWFL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWFL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GWFM)) THEN
  SELF%GWFM  => SELF%F_GWFM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWFM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GWT)) THEN
  SELF%GWT  => SELF%F_GWT%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWT  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHPREF)) THEN
  SELF%NHPREF  => SELF%F_NHPREF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHPREF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHPREH)) THEN
  SELF%NHPREH (1:,0:) => SELF%F_NHPREH%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHPREH (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_QCHAL)) THEN
  SELF%QCHAL  => SELF%F_QCHAL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QCHAL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_QCHAM)) THEN
  SELF%QCHAM  => SELF%F_QCHAM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QCHAM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RDPHI)) THEN
  SELF%RDPHI  => SELF%F_RDPHI%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RDPHI  => ZDUM2
ENDIF

END SUBROUTINE CPG_DYN_TYPE_UPDATE_VIEW

SUBROUTINE CPG_DYN_TYPE_FINAL (SELF)
CLASS (CPG_DYN_TYPE)         :: SELF

IF (ASSOCIATED (SELF%F_OROGL)) CALL DELETE_TEMPORARY (SELF%F_OROGL) 
IF (ASSOCIATED (SELF%F_OROGM)) CALL DELETE_TEMPORARY (SELF%F_OROGM) 
IF (ASSOCIATED (SELF%F_PHI)) CALL DELETE_TEMPORARY (SELF%F_PHI) 
IF (ASSOCIATED (SELF%F_PRE)) CALL DELETE_TEMPORARY (SELF%F_PRE) 
IF (ASSOCIATED (SELF%F_PHIF)) CALL DELETE_TEMPORARY (SELF%F_PHIF) 
IF (ASSOCIATED (SELF%F_PREF)) CALL DELETE_TEMPORARY (SELF%F_PREF) 
IF (ASSOCIATED (SELF%F_WRL)) CALL DELETE_TEMPORARY (SELF%F_WRL) 
IF (ASSOCIATED (SELF%F_PREL)) CALL DELETE_TEMPORARY (SELF%F_PREL) 
IF (ASSOCIATED (SELF%F_PREM)) CALL DELETE_TEMPORARY (SELF%F_PREM) 
IF (ASSOCIATED (SELF%F_NHY)) CALL DELETE_TEMPORARY (SELF%F_NHY) 
IF (ASSOCIATED (SELF%F_GWFT)) CALL DELETE_TEMPORARY (SELF%F_GWFT) 
IF (ASSOCIATED (SELF%F_KENE)) CALL DELETE_TEMPORARY (SELF%F_KENE) 
IF (ASSOCIATED (SELF%F_NHX)) CALL DELETE_TEMPORARY (SELF%F_NHX) 
IF (ASSOCIATED (SELF%F_PHIFL)) CALL DELETE_TEMPORARY (SELF%F_PHIFL) 
IF (ASSOCIATED (SELF%F_PHIFM)) CALL DELETE_TEMPORARY (SELF%F_PHIFM) 
IF (ASSOCIATED (SELF%F_RTL)) CALL DELETE_TEMPORARY (SELF%F_RTL) 
IF (ASSOCIATED (SELF%F_RTM)) CALL DELETE_TEMPORARY (SELF%F_RTM) 
CALL SELF%RCP%FINAL ()
CALL SELF%CTY%FINAL ()
CALL SELF%UVH%FINAL ()
CALL SELF%XYB%FINAL ()
IF (ASSOCIATED (SELF%F_DBBC)) CALL DELETE_TEMPORARY (SELF%F_DBBC) 
IF (ASSOCIATED (SELF%F_GWS)) CALL DELETE_TEMPORARY (SELF%F_GWS) 
IF (ASSOCIATED (SELF%F_GWFL)) CALL DELETE_TEMPORARY (SELF%F_GWFL) 
IF (ASSOCIATED (SELF%F_GWFM)) CALL DELETE_TEMPORARY (SELF%F_GWFM) 
IF (ASSOCIATED (SELF%F_GWT)) CALL DELETE_TEMPORARY (SELF%F_GWT) 
IF (ASSOCIATED (SELF%F_NHPREF)) CALL DELETE_TEMPORARY (SELF%F_NHPREF) 
IF (ASSOCIATED (SELF%F_NHPREH)) CALL DELETE_TEMPORARY (SELF%F_NHPREH) 
IF (ASSOCIATED (SELF%F_QCHAL)) CALL DELETE_TEMPORARY (SELF%F_QCHAL) 
IF (ASSOCIATED (SELF%F_QCHAM)) CALL DELETE_TEMPORARY (SELF%F_QCHAM) 
IF (ASSOCIATED (SELF%F_RDPHI)) CALL DELETE_TEMPORARY (SELF%F_RDPHI) 

END SUBROUTINE CPG_DYN_TYPE_FINAL




SUBROUTINE CPG_PHY_TYPE_INIT (SELF &
                                & , KT  &
                                & , REGISTRY &
                                & , NLEV &
                                & , PERSISTENT &
                                & , LDMF_PHYS &
                           &)

USE INTDYN_MOD, ONLY : YYTCTY0, YYTRCP0, YYTHW0, YYTXYB0, YYTXYB0_PHY, YYTXYBDER0
USE INTDYN_MOD, ONLY :          YYTRCP9, YYTHW9, YYTXYB9, YYTXYB9_PHY
USE INTDYN_MOD, ONLY : TRCP, TCTY, THWIND, TXYB, TXYBDER


CLASS (CPG_PHY_TYPE)                    :: SELF
INTEGER(KIND=JPIM),           INTENT (IN)    :: KT
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),          INTENT (IN)    :: NLEV
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS


LOGICAL :: LLT0
LOGICAL :: LLMF_PHYS

TYPE (TRCP)   , POINTER :: YLTRCP     
TYPE (TCTY)   , POINTER :: YLTCTY     
TYPE (THWIND) , POINTER :: YLTHW     
TYPE (TXYB)   , POINTER :: YLTXYB     
TYPE (TXYB)   , POINTER :: YLTXYB_PHY
TYPE (TXYBDER), POINTER :: YLTXYBDER

TYPE (TCTY),   TARGET :: YLTCTY0 
TYPE (THWIND), TARGET :: YLTHW0, YLTHW9 
TYPE (TRCP),   TARGET :: YLTRCP0, YLTRCP9 
TYPE (TXYB),   TARGET :: YLTXYB0, YLTXYB0_PHY, YLTXYB9, YLTXYB9_PHY
TYPE (TXYBDER),TARGET :: YLTXYBDER0

YLTCTY0     = YYTCTY0 
YLTHW0      = YYTHW0 
YLTHW9      = YYTHW9 
YLTRCP0     = YYTRCP0 
YLTRCP9     = YYTRCP9 
YLTXYB0     = YYTXYB0 
YLTXYB0_PHY = YYTXYB0_PHY 
YLTXYB9     = YYTXYB9 
YLTXYB9_PHY = YYTXYB9_PHY
YLTXYBDER0  = YYTXYBDER0

LLT0 = KT == 0

YLTRCP     => NULL ()
YLTCTY     => NULL ()
YLTHW      => NULL ()
YLTXYB     => NULL ()
YLTXYB_PHY => NULL ()
YLTXYBDER  => NULL ()

IF (KT == 0) THEN
  YLTRCP     => YLTRCP0
  YLTCTY     => YLTCTY0
  YLTHW      => YLTHW0
  YLTXYB     => YLTXYB0
  YLTXYB_PHY => YLTXYB0_PHY
  YLTXYBDER  => YLTXYBDER0
ELSEIF (KT == 9) THEN
  YLTRCP     => YLTRCP9
  YLTCTY     => NULL ()
  YLTHW      => YLTHW9
  YLTXYB     => YLTXYB9
  YLTXYB_PHY => YLTXYB9_PHY
ENDIF

LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_PRE => CREATE_TEMPORARY ("PRE", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_PREF => CREATE_TEMPORARY ("PREF", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_PREHYD => CREATE_TEMPORARY ("PREHYD", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_PREHYDF => CREATE_TEMPORARY ("PREHYDF", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_WL => CREATE_TEMPORARY ("WL", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_WM => CREATE_TEMPORARY ("WM", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_W => CREATE_TEMPORARY ("W", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  CALL SELF%XYB%INIT (REGISTRY, NLEV, YLTXYB_PHY, PERSISTENT)
ENDIF


END SUBROUTINE CPG_PHY_TYPE_INIT

SUBROUTINE CPG_PHY_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_PHY_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_PRE)) THEN
  SELF%PRE (1:,0:) => SELF%F_PRE%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PRE (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PREF)) THEN
  SELF%PREF  => SELF%F_PREF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PREF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PREHYD)) THEN
  SELF%PREHYD (1:,0:) => SELF%F_PREHYD%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PREHYD (1:,0:) => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PREHYDF)) THEN
  SELF%PREHYDF  => SELF%F_PREHYDF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PREHYDF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_WL)) THEN
  SELF%WL  => SELF%F_WL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%WL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_WM)) THEN
  SELF%WM  => SELF%F_WM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%WM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_W)) THEN
  SELF%W  => SELF%F_W%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%W  => ZDUM2
ENDIF
CALL SELF%XYB%UPDATE_VIEW (BLOCK_INDEX)

END SUBROUTINE CPG_PHY_TYPE_UPDATE_VIEW

SUBROUTINE CPG_PHY_TYPE_FINAL (SELF)
CLASS (CPG_PHY_TYPE)         :: SELF

IF (ASSOCIATED (SELF%F_PRE)) CALL DELETE_TEMPORARY (SELF%F_PRE) 
IF (ASSOCIATED (SELF%F_PREF)) CALL DELETE_TEMPORARY (SELF%F_PREF) 
IF (ASSOCIATED (SELF%F_PREHYD)) CALL DELETE_TEMPORARY (SELF%F_PREHYD) 
IF (ASSOCIATED (SELF%F_PREHYDF)) CALL DELETE_TEMPORARY (SELF%F_PREHYDF) 
IF (ASSOCIATED (SELF%F_WL)) CALL DELETE_TEMPORARY (SELF%F_WL) 
IF (ASSOCIATED (SELF%F_WM)) CALL DELETE_TEMPORARY (SELF%F_WM) 
IF (ASSOCIATED (SELF%F_W)) CALL DELETE_TEMPORARY (SELF%F_W) 
CALL SELF%XYB%FINAL ()

END SUBROUTINE CPG_PHY_TYPE_FINAL




SUBROUTINE CPG_MISC_TYPE_INIT (SELF &
                                & , REGISTRY &
                                & , NLEV &
                                & , PERSISTENT &
                                & , YDMODEL &
                           &)


USE TYPE_MODEL, ONLY : MODEL

CLASS (CPG_MISC_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),          INTENT (IN)    :: NLEV
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT
TYPE (MODEL),                 INTENT (IN)    :: YDMODEL







SELF%F_NEB => CREATE_TEMPORARY ("NEB", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)

SELF%F_QLI => CREATE_TEMPORARY ("QLI", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)

SELF%F_QICE => CREATE_TEMPORARY ("QICE", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)

SELF%F_QRAIN => CREATE_TEMPORARY ("QRAIN", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)

SELF%F_QSNOW => CREATE_TEMPORARY ("QSNOW", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)

SELF%F_RH => CREATE_TEMPORARY ("RH", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT)

SELF%F_QS => CREATE_TEMPORARY ("QS", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_QSOL => CREATE_TEMPORARY ("QSOL", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_DHSF => CREATE_TEMPORARY ("DHSF", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_CLCT => CREATE_TEMPORARY ("CLCT", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_LSM => CREATE_TEMPORARY ("LSM", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_TSOL => CREATE_TEMPORARY ("TSOL", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FTCNS => CREATE_TEMPORARY ("FTCNS", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NDIM=6, PERSISTENT=PERSISTENT)

SELF%F_KOZO => CREATE_TEMPORARY ("KOZO", GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NDIM=YDMODEL%YRML_PHY_G%YRDPHY%NVCLIS,&
    & PERSISTENT=PERSISTENT)

SELF%F_GPAR => CREATE_TEMPORARY ("GPAR", GEOM=REGISTRY%GEOM, NLEV=YDMODEL%YRML_PHY_MF%YRPARAR%NGPAR+1, PERSISTENT=PERSISTENT)


END SUBROUTINE CPG_MISC_TYPE_INIT

SUBROUTINE CPG_MISC_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_MISC_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_NEB)) THEN
  SELF%NEB  => SELF%F_NEB%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NEB  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_QLI)) THEN
  SELF%QLI  => SELF%F_QLI%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QLI  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_QICE)) THEN
  SELF%QICE  => SELF%F_QICE%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QICE  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_QRAIN)) THEN
  SELF%QRAIN  => SELF%F_QRAIN%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QRAIN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_QSNOW)) THEN
  SELF%QSNOW  => SELF%F_QSNOW%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QSNOW  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RH)) THEN
  SELF%RH  => SELF%F_RH%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RH  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_QS)) THEN
  SELF%QS  => SELF%F_QS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_QSOL)) THEN
  SELF%QSOL  => SELF%F_QSOL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QSOL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_DHSF)) THEN
  SELF%DHSF  => SELF%F_DHSF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DHSF  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_CLCT)) THEN
  SELF%CLCT  => SELF%F_CLCT%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%CLCT  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_LSM)) THEN
  SELF%LSM  => SELF%F_LSM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%LSM  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_TSOL)) THEN
  SELF%TSOL  => SELF%F_TSOL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%TSOL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FTCNS)) THEN
  SELF%FTCNS (1:,0:, 1:) => SELF%F_FTCNS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%FTCNS (1:,0:, 1:) => ZDUM3
ENDIF
IF (ASSOCIATED (SELF%F_KOZO)) THEN
  SELF%KOZO (1:,0:, 1:) => SELF%F_KOZO%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%KOZO (1:,0:, 1:) => ZDUM3
ENDIF
IF (ASSOCIATED (SELF%F_GPAR)) THEN
  SELF%GPAR  => SELF%F_GPAR%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GPAR  => ZDUM2
ENDIF

END SUBROUTINE CPG_MISC_TYPE_UPDATE_VIEW

SUBROUTINE CPG_MISC_TYPE_FINAL (SELF)
CLASS (CPG_MISC_TYPE)         :: SELF

IF (ASSOCIATED (SELF%F_NEB)) CALL DELETE_TEMPORARY (SELF%F_NEB) 
IF (ASSOCIATED (SELF%F_QLI)) CALL DELETE_TEMPORARY (SELF%F_QLI) 
IF (ASSOCIATED (SELF%F_QICE)) CALL DELETE_TEMPORARY (SELF%F_QICE) 
IF (ASSOCIATED (SELF%F_QRAIN)) CALL DELETE_TEMPORARY (SELF%F_QRAIN) 
IF (ASSOCIATED (SELF%F_QSNOW)) CALL DELETE_TEMPORARY (SELF%F_QSNOW) 
IF (ASSOCIATED (SELF%F_RH)) CALL DELETE_TEMPORARY (SELF%F_RH) 
IF (ASSOCIATED (SELF%F_QS)) CALL DELETE_TEMPORARY (SELF%F_QS) 
IF (ASSOCIATED (SELF%F_QSOL)) CALL DELETE_TEMPORARY (SELF%F_QSOL) 
IF (ASSOCIATED (SELF%F_DHSF)) CALL DELETE_TEMPORARY (SELF%F_DHSF) 
IF (ASSOCIATED (SELF%F_CLCT)) CALL DELETE_TEMPORARY (SELF%F_CLCT) 
IF (ASSOCIATED (SELF%F_LSM)) CALL DELETE_TEMPORARY (SELF%F_LSM) 
IF (ASSOCIATED (SELF%F_TSOL)) CALL DELETE_TEMPORARY (SELF%F_TSOL) 
IF (ASSOCIATED (SELF%F_FTCNS)) CALL DELETE_TEMPORARY (SELF%F_FTCNS) 
IF (ASSOCIATED (SELF%F_KOZO)) CALL DELETE_TEMPORARY (SELF%F_KOZO) 
IF (ASSOCIATED (SELF%F_GPAR)) CALL DELETE_TEMPORARY (SELF%F_GPAR) 

END SUBROUTINE CPG_MISC_TYPE_FINAL

SUBROUTINE CPG_TMP_TYPE_INIT (SELF, REGISTRY, NLEV, PERSISTENT)

CLASS (CPG_TMP_TYPE) :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),          INTENT (IN)    :: NLEV
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT

CALL SELF%CPG_GP%INIT (REGISTRY, NLEV, PERSISTENT)

END SUBROUTINE

SUBROUTINE CPG_TMP_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_TMP_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

CALL SELF%CPG_GP%UPDATE_VIEW (BLOCK_INDEX)

END SUBROUTINE 

SUBROUTINE CPG_TMP_TYPE_FINAL (SELF)

CLASS (CPG_TMP_TYPE)         :: SELF

CALL SELF%CPG_GP%FINAL

END SUBROUTINE

SUBROUTINE CPG_DDH_TYPE_INIT (SELF, REGISTRY, NLEV, PERSISTENT, YDMODEL, YDDDH)

USE TYPE_MODEL, ONLY : MODEL
USE DDH_MIX, ONLY : TYP_DDH

CLASS (CPG_DDH_TYPE)                             :: SELF
TYPE (FIELD_REGISTRY),            INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),              INTENT (IN)    :: NLEV
LOGICAL, OPTIONAL,                INTENT (IN)    :: PERSISTENT
TYPE (MODEL),                     INTENT (IN)    :: YDMODEL
TYPE (TYP_DDH),                   INTENT (IN)    :: YDDDH


ALLOCATE (SELF%F_AUX3D)
SELF%F_AUX3D = FIELD_4D ("AUX3D", SHAPE=[NLEV+1, YDMODEL%YRML_DIAG%YRMDDH%NDHIDH, YDDDH%NFIELDS3D_AUTO], &
                       & NBLOCKS=REGISTRY%GEOM%YRDIM%NGPBLKS, PERSISTENT=PERSISTENT)
ALLOCATE (SELF%F_AUX2D)
SELF%F_AUX2D = FIELD_3D ("AUX2D", SHAPE=[YDMODEL%YRML_DIAG%YRMDDH%NDHIDH, YDDDH%NFIELDS2D_AUTO], &
                       & NBLOCKS=REGISTRY%GEOM%YRDIM%NGPBLKS, PERSISTENT=PERSISTENT)

SELF%F_DHCV  => CREATE_TEMPORARY ("DHCV", GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT, NDIM=YDMODEL%YRML_DIAG%YRMDDH%NDHCVSUN)
SELF%F_AUXSM => CREATE_TEMPORARY ("AUXSM", GEOM=REGISTRY%GEOM, NLEV=1, PERSISTENT=PERSISTENT, NDIM=[NLEV, 13])
SELF%F_DDHI  => CREATE_TEMPORARY_INT ("DDHI", GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

END SUBROUTINE CPG_DDH_TYPE_INIT

SUBROUTINE CPG_DDH_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_DDH_TYPE)              :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_AUX3D)) SELF%AUX3D (0:, 1:, 1:)  => SELF%F_AUX3D%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_AUX2D)) SELF%AUX2D  => SELF%F_AUX2D%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_DHCV )) SELF%DHCV   => SELF%F_DHCV %GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_AUXSM)) SELF%AUXSM  => SELF%F_AUXSM%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_DDHI )) SELF%DDHI   => SELF%F_DDHI %GET_VIEW (BLOCK_INDEX)

END SUBROUTINE CPG_DDH_TYPE_UPDATE_VIEW

SUBROUTINE CPG_DDH_TYPE_FINAL (SELF)

CLASS (CPG_DDH_TYPE)              :: SELF

CALL DELETE_TEMPORARY (SELF%F_AUX3D)
CALL DELETE_TEMPORARY (SELF%F_AUX2D)
CALL DELETE_TEMPORARY (SELF%F_DHCV)
CALL DELETE_TEMPORARY (SELF%F_AUXSM)
CALL DELETE_TEMPORARY (SELF%F_DDHI)

SELF%AUX3D => NULL ()
SELF%AUX2D => NULL ()
SELF%DHCV  => NULL ()
SELF%AUXSM => NULL ()
SELF%DDHI  => NULL ()

END SUBROUTINE CPG_DDH_TYPE_FINAL


SUBROUTINE CPG_SL1_TYPE_INIT (SELF, REGISTRY, NLEV, YDTPTRSLB1, PERSISTENT, PB1)

USE PTRSLB1, ONLY : TPTRSLB1

CLASS (CPG_SL1_TYPE)                         :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TPTRSLB1),              INTENT (IN)    :: YDTPTRSLB1
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PB1 (:, :, :)

SELF%NLEV = NLEV

IF (PRESENT (PB1)) THEN
  SELF%F_DATA => CREATE_FIELD_WRAP ('PB1', PB1)
ELSE
  SELF%F_DATA => CREATE_TEMPORARY ('PB1', GEOM=REGISTRY%GEOM, NLEV=YDTPTRSLB1%NFLDSLB1, PERSISTENT=PERSISTENT)
ENDIF

  SELF%I_U9 = YDTPTRSLB1%MSLB1U9
  SELF%I_V9 = YDTPTRSLB1%MSLB1V9
  SELF%I_T9 = YDTPTRSLB1%MSLB1T9
  SELF%I_PD9 = YDTPTRSLB1%MSLB1PD9
  SELF%I_VD9 = YDTPTRSLB1%MSLB1VD9
  SELF%I_NHX9 = YDTPTRSLB1%MSLB1NHX9
  SELF%I_UR0 = YDTPTRSLB1%MSLB1UR0
  SELF%I_VR0 = YDTPTRSLB1%MSLB1VR0
  SELF%I_ZR0 = YDTPTRSLB1%MSLB1ZR0
  SELF%I_WR0 = YDTPTRSLB1%MSLB1WR0
  SELF%I_UR00 = YDTPTRSLB1%MSLB1UR00
  SELF%I_VR00 = YDTPTRSLB1%MSLB1VR00
  SELF%I_ZR00 = YDTPTRSLB1%MSLB1ZR00
  SELF%I_WR00 = YDTPTRSLB1%MSLB1WR00
  SELF%I_WRA = YDTPTRSLB1%MSLB1WRA
  SELF%I_UR9 = YDTPTRSLB1%MSLB1UR9
  SELF%I_VR9 = YDTPTRSLB1%MSLB1VR9
  SELF%I_DBBC9 = YDTPTRSLB1%MSLB1DBBC9
  SELF%I_DPHI9 = YDTPTRSLB1%MSLB1DPHI9
  SELF%I_GWS9 = YDTPTRSLB1%MSLB1GWS9
  SELF%I_U0 = YDTPTRSLB1%MSLB1U0
  SELF%I_V0 = YDTPTRSLB1%MSLB1V0
  SELF%I_T0 = YDTPTRSLB1%MSLB1T0
  SELF%I_PD0 = YDTPTRSLB1%MSLB1PD0
  SELF%I_VD0 = YDTPTRSLB1%MSLB1VD0
  SELF%I_C9 = YDTPTRSLB1%MSLB1C9
  SELF%I_SP9 = YDTPTRSLB1%MSLB1SP9
  SELF%I_SP0 = YDTPTRSLB1%MSLB1SP0
  SELF%I_C0 = YDTPTRSLB1%MSLB1C0
  SELF%I_UP9 = YDTPTRSLB1%MSLB1UP9
  SELF%I_VP9 = YDTPTRSLB1%MSLB1VP9
  SELF%I_TP9 = YDTPTRSLB1%MSLB1TP9
  SELF%I_U9_SI = YDTPTRSLB1%MSLB1U9_SI
  SELF%I_V9_SI = YDTPTRSLB1%MSLB1V9_SI
  SELF%I_T9_SI = YDTPTRSLB1%MSLB1T9_SI
  SELF%I_PD9_SI = YDTPTRSLB1%MSLB1PD9_SI
  SELF%I_VD9_SI = YDTPTRSLB1%MSLB1VD9_SI
  SELF%I_C9_SI = YDTPTRSLB1%MSLB1C9_SI
  SELF%I_UF9 = YDTPTRSLB1%MSLB1UF9
  SELF%I_VF9 = YDTPTRSLB1%MSLB1VF9
  SELF%I_TF9 = YDTPTRSLB1%MSLB1TF9
  SELF%I_VDF9 = YDTPTRSLB1%MSLB1VDF9
  SELF%I_U9_NL = YDTPTRSLB1%MSLB1U9_NL
  SELF%I_V9_NL = YDTPTRSLB1%MSLB1V9_NL
  SELF%I_T9_NL = YDTPTRSLB1%MSLB1T9_NL
  SELF%I_PD9_NL = YDTPTRSLB1%MSLB1PD9_NL
  SELF%I_VD9_NL = YDTPTRSLB1%MSLB1VD9_NL
  SELF%I_C9_NL = YDTPTRSLB1%MSLB1C9_NL

END SUBROUTINE CPG_SL1_TYPE_INIT

SUBROUTINE CPG_SL1_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_SL1_TYPE)        :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN
  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)
  IF (SELF%I_U9 > 0) THEN
    SELF%U9 => SELF%ZVIEW (:, SELF%I_U9:SELF%I_U9+SELF%NLEV+1)
  ELSE
    SELF%U9 => ZDUM2
  ENDIF
  IF (SELF%I_V9 > 0) THEN
    SELF%V9 => SELF%ZVIEW (:, SELF%I_V9:SELF%I_V9+SELF%NLEV+1)
  ELSE
    SELF%V9 => ZDUM2
  ENDIF
  IF (SELF%I_T9 > 0) THEN
    SELF%T9 => SELF%ZVIEW (:, SELF%I_T9:SELF%I_T9+SELF%NLEV+1)
  ELSE
    SELF%T9 => ZDUM2
  ENDIF
  IF (SELF%I_PD9 > 0) THEN
    SELF%PD9 => SELF%ZVIEW (:, SELF%I_PD9:SELF%I_PD9+SELF%NLEV+1)
  ELSE
    SELF%PD9 => ZDUM2
  ENDIF
  IF (SELF%I_VD9 > 0) THEN
    SELF%VD9 => SELF%ZVIEW (:, SELF%I_VD9:SELF%I_VD9+SELF%NLEV+1)
  ELSE
    SELF%VD9 => ZDUM2
  ENDIF
  IF (SELF%I_NHX9 > 0) THEN
    SELF%NHX9 => SELF%ZVIEW (:, SELF%I_NHX9:SELF%I_NHX9+SELF%NLEV+1)
  ELSE
    SELF%NHX9 => ZDUM2
  ENDIF
  IF (SELF%I_UR0 > 0) THEN
    SELF%UR0 => SELF%ZVIEW (:, SELF%I_UR0:SELF%I_UR0+SELF%NLEV+1)
  ELSE
    SELF%UR0 => ZDUM2
  ENDIF
  IF (SELF%I_VR0 > 0) THEN
    SELF%VR0 => SELF%ZVIEW (:, SELF%I_VR0:SELF%I_VR0+SELF%NLEV+1)
  ELSE
    SELF%VR0 => ZDUM2
  ENDIF
  IF (SELF%I_ZR0 > 0) THEN
    SELF%ZR0 => SELF%ZVIEW (:, SELF%I_ZR0:SELF%I_ZR0+SELF%NLEV+1)
  ELSE
    SELF%ZR0 => ZDUM2
  ENDIF
  IF (SELF%I_WR0 > 0) THEN
    SELF%WR0 => SELF%ZVIEW (:, SELF%I_WR0:SELF%I_WR0+SELF%NLEV+1)
  ELSE
    SELF%WR0 => ZDUM2
  ENDIF
  IF (SELF%I_UR00 > 0) THEN
    SELF%UR00 => SELF%ZVIEW (:, SELF%I_UR00:SELF%I_UR00+SELF%NLEV+1)
  ELSE
    SELF%UR00 => ZDUM2
  ENDIF
  IF (SELF%I_VR00 > 0) THEN
    SELF%VR00 => SELF%ZVIEW (:, SELF%I_VR00:SELF%I_VR00+SELF%NLEV+1)
  ELSE
    SELF%VR00 => ZDUM2
  ENDIF
  IF (SELF%I_ZR00 > 0) THEN
    SELF%ZR00 => SELF%ZVIEW (:, SELF%I_ZR00:SELF%I_ZR00+SELF%NLEV+1)
  ELSE
    SELF%ZR00 => ZDUM2
  ENDIF
  IF (SELF%I_WR00 > 0) THEN
    SELF%WR00 => SELF%ZVIEW (:, SELF%I_WR00:SELF%I_WR00+SELF%NLEV+1)
  ELSE
    SELF%WR00 => ZDUM2
  ENDIF
  IF (SELF%I_WRA > 0) THEN
    SELF%WRA => SELF%ZVIEW (:, SELF%I_WRA:SELF%I_WRA+SELF%NLEV+1)
  ELSE
    SELF%WRA => ZDUM2
  ENDIF
  IF (SELF%I_UR9 > 0) THEN
    SELF%UR9 => SELF%ZVIEW (:, SELF%I_UR9:SELF%I_UR9+SELF%NLEV+1)
  ELSE
    SELF%UR9 => ZDUM2
  ENDIF
  IF (SELF%I_VR9 > 0) THEN
    SELF%VR9 => SELF%ZVIEW (:, SELF%I_VR9:SELF%I_VR9+SELF%NLEV+1)
  ELSE
    SELF%VR9 => ZDUM2
  ENDIF
  IF (SELF%I_DBBC9 > 0) THEN
    SELF%DBBC9 => SELF%ZVIEW (:, SELF%I_DBBC9:SELF%I_DBBC9+SELF%NLEV+1)
  ELSE
    SELF%DBBC9 => ZDUM2
  ENDIF
  IF (SELF%I_DPHI9 > 0) THEN
    SELF%DPHI9 => SELF%ZVIEW (:, SELF%I_DPHI9:SELF%I_DPHI9+SELF%NLEV+1)
  ELSE
    SELF%DPHI9 => ZDUM2
  ENDIF
  IF (SELF%I_GWS9 > 0) THEN
    SELF%GWS9 => SELF%ZVIEW (:, SELF%I_GWS9)
  ELSE
    SELF%GWS9 => ZDUM1
  ENDIF
  IF (SELF%I_U0 > 0) THEN
    SELF%U0 => SELF%ZVIEW (:, SELF%I_U0:SELF%I_U0+SELF%NLEV+1)
  ELSE
    SELF%U0 => ZDUM2
  ENDIF
  IF (SELF%I_V0 > 0) THEN
    SELF%V0 => SELF%ZVIEW (:, SELF%I_V0:SELF%I_V0+SELF%NLEV+1)
  ELSE
    SELF%V0 => ZDUM2
  ENDIF
  IF (SELF%I_T0 > 0) THEN
    SELF%T0 => SELF%ZVIEW (:, SELF%I_T0:SELF%I_T0+SELF%NLEV+1)
  ELSE
    SELF%T0 => ZDUM2
  ENDIF
  IF (SELF%I_PD0 > 0) THEN
    SELF%PD0 => SELF%ZVIEW (:, SELF%I_PD0:SELF%I_PD0+SELF%NLEV+1)
  ELSE
    SELF%PD0 => ZDUM2
  ENDIF
  IF (SELF%I_VD0 > 0) THEN
    SELF%VD0 => SELF%ZVIEW (:, SELF%I_VD0:SELF%I_VD0+SELF%NLEV+1)
  ELSE
    SELF%VD0 => ZDUM2
  ENDIF
  IF (SELF%I_C9 > 0) THEN
    SELF%C9 => SELF%ZVIEW (:, SELF%I_C9:SELF%I_C9+SELF%NLEV+1)
  ELSE
    SELF%C9 => ZDUM2
  ENDIF
  IF (SELF%I_SP9 > 0) THEN
    SELF%SP9 => SELF%ZVIEW (:, SELF%I_SP9)
  ELSE
    SELF%SP9 => ZDUM1
  ENDIF
  IF (SELF%I_SP0 > 0) THEN
    SELF%SP0 => SELF%ZVIEW (:, SELF%I_SP0)
  ELSE
    SELF%SP0 => ZDUM1
  ENDIF
  IF (SELF%I_C0 > 0) THEN
    SELF%C0 => SELF%ZVIEW (:, SELF%I_C0:SELF%I_C0+SELF%NLEV+1)
  ELSE
    SELF%C0 => ZDUM2
  ENDIF
  IF (SELF%I_UP9 > 0) THEN
    SELF%UP9 => SELF%ZVIEW (:, SELF%I_UP9:SELF%I_UP9+SELF%NLEV+1)
  ELSE
    SELF%UP9 => ZDUM2
  ENDIF
  IF (SELF%I_VP9 > 0) THEN
    SELF%VP9 => SELF%ZVIEW (:, SELF%I_VP9:SELF%I_VP9+SELF%NLEV+1)
  ELSE
    SELF%VP9 => ZDUM2
  ENDIF
  IF (SELF%I_TP9 > 0) THEN
    SELF%TP9 => SELF%ZVIEW (:, SELF%I_TP9:SELF%I_TP9+SELF%NLEV+1)
  ELSE
    SELF%TP9 => ZDUM2
  ENDIF
  IF (SELF%I_U9_SI > 0) THEN
    SELF%U9_SI => SELF%ZVIEW (:, SELF%I_U9_SI:SELF%I_U9_SI+SELF%NLEV+1)
  ELSE
    SELF%U9_SI => ZDUM2
  ENDIF
  IF (SELF%I_V9_SI > 0) THEN
    SELF%V9_SI => SELF%ZVIEW (:, SELF%I_V9_SI:SELF%I_V9_SI+SELF%NLEV+1)
  ELSE
    SELF%V9_SI => ZDUM2
  ENDIF
  IF (SELF%I_T9_SI > 0) THEN
    SELF%T9_SI => SELF%ZVIEW (:, SELF%I_T9_SI:SELF%I_T9_SI+SELF%NLEV+1)
  ELSE
    SELF%T9_SI => ZDUM2
  ENDIF
  IF (SELF%I_PD9_SI > 0) THEN
    SELF%PD9_SI => SELF%ZVIEW (:, SELF%I_PD9_SI:SELF%I_PD9_SI+SELF%NLEV+1)
  ELSE
    SELF%PD9_SI => ZDUM2
  ENDIF
  IF (SELF%I_VD9_SI > 0) THEN
    SELF%VD9_SI => SELF%ZVIEW (:, SELF%I_VD9_SI:SELF%I_VD9_SI+SELF%NLEV+1)
  ELSE
    SELF%VD9_SI => ZDUM2
  ENDIF
  IF (SELF%I_C9_SI > 0) THEN
    SELF%C9_SI => SELF%ZVIEW (:, SELF%I_C9_SI:SELF%I_C9_SI+SELF%NLEV+1)
  ELSE
    SELF%C9_SI => ZDUM2
  ENDIF
  IF (SELF%I_UF9 > 0) THEN
    SELF%UF9 => SELF%ZVIEW (:, SELF%I_UF9:SELF%I_UF9+SELF%NLEV+1)
  ELSE
    SELF%UF9 => ZDUM2
  ENDIF
  IF (SELF%I_VF9 > 0) THEN
    SELF%VF9 => SELF%ZVIEW (:, SELF%I_VF9:SELF%I_VF9+SELF%NLEV+1)
  ELSE
    SELF%VF9 => ZDUM2
  ENDIF
  IF (SELF%I_TF9 > 0) THEN
    SELF%TF9 => SELF%ZVIEW (:, SELF%I_TF9:SELF%I_TF9+SELF%NLEV+1)
  ELSE
    SELF%TF9 => ZDUM2
  ENDIF
  IF (SELF%I_VDF9 > 0) THEN
    SELF%VDF9 => SELF%ZVIEW (:, SELF%I_VDF9:SELF%I_VDF9+SELF%NLEV+1)
  ELSE
    SELF%VDF9 => ZDUM2
  ENDIF
  IF (SELF%I_U9_NL > 0) THEN
    SELF%U9_NL => SELF%ZVIEW (:, SELF%I_U9_NL:SELF%I_U9_NL+SELF%NLEV+1)
  ELSE
    SELF%U9_NL => ZDUM2
  ENDIF
  IF (SELF%I_V9_NL > 0) THEN
    SELF%V9_NL => SELF%ZVIEW (:, SELF%I_V9_NL:SELF%I_V9_NL+SELF%NLEV+1)
  ELSE
    SELF%V9_NL => ZDUM2
  ENDIF
  IF (SELF%I_T9_NL > 0) THEN
    SELF%T9_NL => SELF%ZVIEW (:, SELF%I_T9_NL:SELF%I_T9_NL+SELF%NLEV+1)
  ELSE
    SELF%T9_NL => ZDUM2
  ENDIF
  IF (SELF%I_PD9_NL > 0) THEN
    SELF%PD9_NL => SELF%ZVIEW (:, SELF%I_PD9_NL:SELF%I_PD9_NL+SELF%NLEV+1)
  ELSE
    SELF%PD9_NL => ZDUM2
  ENDIF
  IF (SELF%I_VD9_NL > 0) THEN
    SELF%VD9_NL => SELF%ZVIEW (:, SELF%I_VD9_NL:SELF%I_VD9_NL+SELF%NLEV+1)
  ELSE
    SELF%VD9_NL => ZDUM2
  ENDIF
  IF (SELF%I_C9_NL > 0) THEN
    SELF%C9_NL => SELF%ZVIEW (:, SELF%I_C9_NL:SELF%I_C9_NL+SELF%NLEV+1)
  ELSE
    SELF%C9_NL => ZDUM2
  ENDIF

ELSE
  SELF%ZVIEW => ZDUM2

  SELF%U9 => ZDUM2
  SELF%V9 => ZDUM2
  SELF%T9 => ZDUM2
  SELF%PD9 => ZDUM2
  SELF%VD9 => ZDUM2
  SELF%NHX9 => ZDUM2
  SELF%UR0 => ZDUM2
  SELF%VR0 => ZDUM2
  SELF%ZR0 => ZDUM2
  SELF%WR0 => ZDUM2
  SELF%UR00 => ZDUM2
  SELF%VR00 => ZDUM2
  SELF%ZR00 => ZDUM2
  SELF%WR00 => ZDUM2
  SELF%WRA => ZDUM2
  SELF%UR9 => ZDUM2
  SELF%VR9 => ZDUM2
  SELF%DBBC9 => ZDUM2
  SELF%DPHI9 => ZDUM2
  SELF%GWS9 => ZDUM1
  SELF%U0 => ZDUM2
  SELF%V0 => ZDUM2
  SELF%T0 => ZDUM2
  SELF%PD0 => ZDUM2
  SELF%VD0 => ZDUM2
  SELF%C9 => ZDUM2
  SELF%SP9 => ZDUM1
  SELF%SP0 => ZDUM1
  SELF%C0 => ZDUM2
  SELF%UP9 => ZDUM2
  SELF%VP9 => ZDUM2
  SELF%TP9 => ZDUM2
  SELF%U9_SI => ZDUM2
  SELF%V9_SI => ZDUM2
  SELF%T9_SI => ZDUM2
  SELF%PD9_SI => ZDUM2
  SELF%VD9_SI => ZDUM2
  SELF%C9_SI => ZDUM2
  SELF%UF9 => ZDUM2
  SELF%VF9 => ZDUM2
  SELF%TF9 => ZDUM2
  SELF%VDF9 => ZDUM2
  SELF%U9_NL => ZDUM2
  SELF%V9_NL => ZDUM2
  SELF%T9_NL => ZDUM2
  SELF%PD9_NL => ZDUM2
  SELF%VD9_NL => ZDUM2
  SELF%C9_NL => ZDUM2

ENDIF

END SUBROUTINE CPG_SL1_TYPE_UPDATE_VIEW

SUBROUTINE CPG_SL1_TYPE_FINAL (SELF)
CLASS (CPG_SL1_TYPE)          :: SELF

SELF%ZVIEW => NULL ()

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)

END SUBROUTINE CPG_SL1_TYPE_FINAL

SUBROUTINE CPG_SL2_TYPE_INIT (SELF, REGISTRY, NLEV, YDTPTRSLB2, PERSISTENT, PB2)

USE PTRSLB2, ONLY : TPTRSLB2

CLASS (CPG_SL2_TYPE)                         :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TPTRSLB2),              INTENT (IN)    :: YDTPTRSLB2
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PB2 (:, :, :)

SELF%NLEV = NLEV

IF (PRESENT (PB2)) THEN
  SELF%F_DATA => CREATE_FIELD_WRAP ('PB2', PB2)
ELSE
  SELF%F_DATA => CREATE_TEMPORARY ('PB2', GEOM=REGISTRY%GEOM, NLEV=YDTPTRSLB2%NFLDSLB2, PERSISTENT=PERSISTENT)
ENDIF


END SUBROUTINE CPG_SL2_TYPE_INIT

SUBROUTINE CPG_SL2_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_SL2_TYPE)        :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN
  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)

ELSE
  SELF%ZVIEW => ZDUM2


ENDIF

END SUBROUTINE CPG_SL2_TYPE_UPDATE_VIEW

SUBROUTINE CPG_SL2_TYPE_FINAL (SELF)
CLASS (CPG_SL2_TYPE)          :: SELF

SELF%ZVIEW => NULL ()

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)

END SUBROUTINE CPG_SL2_TYPE_FINAL

END MODULE CPG_TYPE_MOD

