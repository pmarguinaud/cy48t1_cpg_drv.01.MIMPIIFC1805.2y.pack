MODULE CPG_TYPE_MOD

USE FIELD_MODULE
USE FIELD_REGISTRY_MOD
USE PARKIND1, ONLY : JPRB, JPIM

IMPLICIT NONE

TYPE CPG_XYBDER_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZDATA (:,:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LNPRL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: LNPRL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_LNPRL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LNPRM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: LNPRM (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_LNPRM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ALPHL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: ALPHL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_ALPHL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ALPHM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: ALPHM (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_ALPHM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ALPHPLL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: ALPHPLL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_ALPHPLL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ALPHPLM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: ALPHPLM (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_ALPHPLM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: COEFD (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: COEFD (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_COEFD => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: COEFA (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: COEFA (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_COEFA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: COEFAPL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: COEFAPL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_COEFAPL => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_XYBDER_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_XYBDER_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_XYBDER_TYPE_FINAL
END TYPE CPG_XYBDER_TYPE

TYPE CPG_XYB_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZDATA (:,:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DELP (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DELP (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_DELP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RDELP (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RDELP (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RDELP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LNPR (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: LNPR (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_LNPR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ALPH (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: ALPH (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_ALPH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RTGR (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RTGR (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RTGR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RPRE (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RPRE (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RPRE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RPP (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RPP (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RPP => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_XYB_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_XYB_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_XYB_TYPE_FINAL
END TYPE CPG_XYB_TYPE

TYPE CPG_HWIND_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZDATA (:,:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UH (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: UH (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_UH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VH (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: VH (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_VH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WWI (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: WWI (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_WWI => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_HWIND_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_HWIND_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_HWIND_TYPE_FINAL
END TYPE CPG_HWIND_TYPE

TYPE CPG_RCP_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZDATA (:,:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CP (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: CP (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_CP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: R (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: R (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_R => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAP (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: KAP (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_KAP => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_RCP_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_RCP_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_RCP_TYPE_FINAL
END TYPE CPG_RCP_TYPE

TYPE CPG_CTY_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZDATA (:,:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EVEL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: EVEL (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_EVEL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VVEL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: VVEL (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_VVEL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PSDIV (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PSDIV (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PSDIV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PSDVBC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PSDVBC (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PSDVBC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIVDP (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DIVDP (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_DIVDP => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_CTY_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_CTY_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_CTY_TYPE_FINAL
END TYPE CPG_CTY_TYPE

TYPE CPG_TND_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZDATA (:,:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDU (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TNDU (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_TNDU => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDV (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TNDV (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_TNDV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDU_NOC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TNDU_NOC (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_TNDU_NOC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDV_NOC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TNDV_NOC (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_TNDV_NOC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDT (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TNDT (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_TNDT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDPD (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TNDPD (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_TNDPD => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDVD (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TNDVD (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_TNDVD => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDGW (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TNDGW (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_TNDGW => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_TND_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_TND_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_TND_TYPE_FINAL
END TYPE CPG_TND_TYPE

TYPE CPG_GPAR_TYPE
  LOGICAL :: LOWNED = .FALSE.
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:) => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZDATA (:,:,:) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: INPRR (:) => NULL ()
!>REAL (KIND=JPRB)                      :: INPRR (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_INPRR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: INPRS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: INPRS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_INPRS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: INPRG (:) => NULL ()
!>REAL (KIND=JPRB)                      :: INPRG (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_INPRG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ACPRR (:) => NULL ()
!>REAL (KIND=JPRB)                      :: ACPRR (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_ACPRR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ACPRS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: ACPRS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_ACPRS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ACPRG (:) => NULL ()
!>REAL (KIND=JPRB)                      :: ACPRG (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_ACPRG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ALBDIR (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: ALBDIR (NPROMA, 1:YDCPG_DIM%KSW)
  TYPE (FIELD_3D), POINTER :: F_ALBDIR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ALBSCA (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: ALBSCA (NPROMA, 1:YDCPG_DIM%KSW)
  TYPE (FIELD_3D), POINTER :: F_ALBSCA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RAIN (:) => NULL ()
!>REAL (KIND=JPRB)                      :: RAIN (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_RAIN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SNOW (:) => NULL ()
!>REAL (KIND=JPRB)                      :: SNOW (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_SNOW => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GZ0 (:) => NULL ()
!>REAL (KIND=JPRB)                      :: GZ0 (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_GZ0 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GZ0H (:) => NULL ()
!>REAL (KIND=JPRB)                      :: GZ0H (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_GZ0H => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VQS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: VQS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_VQS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VTS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: VTS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_VTS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VEMIS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: VEMIS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_VEMIS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SWDIR (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SWDIR (NPROMA, 1:YDCPG_DIM%KSW)
  TYPE (FIELD_3D), POINTER :: F_SWDIR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SWDIF (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SWDIF (NPROMA, 1:YDCPG_DIM%KSW)
  TYPE (FIELD_3D), POINTER :: F_SWDIF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LSM (:) => NULL ()
!>REAL (KIND=JPRB)                      :: LSM (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_LSM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CD (:) => NULL ()
!>REAL (KIND=JPRB)                      :: CD (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_CD => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_GPAR_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_GPAR_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_GPAR_TYPE_FINAL
END TYPE CPG_GPAR_TYPE

TYPE CPG_GP_T_TMP_TYPE

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GDW (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GDW (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_GDW => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWHT (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GWHT (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_GWHT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: OROGLL (:) => NULL ()
!>REAL (KIND=JPRB)                      :: OROGLL (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_OROGLL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: OROGMM (:) => NULL ()
!>REAL (KIND=JPRB)                      :: OROGMM (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_OROGMM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: OROGLM (:) => NULL ()
!>REAL (KIND=JPRB)                      :: OROGLM (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_OROGLM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DELNHPRE (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DELNHPRE (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_DELNHPRE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DPHYCTY (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DPHYCTY (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_DPHYCTY => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DVER (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DVER (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_DVER => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DVERL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DVERL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_DVERL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DVERM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DVERM (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_DVERM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DVERW (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DVERW (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_DVERW => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EIQCHAF (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: EIQCHAF (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_EIQCHAF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EQCHAF (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: EQCHAF (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_EQCHAF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EQCHAH (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: EQCHAH (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_EQCHAH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GPHL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GPHL (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_GPHL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GPHM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GPHM (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_GPHM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWHL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GWHL (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_GWHL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWHM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GWHM (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_GWHM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAPH (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: KAPH (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_KAPH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LNNHPREFL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: LNNHPREFL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_LNNHPREFL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LNNHPREFM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: LNNHPREFM (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_LNNHPREFM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHPPI (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: NHPPI (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_NHPPI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHPREL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: NHPREL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_NHPREL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHPREM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: NHPREM (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_NHPREM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHXD_T (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: NHXD_T (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_NHXD_T => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHXS (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: NHXS (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_NHXS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHXS_T (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: NHXS_T (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_NHXS_T => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHXT (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: NHXT (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_NHXT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PDEP (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PDEP (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PDEP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PDEPS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: PDEPS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_PDEPS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PSGRTL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PSGRTL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PSGRTL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PSGRTM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PSGRTM (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PSGRTM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: R0T (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: R0T (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_R0T => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: R9T (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: R9T (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_R9T => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RDT (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RDT (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RDT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RDTL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RDTL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RDTL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RDTM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RDTM (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RDTM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RNHPPI (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RNHPPI (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RNHPPI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RPREF (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RPREF (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RPREF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RRED (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RRED (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RRED => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RT (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RT (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RTR (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RTR (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RTR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SGRTL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SGRTL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_SGRTL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SGRTM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SGRTM (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_SGRTM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SGRTSL (:) => NULL ()
!>REAL (KIND=JPRB)                      :: SGRTSL (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_SGRTSL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SGRTSM (:) => NULL ()
!>REAL (KIND=JPRB)                      :: SGRTSM (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_SGRTSM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SVDINCR13 (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SVDINCR13 (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_SVDINCR13 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDGWF_LAP (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TNDGWF_LAP (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_TNDGWF_LAP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDGWF_OTH (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TNDGWF_OTH (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_TNDGWF_OTH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDGWH_LAP (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TNDGWH_LAP (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_TNDGWH_LAP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDGWH_OTH (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TNDGWH_OTH (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_TNDGWH_OTH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDUS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: TNDUS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_TNDUS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TNDVS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: TNDVS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_TNDVS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: US (:) => NULL ()
!>REAL (KIND=JPRB)                      :: US (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_US => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: US_L (:) => NULL ()
!>REAL (KIND=JPRB)                      :: US_L (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_US_L => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: US_M (:) => NULL ()
!>REAL (KIND=JPRB)                      :: US_M (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_US_M => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: VS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_VS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VS_L (:) => NULL ()
!>REAL (KIND=JPRB)                      :: VS_L (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_VS_L => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VS_M (:) => NULL ()
!>REAL (KIND=JPRB)                      :: VS_M (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_VS_M => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: Z3DIVG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: Z3DIVG (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_Z3DIVG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WH2F (:, :, :) => NULL ()
!>REAL (KIND=JPRB)                      :: WH2F (NPROMA, 1:NLEV, 1:2)
  TYPE (FIELD_4D), POINTER :: F_WH2F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZERO (:) => NULL ()
!>REAL (KIND=JPRB)                      :: ZERO (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_ZERO => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ONE (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: ONE (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_ONE => NULL ()
  TYPE (CPG_XYBDER_TYPE) :: XYBDER
  TYPE (CPG_HWIND_TYPE) :: UVH

CONTAINS
  PROCEDURE :: INIT => CPG_GP_T_TMP_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_GP_T_TMP_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_GP_T_TMP_TYPE_FINAL
END TYPE CPG_GP_T_TMP_TYPE

TYPE CPG_GP_TMP_TYPE

  TYPE (CPG_GP_T_TMP_TYPE) :: T0
  TYPE (CPG_GP_T_TMP_TYPE) :: T9

CONTAINS
  PROCEDURE :: INIT => CPG_GP_TMP_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_GP_TMP_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_GP_TMP_TYPE_FINAL
END TYPE CPG_GP_TMP_TYPE

TYPE CPG_DYN_TYPE

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: OROGL (:) => NULL ()
!>REAL (KIND=JPRB)                      :: OROGL (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_OROGL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: OROGM (:) => NULL ()
!>REAL (KIND=JPRB)                      :: OROGM (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_OROGM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PHI (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PHI (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PHI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PRE (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PRE (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PRE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PHIF (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PHIF (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PHIF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREF (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PREF (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PREF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WRL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: WRL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_WRL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREL (:) => NULL ()
!>REAL (KIND=JPRB)                      :: PREL (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_PREL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREM (:) => NULL ()
!>REAL (KIND=JPRB)                      :: PREM (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_PREM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHY (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: NHY (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_NHY => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWFT (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GWFT (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_GWFT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KENE (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: KENE (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_KENE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHX (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: NHX (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_NHX => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PHIFL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PHIFL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PHIFL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PHIFM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PHIFM (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PHIFM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RTL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RTL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RTL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RTM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RTM (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RTM => NULL ()
  TYPE (CPG_RCP_TYPE) :: RCP
  TYPE (CPG_CTY_TYPE) :: CTY
  TYPE (CPG_HWIND_TYPE) :: UVH
  TYPE (CPG_XYB_TYPE) :: XYB
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DBBC (:) => NULL ()
!>REAL (KIND=JPRB)                      :: DBBC (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_DBBC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: GWS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_GWS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWFL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GWFL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_GWFL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWFM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GWFM (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_GWFM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWT (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GWT (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_GWT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHPREF (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: NHPREF (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_NHPREF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHPREH (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: NHPREH (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_NHPREH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QCHAL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: QCHAL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_QCHAL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QCHAM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: QCHAM (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_QCHAM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RDPHI (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RDPHI (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_RDPHI => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_DYN_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_DYN_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_DYN_TYPE_FINAL
END TYPE CPG_DYN_TYPE

TYPE CPG_PHY_TYPE

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PRE (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PRE (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PRE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREF (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PREF (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PREF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREHYD (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PREHYD (NPROMA, 0:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PREHYD => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PREHYDF (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PREHYDF (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_PREHYDF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: WL (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_WL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WM (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: WM (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_WM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: W (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: W (NPROMA, 1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_W => NULL ()
  TYPE (CPG_XYB_TYPE) :: XYB

CONTAINS
  PROCEDURE :: INIT => CPG_PHY_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_PHY_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_PHY_TYPE_FINAL
END TYPE CPG_PHY_TYPE


TYPE CPG_MISC_TYPE

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NEB (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: NEB (NPROMA, 1:YDCPG_DIM%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_NEB => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QLI (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: QLI (NPROMA, 1:YDCPG_DIM%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_QLI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QICE (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: QICE (NPROMA, 1:YDCPG_DIM%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_QICE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QRAIN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: QRAIN (NPROMA, 1:YDCPG_DIM%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_QRAIN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QSNOW (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: QSNOW (NPROMA, 1:YDCPG_DIM%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_QSNOW => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RH (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RH (NPROMA, 1:YDCPG_DIM%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_RH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: QS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_QS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QSOL (:) => NULL ()
!>REAL (KIND=JPRB)                      :: QSOL (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_QSOL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DHSF (:) => NULL ()
!>REAL (KIND=JPRB)                      :: DHSF (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_DHSF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CLCT (:) => NULL ()
!>REAL (KIND=JPRB)                      :: CLCT (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_CLCT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LSM (:) => NULL ()
!>REAL (KIND=JPRB)                      :: LSM (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_LSM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TSOL (:) => NULL ()
!>REAL (KIND=JPRB)                      :: TSOL (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_TSOL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FTCNS (:, :, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FTCNS (NPROMA, 0:YDCPG_DIM%KFLEVG, 1:6)
  TYPE (FIELD_4D), POINTER :: F_FTCNS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KOZO (:, :, :) => NULL ()
!>REAL (KIND=JPRB)                      :: KOZO (NPROMA, 0:YDCPG_DIM%KFLEVG, 1:YDCPG_DIM%KVCLIS)
  TYPE (FIELD_4D), POINTER :: F_KOZO => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_MISC_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_MISC_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_MISC_TYPE_FINAL
END TYPE CPG_MISC_TYPE

TYPE CPG_TMP_TYPE
  TYPE (CPG_GP_TMP_TYPE) :: CPG_GP
CONTAINS
  PROCEDURE :: INIT => CPG_TMP_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_TMP_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_TMP_TYPE_FINAL
END TYPE CPG_TMP_TYPE

TYPE CPG_DDH_TYPE
  REAL(KIND=JPRB), POINTER, CONTIGUOUS :: AUX3D (:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_AUX3D => NULL ()
  
  REAL(KIND=JPRB), POINTER, CONTIGUOUS :: AUX2D (:,:) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_AUX2D => NULL ()

  REAL(KIND=JPRB), POINTER, CONTIGUOUS :: DHCV  (:,:,:) => NULL ()
  TYPE (FIELD_4D), POINTER :: F_DHCV => NULL ()
  REAL(KIND=JPRB), POINTER, CONTIGUOUS :: AUXSM (:,:,:,:) => NULL ()
  TYPE (FIELD_5D), POINTER :: F_AUXSM => NULL ()
  INTEGER(KIND=JPIM), POINTER, CONTIGUOUS :: DDHI (:) => NULL ()
  TYPE (FIELD_INT2D), POINTER :: F_DDHI => NULL ()
CONTAINS
  PROCEDURE :: INIT => CPG_DDH_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_DDH_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_DDH_TYPE_FINAL
END TYPE CPG_DDH_TYPE




TYPE CPG_SL1_TYPE
  LOGICAL :: LOWNED = .FALSE.
  INTEGER (KIND=JPIM) :: NLEV = -1
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:) => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZDATA (:,:,:) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: U9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: U9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_U9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: V9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: V9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_V9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: T9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: T9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_T9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PD9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: PD9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_PD9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VD9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VD9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VD9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NHX9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: NHX9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_NHX9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UR0 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: UR0 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_UR0 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VR0 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VR0 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VR0 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZR0 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: ZR0 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_ZR0 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WR0 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: WR0 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_WR0 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UR00 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: UR00 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_UR00 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VR00 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VR00 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VR00 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZR00 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: ZR00 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_ZR00 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WR00 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: WR00 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_WR00 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WRA (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: WRA (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_WRA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UR9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: UR9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_UR9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VR9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VR9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VR9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DBBC9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: DBBC9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_DBBC9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DPHI9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: DPHI9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_DPHI9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWS9 (:) => NULL ()
!>REAL (KIND=JPRB)                      :: GWS9 (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_GWS9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: U0 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: U0 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_U0 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: V0 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: V0 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_V0 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: T0 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: T0 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_T0 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PD0 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: PD0 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_PD0 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VD0 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VD0 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VD0 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: C9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: C9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_C9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SP9 (:) => NULL ()
!>REAL (KIND=JPRB)                      :: SP9 (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_SP9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SP0 (:) => NULL ()
!>REAL (KIND=JPRB)                      :: SP0 (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_SP0 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: C0 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: C0 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_C0 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UP9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: UP9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_UP9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VP9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VP9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VP9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TP9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: TP9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_TP9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: U9_SI (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: U9_SI (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_U9_SI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: V9_SI (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: V9_SI (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_V9_SI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: T9_SI (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: T9_SI (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_T9_SI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PD9_SI (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: PD9_SI (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_PD9_SI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VD9_SI (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VD9_SI (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VD9_SI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: C9_SI (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: C9_SI (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_C9_SI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UF9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: UF9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_UF9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VF9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VF9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VF9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TF9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: TF9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_TF9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VDF9 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VDF9 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VDF9 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: U9_NL (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: U9_NL (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_U9_NL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: V9_NL (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: V9_NL (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_V9_NL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: T9_NL (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: T9_NL (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_T9_NL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PD9_NL (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: PD9_NL (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_PD9_NL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VD9_NL (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VD9_NL (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VD9_NL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: C9_NL (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: C9_NL (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_C9_NL => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: Q   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: Q (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_Q => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: Q_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: Q_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_Q_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: I   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: I (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_I => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: I_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: I_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_I_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: L   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: L (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_L => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: L_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: L_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_L_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LCONV   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: LCONV (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_LCONV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LCONV_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: LCONV_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_LCONV_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ICONV   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: ICONV (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_ICONV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ICONV_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: ICONV_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_ICONV_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RCONV   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RCONV (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_RCONV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RCONV_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RCONV_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_RCONV_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SCONV   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SCONV (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_SCONV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SCONV_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SCONV_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_SCONV_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: IRAD   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: IRAD (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_IRAD => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: IRAD_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: IRAD_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_IRAD_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LRAD   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: LRAD (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_LRAD => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LRAD_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: LRAD_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_LRAD_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: S   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: S (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_S => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: S_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: S_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_S_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: R   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: R (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_R => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: R_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: R_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_R_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: G   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: G (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_G => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: G_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: G_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_G_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: H   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: H (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_H => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: H_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: H_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_H_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TKE   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TKE (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_TKE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TKE_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TKE_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_TKE_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TTE   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TTE (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_TTE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TTE_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TTE_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_TTE_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EFB1   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: EFB1 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_EFB1 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EFB1_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: EFB1_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_EFB1_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EFB2   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: EFB2 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_EFB2 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EFB2_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: EFB2_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_EFB2_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EFB3   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: EFB3 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_EFB3 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EFB3_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: EFB3_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_EFB3_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: A   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: A (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_A => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: A_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: A_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_A_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: O3   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: O3 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_O3 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: O3_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: O3_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_O3_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SRC   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SRC (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_SRC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SRC_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SRC_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_SRC_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: MXL   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: MXL (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_MXL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: MXL_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: MXL_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_MXL_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SHTUR   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SHTUR (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_SHTUR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SHTUR_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SHTUR_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_SHTUR_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FQTUR   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FQTUR (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_FQTUR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FQTUR_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FQTUR_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_FQTUR_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FSTUR   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FSTUR (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_FSTUR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FSTUR_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FSTUR_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_FSTUR_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CPF   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: CPF (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_CPF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CPF_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: CPF_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_CPF_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SPF   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SPF (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_SPF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SPF_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SPF_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_SPF_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CVGQ   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: CVGQ (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_CVGQ => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CVGQ_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: CVGQ_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_CVGQ_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QVA   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: QVA (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_QVA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QVA_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: QVA_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_QVA_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LRCH4   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: LRCH4 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_LRCH4 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: LRCH4_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: LRCH4_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_LRCH4_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PHYCTY   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PHYCTY (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_PHYCTY => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PHYCTY_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: PHYCTY_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_PHYCTY_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RSPEC   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RSPEC (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_RSPEC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RSPEC_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RSPEC_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_RSPEC_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SDSAT   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SDSAT (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_SDSAT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SDSAT_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: SDSAT_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_SDSAT_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CVV   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: CVV (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_CVV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CVV_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: CVV_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_CVV_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RKTH   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RKTH (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_RKTH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RKTH_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RKTH_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_RKTH_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RKTQV   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RKTQV (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_RKTQV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RKTQV_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RKTQV_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_RKTQV_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RKTQC   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RKTQC (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_RKTQC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RKTQC_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: RKTQC_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_RKTQC_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UOM   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: UOM (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_UOM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UOM_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: UOM_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_UOM_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UAL   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: UAL (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_UAL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UAL_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: UAL_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_UAL_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DOM   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DOM (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_DOM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DOM_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DOM_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_DOM_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DAL   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DAL (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_DAL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DAL_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DAL_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_DAL_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UEN   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: UEN (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_UEN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UEN_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: UEN_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_UEN_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UNEBH   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: UNEBH (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_UNEBH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UNEBH_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: UNEBH_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_UNEBH_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FSD   (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FSD (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_FSD => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FSD_F (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FSD_F (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_FSD_F => NULL ()
CONTAINS
  PROCEDURE :: INIT => CPG_SL1_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_SL1_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_SL1_TYPE_FINAL
END TYPE CPG_SL1_TYPE

TYPE CPG_SL2_TYPE
  LOGICAL :: LOWNED = .FALSE.
  INTEGER (KIND=JPIM) :: NLEV = -1
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:) => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZDATA (:,:,:) => NULL ()
  TYPE (FIELD_3D), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DBBC1 (:) => NULL ()
!>REAL (KIND=JPRB)                      :: DBBC1 (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_DBBC1 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DPHI1 (:) => NULL ()
!>REAL (KIND=JPRB)                      :: DPHI1 (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_DPHI1 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: USI (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: USI (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_USI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VSI (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VSI (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VSI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TSI (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: TSI (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_TSI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PDSI (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: PDSI (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_PDSI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VDSI (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VDSI (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VDSI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SPSI (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: SPSI (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_SPSI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VVEL (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VVEL (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VVEL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: URL (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: URL (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_URL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VRL (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VRL (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VRL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WRL (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: WRL (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_WRL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: URL5 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: URL5 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_URL5 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VRL5 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VRL5 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VRL5 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WRL5 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: WRL5 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_WRL5 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: USI5 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: USI5 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_USI5 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VSI5 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VSI5 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_VSI5 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: U15 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: U15 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_U15 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: V15 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: V15 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_V15 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: T15 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: T15 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_T15 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: Q15 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: Q15 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_Q15 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAPPA (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: KAPPA (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_KAPPA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAPPAT (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: KAPPAT (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_KAPPAT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAPPAM (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: KAPPAM (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_KAPPAM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAPPAH (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: KAPPAH (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_KAPPAH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAPPA5 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: KAPPA5 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_KAPPA5 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAPPAT5 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: KAPPAT5 (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_KAPPAT5 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWF (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: GWF (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_GWF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GDW (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: GDW (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_GDW => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWS (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: GWS (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_GWS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: STDDISU (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: STDDISU (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_STDDISU => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: STDDISV (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: STDDISV (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_STDDISV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: STDDISW (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: STDDISW (NPROMA, 0:NLEV+1)
  TYPE (FIELD_3D), POINTER :: F_STDDISW => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_SL2_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => CPG_SL2_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_SL2_TYPE_FINAL
END TYPE CPG_SL2_TYPE

REAL(KIND=JPRB),    PRIVATE, SAVE, TARGET :: ZDUM1 (1), ZDUM2 (1, 1), ZDUM3 (1,1,1)
INTEGER(KIND=JPIM), PRIVATE, SAVE, TARGET :: IDUM1 (1), IDUM2 (1, 1), IDUM3 (1,1,1)

CONTAINS

SUBROUTINE CPG_XYBDER_TYPE_INIT (SELF, REGISTRY, NLEV, YDTXYBDER, PERSISTENT, PTXYBDER)

USE INTDYN_MOD, ONLY : TXYBDER
USE OML_MOD, ONLY: OML_MAX_THREADS

CLASS (CPG_XYBDER_TYPE)                          :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TXYBDER),                    INTENT (IN)    :: YDTXYBDER
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PTXYBDER (:, :, :, :)

LOGICAL :: LLPERSISTENT

LLPERSISTENT = .FALSE.
IF (PRESENT (PERSISTENT)) LLPERSISTENT = PERSISTENT

IF (PRESENT (PTXYBDER)) THEN
  SELF%ZDATA => PTXYBDER
  SELF%LOWNED = .FALSE.
  LLPERSISTENT = .TRUE.
ELSEIF (LLPERSISTENT) THEN
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, NLEV, YDTXYBDER%NDIM, REGISTRY%GEOM%YRDIM%NGPBLKS))
  SELF%LOWNED = .TRUE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, NLEV, YDTXYBDER%NDIM, OML_MAX_THREADS ()))
  SELF%LOWNED = .TRUE.
ENDIF

SELF%F_DATA => CREATE_FIELD_WRAP (SELF%ZDATA, PERSISTENT=LLPERSISTENT)

SELF%F_LNPRL => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYBDER%M_LNPRL, :), PERSISTENT=LLPERSISTENT)
SELF%F_LNPRM => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYBDER%M_LNPRM, :), PERSISTENT=LLPERSISTENT)
SELF%F_ALPHL => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYBDER%M_ALPHL, :), PERSISTENT=LLPERSISTENT)
SELF%F_ALPHM => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYBDER%M_ALPHM, :), PERSISTENT=LLPERSISTENT)
SELF%F_ALPHPLL => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYBDER%M_ALPHPLL, :), PERSISTENT=LLPERSISTENT)
SELF%F_ALPHPLM => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYBDER%M_ALPHPLM, :), PERSISTENT=LLPERSISTENT)
SELF%F_COEFD => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYBDER%M_COEFD, :), PERSISTENT=LLPERSISTENT)
SELF%F_COEFA => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYBDER%M_COEFA, :), PERSISTENT=LLPERSISTENT)
SELF%F_COEFAPL => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYBDER%M_COEFAPL, :), PERSISTENT=LLPERSISTENT)

END SUBROUTINE CPG_XYBDER_TYPE_INIT

SUBROUTINE CPG_XYBDER_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_XYBDER_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN

  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)

  IF (ASSOCIATED (SELF%F_LNPRL)) THEN
    SELF%LNPRL  => SELF%F_LNPRL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%LNPRL  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_LNPRM)) THEN
    SELF%LNPRM  => SELF%F_LNPRM%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%LNPRM  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_ALPHL)) THEN
    SELF%ALPHL  => SELF%F_ALPHL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%ALPHL  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_ALPHM)) THEN
    SELF%ALPHM  => SELF%F_ALPHM%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%ALPHM  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_ALPHPLL)) THEN
    SELF%ALPHPLL  => SELF%F_ALPHPLL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%ALPHPLL  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_ALPHPLM)) THEN
    SELF%ALPHPLM  => SELF%F_ALPHPLM%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%ALPHPLM  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_COEFD)) THEN
    SELF%COEFD  => SELF%F_COEFD%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%COEFD  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_COEFA)) THEN
    SELF%COEFA  => SELF%F_COEFA%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%COEFA  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_COEFAPL)) THEN
    SELF%COEFAPL  => SELF%F_COEFAPL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%COEFAPL  => ZDUM2
  ENDIF

ELSE

  SELF%ZVIEW => ZDUM3

  SELF%LNPRL  => ZDUM2
  SELF%LNPRM  => ZDUM2
  SELF%ALPHL  => ZDUM2
  SELF%ALPHM  => ZDUM2
  SELF%ALPHPLL  => ZDUM2
  SELF%ALPHPLM  => ZDUM2
  SELF%COEFD  => ZDUM2
  SELF%COEFA  => ZDUM2
  SELF%COEFAPL  => ZDUM2

ENDIF

END SUBROUTINE CPG_XYBDER_TYPE_UPDATE_VIEW

SUBROUTINE CPG_XYBDER_TYPE_FINAL (SELF)
CLASS (CPG_XYBDER_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)
SELF%F_DATA => NULL ()

IF (SELF%LOWNED) THEN
  DEALLOCATE (SELF%ZDATA)
ENDIF

SELF%ZDATA => NULL ()
SELF%ZVIEW => NULL ()

IF (ASSOCIATED (SELF%F_LNPRL)) THEN
  CALL DELETE_TEMPORARY (SELF%F_LNPRL) 
  SELF%F_LNPRL => NULL ()
  SELF%LNPRL => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_LNPRM)) THEN
  CALL DELETE_TEMPORARY (SELF%F_LNPRM) 
  SELF%F_LNPRM => NULL ()
  SELF%LNPRM => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_ALPHL)) THEN
  CALL DELETE_TEMPORARY (SELF%F_ALPHL) 
  SELF%F_ALPHL => NULL ()
  SELF%ALPHL => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_ALPHM)) THEN
  CALL DELETE_TEMPORARY (SELF%F_ALPHM) 
  SELF%F_ALPHM => NULL ()
  SELF%ALPHM => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_ALPHPLL)) THEN
  CALL DELETE_TEMPORARY (SELF%F_ALPHPLL) 
  SELF%F_ALPHPLL => NULL ()
  SELF%ALPHPLL => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_ALPHPLM)) THEN
  CALL DELETE_TEMPORARY (SELF%F_ALPHPLM) 
  SELF%F_ALPHPLM => NULL ()
  SELF%ALPHPLM => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_COEFD)) THEN
  CALL DELETE_TEMPORARY (SELF%F_COEFD) 
  SELF%F_COEFD => NULL ()
  SELF%COEFD => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_COEFA)) THEN
  CALL DELETE_TEMPORARY (SELF%F_COEFA) 
  SELF%F_COEFA => NULL ()
  SELF%COEFA => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_COEFAPL)) THEN
  CALL DELETE_TEMPORARY (SELF%F_COEFAPL) 
  SELF%F_COEFAPL => NULL ()
  SELF%COEFAPL => NULL ()
ENDIF

END SUBROUTINE CPG_XYBDER_TYPE_FINAL

SUBROUTINE CPG_XYB_TYPE_INIT (SELF, REGISTRY, NLEV, YDTXYB, PERSISTENT, PTXYB)

USE INTDYN_MOD, ONLY : TXYB
USE OML_MOD, ONLY: OML_MAX_THREADS

CLASS (CPG_XYB_TYPE)                          :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TXYB),                    INTENT (IN)    :: YDTXYB
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PTXYB (:, :, :, :)

LOGICAL :: LLPERSISTENT

LLPERSISTENT = .FALSE.
IF (PRESENT (PERSISTENT)) LLPERSISTENT = PERSISTENT

IF (PRESENT (PTXYB)) THEN
  SELF%ZDATA => PTXYB
  SELF%LOWNED = .FALSE.
  LLPERSISTENT = .TRUE.
ELSEIF (LLPERSISTENT) THEN
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, NLEV, YDTXYB%NDIM, REGISTRY%GEOM%YRDIM%NGPBLKS))
  SELF%LOWNED = .TRUE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, NLEV, YDTXYB%NDIM, OML_MAX_THREADS ()))
  SELF%LOWNED = .TRUE.
ENDIF

SELF%F_DATA => CREATE_FIELD_WRAP (SELF%ZDATA, PERSISTENT=LLPERSISTENT)

SELF%F_DELP => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYB%M_DELP, :), PERSISTENT=LLPERSISTENT)
SELF%F_RDELP => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYB%M_RDELP, :), PERSISTENT=LLPERSISTENT)
SELF%F_LNPR => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYB%M_LNPR, :), PERSISTENT=LLPERSISTENT)
SELF%F_ALPH => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYB%M_ALPH, :), PERSISTENT=LLPERSISTENT)
SELF%F_RTGR => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYB%M_RTGR, :), PERSISTENT=LLPERSISTENT)
SELF%F_RPRE => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYB%M_RPRE, :), PERSISTENT=LLPERSISTENT)
SELF%F_RPP => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTXYB%M_RPP, :), PERSISTENT=LLPERSISTENT)

END SUBROUTINE CPG_XYB_TYPE_INIT

SUBROUTINE CPG_XYB_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_XYB_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN

  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)

  IF (ASSOCIATED (SELF%F_DELP)) THEN
    SELF%DELP  => SELF%F_DELP%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%DELP  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RDELP)) THEN
    SELF%RDELP  => SELF%F_RDELP%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RDELP  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_LNPR)) THEN
    SELF%LNPR  => SELF%F_LNPR%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%LNPR  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_ALPH)) THEN
    SELF%ALPH  => SELF%F_ALPH%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%ALPH  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RTGR)) THEN
    SELF%RTGR  => SELF%F_RTGR%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RTGR  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RPRE)) THEN
    SELF%RPRE  => SELF%F_RPRE%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RPRE  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RPP)) THEN
    SELF%RPP  => SELF%F_RPP%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RPP  => ZDUM2
  ENDIF

ELSE

  SELF%ZVIEW => ZDUM3

  SELF%DELP  => ZDUM2
  SELF%RDELP  => ZDUM2
  SELF%LNPR  => ZDUM2
  SELF%ALPH  => ZDUM2
  SELF%RTGR  => ZDUM2
  SELF%RPRE  => ZDUM2
  SELF%RPP  => ZDUM2

ENDIF

END SUBROUTINE CPG_XYB_TYPE_UPDATE_VIEW

SUBROUTINE CPG_XYB_TYPE_FINAL (SELF)
CLASS (CPG_XYB_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)
SELF%F_DATA => NULL ()

IF (SELF%LOWNED) THEN
  DEALLOCATE (SELF%ZDATA)
ENDIF

SELF%ZDATA => NULL ()
SELF%ZVIEW => NULL ()

IF (ASSOCIATED (SELF%F_DELP)) THEN
  CALL DELETE_TEMPORARY (SELF%F_DELP) 
  SELF%F_DELP => NULL ()
  SELF%DELP => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_RDELP)) THEN
  CALL DELETE_TEMPORARY (SELF%F_RDELP) 
  SELF%F_RDELP => NULL ()
  SELF%RDELP => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_LNPR)) THEN
  CALL DELETE_TEMPORARY (SELF%F_LNPR) 
  SELF%F_LNPR => NULL ()
  SELF%LNPR => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_ALPH)) THEN
  CALL DELETE_TEMPORARY (SELF%F_ALPH) 
  SELF%F_ALPH => NULL ()
  SELF%ALPH => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_RTGR)) THEN
  CALL DELETE_TEMPORARY (SELF%F_RTGR) 
  SELF%F_RTGR => NULL ()
  SELF%RTGR => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_RPRE)) THEN
  CALL DELETE_TEMPORARY (SELF%F_RPRE) 
  SELF%F_RPRE => NULL ()
  SELF%RPRE => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_RPP)) THEN
  CALL DELETE_TEMPORARY (SELF%F_RPP) 
  SELF%F_RPP => NULL ()
  SELF%RPP => NULL ()
ENDIF

END SUBROUTINE CPG_XYB_TYPE_FINAL

SUBROUTINE CPG_HWIND_TYPE_INIT (SELF, REGISTRY, NLEV, YDTHWIND, PERSISTENT, PTHWIND)

USE INTDYN_MOD, ONLY : THWIND
USE OML_MOD, ONLY: OML_MAX_THREADS

CLASS (CPG_HWIND_TYPE)                          :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (THWIND),                    INTENT (IN)    :: YDTHWIND
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PTHWIND (:, :, :, :)

LOGICAL :: LLPERSISTENT

LLPERSISTENT = .FALSE.
IF (PRESENT (PERSISTENT)) LLPERSISTENT = PERSISTENT

IF (PRESENT (PTHWIND)) THEN
  SELF%ZDATA => PTHWIND
  SELF%LOWNED = .FALSE.
  LLPERSISTENT = .TRUE.
ELSEIF (LLPERSISTENT) THEN
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, NLEV+1, YDTHWIND%NDIM, REGISTRY%GEOM%YRDIM%NGPBLKS))
  SELF%LOWNED = .TRUE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, NLEV+1, YDTHWIND%NDIM, OML_MAX_THREADS ()))
  SELF%LOWNED = .TRUE.
ENDIF

SELF%F_DATA => CREATE_FIELD_WRAP (SELF%ZDATA, PERSISTENT=LLPERSISTENT)

SELF%F_UH => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTHWIND%M_UH, :), PERSISTENT=LLPERSISTENT)
SELF%F_VH => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTHWIND%M_VH, :), PERSISTENT=LLPERSISTENT)
SELF%F_WWI => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTHWIND%M_WWI, :), PERSISTENT=LLPERSISTENT)

END SUBROUTINE CPG_HWIND_TYPE_INIT

SUBROUTINE CPG_HWIND_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_HWIND_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN

  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)

  IF (ASSOCIATED (SELF%F_UH)) THEN
    SELF%UH (1:,0:) => SELF%F_UH%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%UH (1:,0:) => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VH)) THEN
    SELF%VH (1:,0:) => SELF%F_VH%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VH (1:,0:) => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_WWI)) THEN
    SELF%WWI (1:,0:) => SELF%F_WWI%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%WWI (1:,0:) => ZDUM2
  ENDIF

ELSE

  SELF%ZVIEW => ZDUM3

  SELF%UH (1:,0:) => ZDUM2
  SELF%VH (1:,0:) => ZDUM2
  SELF%WWI (1:,0:) => ZDUM2

ENDIF

END SUBROUTINE CPG_HWIND_TYPE_UPDATE_VIEW

SUBROUTINE CPG_HWIND_TYPE_FINAL (SELF)
CLASS (CPG_HWIND_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)
SELF%F_DATA => NULL ()

IF (SELF%LOWNED) THEN
  DEALLOCATE (SELF%ZDATA)
ENDIF

SELF%ZDATA => NULL ()
SELF%ZVIEW => NULL ()

IF (ASSOCIATED (SELF%F_UH)) THEN
  CALL DELETE_TEMPORARY (SELF%F_UH) 
  SELF%F_UH => NULL ()
  SELF%UH => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_VH)) THEN
  CALL DELETE_TEMPORARY (SELF%F_VH) 
  SELF%F_VH => NULL ()
  SELF%VH => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_WWI)) THEN
  CALL DELETE_TEMPORARY (SELF%F_WWI) 
  SELF%F_WWI => NULL ()
  SELF%WWI => NULL ()
ENDIF

END SUBROUTINE CPG_HWIND_TYPE_FINAL

SUBROUTINE CPG_RCP_TYPE_INIT (SELF, REGISTRY, NLEV, YDTRCP, PERSISTENT, PTRCP)

USE INTDYN_MOD, ONLY : TRCP
USE OML_MOD, ONLY: OML_MAX_THREADS

CLASS (CPG_RCP_TYPE)                          :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TRCP),                    INTENT (IN)    :: YDTRCP
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PTRCP (:, :, :, :)

LOGICAL :: LLPERSISTENT

LLPERSISTENT = .FALSE.
IF (PRESENT (PERSISTENT)) LLPERSISTENT = PERSISTENT

IF (PRESENT (PTRCP)) THEN
  SELF%ZDATA => PTRCP
  SELF%LOWNED = .FALSE.
  LLPERSISTENT = .TRUE.
ELSEIF (LLPERSISTENT) THEN
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, NLEV, YDTRCP%NDIM, REGISTRY%GEOM%YRDIM%NGPBLKS))
  SELF%LOWNED = .TRUE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, NLEV, YDTRCP%NDIM, OML_MAX_THREADS ()))
  SELF%LOWNED = .TRUE.
ENDIF

SELF%F_DATA => CREATE_FIELD_WRAP (SELF%ZDATA, PERSISTENT=LLPERSISTENT)

SELF%F_CP => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTRCP%M_CP, :), PERSISTENT=LLPERSISTENT)
SELF%F_R => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTRCP%M_R, :), PERSISTENT=LLPERSISTENT)
SELF%F_KAP => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTRCP%M_KAP, :), PERSISTENT=LLPERSISTENT)

END SUBROUTINE CPG_RCP_TYPE_INIT

SUBROUTINE CPG_RCP_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_RCP_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN

  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)

  IF (ASSOCIATED (SELF%F_CP)) THEN
    SELF%CP  => SELF%F_CP%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%CP  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_R)) THEN
    SELF%R  => SELF%F_R%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%R  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_KAP)) THEN
    SELF%KAP  => SELF%F_KAP%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%KAP  => ZDUM2
  ENDIF

ELSE

  SELF%ZVIEW => ZDUM3

  SELF%CP  => ZDUM2
  SELF%R  => ZDUM2
  SELF%KAP  => ZDUM2

ENDIF

END SUBROUTINE CPG_RCP_TYPE_UPDATE_VIEW

SUBROUTINE CPG_RCP_TYPE_FINAL (SELF)
CLASS (CPG_RCP_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)
SELF%F_DATA => NULL ()

IF (SELF%LOWNED) THEN
  DEALLOCATE (SELF%ZDATA)
ENDIF

SELF%ZDATA => NULL ()
SELF%ZVIEW => NULL ()

IF (ASSOCIATED (SELF%F_CP)) THEN
  CALL DELETE_TEMPORARY (SELF%F_CP) 
  SELF%F_CP => NULL ()
  SELF%CP => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_R)) THEN
  CALL DELETE_TEMPORARY (SELF%F_R) 
  SELF%F_R => NULL ()
  SELF%R => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_KAP)) THEN
  CALL DELETE_TEMPORARY (SELF%F_KAP) 
  SELF%F_KAP => NULL ()
  SELF%KAP => NULL ()
ENDIF

END SUBROUTINE CPG_RCP_TYPE_FINAL

SUBROUTINE CPG_CTY_TYPE_INIT (SELF, REGISTRY, NLEV, YDTCTY, PERSISTENT, PTCTY)

USE INTDYN_MOD, ONLY : TCTY
USE OML_MOD, ONLY: OML_MAX_THREADS

CLASS (CPG_CTY_TYPE)                          :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TCTY),                    INTENT (IN)    :: YDTCTY
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PTCTY (:, :, :, :)

LOGICAL :: LLPERSISTENT

LLPERSISTENT = .FALSE.
IF (PRESENT (PERSISTENT)) LLPERSISTENT = PERSISTENT

IF (PRESENT (PTCTY)) THEN
  SELF%ZDATA => PTCTY
  SELF%LOWNED = .FALSE.
  LLPERSISTENT = .TRUE.
ELSEIF (LLPERSISTENT) THEN
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, NLEV+1, YDTCTY%NDIM, REGISTRY%GEOM%YRDIM%NGPBLKS))
  SELF%LOWNED = .TRUE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, NLEV+1, YDTCTY%NDIM, OML_MAX_THREADS ()))
  SELF%LOWNED = .TRUE.
ENDIF

SELF%F_DATA => CREATE_FIELD_WRAP (SELF%ZDATA, PERSISTENT=LLPERSISTENT)

SELF%F_EVEL => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTCTY%M_EVEL, :), PERSISTENT=LLPERSISTENT)
SELF%F_VVEL => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTCTY%M_VVEL, :), PERSISTENT=LLPERSISTENT)
SELF%F_PSDIV => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTCTY%M_PSDIV, :), PERSISTENT=LLPERSISTENT)
SELF%F_PSDVBC => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTCTY%M_PSDVBC, :), PERSISTENT=LLPERSISTENT)
SELF%F_DIVDP => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTCTY%M_DIVDP, :), PERSISTENT=LLPERSISTENT)

END SUBROUTINE CPG_CTY_TYPE_INIT

SUBROUTINE CPG_CTY_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_CTY_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN

  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)

  IF (ASSOCIATED (SELF%F_EVEL)) THEN
    SELF%EVEL (1:,0:) => SELF%F_EVEL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%EVEL (1:,0:) => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VVEL)) THEN
    SELF%VVEL (1:,0:) => SELF%F_VVEL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VVEL (1:,0:) => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_PSDIV)) THEN
    SELF%PSDIV (1:,0:) => SELF%F_PSDIV%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%PSDIV (1:,0:) => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_PSDVBC)) THEN
    SELF%PSDVBC (1:,0:) => SELF%F_PSDVBC%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%PSDVBC (1:,0:) => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_DIVDP)) THEN
    SELF%DIVDP (1:,0:) => SELF%F_DIVDP%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%DIVDP (1:,0:) => ZDUM2
  ENDIF

ELSE

  SELF%ZVIEW => ZDUM3

  SELF%EVEL (1:,0:) => ZDUM2
  SELF%VVEL (1:,0:) => ZDUM2
  SELF%PSDIV (1:,0:) => ZDUM2
  SELF%PSDVBC (1:,0:) => ZDUM2
  SELF%DIVDP (1:,0:) => ZDUM2

ENDIF

END SUBROUTINE CPG_CTY_TYPE_UPDATE_VIEW

SUBROUTINE CPG_CTY_TYPE_FINAL (SELF)
CLASS (CPG_CTY_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)
SELF%F_DATA => NULL ()

IF (SELF%LOWNED) THEN
  DEALLOCATE (SELF%ZDATA)
ENDIF

SELF%ZDATA => NULL ()
SELF%ZVIEW => NULL ()

IF (ASSOCIATED (SELF%F_EVEL)) THEN
  CALL DELETE_TEMPORARY (SELF%F_EVEL) 
  SELF%F_EVEL => NULL ()
  SELF%EVEL => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_VVEL)) THEN
  CALL DELETE_TEMPORARY (SELF%F_VVEL) 
  SELF%F_VVEL => NULL ()
  SELF%VVEL => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_PSDIV)) THEN
  CALL DELETE_TEMPORARY (SELF%F_PSDIV) 
  SELF%F_PSDIV => NULL ()
  SELF%PSDIV => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_PSDVBC)) THEN
  CALL DELETE_TEMPORARY (SELF%F_PSDVBC) 
  SELF%F_PSDVBC => NULL ()
  SELF%PSDVBC => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_DIVDP)) THEN
  CALL DELETE_TEMPORARY (SELF%F_DIVDP) 
  SELF%F_DIVDP => NULL ()
  SELF%DIVDP => NULL ()
ENDIF

END SUBROUTINE CPG_CTY_TYPE_FINAL

SUBROUTINE CPG_TND_TYPE_INIT (SELF, REGISTRY, NLEV, YDTTND, PERSISTENT, PTTND)

USE INTDYN_MOD, ONLY : TTND
USE OML_MOD, ONLY: OML_MAX_THREADS

CLASS (CPG_TND_TYPE)                          :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TTND),                    INTENT (IN)    :: YDTTND
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PTTND (:, :, :, :)

LOGICAL :: LLPERSISTENT

LLPERSISTENT = .FALSE.
IF (PRESENT (PERSISTENT)) LLPERSISTENT = PERSISTENT

IF (PRESENT (PTTND)) THEN
  SELF%ZDATA => PTTND
  SELF%LOWNED = .FALSE.
  LLPERSISTENT = .TRUE.
ELSEIF (LLPERSISTENT) THEN
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, NLEV, YDTTND%NDIM, REGISTRY%GEOM%YRDIM%NGPBLKS))
  SELF%LOWNED = .TRUE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, NLEV, YDTTND%NDIM, OML_MAX_THREADS ()))
  SELF%LOWNED = .TRUE.
ENDIF

SELF%F_DATA => CREATE_FIELD_WRAP (SELF%ZDATA, PERSISTENT=LLPERSISTENT)

SELF%F_TNDU => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTTND%M_TNDU, :), PERSISTENT=LLPERSISTENT)
SELF%F_TNDV => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTTND%M_TNDV, :), PERSISTENT=LLPERSISTENT)
SELF%F_TNDU_NOC => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTTND%M_TNDU_NOC, :), PERSISTENT=LLPERSISTENT)
SELF%F_TNDV_NOC => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTTND%M_TNDV_NOC, :), PERSISTENT=LLPERSISTENT)
SELF%F_TNDT => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTTND%M_TNDT, :), PERSISTENT=LLPERSISTENT)
SELF%F_TNDPD => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTTND%M_TNDPD, :), PERSISTENT=LLPERSISTENT)
SELF%F_TNDVD => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTTND%M_TNDVD, :), PERSISTENT=LLPERSISTENT)
SELF%F_TNDGW => CREATE_FIELD_WRAP (SELF%ZDATA (:, :, YDTTND%M_TNDGW, :), PERSISTENT=LLPERSISTENT)

END SUBROUTINE CPG_TND_TYPE_INIT

SUBROUTINE CPG_TND_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_TND_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN

  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)

  IF (ASSOCIATED (SELF%F_TNDU)) THEN
    SELF%TNDU  => SELF%F_TNDU%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TNDU  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TNDV)) THEN
    SELF%TNDV  => SELF%F_TNDV%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TNDV  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TNDU_NOC)) THEN
    SELF%TNDU_NOC  => SELF%F_TNDU_NOC%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TNDU_NOC  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TNDV_NOC)) THEN
    SELF%TNDV_NOC  => SELF%F_TNDV_NOC%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TNDV_NOC  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TNDT)) THEN
    SELF%TNDT  => SELF%F_TNDT%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TNDT  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TNDPD)) THEN
    SELF%TNDPD  => SELF%F_TNDPD%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TNDPD  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TNDVD)) THEN
    SELF%TNDVD  => SELF%F_TNDVD%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TNDVD  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TNDGW)) THEN
    SELF%TNDGW  => SELF%F_TNDGW%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TNDGW  => ZDUM2
  ENDIF

ELSE

  SELF%ZVIEW => ZDUM3

  SELF%TNDU  => ZDUM2
  SELF%TNDV  => ZDUM2
  SELF%TNDU_NOC  => ZDUM2
  SELF%TNDV_NOC  => ZDUM2
  SELF%TNDT  => ZDUM2
  SELF%TNDPD  => ZDUM2
  SELF%TNDVD  => ZDUM2
  SELF%TNDGW  => ZDUM2

ENDIF

END SUBROUTINE CPG_TND_TYPE_UPDATE_VIEW

SUBROUTINE CPG_TND_TYPE_FINAL (SELF)
CLASS (CPG_TND_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)
SELF%F_DATA => NULL ()

IF (SELF%LOWNED) THEN
  DEALLOCATE (SELF%ZDATA)
ENDIF

SELF%ZDATA => NULL ()
SELF%ZVIEW => NULL ()

IF (ASSOCIATED (SELF%F_TNDU)) THEN
  CALL DELETE_TEMPORARY (SELF%F_TNDU) 
  SELF%F_TNDU => NULL ()
  SELF%TNDU => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_TNDV)) THEN
  CALL DELETE_TEMPORARY (SELF%F_TNDV) 
  SELF%F_TNDV => NULL ()
  SELF%TNDV => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_TNDU_NOC)) THEN
  CALL DELETE_TEMPORARY (SELF%F_TNDU_NOC) 
  SELF%F_TNDU_NOC => NULL ()
  SELF%TNDU_NOC => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_TNDV_NOC)) THEN
  CALL DELETE_TEMPORARY (SELF%F_TNDV_NOC) 
  SELF%F_TNDV_NOC => NULL ()
  SELF%TNDV_NOC => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_TNDT)) THEN
  CALL DELETE_TEMPORARY (SELF%F_TNDT) 
  SELF%F_TNDT => NULL ()
  SELF%TNDT => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_TNDPD)) THEN
  CALL DELETE_TEMPORARY (SELF%F_TNDPD) 
  SELF%F_TNDPD => NULL ()
  SELF%TNDPD => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_TNDVD)) THEN
  CALL DELETE_TEMPORARY (SELF%F_TNDVD) 
  SELF%F_TNDVD => NULL ()
  SELF%TNDVD => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_TNDGW)) THEN
  CALL DELETE_TEMPORARY (SELF%F_TNDGW) 
  SELF%F_TNDGW => NULL ()
  SELF%TNDGW => NULL ()
ENDIF

END SUBROUTINE CPG_TND_TYPE_FINAL

SUBROUTINE CPG_GPAR_TYPE_INIT (SELF, REGISTRY, YDCPG_DIM, YDTPARAR, PERSISTENT, PTPARAR)

USE YOMPARAR, ONLY : TPARAR
USE OML_MOD, ONLY: OML_MAX_THREADS
USE CPG_DIM_TYPE_MOD, ONLY : CPG_DIM_TYPE

CLASS (CPG_GPAR_TYPE)                          :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
TYPE (CPG_DIM_TYPE),                INTENT (IN)    :: YDCPG_DIM
TYPE (TPARAR),                    INTENT (IN)    :: YDTPARAR
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PTPARAR (:, :, :)

LOGICAL :: LLPERSISTENT

LLPERSISTENT = .FALSE.
IF (PRESENT (PERSISTENT)) LLPERSISTENT = PERSISTENT

IF (PRESENT (PTPARAR)) THEN
  SELF%ZDATA => PTPARAR
  SELF%LOWNED = .FALSE.
  LLPERSISTENT = .TRUE.
ELSEIF (LLPERSISTENT) THEN
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, YDTPARAR%NGPAR, REGISTRY%GEOM%YRDIM%NGPBLKS))
  SELF%LOWNED = .TRUE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, YDTPARAR%NGPAR, OML_MAX_THREADS ()))
  SELF%LOWNED = .TRUE.
ENDIF

SELF%F_DATA => CREATE_FIELD_WRAP (SELF%ZDATA, PERSISTENT=LLPERSISTENT)

IF (YDTPARAR%MINPRR > 0) THEN
  SELF%F_INPRR => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MINPRR, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_INPRR => NULL ()
ENDIF
IF (YDTPARAR%MINPRS > 0) THEN
  SELF%F_INPRS => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MINPRS, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_INPRS => NULL ()
ENDIF
IF (YDTPARAR%MINPRG > 0) THEN
  SELF%F_INPRG => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MINPRG, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_INPRG => NULL ()
ENDIF
IF (YDTPARAR%MACPRR > 0) THEN
  SELF%F_ACPRR => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MACPRR, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_ACPRR => NULL ()
ENDIF
IF (YDTPARAR%MACPRS > 0) THEN
  SELF%F_ACPRS => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MACPRS, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_ACPRS => NULL ()
ENDIF
IF (YDTPARAR%MACPRG > 0) THEN
  SELF%F_ACPRG => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MACPRG, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_ACPRG => NULL ()
ENDIF
IF (YDTPARAR%MALBDIR > 0) THEN
  SELF%F_ALBDIR => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MALBDIR:YDTPARAR%MALBDIR+YDCPG_DIM%KSW-1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_ALBDIR => NULL ()
ENDIF
IF (YDTPARAR%MALBSCA > 0) THEN
  SELF%F_ALBSCA => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MALBSCA:YDTPARAR%MALBSCA+YDCPG_DIM%KSW-1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_ALBSCA => NULL ()
ENDIF
IF (YDTPARAR%MRAIN > 0) THEN
  SELF%F_RAIN => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MRAIN, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_RAIN => NULL ()
ENDIF
IF (YDTPARAR%MSNOW > 0) THEN
  SELF%F_SNOW => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MSNOW, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_SNOW => NULL ()
ENDIF
IF (YDTPARAR%MGZ0 > 0) THEN
  SELF%F_GZ0 => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MGZ0, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_GZ0 => NULL ()
ENDIF
IF (YDTPARAR%MGZ0H > 0) THEN
  SELF%F_GZ0H => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MGZ0H, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_GZ0H => NULL ()
ENDIF
IF (YDTPARAR%MVQS > 0) THEN
  SELF%F_VQS => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MVQS, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VQS => NULL ()
ENDIF
IF (YDTPARAR%MVTS > 0) THEN
  SELF%F_VTS => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MVTS, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VTS => NULL ()
ENDIF
IF (YDTPARAR%MVEMIS > 0) THEN
  SELF%F_VEMIS => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MVEMIS, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VEMIS => NULL ()
ENDIF
IF (YDTPARAR%MSWDIR > 0) THEN
  SELF%F_SWDIR => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MSWDIR:YDTPARAR%MSWDIR+YDCPG_DIM%KSW-1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_SWDIR => NULL ()
ENDIF
IF (YDTPARAR%MSWDIF > 0) THEN
  SELF%F_SWDIF => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MSWDIF:YDTPARAR%MSWDIF+YDCPG_DIM%KSW-1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_SWDIF => NULL ()
ENDIF
IF (YDTPARAR%MLSM > 0) THEN
  SELF%F_LSM => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MLSM, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_LSM => NULL ()
ENDIF
IF (YDTPARAR%MCD > 0) THEN
  SELF%F_CD => CREATE_FIELD_WRAP (SELF%ZDATA (:, YDTPARAR%MCD, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_CD => NULL ()
ENDIF

END SUBROUTINE CPG_GPAR_TYPE_INIT

SUBROUTINE CPG_GPAR_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_GPAR_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN

  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)

  IF (ASSOCIATED (SELF%F_INPRR)) THEN
    SELF%INPRR  => SELF%F_INPRR%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%INPRR  => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_INPRS)) THEN
    SELF%INPRS  => SELF%F_INPRS%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%INPRS  => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_INPRG)) THEN
    SELF%INPRG  => SELF%F_INPRG%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%INPRG  => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_ACPRR)) THEN
    SELF%ACPRR  => SELF%F_ACPRR%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%ACPRR  => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_ACPRS)) THEN
    SELF%ACPRS  => SELF%F_ACPRS%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%ACPRS  => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_ACPRG)) THEN
    SELF%ACPRG  => SELF%F_ACPRG%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%ACPRG  => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_ALBDIR)) THEN
    SELF%ALBDIR  => SELF%F_ALBDIR%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%ALBDIR  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_ALBSCA)) THEN
    SELF%ALBSCA  => SELF%F_ALBSCA%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%ALBSCA  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RAIN)) THEN
    SELF%RAIN  => SELF%F_RAIN%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RAIN  => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_SNOW)) THEN
    SELF%SNOW  => SELF%F_SNOW%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SNOW  => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_GZ0)) THEN
    SELF%GZ0  => SELF%F_GZ0%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%GZ0  => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_GZ0H)) THEN
    SELF%GZ0H  => SELF%F_GZ0H%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%GZ0H  => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_VQS)) THEN
    SELF%VQS  => SELF%F_VQS%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VQS  => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_VTS)) THEN
    SELF%VTS  => SELF%F_VTS%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VTS  => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_VEMIS)) THEN
    SELF%VEMIS  => SELF%F_VEMIS%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VEMIS  => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_SWDIR)) THEN
    SELF%SWDIR  => SELF%F_SWDIR%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SWDIR  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_SWDIF)) THEN
    SELF%SWDIF  => SELF%F_SWDIF%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SWDIF  => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_LSM)) THEN
    SELF%LSM  => SELF%F_LSM%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%LSM  => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_CD)) THEN
    SELF%CD  => SELF%F_CD%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%CD  => ZDUM1
  ENDIF

ELSE

  SELF%ZVIEW => ZDUM2

  SELF%INPRR  => ZDUM1
  SELF%INPRS  => ZDUM1
  SELF%INPRG  => ZDUM1
  SELF%ACPRR  => ZDUM1
  SELF%ACPRS  => ZDUM1
  SELF%ACPRG  => ZDUM1
  SELF%ALBDIR  => ZDUM2
  SELF%ALBSCA  => ZDUM2
  SELF%RAIN  => ZDUM1
  SELF%SNOW  => ZDUM1
  SELF%GZ0  => ZDUM1
  SELF%GZ0H  => ZDUM1
  SELF%VQS  => ZDUM1
  SELF%VTS  => ZDUM1
  SELF%VEMIS  => ZDUM1
  SELF%SWDIR  => ZDUM2
  SELF%SWDIF  => ZDUM2
  SELF%LSM  => ZDUM1
  SELF%CD  => ZDUM1

ENDIF

END SUBROUTINE CPG_GPAR_TYPE_UPDATE_VIEW

SUBROUTINE CPG_GPAR_TYPE_FINAL (SELF)
CLASS (CPG_GPAR_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)
SELF%F_DATA => NULL ()

IF (SELF%LOWNED) THEN
  DEALLOCATE (SELF%ZDATA)
ENDIF

SELF%ZDATA => NULL ()
SELF%ZVIEW => NULL ()

IF (ASSOCIATED (SELF%F_INPRR)) THEN
  CALL DELETE_TEMPORARY (SELF%F_INPRR) 
  SELF%F_INPRR => NULL ()
  SELF%INPRR => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_INPRS)) THEN
  CALL DELETE_TEMPORARY (SELF%F_INPRS) 
  SELF%F_INPRS => NULL ()
  SELF%INPRS => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_INPRG)) THEN
  CALL DELETE_TEMPORARY (SELF%F_INPRG) 
  SELF%F_INPRG => NULL ()
  SELF%INPRG => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_ACPRR)) THEN
  CALL DELETE_TEMPORARY (SELF%F_ACPRR) 
  SELF%F_ACPRR => NULL ()
  SELF%ACPRR => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_ACPRS)) THEN
  CALL DELETE_TEMPORARY (SELF%F_ACPRS) 
  SELF%F_ACPRS => NULL ()
  SELF%ACPRS => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_ACPRG)) THEN
  CALL DELETE_TEMPORARY (SELF%F_ACPRG) 
  SELF%F_ACPRG => NULL ()
  SELF%ACPRG => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_ALBDIR)) THEN
  CALL DELETE_TEMPORARY (SELF%F_ALBDIR) 
  SELF%F_ALBDIR => NULL ()
  SELF%ALBDIR => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_ALBSCA)) THEN
  CALL DELETE_TEMPORARY (SELF%F_ALBSCA) 
  SELF%F_ALBSCA => NULL ()
  SELF%ALBSCA => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_RAIN)) THEN
  CALL DELETE_TEMPORARY (SELF%F_RAIN) 
  SELF%F_RAIN => NULL ()
  SELF%RAIN => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_SNOW)) THEN
  CALL DELETE_TEMPORARY (SELF%F_SNOW) 
  SELF%F_SNOW => NULL ()
  SELF%SNOW => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_GZ0)) THEN
  CALL DELETE_TEMPORARY (SELF%F_GZ0) 
  SELF%F_GZ0 => NULL ()
  SELF%GZ0 => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_GZ0H)) THEN
  CALL DELETE_TEMPORARY (SELF%F_GZ0H) 
  SELF%F_GZ0H => NULL ()
  SELF%GZ0H => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_VQS)) THEN
  CALL DELETE_TEMPORARY (SELF%F_VQS) 
  SELF%F_VQS => NULL ()
  SELF%VQS => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_VTS)) THEN
  CALL DELETE_TEMPORARY (SELF%F_VTS) 
  SELF%F_VTS => NULL ()
  SELF%VTS => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_VEMIS)) THEN
  CALL DELETE_TEMPORARY (SELF%F_VEMIS) 
  SELF%F_VEMIS => NULL ()
  SELF%VEMIS => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_SWDIR)) THEN
  CALL DELETE_TEMPORARY (SELF%F_SWDIR) 
  SELF%F_SWDIR => NULL ()
  SELF%SWDIR => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_SWDIF)) THEN
  CALL DELETE_TEMPORARY (SELF%F_SWDIF) 
  SELF%F_SWDIF => NULL ()
  SELF%SWDIF => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_LSM)) THEN
  CALL DELETE_TEMPORARY (SELF%F_LSM) 
  SELF%F_LSM => NULL ()
  SELF%LSM => NULL ()
ENDIF
IF (ASSOCIATED (SELF%F_CD)) THEN
  CALL DELETE_TEMPORARY (SELF%F_CD) 
  SELF%F_CD => NULL ()
  SELF%CD => NULL ()
ENDIF

END SUBROUTINE CPG_GPAR_TYPE_FINAL




SUBROUTINE CPG_GP_T_TMP_TYPE_INIT (SELF &
                                & , KT  &
                                & , REGISTRY &
                                & , NLEV &
                                & , PERSISTENT &
                           &)

USE INTDYN_MOD, ONLY : YYTCTY0, YYTRCP0, YYTHW0, YYTXYB0, YYTXYB0_PHY, YYTXYBDER0
USE INTDYN_MOD, ONLY :          YYTRCP9, YYTHW9, YYTXYB9, YYTXYB9_PHY
USE INTDYN_MOD, ONLY : TRCP, TCTY, THWIND, TXYB, TXYBDER


USE YOMCT0    , ONLY : LNHDYN, LNHEE, LNHQE

CLASS (CPG_GP_T_TMP_TYPE)                    :: SELF
INTEGER(KIND=JPIM),           INTENT (IN)    :: KT
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),          INTENT (IN)    :: NLEV
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT


LOGICAL :: LLT0

TYPE (TRCP)   , POINTER :: YLTRCP     
TYPE (TCTY)   , POINTER :: YLTCTY     
TYPE (THWIND) , POINTER :: YLTHW     
TYPE (TXYB)   , POINTER :: YLTXYB     
TYPE (TXYB)   , POINTER :: YLTXYB_PHY
TYPE (TXYBDER), POINTER :: YLTXYBDER

TYPE (TCTY),   TARGET :: YLTCTY0 
TYPE (THWIND), TARGET :: YLTHW0, YLTHW9 
TYPE (TRCP),   TARGET :: YLTRCP0, YLTRCP9 
TYPE (TXYB),   TARGET :: YLTXYB0, YLTXYB0_PHY, YLTXYB9, YLTXYB9_PHY
TYPE (TXYBDER),TARGET :: YLTXYBDER0

YLTCTY0     = YYTCTY0 
YLTHW0      = YYTHW0 
YLTHW9      = YYTHW9 
YLTRCP0     = YYTRCP0 
YLTRCP9     = YYTRCP9 
YLTXYB0     = YYTXYB0 
YLTXYB0_PHY = YYTXYB0_PHY 
YLTXYB9     = YYTXYB9 
YLTXYB9_PHY = YYTXYB9_PHY
YLTXYBDER0  = YYTXYBDER0

LLT0 = KT == 0

YLTRCP     => NULL ()
YLTCTY     => NULL ()
YLTHW      => NULL ()
YLTXYB     => NULL ()
YLTXYB_PHY => NULL ()
YLTXYBDER  => NULL ()

IF (KT == 0) THEN
  YLTRCP     => YLTRCP0
  YLTCTY     => YLTCTY0
  YLTHW      => YLTHW0
  YLTXYB     => YLTXYB0
  YLTXYB_PHY => YLTXYB0_PHY
  YLTXYBDER  => YLTXYBDER0
ELSEIF (KT == 9) THEN
  YLTRCP     => YLTRCP9
  YLTCTY     => NULL ()
  YLTHW      => YLTHW9
  YLTXYB     => YLTXYB9
  YLTXYB_PHY => YLTXYB9_PHY
ENDIF


IF (LNHDYN) THEN
  SELF%F_GDW => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

SELF%F_GWHT => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)

IF (LNHDYN.AND.LLT0) THEN
  SELF%F_OROGLL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN.AND.LLT0) THEN
  SELF%F_OROGMM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN.AND.LLT0) THEN
  SELF%F_OROGLM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHEE) THEN
  SELF%F_DELNHPRE => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.(.NOT.LNHDYN)) THEN
  SELF%F_DPHYCTY => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

SELF%F_DVER => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_DVERL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_DVERM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHEE) THEN
  SELF%F_DVERW => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHQE) THEN
  SELF%F_EIQCHAF => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHQE) THEN
  SELF%F_EQCHAF => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHQE) THEN
  SELF%F_EQCHAH => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_GPHL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_GPHM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_GWHL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_GWHM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHQE) THEN
  SELF%F_KAPH => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_LNNHPREFL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_LNNHPREFM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHEE) THEN
  SELF%F_NHPPI => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_NHPREL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_NHPREM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHQE) THEN
  SELF%F_NHXD_T => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_NHXS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHQE) THEN
  SELF%F_NHXS_T => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF ((.NOT.LNHDYN)) THEN
  SELF%F_NHXT => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHEE) THEN
  SELF%F_PDEP => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_PDEPS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_PSGRTL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_PSGRTM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (.NOT.LLT0) THEN
  SELF%F_R0T => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF ((.NOT.LLT0).AND.LNHQE) THEN
  SELF%F_R9T => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF ((.NOT.LNHDYN).OR.LNHEE) THEN
  SELF%F_RDT => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_RDTL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_RDTM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHEE) THEN
  SELF%F_RNHPPI => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_RPREF => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHEE) THEN
  SELF%F_RRED => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_RT => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_RTR => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_SGRTL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_SGRTM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_SGRTSL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_SGRTSM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_SVDINCR13 => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_TNDGWF_LAP => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_TNDGWF_OTH => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_TNDGWH_LAP => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_TNDGWH_OTH => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_TNDUS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_TNDVS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

SELF%F_US => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_US_L => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_US_M => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

SELF%F_VS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_VS_L => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHDYN) THEN
  SELF%F_VS_M => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_Z3DIVG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_WH2F => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, NDIM=2, NDIM0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHEE) THEN
  SELF%F_ZERO => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0.AND.LNHQE) THEN
  SELF%F_ONE => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  CALL SELF%XYBDER%INIT (REGISTRY, NLEV, YLTXYBDER, PERSISTENT)
ENDIF

IF (.NOT.LLT0) THEN
  CALL SELF%UVH%INIT (REGISTRY, NLEV, YLTHW, PERSISTENT)
ENDIF


END SUBROUTINE CPG_GP_T_TMP_TYPE_INIT

SUBROUTINE CPG_GP_T_TMP_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_GP_T_TMP_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_GDW)) THEN
  SELF%GDW  => SELF%F_GDW%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GDW  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GWHT)) THEN
  SELF%GWHT  => SELF%F_GWHT%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWHT  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_OROGLL)) THEN
  SELF%OROGLL  => SELF%F_OROGLL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%OROGLL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_OROGMM)) THEN
  SELF%OROGMM  => SELF%F_OROGMM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%OROGMM  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_OROGLM)) THEN
  SELF%OROGLM  => SELF%F_OROGLM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%OROGLM  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_DELNHPRE)) THEN
  SELF%DELNHPRE  => SELF%F_DELNHPRE%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DELNHPRE  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DPHYCTY)) THEN
  SELF%DPHYCTY  => SELF%F_DPHYCTY%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DPHYCTY  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DVER)) THEN
  SELF%DVER  => SELF%F_DVER%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DVER  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DVERL)) THEN
  SELF%DVERL  => SELF%F_DVERL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DVERL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DVERM)) THEN
  SELF%DVERM  => SELF%F_DVERM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DVERM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DVERW)) THEN
  SELF%DVERW  => SELF%F_DVERW%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DVERW  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_EIQCHAF)) THEN
  SELF%EIQCHAF  => SELF%F_EIQCHAF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%EIQCHAF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_EQCHAF)) THEN
  SELF%EQCHAF  => SELF%F_EQCHAF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%EQCHAF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_EQCHAH)) THEN
  SELF%EQCHAH  => SELF%F_EQCHAH%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%EQCHAH  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GPHL)) THEN
  SELF%GPHL  => SELF%F_GPHL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GPHL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GPHM)) THEN
  SELF%GPHM  => SELF%F_GPHM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GPHM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GWHL)) THEN
  SELF%GWHL  => SELF%F_GWHL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWHL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GWHM)) THEN
  SELF%GWHM  => SELF%F_GWHM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWHM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_KAPH)) THEN
  SELF%KAPH  => SELF%F_KAPH%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%KAPH  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_LNNHPREFL)) THEN
  SELF%LNNHPREFL  => SELF%F_LNNHPREFL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%LNNHPREFL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_LNNHPREFM)) THEN
  SELF%LNNHPREFM  => SELF%F_LNNHPREFM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%LNNHPREFM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHPPI)) THEN
  SELF%NHPPI  => SELF%F_NHPPI%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHPPI  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHPREL)) THEN
  SELF%NHPREL  => SELF%F_NHPREL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHPREL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHPREM)) THEN
  SELF%NHPREM  => SELF%F_NHPREM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHPREM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHXD_T)) THEN
  SELF%NHXD_T  => SELF%F_NHXD_T%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHXD_T  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHXS)) THEN
  SELF%NHXS  => SELF%F_NHXS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHXS  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHXS_T)) THEN
  SELF%NHXS_T  => SELF%F_NHXS_T%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHXS_T  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHXT)) THEN
  SELF%NHXT  => SELF%F_NHXT%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHXT  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PDEP)) THEN
  SELF%PDEP  => SELF%F_PDEP%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PDEP  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PDEPS)) THEN
  SELF%PDEPS  => SELF%F_PDEPS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PDEPS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_PSGRTL)) THEN
  SELF%PSGRTL  => SELF%F_PSGRTL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PSGRTL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PSGRTM)) THEN
  SELF%PSGRTM  => SELF%F_PSGRTM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PSGRTM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_R0T)) THEN
  SELF%R0T  => SELF%F_R0T%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%R0T  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_R9T)) THEN
  SELF%R9T  => SELF%F_R9T%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%R9T  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RDT)) THEN
  SELF%RDT  => SELF%F_RDT%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RDT  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RDTL)) THEN
  SELF%RDTL  => SELF%F_RDTL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RDTL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RDTM)) THEN
  SELF%RDTM  => SELF%F_RDTM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RDTM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RNHPPI)) THEN
  SELF%RNHPPI  => SELF%F_RNHPPI%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RNHPPI  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RPREF)) THEN
  SELF%RPREF  => SELF%F_RPREF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RPREF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RRED)) THEN
  SELF%RRED  => SELF%F_RRED%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RRED  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RT)) THEN
  SELF%RT  => SELF%F_RT%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RT  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RTR)) THEN
  SELF%RTR  => SELF%F_RTR%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RTR  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_SGRTL)) THEN
  SELF%SGRTL  => SELF%F_SGRTL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%SGRTL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_SGRTM)) THEN
  SELF%SGRTM  => SELF%F_SGRTM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%SGRTM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_SGRTSL)) THEN
  SELF%SGRTSL  => SELF%F_SGRTSL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%SGRTSL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_SGRTSM)) THEN
  SELF%SGRTSM  => SELF%F_SGRTSM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%SGRTSM  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_SVDINCR13)) THEN
  SELF%SVDINCR13  => SELF%F_SVDINCR13%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%SVDINCR13  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_TNDGWF_LAP)) THEN
  SELF%TNDGWF_LAP  => SELF%F_TNDGWF_LAP%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%TNDGWF_LAP  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_TNDGWF_OTH)) THEN
  SELF%TNDGWF_OTH  => SELF%F_TNDGWF_OTH%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%TNDGWF_OTH  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_TNDGWH_LAP)) THEN
  SELF%TNDGWH_LAP  => SELF%F_TNDGWH_LAP%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%TNDGWH_LAP  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_TNDGWH_OTH)) THEN
  SELF%TNDGWH_OTH  => SELF%F_TNDGWH_OTH%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%TNDGWH_OTH  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_TNDUS)) THEN
  SELF%TNDUS  => SELF%F_TNDUS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%TNDUS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_TNDVS)) THEN
  SELF%TNDVS  => SELF%F_TNDVS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%TNDVS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_US)) THEN
  SELF%US  => SELF%F_US%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%US  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_US_L)) THEN
  SELF%US_L  => SELF%F_US_L%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%US_L  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_US_M)) THEN
  SELF%US_M  => SELF%F_US_M%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%US_M  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_VS)) THEN
  SELF%VS  => SELF%F_VS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%VS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_VS_L)) THEN
  SELF%VS_L  => SELF%F_VS_L%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%VS_L  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_VS_M)) THEN
  SELF%VS_M  => SELF%F_VS_M%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%VS_M  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_Z3DIVG)) THEN
  SELF%Z3DIVG  => SELF%F_Z3DIVG%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%Z3DIVG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_WH2F)) THEN
  SELF%WH2F  => SELF%F_WH2F%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%WH2F  => ZDUM3
ENDIF
IF (ASSOCIATED (SELF%F_ZERO)) THEN
  SELF%ZERO  => SELF%F_ZERO%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%ZERO  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_ONE)) THEN
  SELF%ONE  => SELF%F_ONE%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%ONE  => ZDUM2
ENDIF
CALL SELF%XYBDER%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%UVH%UPDATE_VIEW (BLOCK_INDEX)

END SUBROUTINE CPG_GP_T_TMP_TYPE_UPDATE_VIEW

SUBROUTINE CPG_GP_T_TMP_TYPE_FINAL (SELF)
CLASS (CPG_GP_T_TMP_TYPE)         :: SELF

IF (ASSOCIATED (SELF%F_GDW)) CALL DELETE_TEMPORARY (SELF%F_GDW) 
IF (ASSOCIATED (SELF%F_GWHT)) CALL DELETE_TEMPORARY (SELF%F_GWHT) 
IF (ASSOCIATED (SELF%F_OROGLL)) CALL DELETE_TEMPORARY (SELF%F_OROGLL) 
IF (ASSOCIATED (SELF%F_OROGMM)) CALL DELETE_TEMPORARY (SELF%F_OROGMM) 
IF (ASSOCIATED (SELF%F_OROGLM)) CALL DELETE_TEMPORARY (SELF%F_OROGLM) 
IF (ASSOCIATED (SELF%F_DELNHPRE)) CALL DELETE_TEMPORARY (SELF%F_DELNHPRE) 
IF (ASSOCIATED (SELF%F_DPHYCTY)) CALL DELETE_TEMPORARY (SELF%F_DPHYCTY) 
IF (ASSOCIATED (SELF%F_DVER)) CALL DELETE_TEMPORARY (SELF%F_DVER) 
IF (ASSOCIATED (SELF%F_DVERL)) CALL DELETE_TEMPORARY (SELF%F_DVERL) 
IF (ASSOCIATED (SELF%F_DVERM)) CALL DELETE_TEMPORARY (SELF%F_DVERM) 
IF (ASSOCIATED (SELF%F_DVERW)) CALL DELETE_TEMPORARY (SELF%F_DVERW) 
IF (ASSOCIATED (SELF%F_EIQCHAF)) CALL DELETE_TEMPORARY (SELF%F_EIQCHAF) 
IF (ASSOCIATED (SELF%F_EQCHAF)) CALL DELETE_TEMPORARY (SELF%F_EQCHAF) 
IF (ASSOCIATED (SELF%F_EQCHAH)) CALL DELETE_TEMPORARY (SELF%F_EQCHAH) 
IF (ASSOCIATED (SELF%F_GPHL)) CALL DELETE_TEMPORARY (SELF%F_GPHL) 
IF (ASSOCIATED (SELF%F_GPHM)) CALL DELETE_TEMPORARY (SELF%F_GPHM) 
IF (ASSOCIATED (SELF%F_GWHL)) CALL DELETE_TEMPORARY (SELF%F_GWHL) 
IF (ASSOCIATED (SELF%F_GWHM)) CALL DELETE_TEMPORARY (SELF%F_GWHM) 
IF (ASSOCIATED (SELF%F_KAPH)) CALL DELETE_TEMPORARY (SELF%F_KAPH) 
IF (ASSOCIATED (SELF%F_LNNHPREFL)) CALL DELETE_TEMPORARY (SELF%F_LNNHPREFL) 
IF (ASSOCIATED (SELF%F_LNNHPREFM)) CALL DELETE_TEMPORARY (SELF%F_LNNHPREFM) 
IF (ASSOCIATED (SELF%F_NHPPI)) CALL DELETE_TEMPORARY (SELF%F_NHPPI) 
IF (ASSOCIATED (SELF%F_NHPREL)) CALL DELETE_TEMPORARY (SELF%F_NHPREL) 
IF (ASSOCIATED (SELF%F_NHPREM)) CALL DELETE_TEMPORARY (SELF%F_NHPREM) 
IF (ASSOCIATED (SELF%F_NHXD_T)) CALL DELETE_TEMPORARY (SELF%F_NHXD_T) 
IF (ASSOCIATED (SELF%F_NHXS)) CALL DELETE_TEMPORARY (SELF%F_NHXS) 
IF (ASSOCIATED (SELF%F_NHXS_T)) CALL DELETE_TEMPORARY (SELF%F_NHXS_T) 
IF (ASSOCIATED (SELF%F_NHXT)) CALL DELETE_TEMPORARY (SELF%F_NHXT) 
IF (ASSOCIATED (SELF%F_PDEP)) CALL DELETE_TEMPORARY (SELF%F_PDEP) 
IF (ASSOCIATED (SELF%F_PDEPS)) CALL DELETE_TEMPORARY (SELF%F_PDEPS) 
IF (ASSOCIATED (SELF%F_PSGRTL)) CALL DELETE_TEMPORARY (SELF%F_PSGRTL) 
IF (ASSOCIATED (SELF%F_PSGRTM)) CALL DELETE_TEMPORARY (SELF%F_PSGRTM) 
IF (ASSOCIATED (SELF%F_R0T)) CALL DELETE_TEMPORARY (SELF%F_R0T) 
IF (ASSOCIATED (SELF%F_R9T)) CALL DELETE_TEMPORARY (SELF%F_R9T) 
IF (ASSOCIATED (SELF%F_RDT)) CALL DELETE_TEMPORARY (SELF%F_RDT) 
IF (ASSOCIATED (SELF%F_RDTL)) CALL DELETE_TEMPORARY (SELF%F_RDTL) 
IF (ASSOCIATED (SELF%F_RDTM)) CALL DELETE_TEMPORARY (SELF%F_RDTM) 
IF (ASSOCIATED (SELF%F_RNHPPI)) CALL DELETE_TEMPORARY (SELF%F_RNHPPI) 
IF (ASSOCIATED (SELF%F_RPREF)) CALL DELETE_TEMPORARY (SELF%F_RPREF) 
IF (ASSOCIATED (SELF%F_RRED)) CALL DELETE_TEMPORARY (SELF%F_RRED) 
IF (ASSOCIATED (SELF%F_RT)) CALL DELETE_TEMPORARY (SELF%F_RT) 
IF (ASSOCIATED (SELF%F_RTR)) CALL DELETE_TEMPORARY (SELF%F_RTR) 
IF (ASSOCIATED (SELF%F_SGRTL)) CALL DELETE_TEMPORARY (SELF%F_SGRTL) 
IF (ASSOCIATED (SELF%F_SGRTM)) CALL DELETE_TEMPORARY (SELF%F_SGRTM) 
IF (ASSOCIATED (SELF%F_SGRTSL)) CALL DELETE_TEMPORARY (SELF%F_SGRTSL) 
IF (ASSOCIATED (SELF%F_SGRTSM)) CALL DELETE_TEMPORARY (SELF%F_SGRTSM) 
IF (ASSOCIATED (SELF%F_SVDINCR13)) CALL DELETE_TEMPORARY (SELF%F_SVDINCR13) 
IF (ASSOCIATED (SELF%F_TNDGWF_LAP)) CALL DELETE_TEMPORARY (SELF%F_TNDGWF_LAP) 
IF (ASSOCIATED (SELF%F_TNDGWF_OTH)) CALL DELETE_TEMPORARY (SELF%F_TNDGWF_OTH) 
IF (ASSOCIATED (SELF%F_TNDGWH_LAP)) CALL DELETE_TEMPORARY (SELF%F_TNDGWH_LAP) 
IF (ASSOCIATED (SELF%F_TNDGWH_OTH)) CALL DELETE_TEMPORARY (SELF%F_TNDGWH_OTH) 
IF (ASSOCIATED (SELF%F_TNDUS)) CALL DELETE_TEMPORARY (SELF%F_TNDUS) 
IF (ASSOCIATED (SELF%F_TNDVS)) CALL DELETE_TEMPORARY (SELF%F_TNDVS) 
IF (ASSOCIATED (SELF%F_US)) CALL DELETE_TEMPORARY (SELF%F_US) 
IF (ASSOCIATED (SELF%F_US_L)) CALL DELETE_TEMPORARY (SELF%F_US_L) 
IF (ASSOCIATED (SELF%F_US_M)) CALL DELETE_TEMPORARY (SELF%F_US_M) 
IF (ASSOCIATED (SELF%F_VS)) CALL DELETE_TEMPORARY (SELF%F_VS) 
IF (ASSOCIATED (SELF%F_VS_L)) CALL DELETE_TEMPORARY (SELF%F_VS_L) 
IF (ASSOCIATED (SELF%F_VS_M)) CALL DELETE_TEMPORARY (SELF%F_VS_M) 
IF (ASSOCIATED (SELF%F_Z3DIVG)) CALL DELETE_TEMPORARY (SELF%F_Z3DIVG) 
IF (ASSOCIATED (SELF%F_WH2F)) CALL DELETE_TEMPORARY (SELF%F_WH2F) 
IF (ASSOCIATED (SELF%F_ZERO)) CALL DELETE_TEMPORARY (SELF%F_ZERO) 
IF (ASSOCIATED (SELF%F_ONE)) CALL DELETE_TEMPORARY (SELF%F_ONE) 
CALL SELF%XYBDER%FINAL ()
CALL SELF%UVH%FINAL ()

END SUBROUTINE CPG_GP_T_TMP_TYPE_FINAL




SUBROUTINE CPG_GP_TMP_TYPE_INIT (SELF &
                                & , REGISTRY &
                                & , NLEV &
                                & , PERSISTENT &
                           &)




CLASS (CPG_GP_TMP_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),          INTENT (IN)    :: NLEV
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT







CALL SELF%T0%INIT (0, REGISTRY, NLEV, PERSISTENT)

CALL SELF%T9%INIT (9, REGISTRY, NLEV, PERSISTENT)


END SUBROUTINE CPG_GP_TMP_TYPE_INIT

SUBROUTINE CPG_GP_TMP_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_GP_TMP_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

CALL SELF%T0%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%T9%UPDATE_VIEW (BLOCK_INDEX)

END SUBROUTINE CPG_GP_TMP_TYPE_UPDATE_VIEW

SUBROUTINE CPG_GP_TMP_TYPE_FINAL (SELF)
CLASS (CPG_GP_TMP_TYPE)         :: SELF

CALL SELF%T0%FINAL ()
CALL SELF%T9%FINAL ()

END SUBROUTINE CPG_GP_TMP_TYPE_FINAL




SUBROUTINE CPG_DYN_TYPE_INIT (SELF &
                                & , KT  &
                                & , REGISTRY &
                                & , NLEV &
                                & , PERSISTENT &
                           &, PHIF &
                           &, PREF &
                           &, PWRL &
                           &, PRCP &
                           &, PCTY &
                           &)

USE INTDYN_MOD, ONLY : YYTCTY0, YYTRCP0, YYTHW0, YYTXYB0, YYTXYB0_PHY, YYTXYBDER0
USE INTDYN_MOD, ONLY :          YYTRCP9, YYTHW9, YYTXYB9, YYTXYB9_PHY
USE INTDYN_MOD, ONLY : TRCP, TCTY, THWIND, TXYB, TXYBDER


USE YOMCT0    , ONLY : LNHDYN, LNHEE, LNHQE

CLASS (CPG_DYN_TYPE)                    :: SELF
INTEGER(KIND=JPIM),           INTENT (IN)    :: KT
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),          INTENT (IN)    :: NLEV
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT

REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PHIF(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PREF(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PWRL(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PRCP(:, :, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PCTY(:, :, :, :)

LOGICAL :: LLT0

TYPE (TRCP)   , POINTER :: YLTRCP     
TYPE (TCTY)   , POINTER :: YLTCTY     
TYPE (THWIND) , POINTER :: YLTHW     
TYPE (TXYB)   , POINTER :: YLTXYB     
TYPE (TXYB)   , POINTER :: YLTXYB_PHY
TYPE (TXYBDER), POINTER :: YLTXYBDER

TYPE (TCTY),   TARGET :: YLTCTY0 
TYPE (THWIND), TARGET :: YLTHW0, YLTHW9 
TYPE (TRCP),   TARGET :: YLTRCP0, YLTRCP9 
TYPE (TXYB),   TARGET :: YLTXYB0, YLTXYB0_PHY, YLTXYB9, YLTXYB9_PHY
TYPE (TXYBDER),TARGET :: YLTXYBDER0

YLTCTY0     = YYTCTY0 
YLTHW0      = YYTHW0 
YLTHW9      = YYTHW9 
YLTRCP0     = YYTRCP0 
YLTRCP9     = YYTRCP9 
YLTXYB0     = YYTXYB0 
YLTXYB0_PHY = YYTXYB0_PHY 
YLTXYB9     = YYTXYB9 
YLTXYB9_PHY = YYTXYB9_PHY
YLTXYBDER0  = YYTXYBDER0

LLT0 = KT == 0

YLTRCP     => NULL ()
YLTCTY     => NULL ()
YLTHW      => NULL ()
YLTXYB     => NULL ()
YLTXYB_PHY => NULL ()
YLTXYBDER  => NULL ()

IF (KT == 0) THEN
  YLTRCP     => YLTRCP0
  YLTCTY     => YLTCTY0
  YLTHW      => YLTHW0
  YLTXYB     => YLTXYB0
  YLTXYB_PHY => YLTXYB0_PHY
  YLTXYBDER  => YLTXYBDER0
ELSEIF (KT == 9) THEN
  YLTRCP     => YLTRCP9
  YLTCTY     => NULL ()
  YLTHW      => YLTHW9
  YLTXYB     => YLTXYB9
  YLTXYB_PHY => YLTXYB9_PHY
ENDIF


IF (LLT0) THEN
  SELF%F_OROGL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_OROGM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

SELF%F_PHI => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_PRE => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)

IF (PRESENT (PHIF)) THEN
    SELF%F_PHIF => CREATE_FIELD_WRAP (PHIF, LBOUNDS=[1, 1, 1])
ELSE
  SELF%F_PHIF => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (PRESENT (PREF)) THEN
    SELF%F_PREF => CREATE_FIELD_WRAP (PREF, LBOUNDS=[1, 1, 1])
ELSE
  SELF%F_PREF => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (PRESENT (PWRL)) THEN
    SELF%F_WRL => CREATE_FIELD_WRAP (PWRL, LBOUNDS=[1, 1, 1])
ENDIF

SELF%F_PREL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_PREM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_NHY => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_GWFT => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)

IF (LLT0) THEN
  SELF%F_KENE => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

SELF%F_NHX => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)

IF (LLT0) THEN
  SELF%F_PHIFL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_PHIFM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_RTL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLT0) THEN
  SELF%F_RTM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

CALL SELF%RCP%INIT (REGISTRY, NLEV, YLTRCP, PERSISTENT, PRCP)

IF (LLT0) THEN
  CALL SELF%CTY%INIT (REGISTRY, NLEV, YLTCTY, PERSISTENT, PCTY)
ENDIF

IF (LLT0) THEN
  CALL SELF%UVH%INIT (REGISTRY, NLEV, YLTHW, PERSISTENT)
ENDIF

CALL SELF%XYB%INIT (REGISTRY, NLEV, YLTXYB, PERSISTENT)

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_DBBC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_GWS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_GWFL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_GWFM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN) THEN
  SELF%F_GWT => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN) THEN
  SELF%F_NHPREF => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN) THEN
  SELF%F_NHPREH => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_QCHAL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_QCHAM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LNHDYN .AND. LLT0) THEN
  SELF%F_RDPHI => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF


END SUBROUTINE CPG_DYN_TYPE_INIT

SUBROUTINE CPG_DYN_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_DYN_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_OROGL)) THEN
  SELF%OROGL  => SELF%F_OROGL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%OROGL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_OROGM)) THEN
  SELF%OROGM  => SELF%F_OROGM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%OROGM  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_PHI)) THEN
  SELF%PHI  => SELF%F_PHI%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PHI  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PRE)) THEN
  SELF%PRE  => SELF%F_PRE%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PRE  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PHIF)) THEN
  SELF%PHIF  => SELF%F_PHIF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PHIF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PREF)) THEN
  SELF%PREF  => SELF%F_PREF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PREF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_WRL)) THEN
  SELF%WRL  => SELF%F_WRL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%WRL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PREL)) THEN
  SELF%PREL  => SELF%F_PREL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PREL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_PREM)) THEN
  SELF%PREM  => SELF%F_PREM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PREM  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_NHY)) THEN
  SELF%NHY  => SELF%F_NHY%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHY  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GWFT)) THEN
  SELF%GWFT  => SELF%F_GWFT%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWFT  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_KENE)) THEN
  SELF%KENE  => SELF%F_KENE%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%KENE  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHX)) THEN
  SELF%NHX  => SELF%F_NHX%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHX  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PHIFL)) THEN
  SELF%PHIFL  => SELF%F_PHIFL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PHIFL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PHIFM)) THEN
  SELF%PHIFM  => SELF%F_PHIFM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PHIFM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RTL)) THEN
  SELF%RTL  => SELF%F_RTL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RTL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RTM)) THEN
  SELF%RTM  => SELF%F_RTM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RTM  => ZDUM2
ENDIF
CALL SELF%RCP%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%CTY%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%UVH%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%XYB%UPDATE_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_DBBC)) THEN
  SELF%DBBC  => SELF%F_DBBC%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DBBC  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_GWS)) THEN
  SELF%GWS  => SELF%F_GWS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_GWFL)) THEN
  SELF%GWFL  => SELF%F_GWFL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWFL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GWFM)) THEN
  SELF%GWFM  => SELF%F_GWFM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWFM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GWT)) THEN
  SELF%GWT  => SELF%F_GWT%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%GWT  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHPREF)) THEN
  SELF%NHPREF  => SELF%F_NHPREF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHPREF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_NHPREH)) THEN
  SELF%NHPREH  => SELF%F_NHPREH%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NHPREH  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_QCHAL)) THEN
  SELF%QCHAL  => SELF%F_QCHAL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QCHAL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_QCHAM)) THEN
  SELF%QCHAM  => SELF%F_QCHAM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QCHAM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RDPHI)) THEN
  SELF%RDPHI  => SELF%F_RDPHI%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RDPHI  => ZDUM2
ENDIF

END SUBROUTINE CPG_DYN_TYPE_UPDATE_VIEW

SUBROUTINE CPG_DYN_TYPE_FINAL (SELF)
CLASS (CPG_DYN_TYPE)         :: SELF

IF (ASSOCIATED (SELF%F_OROGL)) CALL DELETE_TEMPORARY (SELF%F_OROGL) 
IF (ASSOCIATED (SELF%F_OROGM)) CALL DELETE_TEMPORARY (SELF%F_OROGM) 
IF (ASSOCIATED (SELF%F_PHI)) CALL DELETE_TEMPORARY (SELF%F_PHI) 
IF (ASSOCIATED (SELF%F_PRE)) CALL DELETE_TEMPORARY (SELF%F_PRE) 
IF (ASSOCIATED (SELF%F_PHIF)) CALL DELETE_TEMPORARY (SELF%F_PHIF) 
IF (ASSOCIATED (SELF%F_PREF)) CALL DELETE_TEMPORARY (SELF%F_PREF) 
IF (ASSOCIATED (SELF%F_WRL)) CALL DELETE_TEMPORARY (SELF%F_WRL) 
IF (ASSOCIATED (SELF%F_PREL)) CALL DELETE_TEMPORARY (SELF%F_PREL) 
IF (ASSOCIATED (SELF%F_PREM)) CALL DELETE_TEMPORARY (SELF%F_PREM) 
IF (ASSOCIATED (SELF%F_NHY)) CALL DELETE_TEMPORARY (SELF%F_NHY) 
IF (ASSOCIATED (SELF%F_GWFT)) CALL DELETE_TEMPORARY (SELF%F_GWFT) 
IF (ASSOCIATED (SELF%F_KENE)) CALL DELETE_TEMPORARY (SELF%F_KENE) 
IF (ASSOCIATED (SELF%F_NHX)) CALL DELETE_TEMPORARY (SELF%F_NHX) 
IF (ASSOCIATED (SELF%F_PHIFL)) CALL DELETE_TEMPORARY (SELF%F_PHIFL) 
IF (ASSOCIATED (SELF%F_PHIFM)) CALL DELETE_TEMPORARY (SELF%F_PHIFM) 
IF (ASSOCIATED (SELF%F_RTL)) CALL DELETE_TEMPORARY (SELF%F_RTL) 
IF (ASSOCIATED (SELF%F_RTM)) CALL DELETE_TEMPORARY (SELF%F_RTM) 
CALL SELF%RCP%FINAL ()
CALL SELF%CTY%FINAL ()
CALL SELF%UVH%FINAL ()
CALL SELF%XYB%FINAL ()
IF (ASSOCIATED (SELF%F_DBBC)) CALL DELETE_TEMPORARY (SELF%F_DBBC) 
IF (ASSOCIATED (SELF%F_GWS)) CALL DELETE_TEMPORARY (SELF%F_GWS) 
IF (ASSOCIATED (SELF%F_GWFL)) CALL DELETE_TEMPORARY (SELF%F_GWFL) 
IF (ASSOCIATED (SELF%F_GWFM)) CALL DELETE_TEMPORARY (SELF%F_GWFM) 
IF (ASSOCIATED (SELF%F_GWT)) CALL DELETE_TEMPORARY (SELF%F_GWT) 
IF (ASSOCIATED (SELF%F_NHPREF)) CALL DELETE_TEMPORARY (SELF%F_NHPREF) 
IF (ASSOCIATED (SELF%F_NHPREH)) CALL DELETE_TEMPORARY (SELF%F_NHPREH) 
IF (ASSOCIATED (SELF%F_QCHAL)) CALL DELETE_TEMPORARY (SELF%F_QCHAL) 
IF (ASSOCIATED (SELF%F_QCHAM)) CALL DELETE_TEMPORARY (SELF%F_QCHAM) 
IF (ASSOCIATED (SELF%F_RDPHI)) CALL DELETE_TEMPORARY (SELF%F_RDPHI) 

END SUBROUTINE CPG_DYN_TYPE_FINAL




SUBROUTINE CPG_PHY_TYPE_INIT (SELF &
                                & , KT  &
                                & , REGISTRY &
                                & , NLEV &
                                & , PERSISTENT &
                                & , LDMF_PHYS &
                           &)

USE INTDYN_MOD, ONLY : YYTCTY0, YYTRCP0, YYTHW0, YYTXYB0, YYTXYB0_PHY, YYTXYBDER0
USE INTDYN_MOD, ONLY :          YYTRCP9, YYTHW9, YYTXYB9, YYTXYB9_PHY
USE INTDYN_MOD, ONLY : TRCP, TCTY, THWIND, TXYB, TXYBDER



CLASS (CPG_PHY_TYPE)                    :: SELF
INTEGER(KIND=JPIM),           INTENT (IN)    :: KT
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),          INTENT (IN)    :: NLEV
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS


LOGICAL :: LLT0
LOGICAL :: LLMF_PHYS

TYPE (TRCP)   , POINTER :: YLTRCP     
TYPE (TCTY)   , POINTER :: YLTCTY     
TYPE (THWIND) , POINTER :: YLTHW     
TYPE (TXYB)   , POINTER :: YLTXYB     
TYPE (TXYB)   , POINTER :: YLTXYB_PHY
TYPE (TXYBDER), POINTER :: YLTXYBDER

TYPE (TCTY),   TARGET :: YLTCTY0 
TYPE (THWIND), TARGET :: YLTHW0, YLTHW9 
TYPE (TRCP),   TARGET :: YLTRCP0, YLTRCP9 
TYPE (TXYB),   TARGET :: YLTXYB0, YLTXYB0_PHY, YLTXYB9, YLTXYB9_PHY
TYPE (TXYBDER),TARGET :: YLTXYBDER0

YLTCTY0     = YYTCTY0 
YLTHW0      = YYTHW0 
YLTHW9      = YYTHW9 
YLTRCP0     = YYTRCP0 
YLTRCP9     = YYTRCP9 
YLTXYB0     = YYTXYB0 
YLTXYB0_PHY = YYTXYB0_PHY 
YLTXYB9     = YYTXYB9 
YLTXYB9_PHY = YYTXYB9_PHY
YLTXYBDER0  = YYTXYBDER0

LLT0 = KT == 0

YLTRCP     => NULL ()
YLTCTY     => NULL ()
YLTHW      => NULL ()
YLTXYB     => NULL ()
YLTXYB_PHY => NULL ()
YLTXYBDER  => NULL ()

IF (KT == 0) THEN
  YLTRCP     => YLTRCP0
  YLTCTY     => YLTCTY0
  YLTHW      => YLTHW0
  YLTXYB     => YLTXYB0
  YLTXYB_PHY => YLTXYB0_PHY
  YLTXYBDER  => YLTXYBDER0
ELSEIF (KT == 9) THEN
  YLTRCP     => YLTRCP9
  YLTCTY     => NULL ()
  YLTHW      => YLTHW9
  YLTXYB     => YLTXYB9
  YLTXYB_PHY => YLTXYB9_PHY
ENDIF

LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_PRE => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_PREF => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_PREHYD => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV+1, NLEV0=0, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_PREHYDF => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_WL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_WM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  SELF%F_W => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, NLEV0=1, PERSISTENT=PERSISTENT)
ENDIF

IF (LLMF_PHYS) THEN
  CALL SELF%XYB%INIT (REGISTRY, NLEV, YLTXYB_PHY, PERSISTENT)
ENDIF


END SUBROUTINE CPG_PHY_TYPE_INIT

SUBROUTINE CPG_PHY_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_PHY_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_PRE)) THEN
  SELF%PRE  => SELF%F_PRE%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PRE  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PREF)) THEN
  SELF%PREF  => SELF%F_PREF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PREF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PREHYD)) THEN
  SELF%PREHYD  => SELF%F_PREHYD%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PREHYD  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_PREHYDF)) THEN
  SELF%PREHYDF  => SELF%F_PREHYDF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%PREHYDF  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_WL)) THEN
  SELF%WL  => SELF%F_WL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%WL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_WM)) THEN
  SELF%WM  => SELF%F_WM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%WM  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_W)) THEN
  SELF%W  => SELF%F_W%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%W  => ZDUM2
ENDIF
CALL SELF%XYB%UPDATE_VIEW (BLOCK_INDEX)

END SUBROUTINE CPG_PHY_TYPE_UPDATE_VIEW

SUBROUTINE CPG_PHY_TYPE_FINAL (SELF)
CLASS (CPG_PHY_TYPE)         :: SELF

IF (ASSOCIATED (SELF%F_PRE)) CALL DELETE_TEMPORARY (SELF%F_PRE) 
IF (ASSOCIATED (SELF%F_PREF)) CALL DELETE_TEMPORARY (SELF%F_PREF) 
IF (ASSOCIATED (SELF%F_PREHYD)) CALL DELETE_TEMPORARY (SELF%F_PREHYD) 
IF (ASSOCIATED (SELF%F_PREHYDF)) CALL DELETE_TEMPORARY (SELF%F_PREHYDF) 
IF (ASSOCIATED (SELF%F_WL)) CALL DELETE_TEMPORARY (SELF%F_WL) 
IF (ASSOCIATED (SELF%F_WM)) CALL DELETE_TEMPORARY (SELF%F_WM) 
IF (ASSOCIATED (SELF%F_W)) CALL DELETE_TEMPORARY (SELF%F_W) 
CALL SELF%XYB%FINAL ()

END SUBROUTINE CPG_PHY_TYPE_FINAL




SUBROUTINE CPG_MISC_TYPE_INIT (SELF &
                                & , REGISTRY &
                                & , YDCPG_DIM &
                                & , PERSISTENT &
                           &)


USE CPG_DIM_TYPE_MOD, ONLY : CPG_DIM_TYPE


CLASS (CPG_MISC_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_DIM_TYPE),          INTENT (IN)    :: YDCPG_DIM
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT







SELF%F_NEB => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_DIM%KFLEVG, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_QLI => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_DIM%KFLEVG, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_QICE => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_DIM%KFLEVG, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_QRAIN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_DIM%KFLEVG, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_QSNOW => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_DIM%KFLEVG, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_RH => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_DIM%KFLEVG, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_QS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_QSOL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_DHSF => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_CLCT => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_LSM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_TSOL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FTCNS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_DIM%KFLEVG+1, NLEV0=0, NDIM=6, NDIM0=1, PERSISTENT=PERSISTENT)

SELF%F_KOZO => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_DIM%KFLEVG+1, NLEV0=0, NDIM=YDCPG_DIM%KVCLIS, NDIM0=1,&
    & PERSISTENT=PERSISTENT)


END SUBROUTINE CPG_MISC_TYPE_INIT

SUBROUTINE CPG_MISC_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_MISC_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_NEB)) THEN
  SELF%NEB  => SELF%F_NEB%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%NEB  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_QLI)) THEN
  SELF%QLI  => SELF%F_QLI%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QLI  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_QICE)) THEN
  SELF%QICE  => SELF%F_QICE%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QICE  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_QRAIN)) THEN
  SELF%QRAIN  => SELF%F_QRAIN%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QRAIN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_QSNOW)) THEN
  SELF%QSNOW  => SELF%F_QSNOW%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QSNOW  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RH)) THEN
  SELF%RH  => SELF%F_RH%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%RH  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_QS)) THEN
  SELF%QS  => SELF%F_QS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_QSOL)) THEN
  SELF%QSOL  => SELF%F_QSOL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%QSOL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_DHSF)) THEN
  SELF%DHSF  => SELF%F_DHSF%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%DHSF  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_CLCT)) THEN
  SELF%CLCT  => SELF%F_CLCT%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%CLCT  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_LSM)) THEN
  SELF%LSM  => SELF%F_LSM%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%LSM  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_TSOL)) THEN
  SELF%TSOL  => SELF%F_TSOL%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%TSOL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FTCNS)) THEN
  SELF%FTCNS  => SELF%F_FTCNS%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%FTCNS  => ZDUM3
ENDIF
IF (ASSOCIATED (SELF%F_KOZO)) THEN
  SELF%KOZO  => SELF%F_KOZO%GET_VIEW (BLOCK_INDEX)
ELSE
  SELF%KOZO  => ZDUM3
ENDIF

END SUBROUTINE CPG_MISC_TYPE_UPDATE_VIEW

SUBROUTINE CPG_MISC_TYPE_FINAL (SELF)
CLASS (CPG_MISC_TYPE)         :: SELF

IF (ASSOCIATED (SELF%F_NEB)) CALL DELETE_TEMPORARY (SELF%F_NEB) 
IF (ASSOCIATED (SELF%F_QLI)) CALL DELETE_TEMPORARY (SELF%F_QLI) 
IF (ASSOCIATED (SELF%F_QICE)) CALL DELETE_TEMPORARY (SELF%F_QICE) 
IF (ASSOCIATED (SELF%F_QRAIN)) CALL DELETE_TEMPORARY (SELF%F_QRAIN) 
IF (ASSOCIATED (SELF%F_QSNOW)) CALL DELETE_TEMPORARY (SELF%F_QSNOW) 
IF (ASSOCIATED (SELF%F_RH)) CALL DELETE_TEMPORARY (SELF%F_RH) 
IF (ASSOCIATED (SELF%F_QS)) CALL DELETE_TEMPORARY (SELF%F_QS) 
IF (ASSOCIATED (SELF%F_QSOL)) CALL DELETE_TEMPORARY (SELF%F_QSOL) 
IF (ASSOCIATED (SELF%F_DHSF)) CALL DELETE_TEMPORARY (SELF%F_DHSF) 
IF (ASSOCIATED (SELF%F_CLCT)) CALL DELETE_TEMPORARY (SELF%F_CLCT) 
IF (ASSOCIATED (SELF%F_LSM)) CALL DELETE_TEMPORARY (SELF%F_LSM) 
IF (ASSOCIATED (SELF%F_TSOL)) CALL DELETE_TEMPORARY (SELF%F_TSOL) 
IF (ASSOCIATED (SELF%F_FTCNS)) CALL DELETE_TEMPORARY (SELF%F_FTCNS) 
IF (ASSOCIATED (SELF%F_KOZO)) CALL DELETE_TEMPORARY (SELF%F_KOZO) 

END SUBROUTINE CPG_MISC_TYPE_FINAL

SUBROUTINE CPG_TMP_TYPE_INIT (SELF, REGISTRY, NLEV, PERSISTENT)

CLASS (CPG_TMP_TYPE) :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),          INTENT (IN)    :: NLEV
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT

CALL SELF%CPG_GP%INIT (REGISTRY, NLEV, PERSISTENT)

END SUBROUTINE

SUBROUTINE CPG_TMP_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_TMP_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

CALL SELF%CPG_GP%UPDATE_VIEW (BLOCK_INDEX)

END SUBROUTINE 

SUBROUTINE CPG_TMP_TYPE_FINAL (SELF)

CLASS (CPG_TMP_TYPE)         :: SELF

CALL SELF%CPG_GP%FINAL

END SUBROUTINE

SUBROUTINE CPG_DDH_TYPE_INIT (SELF, REGISTRY, NLEV, PERSISTENT, YDMODEL, YDDDH)

USE TYPE_MODEL, ONLY : MODEL
USE DDH_MIX, ONLY : TYP_DDH

CLASS (CPG_DDH_TYPE)                             :: SELF
TYPE (FIELD_REGISTRY),            INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),              INTENT (IN)    :: NLEV
LOGICAL, OPTIONAL,                INTENT (IN)    :: PERSISTENT
TYPE (MODEL),                     INTENT (IN)    :: YDMODEL
TYPE (TYP_DDH),                   INTENT (IN)    :: YDDDH


ALLOCATE (SELF%F_AUX3D)
SELF%F_AUX3D = FIELD_4D (SHAPE=[NLEV+1, YDMODEL%YRML_DIAG%YRMDDH%NDHIDH, YDDDH%NFIELDS3D_AUTO], &
                       & NBLOCKS=REGISTRY%GEOM%YRDIM%NGPBLKS, PERSISTENT=PERSISTENT)
ALLOCATE (SELF%F_AUX2D)
SELF%F_AUX2D = FIELD_3D (SHAPE=[YDMODEL%YRML_DIAG%YRMDDH%NDHIDH, YDDDH%NFIELDS2D_AUTO], &
                       & NBLOCKS=REGISTRY%GEOM%YRDIM%NGPBLKS, PERSISTENT=PERSISTENT)

SELF%F_DHCV  => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=NLEV, PERSISTENT=PERSISTENT, NDIM=YDMODEL%YRML_DIAG%YRMDDH%NDHCVSUN)
SELF%F_AUXSM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=1, PERSISTENT=PERSISTENT, NDIM=NLEV, NDIM2=13)
SELF%F_DDHI  => CREATE_TEMPORARY_INT (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

END SUBROUTINE CPG_DDH_TYPE_INIT

SUBROUTINE CPG_DDH_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_DDH_TYPE)              :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_AUX3D)) SELF%AUX3D (0:, 1:, 1:)  => SELF%F_AUX3D%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_AUX2D)) SELF%AUX2D  => SELF%F_AUX2D%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_DHCV )) SELF%DHCV   => SELF%F_DHCV %GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_AUXSM)) SELF%AUXSM  => SELF%F_AUXSM%GET_VIEW (BLOCK_INDEX)
IF (ASSOCIATED (SELF%F_DDHI )) SELF%DDHI   => SELF%F_DDHI %GET_VIEW (BLOCK_INDEX)

END SUBROUTINE CPG_DDH_TYPE_UPDATE_VIEW

SUBROUTINE CPG_DDH_TYPE_FINAL (SELF)

CLASS (CPG_DDH_TYPE)              :: SELF

CALL DELETE_TEMPORARY (SELF%F_AUX3D)
CALL DELETE_TEMPORARY (SELF%F_AUX2D)
CALL DELETE_TEMPORARY (SELF%F_DHCV)
CALL DELETE_TEMPORARY (SELF%F_AUXSM)
CALL DELETE_TEMPORARY (SELF%F_DDHI)

SELF%AUX3D => NULL ()
SELF%AUX2D => NULL ()
SELF%DHCV  => NULL ()
SELF%AUXSM => NULL ()
SELF%DDHI  => NULL ()

END SUBROUTINE CPG_DDH_TYPE_FINAL


SUBROUTINE CPG_SL1_TYPE_INIT (SELF, REGISTRY, NLEV, YDTPTRSLB1 &
                                & , YDMODEL &
                                & , YGFL &
                                & , PERSISTENT, PB1)

USE PTRSLB1, ONLY : TPTRSLB1
USE OML_MOD, ONLY: OML_MAX_THREADS

USE YOM_YGFL, ONLY: TYPE_GFLD
USE TYPE_MODEL, ONLY : MODEL

CLASS (CPG_SL1_TYPE)                         :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TPTRSLB1),              INTENT (IN)    :: YDTPTRSLB1
TYPE (TYPE_GFLD),                   INTENT (IN)    :: YGFL
TYPE (MODEL),                       INTENT (IN)    :: YDMODEL
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PB1 (:, :, :)

INTEGER (KIND=JPIM) :: JFLD

LOGICAL :: LLPERSISTENT

LLPERSISTENT = .FALSE.
IF (PRESENT (PERSISTENT)) LLPERSISTENT = PERSISTENT

SELF%NLEV = NLEV

IF (PRESENT (PB1)) THEN
  SELF%ZDATA => PB1
  SELF%LOWNED = .FALSE.
  LLPERSISTENT = .TRUE.
ELSEIF (LLPERSISTENT) THEN
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, YDTPTRSLB1%NFLDSLB1, REGISTRY%GEOM%YRDIM%NGPBLKS))
  SELF%LOWNED = .TRUE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, YDTPTRSLB1%NFLDSLB1, OML_MAX_THREADS ()))
  SELF%LOWNED = .TRUE.
ENDIF

SELF%F_DATA => CREATE_FIELD_WRAP (SELF%ZDATA, PERSISTENT=LLPERSISTENT)

IF (YDTPTRSLB1%MSLB1U9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U9
  SELF%F_U9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_U9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1V9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V9
  SELF%F_V9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_V9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1T9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T9
  SELF%F_T9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_T9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1PD9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD9
  SELF%F_PD9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_PD9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VD9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD9
  SELF%F_VD9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VD9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1NHX9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1NHX9
  SELF%F_NHX9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_NHX9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UR0
  SELF%F_UR0 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_UR0 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VR0
  SELF%F_VR0 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VR0 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1ZR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1ZR0
  SELF%F_ZR0 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_ZR0 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1WR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1WR0
  SELF%F_WR0 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_WR0 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UR00
  SELF%F_UR00 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_UR00 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VR00
  SELF%F_VR00 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VR00 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1ZR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1ZR00
  SELF%F_ZR00 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_ZR00 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1WR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1WR00
  SELF%F_WR00 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_WR00 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1WRA > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1WRA
  SELF%F_WRA => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_WRA => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UR9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UR9
  SELF%F_UR9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_UR9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VR9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VR9
  SELF%F_VR9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VR9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1DBBC9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1DBBC9
  SELF%F_DBBC9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_DBBC9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1DPHI9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1DPHI9
  SELF%F_DPHI9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_DPHI9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1GWS9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GWS9
  SELF%F_GWS9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_GWS9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1U0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U0
  SELF%F_U0 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_U0 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1V0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V0
  SELF%F_V0 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_V0 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1T0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T0
  SELF%F_T0 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_T0 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1PD0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD0
  SELF%F_PD0 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_PD0 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VD0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD0
  SELF%F_VD0 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VD0 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1C9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C9
  SELF%F_C9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_C9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1SP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1SP9
  SELF%F_SP9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_SP9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1SP0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1SP0
  SELF%F_SP0 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_SP0 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1C0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C0
  SELF%F_C0 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_C0 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UP9
  SELF%F_UP9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_UP9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VP9
  SELF%F_VP9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VP9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1TP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1TP9
  SELF%F_TP9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_TP9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1U9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U9_SI
  SELF%F_U9_SI => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_U9_SI => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1V9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V9_SI
  SELF%F_V9_SI => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_V9_SI => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1T9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T9_SI
  SELF%F_T9_SI => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_T9_SI => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1PD9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD9_SI
  SELF%F_PD9_SI => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_PD9_SI => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VD9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD9_SI
  SELF%F_VD9_SI => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VD9_SI => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1C9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C9_SI
  SELF%F_C9_SI => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_C9_SI => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UF9
  SELF%F_UF9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_UF9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VF9
  SELF%F_VF9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VF9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1TF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1TF9
  SELF%F_TF9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_TF9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VDF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VDF9
  SELF%F_VDF9 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VDF9 => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1U9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U9_NL
  SELF%F_U9_NL => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_U9_NL => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1V9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V9_NL
  SELF%F_V9_NL => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_V9_NL => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1T9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T9_NL
  SELF%F_T9_NL => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_T9_NL => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1PD9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD9_NL
  SELF%F_PD9_NL => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_PD9_NL => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VD9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD9_NL
  SELF%F_VD9_NL => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VD9_NL => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1C9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C9_NL
  SELF%F_C9_NL => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_C9_NL => NULL ()
ENDIF

IF (YGFL%YQ%MP_SL1 > 0 .AND. YGFL%YQ%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YQ%MP_SL1-1)*(NLEV+2)
  SELF%F_Q => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_Q => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YQ%MP_SL1 > 0 .AND. YGFL%YQ%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YQ%MP_SL1-1)*(NLEV+2)
    SELF%F_Q_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_Q_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YI%MP_SL1 > 0 .AND. YGFL%YI%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YI%MP_SL1-1)*(NLEV+2)
  SELF%F_I => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_I => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YI%MP_SL1 > 0 .AND. YGFL%YI%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YI%MP_SL1-1)*(NLEV+2)
    SELF%F_I_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_I_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YL%MP_SL1 > 0 .AND. YGFL%YL%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YL%MP_SL1-1)*(NLEV+2)
  SELF%F_L => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_L => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YL%MP_SL1 > 0 .AND. YGFL%YL%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YL%MP_SL1-1)*(NLEV+2)
    SELF%F_L_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_L_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YLCONV%MP_SL1 > 0 .AND. YGFL%YLCONV%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YLCONV%MP_SL1-1)*(NLEV+2)
  SELF%F_LCONV => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_LCONV => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YLCONV%MP_SL1 > 0 .AND. YGFL%YLCONV%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YLCONV%MP_SL1-1)*(NLEV+2)
    SELF%F_LCONV_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_LCONV_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YICONV%MP_SL1 > 0 .AND. YGFL%YICONV%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YICONV%MP_SL1-1)*(NLEV+2)
  SELF%F_ICONV => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_ICONV => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YICONV%MP_SL1 > 0 .AND. YGFL%YICONV%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YICONV%MP_SL1-1)*(NLEV+2)
    SELF%F_ICONV_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_ICONV_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YRCONV%MP_SL1 > 0 .AND. YGFL%YRCONV%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YRCONV%MP_SL1-1)*(NLEV+2)
  SELF%F_RCONV => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_RCONV => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YRCONV%MP_SL1 > 0 .AND. YGFL%YRCONV%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YRCONV%MP_SL1-1)*(NLEV+2)
    SELF%F_RCONV_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_RCONV_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YSCONV%MP_SL1 > 0 .AND. YGFL%YSCONV%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YSCONV%MP_SL1-1)*(NLEV+2)
  SELF%F_SCONV => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_SCONV => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YSCONV%MP_SL1 > 0 .AND. YGFL%YSCONV%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YSCONV%MP_SL1-1)*(NLEV+2)
    SELF%F_SCONV_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_SCONV_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YIRAD%MP_SL1 > 0 .AND. YGFL%YIRAD%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YIRAD%MP_SL1-1)*(NLEV+2)
  SELF%F_IRAD => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_IRAD => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YIRAD%MP_SL1 > 0 .AND. YGFL%YIRAD%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YIRAD%MP_SL1-1)*(NLEV+2)
    SELF%F_IRAD_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_IRAD_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YLRAD%MP_SL1 > 0 .AND. YGFL%YLRAD%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YLRAD%MP_SL1-1)*(NLEV+2)
  SELF%F_LRAD => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_LRAD => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YLRAD%MP_SL1 > 0 .AND. YGFL%YLRAD%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YLRAD%MP_SL1-1)*(NLEV+2)
    SELF%F_LRAD_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_LRAD_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YS%MP_SL1 > 0 .AND. YGFL%YS%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YS%MP_SL1-1)*(NLEV+2)
  SELF%F_S => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_S => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YS%MP_SL1 > 0 .AND. YGFL%YS%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YS%MP_SL1-1)*(NLEV+2)
    SELF%F_S_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_S_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YR%MP_SL1 > 0 .AND. YGFL%YR%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YR%MP_SL1-1)*(NLEV+2)
  SELF%F_R => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_R => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YR%MP_SL1 > 0 .AND. YGFL%YR%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YR%MP_SL1-1)*(NLEV+2)
    SELF%F_R_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_R_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YG%MP_SL1 > 0 .AND. YGFL%YG%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YG%MP_SL1-1)*(NLEV+2)
  SELF%F_G => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_G => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YG%MP_SL1 > 0 .AND. YGFL%YG%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YG%MP_SL1-1)*(NLEV+2)
    SELF%F_G_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_G_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YH%MP_SL1 > 0 .AND. YGFL%YH%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YH%MP_SL1-1)*(NLEV+2)
  SELF%F_H => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_H => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YH%MP_SL1 > 0 .AND. YGFL%YH%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YH%MP_SL1-1)*(NLEV+2)
    SELF%F_H_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_H_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YTKE%MP_SL1 > 0 .AND. YGFL%YTKE%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YTKE%MP_SL1-1)*(NLEV+2)
  SELF%F_TKE => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_TKE => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YTKE%MP_SL1 > 0 .AND. YGFL%YTKE%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YTKE%MP_SL1-1)*(NLEV+2)
    SELF%F_TKE_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_TKE_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YTTE%MP_SL1 > 0 .AND. YGFL%YTTE%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YTTE%MP_SL1-1)*(NLEV+2)
  SELF%F_TTE => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_TTE => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YTTE%MP_SL1 > 0 .AND. YGFL%YTTE%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YTTE%MP_SL1-1)*(NLEV+2)
    SELF%F_TTE_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_TTE_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YEFB1%MP_SL1 > 0 .AND. YGFL%YEFB1%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YEFB1%MP_SL1-1)*(NLEV+2)
  SELF%F_EFB1 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_EFB1 => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YEFB1%MP_SL1 > 0 .AND. YGFL%YEFB1%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YEFB1%MP_SL1-1)*(NLEV+2)
    SELF%F_EFB1_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_EFB1_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YEFB2%MP_SL1 > 0 .AND. YGFL%YEFB2%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YEFB2%MP_SL1-1)*(NLEV+2)
  SELF%F_EFB2 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_EFB2 => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YEFB2%MP_SL1 > 0 .AND. YGFL%YEFB2%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YEFB2%MP_SL1-1)*(NLEV+2)
    SELF%F_EFB2_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_EFB2_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YEFB3%MP_SL1 > 0 .AND. YGFL%YEFB3%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YEFB3%MP_SL1-1)*(NLEV+2)
  SELF%F_EFB3 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_EFB3 => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YEFB3%MP_SL1 > 0 .AND. YGFL%YEFB3%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YEFB3%MP_SL1-1)*(NLEV+2)
    SELF%F_EFB3_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_EFB3_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YA%MP_SL1 > 0 .AND. YGFL%YA%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YA%MP_SL1-1)*(NLEV+2)
  SELF%F_A => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_A => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YA%MP_SL1 > 0 .AND. YGFL%YA%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YA%MP_SL1-1)*(NLEV+2)
    SELF%F_A_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_A_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YO3%MP_SL1 > 0 .AND. YGFL%YO3%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YO3%MP_SL1-1)*(NLEV+2)
  SELF%F_O3 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_O3 => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YO3%MP_SL1 > 0 .AND. YGFL%YO3%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YO3%MP_SL1-1)*(NLEV+2)
    SELF%F_O3_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_O3_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YSRC%MP_SL1 > 0 .AND. YGFL%YSRC%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YSRC%MP_SL1-1)*(NLEV+2)
  SELF%F_SRC => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_SRC => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YSRC%MP_SL1 > 0 .AND. YGFL%YSRC%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YSRC%MP_SL1-1)*(NLEV+2)
    SELF%F_SRC_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_SRC_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YMXL%MP_SL1 > 0 .AND. YGFL%YMXL%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YMXL%MP_SL1-1)*(NLEV+2)
  SELF%F_MXL => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_MXL => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YMXL%MP_SL1 > 0 .AND. YGFL%YMXL%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YMXL%MP_SL1-1)*(NLEV+2)
    SELF%F_MXL_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_MXL_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YSHTUR%MP_SL1 > 0 .AND. YGFL%YSHTUR%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YSHTUR%MP_SL1-1)*(NLEV+2)
  SELF%F_SHTUR => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_SHTUR => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YSHTUR%MP_SL1 > 0 .AND. YGFL%YSHTUR%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YSHTUR%MP_SL1-1)*(NLEV+2)
    SELF%F_SHTUR_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_SHTUR_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YFQTUR%MP_SL1 > 0 .AND. YGFL%YFQTUR%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YFQTUR%MP_SL1-1)*(NLEV+2)
  SELF%F_FQTUR => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_FQTUR => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YFQTUR%MP_SL1 > 0 .AND. YGFL%YFQTUR%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YFQTUR%MP_SL1-1)*(NLEV+2)
    SELF%F_FQTUR_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_FQTUR_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YFSTUR%MP_SL1 > 0 .AND. YGFL%YFSTUR%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YFSTUR%MP_SL1-1)*(NLEV+2)
  SELF%F_FSTUR => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_FSTUR => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YFSTUR%MP_SL1 > 0 .AND. YGFL%YFSTUR%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YFSTUR%MP_SL1-1)*(NLEV+2)
    SELF%F_FSTUR_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_FSTUR_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YCPF%MP_SL1 > 0 .AND. YGFL%YCPF%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YCPF%MP_SL1-1)*(NLEV+2)
  SELF%F_CPF => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_CPF => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YCPF%MP_SL1 > 0 .AND. YGFL%YCPF%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YCPF%MP_SL1-1)*(NLEV+2)
    SELF%F_CPF_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_CPF_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YSPF%MP_SL1 > 0 .AND. YGFL%YSPF%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YSPF%MP_SL1-1)*(NLEV+2)
  SELF%F_SPF => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_SPF => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YSPF%MP_SL1 > 0 .AND. YGFL%YSPF%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YSPF%MP_SL1-1)*(NLEV+2)
    SELF%F_SPF_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_SPF_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YCVGQ%MP_SL1 > 0 .AND. YGFL%YCVGQ%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YCVGQ%MP_SL1-1)*(NLEV+2)
  SELF%F_CVGQ => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_CVGQ => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YCVGQ%MP_SL1 > 0 .AND. YGFL%YCVGQ%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YCVGQ%MP_SL1-1)*(NLEV+2)
    SELF%F_CVGQ_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_CVGQ_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YQVA%MP_SL1 > 0 .AND. YGFL%YQVA%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YQVA%MP_SL1-1)*(NLEV+2)
  SELF%F_QVA => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_QVA => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YQVA%MP_SL1 > 0 .AND. YGFL%YQVA%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YQVA%MP_SL1-1)*(NLEV+2)
    SELF%F_QVA_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_QVA_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YLRCH4%MP_SL1 > 0 .AND. YGFL%YLRCH4%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YLRCH4%MP_SL1-1)*(NLEV+2)
  SELF%F_LRCH4 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_LRCH4 => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YLRCH4%MP_SL1 > 0 .AND. YGFL%YLRCH4%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YLRCH4%MP_SL1-1)*(NLEV+2)
    SELF%F_LRCH4_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_LRCH4_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YPHYCTY%MP_SL1 > 0 .AND. YGFL%YPHYCTY%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YPHYCTY%MP_SL1-1)*(NLEV+2)
  SELF%F_PHYCTY => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_PHYCTY => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YPHYCTY%MP_SL1 > 0 .AND. YGFL%YPHYCTY%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YPHYCTY%MP_SL1-1)*(NLEV+2)
    SELF%F_PHYCTY_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_PHYCTY_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YRSPEC%MP_SL1 > 0 .AND. YGFL%YRSPEC%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YRSPEC%MP_SL1-1)*(NLEV+2)
  SELF%F_RSPEC => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_RSPEC => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YRSPEC%MP_SL1 > 0 .AND. YGFL%YRSPEC%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YRSPEC%MP_SL1-1)*(NLEV+2)
    SELF%F_RSPEC_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_RSPEC_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YSDSAT%MP_SL1 > 0 .AND. YGFL%YSDSAT%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YSDSAT%MP_SL1-1)*(NLEV+2)
  SELF%F_SDSAT => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_SDSAT => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YSDSAT%MP_SL1 > 0 .AND. YGFL%YSDSAT%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YSDSAT%MP_SL1-1)*(NLEV+2)
    SELF%F_SDSAT_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_SDSAT_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YCVV%MP_SL1 > 0 .AND. YGFL%YCVV%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YCVV%MP_SL1-1)*(NLEV+2)
  SELF%F_CVV => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_CVV => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YCVV%MP_SL1 > 0 .AND. YGFL%YCVV%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YCVV%MP_SL1-1)*(NLEV+2)
    SELF%F_CVV_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_CVV_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YRKTH%MP_SL1 > 0 .AND. YGFL%YRKTH%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YRKTH%MP_SL1-1)*(NLEV+2)
  SELF%F_RKTH => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_RKTH => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YRKTH%MP_SL1 > 0 .AND. YGFL%YRKTH%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YRKTH%MP_SL1-1)*(NLEV+2)
    SELF%F_RKTH_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_RKTH_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YRKTQV%MP_SL1 > 0 .AND. YGFL%YRKTQV%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YRKTQV%MP_SL1-1)*(NLEV+2)
  SELF%F_RKTQV => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_RKTQV => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YRKTQV%MP_SL1 > 0 .AND. YGFL%YRKTQV%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YRKTQV%MP_SL1-1)*(NLEV+2)
    SELF%F_RKTQV_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_RKTQV_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YRKTQC%MP_SL1 > 0 .AND. YGFL%YRKTQC%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YRKTQC%MP_SL1-1)*(NLEV+2)
  SELF%F_RKTQC => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_RKTQC => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YRKTQC%MP_SL1 > 0 .AND. YGFL%YRKTQC%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YRKTQC%MP_SL1-1)*(NLEV+2)
    SELF%F_RKTQC_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_RKTQC_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YUOM%MP_SL1 > 0 .AND. YGFL%YUOM%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YUOM%MP_SL1-1)*(NLEV+2)
  SELF%F_UOM => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_UOM => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YUOM%MP_SL1 > 0 .AND. YGFL%YUOM%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YUOM%MP_SL1-1)*(NLEV+2)
    SELF%F_UOM_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_UOM_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YUAL%MP_SL1 > 0 .AND. YGFL%YUAL%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YUAL%MP_SL1-1)*(NLEV+2)
  SELF%F_UAL => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_UAL => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YUAL%MP_SL1 > 0 .AND. YGFL%YUAL%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YUAL%MP_SL1-1)*(NLEV+2)
    SELF%F_UAL_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_UAL_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YDOM%MP_SL1 > 0 .AND. YGFL%YDOM%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YDOM%MP_SL1-1)*(NLEV+2)
  SELF%F_DOM => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_DOM => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YDOM%MP_SL1 > 0 .AND. YGFL%YDOM%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YDOM%MP_SL1-1)*(NLEV+2)
    SELF%F_DOM_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_DOM_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YDAL%MP_SL1 > 0 .AND. YGFL%YDAL%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YDAL%MP_SL1-1)*(NLEV+2)
  SELF%F_DAL => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_DAL => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YDAL%MP_SL1 > 0 .AND. YGFL%YDAL%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YDAL%MP_SL1-1)*(NLEV+2)
    SELF%F_DAL_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_DAL_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YUEN%MP_SL1 > 0 .AND. YGFL%YUEN%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YUEN%MP_SL1-1)*(NLEV+2)
  SELF%F_UEN => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_UEN => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YUEN%MP_SL1 > 0 .AND. YGFL%YUEN%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YUEN%MP_SL1-1)*(NLEV+2)
    SELF%F_UEN_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_UEN_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YUNEBH%MP_SL1 > 0 .AND. YGFL%YUNEBH%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YUNEBH%MP_SL1-1)*(NLEV+2)
  SELF%F_UNEBH => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_UNEBH => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YUNEBH%MP_SL1 > 0 .AND. YGFL%YUNEBH%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YUNEBH%MP_SL1-1)*(NLEV+2)
    SELF%F_UNEBH_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_UNEBH_F => NULL ()
  ENDIF
ENDIF
IF (YGFL%YFSD%MP_SL1 > 0 .AND. YGFL%YFSD%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9  + (YGFL%YFSD%MP_SL1-1)*(NLEV+2)
  SELF%F_FSD => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_FSD => NULL ()
ENDIF
IF (YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) THEN
  IF (YGFL%YFSD%MP_SL1 > 0 .AND. YGFL%YFSD%MP1 > 0) THEN
    JFLD = YDTPTRSLB1%MSLB1GFLF9 + (YGFL%YFSD%MP_SL1-1)*(NLEV+2)
    SELF%F_FSD_F => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
  ELSE
    SELF%F_FSD_F => NULL ()
  ENDIF
ENDIF

END SUBROUTINE CPG_SL1_TYPE_INIT

SUBROUTINE CPG_SL1_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_SL1_TYPE)        :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN
  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)
  IF (ASSOCIATED (SELF%F_U9)) THEN
    SELF%U9 (1:, 0:) => SELF%F_U9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%U9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_V9)) THEN
    SELF%V9 (1:, 0:) => SELF%F_V9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%V9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_T9)) THEN
    SELF%T9 (1:, 0:) => SELF%F_T9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%T9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_PD9)) THEN
    SELF%PD9 (1:, 0:) => SELF%F_PD9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%PD9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VD9)) THEN
    SELF%VD9 (1:, 0:) => SELF%F_VD9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VD9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_NHX9)) THEN
    SELF%NHX9 (1:, 0:) => SELF%F_NHX9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%NHX9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_UR0)) THEN
    SELF%UR0 (1:, 0:) => SELF%F_UR0%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%UR0 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VR0)) THEN
    SELF%VR0 (1:, 0:) => SELF%F_VR0%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VR0 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_ZR0)) THEN
    SELF%ZR0 (1:, 0:) => SELF%F_ZR0%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%ZR0 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_WR0)) THEN
    SELF%WR0 (1:, 0:) => SELF%F_WR0%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%WR0 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_UR00)) THEN
    SELF%UR00 (1:, 0:) => SELF%F_UR00%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%UR00 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VR00)) THEN
    SELF%VR00 (1:, 0:) => SELF%F_VR00%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VR00 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_ZR00)) THEN
    SELF%ZR00 (1:, 0:) => SELF%F_ZR00%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%ZR00 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_WR00)) THEN
    SELF%WR00 (1:, 0:) => SELF%F_WR00%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%WR00 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_WRA)) THEN
    SELF%WRA (1:, 0:) => SELF%F_WRA%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%WRA => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_UR9)) THEN
    SELF%UR9 (1:, 0:) => SELF%F_UR9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%UR9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VR9)) THEN
    SELF%VR9 (1:, 0:) => SELF%F_VR9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VR9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_DBBC9)) THEN
    SELF%DBBC9 (1:, 0:) => SELF%F_DBBC9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%DBBC9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_DPHI9)) THEN
    SELF%DPHI9 (1:, 0:) => SELF%F_DPHI9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%DPHI9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_GWS9)) THEN
    SELF%GWS9 => SELF%F_GWS9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%GWS9 => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_U0)) THEN
    SELF%U0 (1:, 0:) => SELF%F_U0%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%U0 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_V0)) THEN
    SELF%V0 (1:, 0:) => SELF%F_V0%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%V0 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_T0)) THEN
    SELF%T0 (1:, 0:) => SELF%F_T0%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%T0 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_PD0)) THEN
    SELF%PD0 (1:, 0:) => SELF%F_PD0%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%PD0 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VD0)) THEN
    SELF%VD0 (1:, 0:) => SELF%F_VD0%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VD0 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_C9)) THEN
    SELF%C9 (1:, 0:) => SELF%F_C9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%C9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_SP9)) THEN
    SELF%SP9 => SELF%F_SP9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SP9 => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_SP0)) THEN
    SELF%SP0 => SELF%F_SP0%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SP0 => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_C0)) THEN
    SELF%C0 (1:, 0:) => SELF%F_C0%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%C0 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_UP9)) THEN
    SELF%UP9 (1:, 0:) => SELF%F_UP9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%UP9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VP9)) THEN
    SELF%VP9 (1:, 0:) => SELF%F_VP9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VP9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TP9)) THEN
    SELF%TP9 (1:, 0:) => SELF%F_TP9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TP9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_U9_SI)) THEN
    SELF%U9_SI (1:, 0:) => SELF%F_U9_SI%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%U9_SI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_V9_SI)) THEN
    SELF%V9_SI (1:, 0:) => SELF%F_V9_SI%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%V9_SI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_T9_SI)) THEN
    SELF%T9_SI (1:, 0:) => SELF%F_T9_SI%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%T9_SI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_PD9_SI)) THEN
    SELF%PD9_SI (1:, 0:) => SELF%F_PD9_SI%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%PD9_SI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VD9_SI)) THEN
    SELF%VD9_SI (1:, 0:) => SELF%F_VD9_SI%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VD9_SI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_C9_SI)) THEN
    SELF%C9_SI (1:, 0:) => SELF%F_C9_SI%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%C9_SI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_UF9)) THEN
    SELF%UF9 (1:, 0:) => SELF%F_UF9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%UF9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VF9)) THEN
    SELF%VF9 (1:, 0:) => SELF%F_VF9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VF9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TF9)) THEN
    SELF%TF9 (1:, 0:) => SELF%F_TF9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TF9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VDF9)) THEN
    SELF%VDF9 (1:, 0:) => SELF%F_VDF9%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VDF9 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_U9_NL)) THEN
    SELF%U9_NL (1:, 0:) => SELF%F_U9_NL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%U9_NL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_V9_NL)) THEN
    SELF%V9_NL (1:, 0:) => SELF%F_V9_NL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%V9_NL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_T9_NL)) THEN
    SELF%T9_NL (1:, 0:) => SELF%F_T9_NL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%T9_NL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_PD9_NL)) THEN
    SELF%PD9_NL (1:, 0:) => SELF%F_PD9_NL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%PD9_NL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VD9_NL)) THEN
    SELF%VD9_NL (1:, 0:) => SELF%F_VD9_NL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VD9_NL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_C9_NL)) THEN
    SELF%C9_NL (1:, 0:) => SELF%F_C9_NL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%C9_NL => ZDUM2
  ENDIF

  IF (ASSOCIATED (SELF%F_Q)) THEN
    SELF%Q (1:, 0:) => SELF%F_Q%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%Q => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_Q_F)) THEN
    SELF%Q_F (1:, 0:) => SELF%F_Q_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%Q_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_I)) THEN
    SELF%I (1:, 0:) => SELF%F_I%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%I => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_I_F)) THEN
    SELF%I_F (1:, 0:) => SELF%F_I_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%I_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_L)) THEN
    SELF%L (1:, 0:) => SELF%F_L%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%L => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_L_F)) THEN
    SELF%L_F (1:, 0:) => SELF%F_L_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%L_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_LCONV)) THEN
    SELF%LCONV (1:, 0:) => SELF%F_LCONV%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%LCONV => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_LCONV_F)) THEN
    SELF%LCONV_F (1:, 0:) => SELF%F_LCONV_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%LCONV_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_ICONV)) THEN
    SELF%ICONV (1:, 0:) => SELF%F_ICONV%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%ICONV => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_ICONV_F)) THEN
    SELF%ICONV_F (1:, 0:) => SELF%F_ICONV_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%ICONV_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RCONV)) THEN
    SELF%RCONV (1:, 0:) => SELF%F_RCONV%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RCONV => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RCONV_F)) THEN
    SELF%RCONV_F (1:, 0:) => SELF%F_RCONV_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RCONV_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_SCONV)) THEN
    SELF%SCONV (1:, 0:) => SELF%F_SCONV%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SCONV => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_SCONV_F)) THEN
    SELF%SCONV_F (1:, 0:) => SELF%F_SCONV_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SCONV_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_IRAD)) THEN
    SELF%IRAD (1:, 0:) => SELF%F_IRAD%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%IRAD => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_IRAD_F)) THEN
    SELF%IRAD_F (1:, 0:) => SELF%F_IRAD_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%IRAD_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_LRAD)) THEN
    SELF%LRAD (1:, 0:) => SELF%F_LRAD%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%LRAD => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_LRAD_F)) THEN
    SELF%LRAD_F (1:, 0:) => SELF%F_LRAD_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%LRAD_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_S)) THEN
    SELF%S (1:, 0:) => SELF%F_S%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%S => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_S_F)) THEN
    SELF%S_F (1:, 0:) => SELF%F_S_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%S_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_R)) THEN
    SELF%R (1:, 0:) => SELF%F_R%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%R => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_R_F)) THEN
    SELF%R_F (1:, 0:) => SELF%F_R_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%R_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_G)) THEN
    SELF%G (1:, 0:) => SELF%F_G%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%G => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_G_F)) THEN
    SELF%G_F (1:, 0:) => SELF%F_G_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%G_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_H)) THEN
    SELF%H (1:, 0:) => SELF%F_H%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%H => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_H_F)) THEN
    SELF%H_F (1:, 0:) => SELF%F_H_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%H_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TKE)) THEN
    SELF%TKE (1:, 0:) => SELF%F_TKE%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TKE => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TKE_F)) THEN
    SELF%TKE_F (1:, 0:) => SELF%F_TKE_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TKE_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TTE)) THEN
    SELF%TTE (1:, 0:) => SELF%F_TTE%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TTE => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TTE_F)) THEN
    SELF%TTE_F (1:, 0:) => SELF%F_TTE_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TTE_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_EFB1)) THEN
    SELF%EFB1 (1:, 0:) => SELF%F_EFB1%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%EFB1 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_EFB1_F)) THEN
    SELF%EFB1_F (1:, 0:) => SELF%F_EFB1_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%EFB1_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_EFB2)) THEN
    SELF%EFB2 (1:, 0:) => SELF%F_EFB2%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%EFB2 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_EFB2_F)) THEN
    SELF%EFB2_F (1:, 0:) => SELF%F_EFB2_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%EFB2_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_EFB3)) THEN
    SELF%EFB3 (1:, 0:) => SELF%F_EFB3%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%EFB3 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_EFB3_F)) THEN
    SELF%EFB3_F (1:, 0:) => SELF%F_EFB3_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%EFB3_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_A)) THEN
    SELF%A (1:, 0:) => SELF%F_A%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%A => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_A_F)) THEN
    SELF%A_F (1:, 0:) => SELF%F_A_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%A_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_O3)) THEN
    SELF%O3 (1:, 0:) => SELF%F_O3%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%O3 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_O3_F)) THEN
    SELF%O3_F (1:, 0:) => SELF%F_O3_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%O3_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_SRC)) THEN
    SELF%SRC (1:, 0:) => SELF%F_SRC%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SRC => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_SRC_F)) THEN
    SELF%SRC_F (1:, 0:) => SELF%F_SRC_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SRC_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_MXL)) THEN
    SELF%MXL (1:, 0:) => SELF%F_MXL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%MXL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_MXL_F)) THEN
    SELF%MXL_F (1:, 0:) => SELF%F_MXL_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%MXL_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_SHTUR)) THEN
    SELF%SHTUR (1:, 0:) => SELF%F_SHTUR%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SHTUR => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_SHTUR_F)) THEN
    SELF%SHTUR_F (1:, 0:) => SELF%F_SHTUR_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SHTUR_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_FQTUR)) THEN
    SELF%FQTUR (1:, 0:) => SELF%F_FQTUR%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%FQTUR => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_FQTUR_F)) THEN
    SELF%FQTUR_F (1:, 0:) => SELF%F_FQTUR_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%FQTUR_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_FSTUR)) THEN
    SELF%FSTUR (1:, 0:) => SELF%F_FSTUR%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%FSTUR => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_FSTUR_F)) THEN
    SELF%FSTUR_F (1:, 0:) => SELF%F_FSTUR_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%FSTUR_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_CPF)) THEN
    SELF%CPF (1:, 0:) => SELF%F_CPF%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%CPF => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_CPF_F)) THEN
    SELF%CPF_F (1:, 0:) => SELF%F_CPF_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%CPF_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_SPF)) THEN
    SELF%SPF (1:, 0:) => SELF%F_SPF%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SPF => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_SPF_F)) THEN
    SELF%SPF_F (1:, 0:) => SELF%F_SPF_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SPF_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_CVGQ)) THEN
    SELF%CVGQ (1:, 0:) => SELF%F_CVGQ%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%CVGQ => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_CVGQ_F)) THEN
    SELF%CVGQ_F (1:, 0:) => SELF%F_CVGQ_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%CVGQ_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_QVA)) THEN
    SELF%QVA (1:, 0:) => SELF%F_QVA%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%QVA => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_QVA_F)) THEN
    SELF%QVA_F (1:, 0:) => SELF%F_QVA_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%QVA_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_LRCH4)) THEN
    SELF%LRCH4 (1:, 0:) => SELF%F_LRCH4%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%LRCH4 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_LRCH4_F)) THEN
    SELF%LRCH4_F (1:, 0:) => SELF%F_LRCH4_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%LRCH4_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_PHYCTY)) THEN
    SELF%PHYCTY (1:, 0:) => SELF%F_PHYCTY%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%PHYCTY => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_PHYCTY_F)) THEN
    SELF%PHYCTY_F (1:, 0:) => SELF%F_PHYCTY_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%PHYCTY_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RSPEC)) THEN
    SELF%RSPEC (1:, 0:) => SELF%F_RSPEC%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RSPEC => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RSPEC_F)) THEN
    SELF%RSPEC_F (1:, 0:) => SELF%F_RSPEC_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RSPEC_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_SDSAT)) THEN
    SELF%SDSAT (1:, 0:) => SELF%F_SDSAT%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SDSAT => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_SDSAT_F)) THEN
    SELF%SDSAT_F (1:, 0:) => SELF%F_SDSAT_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SDSAT_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_CVV)) THEN
    SELF%CVV (1:, 0:) => SELF%F_CVV%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%CVV => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_CVV_F)) THEN
    SELF%CVV_F (1:, 0:) => SELF%F_CVV_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%CVV_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RKTH)) THEN
    SELF%RKTH (1:, 0:) => SELF%F_RKTH%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RKTH => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RKTH_F)) THEN
    SELF%RKTH_F (1:, 0:) => SELF%F_RKTH_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RKTH_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RKTQV)) THEN
    SELF%RKTQV (1:, 0:) => SELF%F_RKTQV%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RKTQV => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RKTQV_F)) THEN
    SELF%RKTQV_F (1:, 0:) => SELF%F_RKTQV_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RKTQV_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RKTQC)) THEN
    SELF%RKTQC (1:, 0:) => SELF%F_RKTQC%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RKTQC => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_RKTQC_F)) THEN
    SELF%RKTQC_F (1:, 0:) => SELF%F_RKTQC_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%RKTQC_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_UOM)) THEN
    SELF%UOM (1:, 0:) => SELF%F_UOM%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%UOM => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_UOM_F)) THEN
    SELF%UOM_F (1:, 0:) => SELF%F_UOM_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%UOM_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_UAL)) THEN
    SELF%UAL (1:, 0:) => SELF%F_UAL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%UAL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_UAL_F)) THEN
    SELF%UAL_F (1:, 0:) => SELF%F_UAL_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%UAL_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_DOM)) THEN
    SELF%DOM (1:, 0:) => SELF%F_DOM%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%DOM => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_DOM_F)) THEN
    SELF%DOM_F (1:, 0:) => SELF%F_DOM_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%DOM_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_DAL)) THEN
    SELF%DAL (1:, 0:) => SELF%F_DAL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%DAL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_DAL_F)) THEN
    SELF%DAL_F (1:, 0:) => SELF%F_DAL_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%DAL_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_UEN)) THEN
    SELF%UEN (1:, 0:) => SELF%F_UEN%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%UEN => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_UEN_F)) THEN
    SELF%UEN_F (1:, 0:) => SELF%F_UEN_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%UEN_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_UNEBH)) THEN
    SELF%UNEBH (1:, 0:) => SELF%F_UNEBH%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%UNEBH => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_UNEBH_F)) THEN
    SELF%UNEBH_F (1:, 0:) => SELF%F_UNEBH_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%UNEBH_F => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_FSD)) THEN
    SELF%FSD (1:, 0:) => SELF%F_FSD%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%FSD => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_FSD_F)) THEN
    SELF%FSD_F (1:, 0:) => SELF%F_FSD_F%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%FSD_F => ZDUM2
  ENDIF

ELSE
  SELF%ZVIEW => ZDUM2

  SELF%U9 => ZDUM2
  SELF%V9 => ZDUM2
  SELF%T9 => ZDUM2
  SELF%PD9 => ZDUM2
  SELF%VD9 => ZDUM2
  SELF%NHX9 => ZDUM2
  SELF%UR0 => ZDUM2
  SELF%VR0 => ZDUM2
  SELF%ZR0 => ZDUM2
  SELF%WR0 => ZDUM2
  SELF%UR00 => ZDUM2
  SELF%VR00 => ZDUM2
  SELF%ZR00 => ZDUM2
  SELF%WR00 => ZDUM2
  SELF%WRA => ZDUM2
  SELF%UR9 => ZDUM2
  SELF%VR9 => ZDUM2
  SELF%DBBC9 => ZDUM2
  SELF%DPHI9 => ZDUM2
  SELF%GWS9 => ZDUM1
  SELF%U0 => ZDUM2
  SELF%V0 => ZDUM2
  SELF%T0 => ZDUM2
  SELF%PD0 => ZDUM2
  SELF%VD0 => ZDUM2
  SELF%C9 => ZDUM2
  SELF%SP9 => ZDUM1
  SELF%SP0 => ZDUM1
  SELF%C0 => ZDUM2
  SELF%UP9 => ZDUM2
  SELF%VP9 => ZDUM2
  SELF%TP9 => ZDUM2
  SELF%U9_SI => ZDUM2
  SELF%V9_SI => ZDUM2
  SELF%T9_SI => ZDUM2
  SELF%PD9_SI => ZDUM2
  SELF%VD9_SI => ZDUM2
  SELF%C9_SI => ZDUM2
  SELF%UF9 => ZDUM2
  SELF%VF9 => ZDUM2
  SELF%TF9 => ZDUM2
  SELF%VDF9 => ZDUM2
  SELF%U9_NL => ZDUM2
  SELF%V9_NL => ZDUM2
  SELF%T9_NL => ZDUM2
  SELF%PD9_NL => ZDUM2
  SELF%VD9_NL => ZDUM2
  SELF%C9_NL => ZDUM2

  SELF%Q   => ZDUM2
  SELF%Q_F => ZDUM2
  SELF%I   => ZDUM2
  SELF%I_F => ZDUM2
  SELF%L   => ZDUM2
  SELF%L_F => ZDUM2
  SELF%LCONV   => ZDUM2
  SELF%LCONV_F => ZDUM2
  SELF%ICONV   => ZDUM2
  SELF%ICONV_F => ZDUM2
  SELF%RCONV   => ZDUM2
  SELF%RCONV_F => ZDUM2
  SELF%SCONV   => ZDUM2
  SELF%SCONV_F => ZDUM2
  SELF%IRAD   => ZDUM2
  SELF%IRAD_F => ZDUM2
  SELF%LRAD   => ZDUM2
  SELF%LRAD_F => ZDUM2
  SELF%S   => ZDUM2
  SELF%S_F => ZDUM2
  SELF%R   => ZDUM2
  SELF%R_F => ZDUM2
  SELF%G   => ZDUM2
  SELF%G_F => ZDUM2
  SELF%H   => ZDUM2
  SELF%H_F => ZDUM2
  SELF%TKE   => ZDUM2
  SELF%TKE_F => ZDUM2
  SELF%TTE   => ZDUM2
  SELF%TTE_F => ZDUM2
  SELF%EFB1   => ZDUM2
  SELF%EFB1_F => ZDUM2
  SELF%EFB2   => ZDUM2
  SELF%EFB2_F => ZDUM2
  SELF%EFB3   => ZDUM2
  SELF%EFB3_F => ZDUM2
  SELF%A   => ZDUM2
  SELF%A_F => ZDUM2
  SELF%O3   => ZDUM2
  SELF%O3_F => ZDUM2
  SELF%SRC   => ZDUM2
  SELF%SRC_F => ZDUM2
  SELF%MXL   => ZDUM2
  SELF%MXL_F => ZDUM2
  SELF%SHTUR   => ZDUM2
  SELF%SHTUR_F => ZDUM2
  SELF%FQTUR   => ZDUM2
  SELF%FQTUR_F => ZDUM2
  SELF%FSTUR   => ZDUM2
  SELF%FSTUR_F => ZDUM2
  SELF%CPF   => ZDUM2
  SELF%CPF_F => ZDUM2
  SELF%SPF   => ZDUM2
  SELF%SPF_F => ZDUM2
  SELF%CVGQ   => ZDUM2
  SELF%CVGQ_F => ZDUM2
  SELF%QVA   => ZDUM2
  SELF%QVA_F => ZDUM2
  SELF%LRCH4   => ZDUM2
  SELF%LRCH4_F => ZDUM2
  SELF%PHYCTY   => ZDUM2
  SELF%PHYCTY_F => ZDUM2
  SELF%RSPEC   => ZDUM2
  SELF%RSPEC_F => ZDUM2
  SELF%SDSAT   => ZDUM2
  SELF%SDSAT_F => ZDUM2
  SELF%CVV   => ZDUM2
  SELF%CVV_F => ZDUM2
  SELF%RKTH   => ZDUM2
  SELF%RKTH_F => ZDUM2
  SELF%RKTQV   => ZDUM2
  SELF%RKTQV_F => ZDUM2
  SELF%RKTQC   => ZDUM2
  SELF%RKTQC_F => ZDUM2
  SELF%UOM   => ZDUM2
  SELF%UOM_F => ZDUM2
  SELF%UAL   => ZDUM2
  SELF%UAL_F => ZDUM2
  SELF%DOM   => ZDUM2
  SELF%DOM_F => ZDUM2
  SELF%DAL   => ZDUM2
  SELF%DAL_F => ZDUM2
  SELF%UEN   => ZDUM2
  SELF%UEN_F => ZDUM2
  SELF%UNEBH   => ZDUM2
  SELF%UNEBH_F => ZDUM2
  SELF%FSD   => ZDUM2
  SELF%FSD_F => ZDUM2

ENDIF

END SUBROUTINE CPG_SL1_TYPE_UPDATE_VIEW

SUBROUTINE CPG_SL1_TYPE_FINAL (SELF)
CLASS (CPG_SL1_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)
SELF%F_DATA => NULL ()

IF (SELF%LOWNED) THEN
  DEALLOCATE (SELF%ZDATA)
ENDIF

SELF%ZDATA => NULL ()
SELF%ZVIEW => NULL ()

  IF (ASSOCIATED (SELF%F_U9)) CALL DELETE_TEMPORARY (SELF%F_U9)
  SELF%F_U9 => NULL ()
  SELF%U9 => NULL ()
  IF (ASSOCIATED (SELF%F_V9)) CALL DELETE_TEMPORARY (SELF%F_V9)
  SELF%F_V9 => NULL ()
  SELF%V9 => NULL ()
  IF (ASSOCIATED (SELF%F_T9)) CALL DELETE_TEMPORARY (SELF%F_T9)
  SELF%F_T9 => NULL ()
  SELF%T9 => NULL ()
  IF (ASSOCIATED (SELF%F_PD9)) CALL DELETE_TEMPORARY (SELF%F_PD9)
  SELF%F_PD9 => NULL ()
  SELF%PD9 => NULL ()
  IF (ASSOCIATED (SELF%F_VD9)) CALL DELETE_TEMPORARY (SELF%F_VD9)
  SELF%F_VD9 => NULL ()
  SELF%VD9 => NULL ()
  IF (ASSOCIATED (SELF%F_NHX9)) CALL DELETE_TEMPORARY (SELF%F_NHX9)
  SELF%F_NHX9 => NULL ()
  SELF%NHX9 => NULL ()
  IF (ASSOCIATED (SELF%F_UR0)) CALL DELETE_TEMPORARY (SELF%F_UR0)
  SELF%F_UR0 => NULL ()
  SELF%UR0 => NULL ()
  IF (ASSOCIATED (SELF%F_VR0)) CALL DELETE_TEMPORARY (SELF%F_VR0)
  SELF%F_VR0 => NULL ()
  SELF%VR0 => NULL ()
  IF (ASSOCIATED (SELF%F_ZR0)) CALL DELETE_TEMPORARY (SELF%F_ZR0)
  SELF%F_ZR0 => NULL ()
  SELF%ZR0 => NULL ()
  IF (ASSOCIATED (SELF%F_WR0)) CALL DELETE_TEMPORARY (SELF%F_WR0)
  SELF%F_WR0 => NULL ()
  SELF%WR0 => NULL ()
  IF (ASSOCIATED (SELF%F_UR00)) CALL DELETE_TEMPORARY (SELF%F_UR00)
  SELF%F_UR00 => NULL ()
  SELF%UR00 => NULL ()
  IF (ASSOCIATED (SELF%F_VR00)) CALL DELETE_TEMPORARY (SELF%F_VR00)
  SELF%F_VR00 => NULL ()
  SELF%VR00 => NULL ()
  IF (ASSOCIATED (SELF%F_ZR00)) CALL DELETE_TEMPORARY (SELF%F_ZR00)
  SELF%F_ZR00 => NULL ()
  SELF%ZR00 => NULL ()
  IF (ASSOCIATED (SELF%F_WR00)) CALL DELETE_TEMPORARY (SELF%F_WR00)
  SELF%F_WR00 => NULL ()
  SELF%WR00 => NULL ()
  IF (ASSOCIATED (SELF%F_WRA)) CALL DELETE_TEMPORARY (SELF%F_WRA)
  SELF%F_WRA => NULL ()
  SELF%WRA => NULL ()
  IF (ASSOCIATED (SELF%F_UR9)) CALL DELETE_TEMPORARY (SELF%F_UR9)
  SELF%F_UR9 => NULL ()
  SELF%UR9 => NULL ()
  IF (ASSOCIATED (SELF%F_VR9)) CALL DELETE_TEMPORARY (SELF%F_VR9)
  SELF%F_VR9 => NULL ()
  SELF%VR9 => NULL ()
  IF (ASSOCIATED (SELF%F_DBBC9)) CALL DELETE_TEMPORARY (SELF%F_DBBC9)
  SELF%F_DBBC9 => NULL ()
  SELF%DBBC9 => NULL ()
  IF (ASSOCIATED (SELF%F_DPHI9)) CALL DELETE_TEMPORARY (SELF%F_DPHI9)
  SELF%F_DPHI9 => NULL ()
  SELF%DPHI9 => NULL ()
  IF (ASSOCIATED (SELF%F_GWS9)) CALL DELETE_TEMPORARY (SELF%F_GWS9)
  SELF%F_GWS9 => NULL ()
  SELF%GWS9 => NULL ()
  IF (ASSOCIATED (SELF%F_U0)) CALL DELETE_TEMPORARY (SELF%F_U0)
  SELF%F_U0 => NULL ()
  SELF%U0 => NULL ()
  IF (ASSOCIATED (SELF%F_V0)) CALL DELETE_TEMPORARY (SELF%F_V0)
  SELF%F_V0 => NULL ()
  SELF%V0 => NULL ()
  IF (ASSOCIATED (SELF%F_T0)) CALL DELETE_TEMPORARY (SELF%F_T0)
  SELF%F_T0 => NULL ()
  SELF%T0 => NULL ()
  IF (ASSOCIATED (SELF%F_PD0)) CALL DELETE_TEMPORARY (SELF%F_PD0)
  SELF%F_PD0 => NULL ()
  SELF%PD0 => NULL ()
  IF (ASSOCIATED (SELF%F_VD0)) CALL DELETE_TEMPORARY (SELF%F_VD0)
  SELF%F_VD0 => NULL ()
  SELF%VD0 => NULL ()
  IF (ASSOCIATED (SELF%F_C9)) CALL DELETE_TEMPORARY (SELF%F_C9)
  SELF%F_C9 => NULL ()
  SELF%C9 => NULL ()
  IF (ASSOCIATED (SELF%F_SP9)) CALL DELETE_TEMPORARY (SELF%F_SP9)
  SELF%F_SP9 => NULL ()
  SELF%SP9 => NULL ()
  IF (ASSOCIATED (SELF%F_SP0)) CALL DELETE_TEMPORARY (SELF%F_SP0)
  SELF%F_SP0 => NULL ()
  SELF%SP0 => NULL ()
  IF (ASSOCIATED (SELF%F_C0)) CALL DELETE_TEMPORARY (SELF%F_C0)
  SELF%F_C0 => NULL ()
  SELF%C0 => NULL ()
  IF (ASSOCIATED (SELF%F_UP9)) CALL DELETE_TEMPORARY (SELF%F_UP9)
  SELF%F_UP9 => NULL ()
  SELF%UP9 => NULL ()
  IF (ASSOCIATED (SELF%F_VP9)) CALL DELETE_TEMPORARY (SELF%F_VP9)
  SELF%F_VP9 => NULL ()
  SELF%VP9 => NULL ()
  IF (ASSOCIATED (SELF%F_TP9)) CALL DELETE_TEMPORARY (SELF%F_TP9)
  SELF%F_TP9 => NULL ()
  SELF%TP9 => NULL ()
  IF (ASSOCIATED (SELF%F_U9_SI)) CALL DELETE_TEMPORARY (SELF%F_U9_SI)
  SELF%F_U9_SI => NULL ()
  SELF%U9_SI => NULL ()
  IF (ASSOCIATED (SELF%F_V9_SI)) CALL DELETE_TEMPORARY (SELF%F_V9_SI)
  SELF%F_V9_SI => NULL ()
  SELF%V9_SI => NULL ()
  IF (ASSOCIATED (SELF%F_T9_SI)) CALL DELETE_TEMPORARY (SELF%F_T9_SI)
  SELF%F_T9_SI => NULL ()
  SELF%T9_SI => NULL ()
  IF (ASSOCIATED (SELF%F_PD9_SI)) CALL DELETE_TEMPORARY (SELF%F_PD9_SI)
  SELF%F_PD9_SI => NULL ()
  SELF%PD9_SI => NULL ()
  IF (ASSOCIATED (SELF%F_VD9_SI)) CALL DELETE_TEMPORARY (SELF%F_VD9_SI)
  SELF%F_VD9_SI => NULL ()
  SELF%VD9_SI => NULL ()
  IF (ASSOCIATED (SELF%F_C9_SI)) CALL DELETE_TEMPORARY (SELF%F_C9_SI)
  SELF%F_C9_SI => NULL ()
  SELF%C9_SI => NULL ()
  IF (ASSOCIATED (SELF%F_UF9)) CALL DELETE_TEMPORARY (SELF%F_UF9)
  SELF%F_UF9 => NULL ()
  SELF%UF9 => NULL ()
  IF (ASSOCIATED (SELF%F_VF9)) CALL DELETE_TEMPORARY (SELF%F_VF9)
  SELF%F_VF9 => NULL ()
  SELF%VF9 => NULL ()
  IF (ASSOCIATED (SELF%F_TF9)) CALL DELETE_TEMPORARY (SELF%F_TF9)
  SELF%F_TF9 => NULL ()
  SELF%TF9 => NULL ()
  IF (ASSOCIATED (SELF%F_VDF9)) CALL DELETE_TEMPORARY (SELF%F_VDF9)
  SELF%F_VDF9 => NULL ()
  SELF%VDF9 => NULL ()
  IF (ASSOCIATED (SELF%F_U9_NL)) CALL DELETE_TEMPORARY (SELF%F_U9_NL)
  SELF%F_U9_NL => NULL ()
  SELF%U9_NL => NULL ()
  IF (ASSOCIATED (SELF%F_V9_NL)) CALL DELETE_TEMPORARY (SELF%F_V9_NL)
  SELF%F_V9_NL => NULL ()
  SELF%V9_NL => NULL ()
  IF (ASSOCIATED (SELF%F_T9_NL)) CALL DELETE_TEMPORARY (SELF%F_T9_NL)
  SELF%F_T9_NL => NULL ()
  SELF%T9_NL => NULL ()
  IF (ASSOCIATED (SELF%F_PD9_NL)) CALL DELETE_TEMPORARY (SELF%F_PD9_NL)
  SELF%F_PD9_NL => NULL ()
  SELF%PD9_NL => NULL ()
  IF (ASSOCIATED (SELF%F_VD9_NL)) CALL DELETE_TEMPORARY (SELF%F_VD9_NL)
  SELF%F_VD9_NL => NULL ()
  SELF%VD9_NL => NULL ()
  IF (ASSOCIATED (SELF%F_C9_NL)) CALL DELETE_TEMPORARY (SELF%F_C9_NL)
  SELF%F_C9_NL => NULL ()
  SELF%C9_NL => NULL ()

  IF (ASSOCIATED (SELF%F_Q)) CALL DELETE_TEMPORARY (SELF%F_Q)
  SELF%F_Q => NULL ()
  SELF%Q => NULL ()
  IF (ASSOCIATED (SELF%F_Q_F)) CALL DELETE_TEMPORARY (SELF%F_Q_F)
  SELF%F_Q_F => NULL ()
  SELF%Q_F => NULL ()
  IF (ASSOCIATED (SELF%F_I)) CALL DELETE_TEMPORARY (SELF%F_I)
  SELF%F_I => NULL ()
  SELF%I => NULL ()
  IF (ASSOCIATED (SELF%F_I_F)) CALL DELETE_TEMPORARY (SELF%F_I_F)
  SELF%F_I_F => NULL ()
  SELF%I_F => NULL ()
  IF (ASSOCIATED (SELF%F_L)) CALL DELETE_TEMPORARY (SELF%F_L)
  SELF%F_L => NULL ()
  SELF%L => NULL ()
  IF (ASSOCIATED (SELF%F_L_F)) CALL DELETE_TEMPORARY (SELF%F_L_F)
  SELF%F_L_F => NULL ()
  SELF%L_F => NULL ()
  IF (ASSOCIATED (SELF%F_LCONV)) CALL DELETE_TEMPORARY (SELF%F_LCONV)
  SELF%F_LCONV => NULL ()
  SELF%LCONV => NULL ()
  IF (ASSOCIATED (SELF%F_LCONV_F)) CALL DELETE_TEMPORARY (SELF%F_LCONV_F)
  SELF%F_LCONV_F => NULL ()
  SELF%LCONV_F => NULL ()
  IF (ASSOCIATED (SELF%F_ICONV)) CALL DELETE_TEMPORARY (SELF%F_ICONV)
  SELF%F_ICONV => NULL ()
  SELF%ICONV => NULL ()
  IF (ASSOCIATED (SELF%F_ICONV_F)) CALL DELETE_TEMPORARY (SELF%F_ICONV_F)
  SELF%F_ICONV_F => NULL ()
  SELF%ICONV_F => NULL ()
  IF (ASSOCIATED (SELF%F_RCONV)) CALL DELETE_TEMPORARY (SELF%F_RCONV)
  SELF%F_RCONV => NULL ()
  SELF%RCONV => NULL ()
  IF (ASSOCIATED (SELF%F_RCONV_F)) CALL DELETE_TEMPORARY (SELF%F_RCONV_F)
  SELF%F_RCONV_F => NULL ()
  SELF%RCONV_F => NULL ()
  IF (ASSOCIATED (SELF%F_SCONV)) CALL DELETE_TEMPORARY (SELF%F_SCONV)
  SELF%F_SCONV => NULL ()
  SELF%SCONV => NULL ()
  IF (ASSOCIATED (SELF%F_SCONV_F)) CALL DELETE_TEMPORARY (SELF%F_SCONV_F)
  SELF%F_SCONV_F => NULL ()
  SELF%SCONV_F => NULL ()
  IF (ASSOCIATED (SELF%F_IRAD)) CALL DELETE_TEMPORARY (SELF%F_IRAD)
  SELF%F_IRAD => NULL ()
  SELF%IRAD => NULL ()
  IF (ASSOCIATED (SELF%F_IRAD_F)) CALL DELETE_TEMPORARY (SELF%F_IRAD_F)
  SELF%F_IRAD_F => NULL ()
  SELF%IRAD_F => NULL ()
  IF (ASSOCIATED (SELF%F_LRAD)) CALL DELETE_TEMPORARY (SELF%F_LRAD)
  SELF%F_LRAD => NULL ()
  SELF%LRAD => NULL ()
  IF (ASSOCIATED (SELF%F_LRAD_F)) CALL DELETE_TEMPORARY (SELF%F_LRAD_F)
  SELF%F_LRAD_F => NULL ()
  SELF%LRAD_F => NULL ()
  IF (ASSOCIATED (SELF%F_S)) CALL DELETE_TEMPORARY (SELF%F_S)
  SELF%F_S => NULL ()
  SELF%S => NULL ()
  IF (ASSOCIATED (SELF%F_S_F)) CALL DELETE_TEMPORARY (SELF%F_S_F)
  SELF%F_S_F => NULL ()
  SELF%S_F => NULL ()
  IF (ASSOCIATED (SELF%F_R)) CALL DELETE_TEMPORARY (SELF%F_R)
  SELF%F_R => NULL ()
  SELF%R => NULL ()
  IF (ASSOCIATED (SELF%F_R_F)) CALL DELETE_TEMPORARY (SELF%F_R_F)
  SELF%F_R_F => NULL ()
  SELF%R_F => NULL ()
  IF (ASSOCIATED (SELF%F_G)) CALL DELETE_TEMPORARY (SELF%F_G)
  SELF%F_G => NULL ()
  SELF%G => NULL ()
  IF (ASSOCIATED (SELF%F_G_F)) CALL DELETE_TEMPORARY (SELF%F_G_F)
  SELF%F_G_F => NULL ()
  SELF%G_F => NULL ()
  IF (ASSOCIATED (SELF%F_H)) CALL DELETE_TEMPORARY (SELF%F_H)
  SELF%F_H => NULL ()
  SELF%H => NULL ()
  IF (ASSOCIATED (SELF%F_H_F)) CALL DELETE_TEMPORARY (SELF%F_H_F)
  SELF%F_H_F => NULL ()
  SELF%H_F => NULL ()
  IF (ASSOCIATED (SELF%F_TKE)) CALL DELETE_TEMPORARY (SELF%F_TKE)
  SELF%F_TKE => NULL ()
  SELF%TKE => NULL ()
  IF (ASSOCIATED (SELF%F_TKE_F)) CALL DELETE_TEMPORARY (SELF%F_TKE_F)
  SELF%F_TKE_F => NULL ()
  SELF%TKE_F => NULL ()
  IF (ASSOCIATED (SELF%F_TTE)) CALL DELETE_TEMPORARY (SELF%F_TTE)
  SELF%F_TTE => NULL ()
  SELF%TTE => NULL ()
  IF (ASSOCIATED (SELF%F_TTE_F)) CALL DELETE_TEMPORARY (SELF%F_TTE_F)
  SELF%F_TTE_F => NULL ()
  SELF%TTE_F => NULL ()
  IF (ASSOCIATED (SELF%F_EFB1)) CALL DELETE_TEMPORARY (SELF%F_EFB1)
  SELF%F_EFB1 => NULL ()
  SELF%EFB1 => NULL ()
  IF (ASSOCIATED (SELF%F_EFB1_F)) CALL DELETE_TEMPORARY (SELF%F_EFB1_F)
  SELF%F_EFB1_F => NULL ()
  SELF%EFB1_F => NULL ()
  IF (ASSOCIATED (SELF%F_EFB2)) CALL DELETE_TEMPORARY (SELF%F_EFB2)
  SELF%F_EFB2 => NULL ()
  SELF%EFB2 => NULL ()
  IF (ASSOCIATED (SELF%F_EFB2_F)) CALL DELETE_TEMPORARY (SELF%F_EFB2_F)
  SELF%F_EFB2_F => NULL ()
  SELF%EFB2_F => NULL ()
  IF (ASSOCIATED (SELF%F_EFB3)) CALL DELETE_TEMPORARY (SELF%F_EFB3)
  SELF%F_EFB3 => NULL ()
  SELF%EFB3 => NULL ()
  IF (ASSOCIATED (SELF%F_EFB3_F)) CALL DELETE_TEMPORARY (SELF%F_EFB3_F)
  SELF%F_EFB3_F => NULL ()
  SELF%EFB3_F => NULL ()
  IF (ASSOCIATED (SELF%F_A)) CALL DELETE_TEMPORARY (SELF%F_A)
  SELF%F_A => NULL ()
  SELF%A => NULL ()
  IF (ASSOCIATED (SELF%F_A_F)) CALL DELETE_TEMPORARY (SELF%F_A_F)
  SELF%F_A_F => NULL ()
  SELF%A_F => NULL ()
  IF (ASSOCIATED (SELF%F_O3)) CALL DELETE_TEMPORARY (SELF%F_O3)
  SELF%F_O3 => NULL ()
  SELF%O3 => NULL ()
  IF (ASSOCIATED (SELF%F_O3_F)) CALL DELETE_TEMPORARY (SELF%F_O3_F)
  SELF%F_O3_F => NULL ()
  SELF%O3_F => NULL ()
  IF (ASSOCIATED (SELF%F_SRC)) CALL DELETE_TEMPORARY (SELF%F_SRC)
  SELF%F_SRC => NULL ()
  SELF%SRC => NULL ()
  IF (ASSOCIATED (SELF%F_SRC_F)) CALL DELETE_TEMPORARY (SELF%F_SRC_F)
  SELF%F_SRC_F => NULL ()
  SELF%SRC_F => NULL ()
  IF (ASSOCIATED (SELF%F_MXL)) CALL DELETE_TEMPORARY (SELF%F_MXL)
  SELF%F_MXL => NULL ()
  SELF%MXL => NULL ()
  IF (ASSOCIATED (SELF%F_MXL_F)) CALL DELETE_TEMPORARY (SELF%F_MXL_F)
  SELF%F_MXL_F => NULL ()
  SELF%MXL_F => NULL ()
  IF (ASSOCIATED (SELF%F_SHTUR)) CALL DELETE_TEMPORARY (SELF%F_SHTUR)
  SELF%F_SHTUR => NULL ()
  SELF%SHTUR => NULL ()
  IF (ASSOCIATED (SELF%F_SHTUR_F)) CALL DELETE_TEMPORARY (SELF%F_SHTUR_F)
  SELF%F_SHTUR_F => NULL ()
  SELF%SHTUR_F => NULL ()
  IF (ASSOCIATED (SELF%F_FQTUR)) CALL DELETE_TEMPORARY (SELF%F_FQTUR)
  SELF%F_FQTUR => NULL ()
  SELF%FQTUR => NULL ()
  IF (ASSOCIATED (SELF%F_FQTUR_F)) CALL DELETE_TEMPORARY (SELF%F_FQTUR_F)
  SELF%F_FQTUR_F => NULL ()
  SELF%FQTUR_F => NULL ()
  IF (ASSOCIATED (SELF%F_FSTUR)) CALL DELETE_TEMPORARY (SELF%F_FSTUR)
  SELF%F_FSTUR => NULL ()
  SELF%FSTUR => NULL ()
  IF (ASSOCIATED (SELF%F_FSTUR_F)) CALL DELETE_TEMPORARY (SELF%F_FSTUR_F)
  SELF%F_FSTUR_F => NULL ()
  SELF%FSTUR_F => NULL ()
  IF (ASSOCIATED (SELF%F_CPF)) CALL DELETE_TEMPORARY (SELF%F_CPF)
  SELF%F_CPF => NULL ()
  SELF%CPF => NULL ()
  IF (ASSOCIATED (SELF%F_CPF_F)) CALL DELETE_TEMPORARY (SELF%F_CPF_F)
  SELF%F_CPF_F => NULL ()
  SELF%CPF_F => NULL ()
  IF (ASSOCIATED (SELF%F_SPF)) CALL DELETE_TEMPORARY (SELF%F_SPF)
  SELF%F_SPF => NULL ()
  SELF%SPF => NULL ()
  IF (ASSOCIATED (SELF%F_SPF_F)) CALL DELETE_TEMPORARY (SELF%F_SPF_F)
  SELF%F_SPF_F => NULL ()
  SELF%SPF_F => NULL ()
  IF (ASSOCIATED (SELF%F_CVGQ)) CALL DELETE_TEMPORARY (SELF%F_CVGQ)
  SELF%F_CVGQ => NULL ()
  SELF%CVGQ => NULL ()
  IF (ASSOCIATED (SELF%F_CVGQ_F)) CALL DELETE_TEMPORARY (SELF%F_CVGQ_F)
  SELF%F_CVGQ_F => NULL ()
  SELF%CVGQ_F => NULL ()
  IF (ASSOCIATED (SELF%F_QVA)) CALL DELETE_TEMPORARY (SELF%F_QVA)
  SELF%F_QVA => NULL ()
  SELF%QVA => NULL ()
  IF (ASSOCIATED (SELF%F_QVA_F)) CALL DELETE_TEMPORARY (SELF%F_QVA_F)
  SELF%F_QVA_F => NULL ()
  SELF%QVA_F => NULL ()
  IF (ASSOCIATED (SELF%F_LRCH4)) CALL DELETE_TEMPORARY (SELF%F_LRCH4)
  SELF%F_LRCH4 => NULL ()
  SELF%LRCH4 => NULL ()
  IF (ASSOCIATED (SELF%F_LRCH4_F)) CALL DELETE_TEMPORARY (SELF%F_LRCH4_F)
  SELF%F_LRCH4_F => NULL ()
  SELF%LRCH4_F => NULL ()
  IF (ASSOCIATED (SELF%F_PHYCTY)) CALL DELETE_TEMPORARY (SELF%F_PHYCTY)
  SELF%F_PHYCTY => NULL ()
  SELF%PHYCTY => NULL ()
  IF (ASSOCIATED (SELF%F_PHYCTY_F)) CALL DELETE_TEMPORARY (SELF%F_PHYCTY_F)
  SELF%F_PHYCTY_F => NULL ()
  SELF%PHYCTY_F => NULL ()
  IF (ASSOCIATED (SELF%F_RSPEC)) CALL DELETE_TEMPORARY (SELF%F_RSPEC)
  SELF%F_RSPEC => NULL ()
  SELF%RSPEC => NULL ()
  IF (ASSOCIATED (SELF%F_RSPEC_F)) CALL DELETE_TEMPORARY (SELF%F_RSPEC_F)
  SELF%F_RSPEC_F => NULL ()
  SELF%RSPEC_F => NULL ()
  IF (ASSOCIATED (SELF%F_SDSAT)) CALL DELETE_TEMPORARY (SELF%F_SDSAT)
  SELF%F_SDSAT => NULL ()
  SELF%SDSAT => NULL ()
  IF (ASSOCIATED (SELF%F_SDSAT_F)) CALL DELETE_TEMPORARY (SELF%F_SDSAT_F)
  SELF%F_SDSAT_F => NULL ()
  SELF%SDSAT_F => NULL ()
  IF (ASSOCIATED (SELF%F_CVV)) CALL DELETE_TEMPORARY (SELF%F_CVV)
  SELF%F_CVV => NULL ()
  SELF%CVV => NULL ()
  IF (ASSOCIATED (SELF%F_CVV_F)) CALL DELETE_TEMPORARY (SELF%F_CVV_F)
  SELF%F_CVV_F => NULL ()
  SELF%CVV_F => NULL ()
  IF (ASSOCIATED (SELF%F_RKTH)) CALL DELETE_TEMPORARY (SELF%F_RKTH)
  SELF%F_RKTH => NULL ()
  SELF%RKTH => NULL ()
  IF (ASSOCIATED (SELF%F_RKTH_F)) CALL DELETE_TEMPORARY (SELF%F_RKTH_F)
  SELF%F_RKTH_F => NULL ()
  SELF%RKTH_F => NULL ()
  IF (ASSOCIATED (SELF%F_RKTQV)) CALL DELETE_TEMPORARY (SELF%F_RKTQV)
  SELF%F_RKTQV => NULL ()
  SELF%RKTQV => NULL ()
  IF (ASSOCIATED (SELF%F_RKTQV_F)) CALL DELETE_TEMPORARY (SELF%F_RKTQV_F)
  SELF%F_RKTQV_F => NULL ()
  SELF%RKTQV_F => NULL ()
  IF (ASSOCIATED (SELF%F_RKTQC)) CALL DELETE_TEMPORARY (SELF%F_RKTQC)
  SELF%F_RKTQC => NULL ()
  SELF%RKTQC => NULL ()
  IF (ASSOCIATED (SELF%F_RKTQC_F)) CALL DELETE_TEMPORARY (SELF%F_RKTQC_F)
  SELF%F_RKTQC_F => NULL ()
  SELF%RKTQC_F => NULL ()
  IF (ASSOCIATED (SELF%F_UOM)) CALL DELETE_TEMPORARY (SELF%F_UOM)
  SELF%F_UOM => NULL ()
  SELF%UOM => NULL ()
  IF (ASSOCIATED (SELF%F_UOM_F)) CALL DELETE_TEMPORARY (SELF%F_UOM_F)
  SELF%F_UOM_F => NULL ()
  SELF%UOM_F => NULL ()
  IF (ASSOCIATED (SELF%F_UAL)) CALL DELETE_TEMPORARY (SELF%F_UAL)
  SELF%F_UAL => NULL ()
  SELF%UAL => NULL ()
  IF (ASSOCIATED (SELF%F_UAL_F)) CALL DELETE_TEMPORARY (SELF%F_UAL_F)
  SELF%F_UAL_F => NULL ()
  SELF%UAL_F => NULL ()
  IF (ASSOCIATED (SELF%F_DOM)) CALL DELETE_TEMPORARY (SELF%F_DOM)
  SELF%F_DOM => NULL ()
  SELF%DOM => NULL ()
  IF (ASSOCIATED (SELF%F_DOM_F)) CALL DELETE_TEMPORARY (SELF%F_DOM_F)
  SELF%F_DOM_F => NULL ()
  SELF%DOM_F => NULL ()
  IF (ASSOCIATED (SELF%F_DAL)) CALL DELETE_TEMPORARY (SELF%F_DAL)
  SELF%F_DAL => NULL ()
  SELF%DAL => NULL ()
  IF (ASSOCIATED (SELF%F_DAL_F)) CALL DELETE_TEMPORARY (SELF%F_DAL_F)
  SELF%F_DAL_F => NULL ()
  SELF%DAL_F => NULL ()
  IF (ASSOCIATED (SELF%F_UEN)) CALL DELETE_TEMPORARY (SELF%F_UEN)
  SELF%F_UEN => NULL ()
  SELF%UEN => NULL ()
  IF (ASSOCIATED (SELF%F_UEN_F)) CALL DELETE_TEMPORARY (SELF%F_UEN_F)
  SELF%F_UEN_F => NULL ()
  SELF%UEN_F => NULL ()
  IF (ASSOCIATED (SELF%F_UNEBH)) CALL DELETE_TEMPORARY (SELF%F_UNEBH)
  SELF%F_UNEBH => NULL ()
  SELF%UNEBH => NULL ()
  IF (ASSOCIATED (SELF%F_UNEBH_F)) CALL DELETE_TEMPORARY (SELF%F_UNEBH_F)
  SELF%F_UNEBH_F => NULL ()
  SELF%UNEBH_F => NULL ()
  IF (ASSOCIATED (SELF%F_FSD)) CALL DELETE_TEMPORARY (SELF%F_FSD)
  SELF%F_FSD => NULL ()
  SELF%FSD => NULL ()
  IF (ASSOCIATED (SELF%F_FSD_F)) CALL DELETE_TEMPORARY (SELF%F_FSD_F)
  SELF%F_FSD_F => NULL ()
  SELF%FSD_F => NULL ()

END SUBROUTINE CPG_SL1_TYPE_FINAL

SUBROUTINE CPG_SL2_TYPE_INIT (SELF, REGISTRY, NLEV, YDTPTRSLB2 &
                                & , PERSISTENT, PB2)

USE PTRSLB2, ONLY : TPTRSLB2
USE OML_MOD, ONLY: OML_MAX_THREADS


CLASS (CPG_SL2_TYPE)                         :: SELF
TYPE (FIELD_REGISTRY),              INTENT (INOUT) :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TPTRSLB2),              INTENT (IN)    :: YDTPTRSLB2
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PB2 (:, :, :)

INTEGER (KIND=JPIM) :: JFLD

LOGICAL :: LLPERSISTENT

LLPERSISTENT = .FALSE.
IF (PRESENT (PERSISTENT)) LLPERSISTENT = PERSISTENT

SELF%NLEV = NLEV

IF (PRESENT (PB2)) THEN
  SELF%ZDATA => PB2
  SELF%LOWNED = .FALSE.
  LLPERSISTENT = .TRUE.
ELSEIF (LLPERSISTENT) THEN
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, YDTPTRSLB2%NFLDSLB2, REGISTRY%GEOM%YRDIM%NGPBLKS))
  SELF%LOWNED = .TRUE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, YDTPTRSLB2%NFLDSLB2, OML_MAX_THREADS ()))
  SELF%LOWNED = .TRUE.
ENDIF

SELF%F_DATA => CREATE_FIELD_WRAP (SELF%ZDATA, PERSISTENT=LLPERSISTENT)

IF (YDTPTRSLB2%MSLB2DBBC1 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2DBBC1
  SELF%F_DBBC1 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_DBBC1 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2DPHI1 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2DPHI1
  SELF%F_DPHI1 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_DPHI1 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2USI > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2USI
  SELF%F_USI => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_USI => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2VSI > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2VSI
  SELF%F_VSI => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VSI => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2TSI > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2TSI
  SELF%F_TSI => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_TSI => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2PDSI > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2PDSI
  SELF%F_PDSI => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_PDSI => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2VDSI > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2VDSI
  SELF%F_VDSI => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VDSI => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2SPSI > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2SPSI
  SELF%F_SPSI => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_SPSI => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2VVEL > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2VVEL
  SELF%F_VVEL => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VVEL => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2URL > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2URL
  SELF%F_URL => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_URL => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2VRL > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2VRL
  SELF%F_VRL => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VRL => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2WRL > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2WRL
  SELF%F_WRL => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_WRL => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2URL5 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2URL5
  SELF%F_URL5 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_URL5 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2VRL5 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2VRL5
  SELF%F_VRL5 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VRL5 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2WRL5 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2WRL5
  SELF%F_WRL5 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_WRL5 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2USI5 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2USI5
  SELF%F_USI5 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_USI5 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2VSI5 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2VSI5
  SELF%F_VSI5 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_VSI5 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2U15 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2U15
  SELF%F_U15 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_U15 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2V15 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2V15
  SELF%F_V15 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_V15 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2T15 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2T15
  SELF%F_T15 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_T15 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2Q15 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2Q15
  SELF%F_Q15 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_Q15 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2KAPPA > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2KAPPA
  SELF%F_KAPPA => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_KAPPA => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2KAPPAT > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2KAPPAT
  SELF%F_KAPPAT => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_KAPPAT => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2KAPPAM > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2KAPPAM
  SELF%F_KAPPAM => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_KAPPAM => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2KAPPAH > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2KAPPAH
  SELF%F_KAPPAH => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_KAPPAH => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2KAPPA5 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2KAPPA5
  SELF%F_KAPPA5 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_KAPPA5 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2KAPPAT5 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2KAPPAT5
  SELF%F_KAPPAT5 => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_KAPPAT5 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2GWF > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2GWF
  SELF%F_GWF => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_GWF => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2GDW > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2GDW
  SELF%F_GDW => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_GDW => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2GWS > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2GWS
  SELF%F_GWS => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_GWS => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2STDDISU > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2STDDISU
  SELF%F_STDDISU => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_STDDISU => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2STDDISV > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2STDDISV
  SELF%F_STDDISV => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_STDDISV => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2STDDISW > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2STDDISW
  SELF%F_STDDISW => CREATE_FIELD_WRAP (SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT)
ELSE
  SELF%F_STDDISW => NULL ()
ENDIF


END SUBROUTINE CPG_SL2_TYPE_INIT

SUBROUTINE CPG_SL2_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_SL2_TYPE)        :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN
  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)
  IF (ASSOCIATED (SELF%F_DBBC1)) THEN
    SELF%DBBC1 => SELF%F_DBBC1%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%DBBC1 => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_DPHI1)) THEN
    SELF%DPHI1 => SELF%F_DPHI1%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%DPHI1 => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_USI)) THEN
    SELF%USI (1:, 0:) => SELF%F_USI%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%USI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VSI)) THEN
    SELF%VSI (1:, 0:) => SELF%F_VSI%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VSI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TSI)) THEN
    SELF%TSI (1:, 0:) => SELF%F_TSI%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%TSI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_PDSI)) THEN
    SELF%PDSI (1:, 0:) => SELF%F_PDSI%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%PDSI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VDSI)) THEN
    SELF%VDSI (1:, 0:) => SELF%F_VDSI%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VDSI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_SPSI)) THEN
    SELF%SPSI (1:, 0:) => SELF%F_SPSI%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%SPSI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VVEL)) THEN
    SELF%VVEL (1:, 0:) => SELF%F_VVEL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VVEL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_URL)) THEN
    SELF%URL (1:, 0:) => SELF%F_URL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%URL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VRL)) THEN
    SELF%VRL (1:, 0:) => SELF%F_VRL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VRL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_WRL)) THEN
    SELF%WRL (1:, 0:) => SELF%F_WRL%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%WRL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_URL5)) THEN
    SELF%URL5 (1:, 0:) => SELF%F_URL5%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%URL5 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VRL5)) THEN
    SELF%VRL5 (1:, 0:) => SELF%F_VRL5%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VRL5 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_WRL5)) THEN
    SELF%WRL5 (1:, 0:) => SELF%F_WRL5%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%WRL5 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_USI5)) THEN
    SELF%USI5 (1:, 0:) => SELF%F_USI5%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%USI5 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VSI5)) THEN
    SELF%VSI5 (1:, 0:) => SELF%F_VSI5%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%VSI5 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_U15)) THEN
    SELF%U15 (1:, 0:) => SELF%F_U15%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%U15 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_V15)) THEN
    SELF%V15 (1:, 0:) => SELF%F_V15%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%V15 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_T15)) THEN
    SELF%T15 (1:, 0:) => SELF%F_T15%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%T15 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_Q15)) THEN
    SELF%Q15 (1:, 0:) => SELF%F_Q15%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%Q15 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_KAPPA)) THEN
    SELF%KAPPA (1:, 0:) => SELF%F_KAPPA%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%KAPPA => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_KAPPAT)) THEN
    SELF%KAPPAT (1:, 0:) => SELF%F_KAPPAT%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%KAPPAT => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_KAPPAM)) THEN
    SELF%KAPPAM (1:, 0:) => SELF%F_KAPPAM%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%KAPPAM => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_KAPPAH)) THEN
    SELF%KAPPAH (1:, 0:) => SELF%F_KAPPAH%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%KAPPAH => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_KAPPA5)) THEN
    SELF%KAPPA5 (1:, 0:) => SELF%F_KAPPA5%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%KAPPA5 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_KAPPAT5)) THEN
    SELF%KAPPAT5 (1:, 0:) => SELF%F_KAPPAT5%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%KAPPAT5 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_GWF)) THEN
    SELF%GWF (1:, 0:) => SELF%F_GWF%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%GWF => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_GDW)) THEN
    SELF%GDW (1:, 0:) => SELF%F_GDW%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%GDW => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_GWS)) THEN
    SELF%GWS (1:, 0:) => SELF%F_GWS%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%GWS => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_STDDISU)) THEN
    SELF%STDDISU (1:, 0:) => SELF%F_STDDISU%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%STDDISU => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_STDDISV)) THEN
    SELF%STDDISV (1:, 0:) => SELF%F_STDDISV%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%STDDISV => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_STDDISW)) THEN
    SELF%STDDISW (1:, 0:) => SELF%F_STDDISW%GET_VIEW (BLOCK_INDEX)
  ELSE
    SELF%STDDISW => ZDUM2
  ENDIF


ELSE
  SELF%ZVIEW => ZDUM2

  SELF%DBBC1 => ZDUM1
  SELF%DPHI1 => ZDUM1
  SELF%USI => ZDUM2
  SELF%VSI => ZDUM2
  SELF%TSI => ZDUM2
  SELF%PDSI => ZDUM2
  SELF%VDSI => ZDUM2
  SELF%SPSI => ZDUM2
  SELF%VVEL => ZDUM2
  SELF%URL => ZDUM2
  SELF%VRL => ZDUM2
  SELF%WRL => ZDUM2
  SELF%URL5 => ZDUM2
  SELF%VRL5 => ZDUM2
  SELF%WRL5 => ZDUM2
  SELF%USI5 => ZDUM2
  SELF%VSI5 => ZDUM2
  SELF%U15 => ZDUM2
  SELF%V15 => ZDUM2
  SELF%T15 => ZDUM2
  SELF%Q15 => ZDUM2
  SELF%KAPPA => ZDUM2
  SELF%KAPPAT => ZDUM2
  SELF%KAPPAM => ZDUM2
  SELF%KAPPAH => ZDUM2
  SELF%KAPPA5 => ZDUM2
  SELF%KAPPAT5 => ZDUM2
  SELF%GWF => ZDUM2
  SELF%GDW => ZDUM2
  SELF%GWS => ZDUM2
  SELF%STDDISU => ZDUM2
  SELF%STDDISV => ZDUM2
  SELF%STDDISW => ZDUM2


ENDIF

END SUBROUTINE CPG_SL2_TYPE_UPDATE_VIEW

SUBROUTINE CPG_SL2_TYPE_FINAL (SELF)
CLASS (CPG_SL2_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_DATA)) CALL DELETE_TEMPORARY (SELF%F_DATA)
SELF%F_DATA => NULL ()

IF (SELF%LOWNED) THEN
  DEALLOCATE (SELF%ZDATA)
ENDIF

SELF%ZDATA => NULL ()
SELF%ZVIEW => NULL ()

  IF (ASSOCIATED (SELF%F_DBBC1)) CALL DELETE_TEMPORARY (SELF%F_DBBC1)
  SELF%F_DBBC1 => NULL ()
  SELF%DBBC1 => NULL ()
  IF (ASSOCIATED (SELF%F_DPHI1)) CALL DELETE_TEMPORARY (SELF%F_DPHI1)
  SELF%F_DPHI1 => NULL ()
  SELF%DPHI1 => NULL ()
  IF (ASSOCIATED (SELF%F_USI)) CALL DELETE_TEMPORARY (SELF%F_USI)
  SELF%F_USI => NULL ()
  SELF%USI => NULL ()
  IF (ASSOCIATED (SELF%F_VSI)) CALL DELETE_TEMPORARY (SELF%F_VSI)
  SELF%F_VSI => NULL ()
  SELF%VSI => NULL ()
  IF (ASSOCIATED (SELF%F_TSI)) CALL DELETE_TEMPORARY (SELF%F_TSI)
  SELF%F_TSI => NULL ()
  SELF%TSI => NULL ()
  IF (ASSOCIATED (SELF%F_PDSI)) CALL DELETE_TEMPORARY (SELF%F_PDSI)
  SELF%F_PDSI => NULL ()
  SELF%PDSI => NULL ()
  IF (ASSOCIATED (SELF%F_VDSI)) CALL DELETE_TEMPORARY (SELF%F_VDSI)
  SELF%F_VDSI => NULL ()
  SELF%VDSI => NULL ()
  IF (ASSOCIATED (SELF%F_SPSI)) CALL DELETE_TEMPORARY (SELF%F_SPSI)
  SELF%F_SPSI => NULL ()
  SELF%SPSI => NULL ()
  IF (ASSOCIATED (SELF%F_VVEL)) CALL DELETE_TEMPORARY (SELF%F_VVEL)
  SELF%F_VVEL => NULL ()
  SELF%VVEL => NULL ()
  IF (ASSOCIATED (SELF%F_URL)) CALL DELETE_TEMPORARY (SELF%F_URL)
  SELF%F_URL => NULL ()
  SELF%URL => NULL ()
  IF (ASSOCIATED (SELF%F_VRL)) CALL DELETE_TEMPORARY (SELF%F_VRL)
  SELF%F_VRL => NULL ()
  SELF%VRL => NULL ()
  IF (ASSOCIATED (SELF%F_WRL)) CALL DELETE_TEMPORARY (SELF%F_WRL)
  SELF%F_WRL => NULL ()
  SELF%WRL => NULL ()
  IF (ASSOCIATED (SELF%F_URL5)) CALL DELETE_TEMPORARY (SELF%F_URL5)
  SELF%F_URL5 => NULL ()
  SELF%URL5 => NULL ()
  IF (ASSOCIATED (SELF%F_VRL5)) CALL DELETE_TEMPORARY (SELF%F_VRL5)
  SELF%F_VRL5 => NULL ()
  SELF%VRL5 => NULL ()
  IF (ASSOCIATED (SELF%F_WRL5)) CALL DELETE_TEMPORARY (SELF%F_WRL5)
  SELF%F_WRL5 => NULL ()
  SELF%WRL5 => NULL ()
  IF (ASSOCIATED (SELF%F_USI5)) CALL DELETE_TEMPORARY (SELF%F_USI5)
  SELF%F_USI5 => NULL ()
  SELF%USI5 => NULL ()
  IF (ASSOCIATED (SELF%F_VSI5)) CALL DELETE_TEMPORARY (SELF%F_VSI5)
  SELF%F_VSI5 => NULL ()
  SELF%VSI5 => NULL ()
  IF (ASSOCIATED (SELF%F_U15)) CALL DELETE_TEMPORARY (SELF%F_U15)
  SELF%F_U15 => NULL ()
  SELF%U15 => NULL ()
  IF (ASSOCIATED (SELF%F_V15)) CALL DELETE_TEMPORARY (SELF%F_V15)
  SELF%F_V15 => NULL ()
  SELF%V15 => NULL ()
  IF (ASSOCIATED (SELF%F_T15)) CALL DELETE_TEMPORARY (SELF%F_T15)
  SELF%F_T15 => NULL ()
  SELF%T15 => NULL ()
  IF (ASSOCIATED (SELF%F_Q15)) CALL DELETE_TEMPORARY (SELF%F_Q15)
  SELF%F_Q15 => NULL ()
  SELF%Q15 => NULL ()
  IF (ASSOCIATED (SELF%F_KAPPA)) CALL DELETE_TEMPORARY (SELF%F_KAPPA)
  SELF%F_KAPPA => NULL ()
  SELF%KAPPA => NULL ()
  IF (ASSOCIATED (SELF%F_KAPPAT)) CALL DELETE_TEMPORARY (SELF%F_KAPPAT)
  SELF%F_KAPPAT => NULL ()
  SELF%KAPPAT => NULL ()
  IF (ASSOCIATED (SELF%F_KAPPAM)) CALL DELETE_TEMPORARY (SELF%F_KAPPAM)
  SELF%F_KAPPAM => NULL ()
  SELF%KAPPAM => NULL ()
  IF (ASSOCIATED (SELF%F_KAPPAH)) CALL DELETE_TEMPORARY (SELF%F_KAPPAH)
  SELF%F_KAPPAH => NULL ()
  SELF%KAPPAH => NULL ()
  IF (ASSOCIATED (SELF%F_KAPPA5)) CALL DELETE_TEMPORARY (SELF%F_KAPPA5)
  SELF%F_KAPPA5 => NULL ()
  SELF%KAPPA5 => NULL ()
  IF (ASSOCIATED (SELF%F_KAPPAT5)) CALL DELETE_TEMPORARY (SELF%F_KAPPAT5)
  SELF%F_KAPPAT5 => NULL ()
  SELF%KAPPAT5 => NULL ()
  IF (ASSOCIATED (SELF%F_GWF)) CALL DELETE_TEMPORARY (SELF%F_GWF)
  SELF%F_GWF => NULL ()
  SELF%GWF => NULL ()
  IF (ASSOCIATED (SELF%F_GDW)) CALL DELETE_TEMPORARY (SELF%F_GDW)
  SELF%F_GDW => NULL ()
  SELF%GDW => NULL ()
  IF (ASSOCIATED (SELF%F_GWS)) CALL DELETE_TEMPORARY (SELF%F_GWS)
  SELF%F_GWS => NULL ()
  SELF%GWS => NULL ()
  IF (ASSOCIATED (SELF%F_STDDISU)) CALL DELETE_TEMPORARY (SELF%F_STDDISU)
  SELF%F_STDDISU => NULL ()
  SELF%STDDISU => NULL ()
  IF (ASSOCIATED (SELF%F_STDDISV)) CALL DELETE_TEMPORARY (SELF%F_STDDISV)
  SELF%F_STDDISV => NULL ()
  SELF%STDDISV => NULL ()
  IF (ASSOCIATED (SELF%F_STDDISW)) CALL DELETE_TEMPORARY (SELF%F_STDDISW)
  SELF%F_STDDISW => NULL ()
  SELF%STDDISW => NULL ()


END SUBROUTINE CPG_SL2_TYPE_FINAL

END MODULE CPG_TYPE_MOD

