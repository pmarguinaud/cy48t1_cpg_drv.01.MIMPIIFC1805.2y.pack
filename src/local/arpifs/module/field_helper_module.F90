


MODULE FIELD_HELPER_MODULE

USE FIELD_MODULE
USE YOMHOOK

INTERFACE CREATE_TEMPORARY_LU
  MODULE PROCEDURE CREATE_TEMPORARY_2D_LU
  MODULE PROCEDURE CREATE_TEMPORARY_3D_LU
  MODULE PROCEDURE CREATE_TEMPORARY_4D_LU
  MODULE PROCEDURE CREATE_TEMPORARY_5D_LU
  MODULE PROCEDURE CREATE_TEMPORARY_INT2D_LU
  MODULE PROCEDURE CREATE_TEMPORARY_INT3D_LU
  MODULE PROCEDURE CREATE_TEMPORARY_LOG2D_LU
END INTERFACE CREATE_TEMPORARY_LU

INTERFACE GET_HOST_DATA_RDONLY
  MODULE PROCEDURE :: FIELD_2D_GET_HOST_DATA_RDONLY
  MODULE PROCEDURE :: FIELD_3D_GET_HOST_DATA_RDONLY
  MODULE PROCEDURE :: FIELD_4D_GET_HOST_DATA_RDONLY
  MODULE PROCEDURE :: FIELD_5D_GET_HOST_DATA_RDONLY
  MODULE PROCEDURE :: FIELD_INT2D_GET_HOST_DATA_RDONLY
  MODULE PROCEDURE :: FIELD_INT3D_GET_HOST_DATA_RDONLY
  MODULE PROCEDURE :: FIELD_INT4D_GET_HOST_DATA_RDONLY
  MODULE PROCEDURE :: FIELD_INT5D_GET_HOST_DATA_RDONLY
  MODULE PROCEDURE :: FIELD_LOG2D_GET_HOST_DATA_RDONLY
  MODULE PROCEDURE :: FIELD_LOG3D_GET_HOST_DATA_RDONLY
  MODULE PROCEDURE :: FIELD_LOG4D_GET_HOST_DATA_RDONLY
  MODULE PROCEDURE :: FIELD_LOG5D_GET_HOST_DATA_RDONLY
END INTERFACE GET_HOST_DATA_RDONLY

INTERFACE GET_HOST_DATA_WRONLY
  MODULE PROCEDURE :: FIELD_2D_GET_HOST_DATA_WRONLY
  MODULE PROCEDURE :: FIELD_3D_GET_HOST_DATA_WRONLY
  MODULE PROCEDURE :: FIELD_4D_GET_HOST_DATA_WRONLY
  MODULE PROCEDURE :: FIELD_5D_GET_HOST_DATA_WRONLY
  MODULE PROCEDURE :: FIELD_INT2D_GET_HOST_DATA_WRONLY
  MODULE PROCEDURE :: FIELD_INT3D_GET_HOST_DATA_WRONLY
  MODULE PROCEDURE :: FIELD_INT4D_GET_HOST_DATA_WRONLY
  MODULE PROCEDURE :: FIELD_INT5D_GET_HOST_DATA_WRONLY
  MODULE PROCEDURE :: FIELD_LOG2D_GET_HOST_DATA_WRONLY
  MODULE PROCEDURE :: FIELD_LOG3D_GET_HOST_DATA_WRONLY
  MODULE PROCEDURE :: FIELD_LOG4D_GET_HOST_DATA_WRONLY
  MODULE PROCEDURE :: FIELD_LOG5D_GET_HOST_DATA_WRONLY
END INTERFACE GET_HOST_DATA_WRONLY

INTERFACE GET_HOST_DATA_RDWR
  MODULE PROCEDURE :: FIELD_2D_GET_HOST_DATA_RDWR
  MODULE PROCEDURE :: FIELD_3D_GET_HOST_DATA_RDWR
  MODULE PROCEDURE :: FIELD_4D_GET_HOST_DATA_RDWR
  MODULE PROCEDURE :: FIELD_5D_GET_HOST_DATA_RDWR
  MODULE PROCEDURE :: FIELD_INT2D_GET_HOST_DATA_RDWR
  MODULE PROCEDURE :: FIELD_INT3D_GET_HOST_DATA_RDWR
  MODULE PROCEDURE :: FIELD_INT4D_GET_HOST_DATA_RDWR
  MODULE PROCEDURE :: FIELD_INT5D_GET_HOST_DATA_RDWR
  MODULE PROCEDURE :: FIELD_LOG2D_GET_HOST_DATA_RDWR
  MODULE PROCEDURE :: FIELD_LOG3D_GET_HOST_DATA_RDWR
  MODULE PROCEDURE :: FIELD_LOG4D_GET_HOST_DATA_RDWR
  MODULE PROCEDURE :: FIELD_LOG5D_GET_HOST_DATA_RDWR
END INTERFACE GET_HOST_DATA_RDWR

CONTAINS

  FUNCTION FIELD_2D_GET_HOST_DATA_RDONLY(SELF) RESULT(PTR)
    TYPE(FIELD_2D), POINTER, INTENT (IN) :: SELF
    REAL(KIND=JPRB), TARGET, SAVE :: ZDUM (0, 1)
    REAL(KIND=JPRB), POINTER :: PTR(:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_2D_GET_HOST_DATA_RDONLY

  FUNCTION FIELD_2D_GET_HOST_DATA_WRONLY(SELF) RESULT(PTR)
    TYPE(FIELD_2D), POINTER, INTENT (IN) :: SELF
    REAL(KIND=JPRB), TARGET, SAVE :: ZDUM (0, 1)
    REAL(KIND=JPRB), POINTER :: PTR(:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_2D_GET_HOST_DATA_WRONLY

  FUNCTION FIELD_2D_GET_HOST_DATA_RDWR(SELF) RESULT(PTR)
    TYPE(FIELD_2D), POINTER, INTENT (IN) :: SELF
    REAL(KIND=JPRB), TARGET, SAVE :: ZDUM (0, 1)
    REAL(KIND=JPRB), POINTER :: PTR(:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_2D_GET_HOST_DATA_RDWR

  FUNCTION FIELD_3D_GET_HOST_DATA_RDONLY(SELF) RESULT(PTR)
    TYPE(FIELD_3D), POINTER, INTENT (IN) :: SELF
    REAL(KIND=JPRB), TARGET, SAVE :: ZDUM (0, 0, 1)
    REAL(KIND=JPRB), POINTER :: PTR(:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_3D_GET_HOST_DATA_RDONLY

  FUNCTION FIELD_3D_GET_HOST_DATA_WRONLY(SELF) RESULT(PTR)
    TYPE(FIELD_3D), POINTER, INTENT (IN) :: SELF
    REAL(KIND=JPRB), TARGET, SAVE :: ZDUM (0, 0, 1)
    REAL(KIND=JPRB), POINTER :: PTR(:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_3D_GET_HOST_DATA_WRONLY

  FUNCTION FIELD_3D_GET_HOST_DATA_RDWR(SELF) RESULT(PTR)
    TYPE(FIELD_3D), POINTER, INTENT (IN) :: SELF
    REAL(KIND=JPRB), TARGET, SAVE :: ZDUM (0, 0, 1)
    REAL(KIND=JPRB), POINTER :: PTR(:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_3D_GET_HOST_DATA_RDWR

  FUNCTION FIELD_4D_GET_HOST_DATA_RDONLY(SELF) RESULT(PTR)
    TYPE(FIELD_4D), POINTER, INTENT (IN) :: SELF
    REAL(KIND=JPRB), TARGET, SAVE :: ZDUM (0, 0, 0, 1)
    REAL(KIND=JPRB), POINTER :: PTR(:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_4D_GET_HOST_DATA_RDONLY

  FUNCTION FIELD_4D_GET_HOST_DATA_WRONLY(SELF) RESULT(PTR)
    TYPE(FIELD_4D), POINTER, INTENT (IN) :: SELF
    REAL(KIND=JPRB), TARGET, SAVE :: ZDUM (0, 0, 0, 1)
    REAL(KIND=JPRB), POINTER :: PTR(:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_4D_GET_HOST_DATA_WRONLY

  FUNCTION FIELD_4D_GET_HOST_DATA_RDWR(SELF) RESULT(PTR)
    TYPE(FIELD_4D), POINTER, INTENT (IN) :: SELF
    REAL(KIND=JPRB), TARGET, SAVE :: ZDUM (0, 0, 0, 1)
    REAL(KIND=JPRB), POINTER :: PTR(:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_4D_GET_HOST_DATA_RDWR

  FUNCTION FIELD_5D_GET_HOST_DATA_RDONLY(SELF) RESULT(PTR)
    TYPE(FIELD_5D), POINTER, INTENT (IN) :: SELF
    REAL(KIND=JPRB), TARGET, SAVE :: ZDUM (0, 0, 0, 0, 1)
    REAL(KIND=JPRB), POINTER :: PTR(:,:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):, SELF%LBOUNDS(5):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_5D_GET_HOST_DATA_RDONLY

  FUNCTION FIELD_5D_GET_HOST_DATA_WRONLY(SELF) RESULT(PTR)
    TYPE(FIELD_5D), POINTER, INTENT (IN) :: SELF
    REAL(KIND=JPRB), TARGET, SAVE :: ZDUM (0, 0, 0, 0, 1)
    REAL(KIND=JPRB), POINTER :: PTR(:,:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):, SELF%LBOUNDS(5):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_5D_GET_HOST_DATA_WRONLY

  FUNCTION FIELD_5D_GET_HOST_DATA_RDWR(SELF) RESULT(PTR)
    TYPE(FIELD_5D), POINTER, INTENT (IN) :: SELF
    REAL(KIND=JPRB), TARGET, SAVE :: ZDUM (0, 0, 0, 0, 1)
    REAL(KIND=JPRB), POINTER :: PTR(:,:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):, SELF%LBOUNDS(5):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_5D_GET_HOST_DATA_RDWR

  FUNCTION FIELD_INT2D_GET_HOST_DATA_RDONLY(SELF) RESULT(PTR)
    TYPE(FIELD_INT2D), POINTER, INTENT (IN) :: SELF
    INTEGER(KIND=JPIM), TARGET, SAVE :: ZDUM (0, 1)
    INTEGER(KIND=JPIM), POINTER :: PTR(:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_INT2D_GET_HOST_DATA_RDONLY

  FUNCTION FIELD_INT2D_GET_HOST_DATA_WRONLY(SELF) RESULT(PTR)
    TYPE(FIELD_INT2D), POINTER, INTENT (IN) :: SELF
    INTEGER(KIND=JPIM), TARGET, SAVE :: ZDUM (0, 1)
    INTEGER(KIND=JPIM), POINTER :: PTR(:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_INT2D_GET_HOST_DATA_WRONLY

  FUNCTION FIELD_INT2D_GET_HOST_DATA_RDWR(SELF) RESULT(PTR)
    TYPE(FIELD_INT2D), POINTER, INTENT (IN) :: SELF
    INTEGER(KIND=JPIM), TARGET, SAVE :: ZDUM (0, 1)
    INTEGER(KIND=JPIM), POINTER :: PTR(:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_INT2D_GET_HOST_DATA_RDWR

  FUNCTION FIELD_INT3D_GET_HOST_DATA_RDONLY(SELF) RESULT(PTR)
    TYPE(FIELD_INT3D), POINTER, INTENT (IN) :: SELF
    INTEGER(KIND=JPIM), TARGET, SAVE :: ZDUM (0, 0, 1)
    INTEGER(KIND=JPIM), POINTER :: PTR(:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_INT3D_GET_HOST_DATA_RDONLY

  FUNCTION FIELD_INT3D_GET_HOST_DATA_WRONLY(SELF) RESULT(PTR)
    TYPE(FIELD_INT3D), POINTER, INTENT (IN) :: SELF
    INTEGER(KIND=JPIM), TARGET, SAVE :: ZDUM (0, 0, 1)
    INTEGER(KIND=JPIM), POINTER :: PTR(:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_INT3D_GET_HOST_DATA_WRONLY

  FUNCTION FIELD_INT3D_GET_HOST_DATA_RDWR(SELF) RESULT(PTR)
    TYPE(FIELD_INT3D), POINTER, INTENT (IN) :: SELF
    INTEGER(KIND=JPIM), TARGET, SAVE :: ZDUM (0, 0, 1)
    INTEGER(KIND=JPIM), POINTER :: PTR(:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_INT3D_GET_HOST_DATA_RDWR

  FUNCTION FIELD_INT4D_GET_HOST_DATA_RDONLY(SELF) RESULT(PTR)
    TYPE(FIELD_INT4D), POINTER, INTENT (IN) :: SELF
    INTEGER(KIND=JPIM), TARGET, SAVE :: ZDUM (0, 0, 0, 1)
    INTEGER(KIND=JPIM), POINTER :: PTR(:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_INT4D_GET_HOST_DATA_RDONLY

  FUNCTION FIELD_INT4D_GET_HOST_DATA_WRONLY(SELF) RESULT(PTR)
    TYPE(FIELD_INT4D), POINTER, INTENT (IN) :: SELF
    INTEGER(KIND=JPIM), TARGET, SAVE :: ZDUM (0, 0, 0, 1)
    INTEGER(KIND=JPIM), POINTER :: PTR(:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_INT4D_GET_HOST_DATA_WRONLY

  FUNCTION FIELD_INT4D_GET_HOST_DATA_RDWR(SELF) RESULT(PTR)
    TYPE(FIELD_INT4D), POINTER, INTENT (IN) :: SELF
    INTEGER(KIND=JPIM), TARGET, SAVE :: ZDUM (0, 0, 0, 1)
    INTEGER(KIND=JPIM), POINTER :: PTR(:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_INT4D_GET_HOST_DATA_RDWR

  FUNCTION FIELD_INT5D_GET_HOST_DATA_RDONLY(SELF) RESULT(PTR)
    TYPE(FIELD_INT5D), POINTER, INTENT (IN) :: SELF
    INTEGER(KIND=JPIM), TARGET, SAVE :: ZDUM (0, 0, 0, 0, 1)
    INTEGER(KIND=JPIM), POINTER :: PTR(:,:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):, SELF%LBOUNDS(5):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_INT5D_GET_HOST_DATA_RDONLY

  FUNCTION FIELD_INT5D_GET_HOST_DATA_WRONLY(SELF) RESULT(PTR)
    TYPE(FIELD_INT5D), POINTER, INTENT (IN) :: SELF
    INTEGER(KIND=JPIM), TARGET, SAVE :: ZDUM (0, 0, 0, 0, 1)
    INTEGER(KIND=JPIM), POINTER :: PTR(:,:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):, SELF%LBOUNDS(5):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_INT5D_GET_HOST_DATA_WRONLY

  FUNCTION FIELD_INT5D_GET_HOST_DATA_RDWR(SELF) RESULT(PTR)
    TYPE(FIELD_INT5D), POINTER, INTENT (IN) :: SELF
    INTEGER(KIND=JPIM), TARGET, SAVE :: ZDUM (0, 0, 0, 0, 1)
    INTEGER(KIND=JPIM), POINTER :: PTR(:,:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):, SELF%LBOUNDS(5):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_INT5D_GET_HOST_DATA_RDWR

  FUNCTION FIELD_LOG2D_GET_HOST_DATA_RDONLY(SELF) RESULT(PTR)
    TYPE(FIELD_LOG2D), POINTER, INTENT (IN) :: SELF
    LOGICAL, TARGET, SAVE :: ZDUM (0, 1)
    LOGICAL, POINTER :: PTR(:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_LOG2D_GET_HOST_DATA_RDONLY

  FUNCTION FIELD_LOG2D_GET_HOST_DATA_WRONLY(SELF) RESULT(PTR)
    TYPE(FIELD_LOG2D), POINTER, INTENT (IN) :: SELF
    LOGICAL, TARGET, SAVE :: ZDUM (0, 1)
    LOGICAL, POINTER :: PTR(:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_LOG2D_GET_HOST_DATA_WRONLY

  FUNCTION FIELD_LOG2D_GET_HOST_DATA_RDWR(SELF) RESULT(PTR)
    TYPE(FIELD_LOG2D), POINTER, INTENT (IN) :: SELF
    LOGICAL, TARGET, SAVE :: ZDUM (0, 1)
    LOGICAL, POINTER :: PTR(:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_LOG2D_GET_HOST_DATA_RDWR

  FUNCTION FIELD_LOG3D_GET_HOST_DATA_RDONLY(SELF) RESULT(PTR)
    TYPE(FIELD_LOG3D), POINTER, INTENT (IN) :: SELF
    LOGICAL, TARGET, SAVE :: ZDUM (0, 0, 1)
    LOGICAL, POINTER :: PTR(:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_LOG3D_GET_HOST_DATA_RDONLY

  FUNCTION FIELD_LOG3D_GET_HOST_DATA_WRONLY(SELF) RESULT(PTR)
    TYPE(FIELD_LOG3D), POINTER, INTENT (IN) :: SELF
    LOGICAL, TARGET, SAVE :: ZDUM (0, 0, 1)
    LOGICAL, POINTER :: PTR(:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_LOG3D_GET_HOST_DATA_WRONLY

  FUNCTION FIELD_LOG3D_GET_HOST_DATA_RDWR(SELF) RESULT(PTR)
    TYPE(FIELD_LOG3D), POINTER, INTENT (IN) :: SELF
    LOGICAL, TARGET, SAVE :: ZDUM (0, 0, 1)
    LOGICAL, POINTER :: PTR(:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_LOG3D_GET_HOST_DATA_RDWR

  FUNCTION FIELD_LOG4D_GET_HOST_DATA_RDONLY(SELF) RESULT(PTR)
    TYPE(FIELD_LOG4D), POINTER, INTENT (IN) :: SELF
    LOGICAL, TARGET, SAVE :: ZDUM (0, 0, 0, 1)
    LOGICAL, POINTER :: PTR(:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_LOG4D_GET_HOST_DATA_RDONLY

  FUNCTION FIELD_LOG4D_GET_HOST_DATA_WRONLY(SELF) RESULT(PTR)
    TYPE(FIELD_LOG4D), POINTER, INTENT (IN) :: SELF
    LOGICAL, TARGET, SAVE :: ZDUM (0, 0, 0, 1)
    LOGICAL, POINTER :: PTR(:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_LOG4D_GET_HOST_DATA_WRONLY

  FUNCTION FIELD_LOG4D_GET_HOST_DATA_RDWR(SELF) RESULT(PTR)
    TYPE(FIELD_LOG4D), POINTER, INTENT (IN) :: SELF
    LOGICAL, TARGET, SAVE :: ZDUM (0, 0, 0, 1)
    LOGICAL, POINTER :: PTR(:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_LOG4D_GET_HOST_DATA_RDWR

  FUNCTION FIELD_LOG5D_GET_HOST_DATA_RDONLY(SELF) RESULT(PTR)
    TYPE(FIELD_LOG5D), POINTER, INTENT (IN) :: SELF
    LOGICAL, TARGET, SAVE :: ZDUM (0, 0, 0, 0, 1)
    LOGICAL, POINTER :: PTR(:,:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):, SELF%LBOUNDS(5):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_LOG5D_GET_HOST_DATA_RDONLY

  FUNCTION FIELD_LOG5D_GET_HOST_DATA_WRONLY(SELF) RESULT(PTR)
    TYPE(FIELD_LOG5D), POINTER, INTENT (IN) :: SELF
    LOGICAL, TARGET, SAVE :: ZDUM (0, 0, 0, 0, 1)
    LOGICAL, POINTER :: PTR(:,:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):, SELF%LBOUNDS(5):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_LOG5D_GET_HOST_DATA_WRONLY

  FUNCTION FIELD_LOG5D_GET_HOST_DATA_RDWR(SELF) RESULT(PTR)
    TYPE(FIELD_LOG5D), POINTER, INTENT (IN) :: SELF
    LOGICAL, TARGET, SAVE :: ZDUM (0, 0, 0, 0, 1)
    LOGICAL, POINTER :: PTR(:,:,:,:,:)

    IF (ASSOCIATED (SELF)) THEN
      PTR (SELF%LBOUNDS(1):, SELF%LBOUNDS(2):, SELF%LBOUNDS(3):, SELF%LBOUNDS(4):, SELF%LBOUNDS(5):) => SELF%PTR
    ELSE
      PTR => ZDUM
    ENDIF

  END FUNCTION FIELD_LOG5D_GET_HOST_DATA_RDWR



  SUBROUTINE CREATE_TEMPORARY_2D_LU (FIELD_PTR, UBOUNDS, LBOUNDS, PERSISTENT) 

    TYPE(FIELD_2D), POINTER :: FIELD_PTR
    INTEGER(KIND=JPIM), INTENT(IN) :: UBOUNDS (2)
    INTEGER(KIND=JPIM), OPTIONAL, INTENT(IN) :: LBOUNDS (2)
    LOGICAL, OPTIONAL, INTENT(IN) :: PERSISTENT
    INTEGER(KIND=JPIM) :: NBLOCKS
    INTEGER(KIND=JPIM) :: ISIZE (2)
    REAL(KIND=JPRB) :: ZHOOK_HANDLE, ZHOOK_HANDLE_1

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_2D_LU', 0, ZHOOK_HANDLE)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_2D_LU:PART1', 0, ZHOOK_HANDLE_1)
    ISIZE = UBOUNDS
    IF (PRESENT (LBOUNDS)) ISIZE = ISIZE - LBOUNDS + 1

    ALLOCATE(FIELD_PTR)
    NBLOCKS = UBOUNDS (2)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_2D_LU:PART1', 1, ZHOOK_HANDLE_1)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_2D_LU:PART2', 0, ZHOOK_HANDLE_1)
    CALL ALLOCATE_FIELD (FIELD_PTR, SHAPE=ISIZE(1:2-1), NBLOCKS=NBLOCKS, PERSISTENT=PERSISTENT, LBOUNDS=LBOUNDS)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_2D_LU:PART2', 1, ZHOOK_HANDLE_1)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_2D_LU:PART3', 0, ZHOOK_HANDLE_1)
    IF (FIELD_PTR%OWNED) FIELD_PTR%PTR => FIELD_PTR%DATA
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_2D_LU:PART3', 1, ZHOOK_HANDLE_1)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_2D_LU', 1, ZHOOK_HANDLE)

  END SUBROUTINE CREATE_TEMPORARY_2D_LU

  SUBROUTINE CREATE_TEMPORARY_3D_LU (FIELD_PTR, UBOUNDS, LBOUNDS, PERSISTENT) 

    TYPE(FIELD_3D), POINTER :: FIELD_PTR
    INTEGER(KIND=JPIM), INTENT(IN) :: UBOUNDS (3)
    INTEGER(KIND=JPIM), OPTIONAL, INTENT(IN) :: LBOUNDS (3)
    LOGICAL, OPTIONAL, INTENT(IN) :: PERSISTENT
    INTEGER(KIND=JPIM) :: NBLOCKS
    INTEGER(KIND=JPIM) :: ISIZE (3)
    REAL(KIND=JPRB) :: ZHOOK_HANDLE, ZHOOK_HANDLE_1

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_3D_LU', 0, ZHOOK_HANDLE)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_3D_LU:PART1', 0, ZHOOK_HANDLE_1)
    ISIZE = UBOUNDS
    IF (PRESENT (LBOUNDS)) ISIZE = ISIZE - LBOUNDS + 1

    ALLOCATE(FIELD_PTR)
    NBLOCKS = UBOUNDS (3)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_3D_LU:PART1', 1, ZHOOK_HANDLE_1)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_3D_LU:PART2', 0, ZHOOK_HANDLE_1)
    CALL ALLOCATE_FIELD (FIELD_PTR, SHAPE=ISIZE(1:3-1), NBLOCKS=NBLOCKS, PERSISTENT=PERSISTENT, LBOUNDS=LBOUNDS)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_3D_LU:PART2', 1, ZHOOK_HANDLE_1)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_3D_LU:PART3', 0, ZHOOK_HANDLE_1)
    IF (FIELD_PTR%OWNED) FIELD_PTR%PTR => FIELD_PTR%DATA
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_3D_LU:PART3', 1, ZHOOK_HANDLE_1)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_3D_LU', 1, ZHOOK_HANDLE)

  END SUBROUTINE CREATE_TEMPORARY_3D_LU

  SUBROUTINE CREATE_TEMPORARY_4D_LU (FIELD_PTR, UBOUNDS, LBOUNDS, PERSISTENT) 

    TYPE(FIELD_4D), POINTER :: FIELD_PTR
    INTEGER(KIND=JPIM), INTENT(IN) :: UBOUNDS (4)
    INTEGER(KIND=JPIM), OPTIONAL, INTENT(IN) :: LBOUNDS (4)
    LOGICAL, OPTIONAL, INTENT(IN) :: PERSISTENT
    INTEGER(KIND=JPIM) :: NBLOCKS
    INTEGER(KIND=JPIM) :: ISIZE (4)
    REAL(KIND=JPRB) :: ZHOOK_HANDLE, ZHOOK_HANDLE_1

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_4D_LU', 0, ZHOOK_HANDLE)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_4D_LU:PART1', 0, ZHOOK_HANDLE_1)
    ISIZE = UBOUNDS
    IF (PRESENT (LBOUNDS)) ISIZE = ISIZE - LBOUNDS + 1

    ALLOCATE(FIELD_PTR)
    NBLOCKS = UBOUNDS (4)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_4D_LU:PART1', 1, ZHOOK_HANDLE_1)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_4D_LU:PART2', 0, ZHOOK_HANDLE_1)
    CALL ALLOCATE_FIELD (FIELD_PTR, SHAPE=ISIZE(1:4-1), NBLOCKS=NBLOCKS, PERSISTENT=PERSISTENT, LBOUNDS=LBOUNDS)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_4D_LU:PART2', 1, ZHOOK_HANDLE_1)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_4D_LU:PART3', 0, ZHOOK_HANDLE_1)
    IF (FIELD_PTR%OWNED) FIELD_PTR%PTR => FIELD_PTR%DATA
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_4D_LU:PART3', 1, ZHOOK_HANDLE_1)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_4D_LU', 1, ZHOOK_HANDLE)

  END SUBROUTINE CREATE_TEMPORARY_4D_LU

  SUBROUTINE CREATE_TEMPORARY_5D_LU (FIELD_PTR, UBOUNDS, LBOUNDS, PERSISTENT) 

    TYPE(FIELD_5D), POINTER :: FIELD_PTR
    INTEGER(KIND=JPIM), INTENT(IN) :: UBOUNDS (5)
    INTEGER(KIND=JPIM), OPTIONAL, INTENT(IN) :: LBOUNDS (5)
    LOGICAL, OPTIONAL, INTENT(IN) :: PERSISTENT
    INTEGER(KIND=JPIM) :: NBLOCKS
    INTEGER(KIND=JPIM) :: ISIZE (5)
    REAL(KIND=JPRB) :: ZHOOK_HANDLE, ZHOOK_HANDLE_1

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_5D_LU', 0, ZHOOK_HANDLE)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_5D_LU:PART1', 0, ZHOOK_HANDLE_1)
    ISIZE = UBOUNDS
    IF (PRESENT (LBOUNDS)) ISIZE = ISIZE - LBOUNDS + 1

    ALLOCATE(FIELD_PTR)
    NBLOCKS = UBOUNDS (5)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_5D_LU:PART1', 1, ZHOOK_HANDLE_1)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_5D_LU:PART2', 0, ZHOOK_HANDLE_1)
    CALL ALLOCATE_FIELD (FIELD_PTR, SHAPE=ISIZE(1:5-1), NBLOCKS=NBLOCKS, PERSISTENT=PERSISTENT, LBOUNDS=LBOUNDS)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_5D_LU:PART2', 1, ZHOOK_HANDLE_1)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_5D_LU:PART3', 0, ZHOOK_HANDLE_1)
    IF (FIELD_PTR%OWNED) FIELD_PTR%PTR => FIELD_PTR%DATA
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_5D_LU:PART3', 1, ZHOOK_HANDLE_1)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_5D_LU', 1, ZHOOK_HANDLE)

  END SUBROUTINE CREATE_TEMPORARY_5D_LU

  SUBROUTINE CREATE_TEMPORARY_INT2D_LU (FIELD_PTR, UBOUNDS, LBOUNDS, PERSISTENT) 

    TYPE(FIELD_INT2D), POINTER :: FIELD_PTR
    INTEGER(KIND=JPIM), INTENT(IN) :: UBOUNDS (2)
    INTEGER(KIND=JPIM), OPTIONAL, INTENT(IN) :: LBOUNDS (2)
    LOGICAL, OPTIONAL, INTENT(IN) :: PERSISTENT
    INTEGER(KIND=JPIM) :: NBLOCKS
    INTEGER(KIND=JPIM) :: ISIZE (2)
    REAL(KIND=JPRB) :: ZHOOK_HANDLE, ZHOOK_HANDLE_1

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT2D_LU', 0, ZHOOK_HANDLE)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT2D_LU:PART1', 0, ZHOOK_HANDLE_1)
    ISIZE = UBOUNDS
    IF (PRESENT (LBOUNDS)) ISIZE = ISIZE - LBOUNDS + 1

    ALLOCATE(FIELD_PTR)
    NBLOCKS = UBOUNDS (2)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT2D_LU:PART1', 1, ZHOOK_HANDLE_1)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT2D_LU:PART2', 0, ZHOOK_HANDLE_1)
    CALL ALLOCATE_FIELD (FIELD_PTR, SHAPE=ISIZE(1:2-1), NBLOCKS=NBLOCKS, PERSISTENT=PERSISTENT, LBOUNDS=LBOUNDS)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT2D_LU:PART2', 1, ZHOOK_HANDLE_1)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT2D_LU:PART3', 0, ZHOOK_HANDLE_1)
    IF (FIELD_PTR%OWNED) FIELD_PTR%PTR => FIELD_PTR%DATA
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT2D_LU:PART3', 1, ZHOOK_HANDLE_1)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT2D_LU', 1, ZHOOK_HANDLE)

  END SUBROUTINE CREATE_TEMPORARY_INT2D_LU

  SUBROUTINE CREATE_TEMPORARY_INT3D_LU (FIELD_PTR, UBOUNDS, LBOUNDS, PERSISTENT) 

    TYPE(FIELD_INT3D), POINTER :: FIELD_PTR
    INTEGER(KIND=JPIM), INTENT(IN) :: UBOUNDS (3)
    INTEGER(KIND=JPIM), OPTIONAL, INTENT(IN) :: LBOUNDS (3)
    LOGICAL, OPTIONAL, INTENT(IN) :: PERSISTENT
    INTEGER(KIND=JPIM) :: NBLOCKS
    INTEGER(KIND=JPIM) :: ISIZE (3)
    REAL(KIND=JPRB) :: ZHOOK_HANDLE, ZHOOK_HANDLE_1

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT3D_LU', 0, ZHOOK_HANDLE)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT3D_LU:PART1', 0, ZHOOK_HANDLE_1)
    ISIZE = UBOUNDS
    IF (PRESENT (LBOUNDS)) ISIZE = ISIZE - LBOUNDS + 1

    ALLOCATE(FIELD_PTR)
    NBLOCKS = UBOUNDS (3)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT3D_LU:PART1', 1, ZHOOK_HANDLE_1)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT3D_LU:PART2', 0, ZHOOK_HANDLE_1)
    CALL ALLOCATE_FIELD (FIELD_PTR, SHAPE=ISIZE(1:3-1), NBLOCKS=NBLOCKS, PERSISTENT=PERSISTENT, LBOUNDS=LBOUNDS)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT3D_LU:PART2', 1, ZHOOK_HANDLE_1)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT3D_LU:PART3', 0, ZHOOK_HANDLE_1)
    IF (FIELD_PTR%OWNED) FIELD_PTR%PTR => FIELD_PTR%DATA
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT3D_LU:PART3', 1, ZHOOK_HANDLE_1)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_INT3D_LU', 1, ZHOOK_HANDLE)

  END SUBROUTINE CREATE_TEMPORARY_INT3D_LU

  SUBROUTINE CREATE_TEMPORARY_LOG2D_LU (FIELD_PTR, UBOUNDS, LBOUNDS, PERSISTENT) 

    TYPE(FIELD_LOG2D), POINTER :: FIELD_PTR
    INTEGER(KIND=JPIM), INTENT(IN) :: UBOUNDS (2)
    INTEGER(KIND=JPIM), OPTIONAL, INTENT(IN) :: LBOUNDS (2)
    LOGICAL, OPTIONAL, INTENT(IN) :: PERSISTENT
    INTEGER(KIND=JPIM) :: NBLOCKS
    INTEGER(KIND=JPIM) :: ISIZE (2)
    REAL(KIND=JPRB) :: ZHOOK_HANDLE, ZHOOK_HANDLE_1

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_LOG2D_LU', 0, ZHOOK_HANDLE)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_LOG2D_LU:PART1', 0, ZHOOK_HANDLE_1)
    ISIZE = UBOUNDS
    IF (PRESENT (LBOUNDS)) ISIZE = ISIZE - LBOUNDS + 1

    ALLOCATE(FIELD_PTR)
    NBLOCKS = UBOUNDS (2)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_LOG2D_LU:PART1', 1, ZHOOK_HANDLE_1)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_LOG2D_LU:PART2', 0, ZHOOK_HANDLE_1)
    CALL ALLOCATE_FIELD (FIELD_PTR, SHAPE=ISIZE(1:2-1), NBLOCKS=NBLOCKS, PERSISTENT=PERSISTENT, LBOUNDS=LBOUNDS)
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_LOG2D_LU:PART2', 1, ZHOOK_HANDLE_1)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_LOG2D_LU:PART3', 0, ZHOOK_HANDLE_1)
    IF (FIELD_PTR%OWNED) FIELD_PTR%PTR => FIELD_PTR%DATA
    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_LOG2D_LU:PART3', 1, ZHOOK_HANDLE_1)

    IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARY_LOG2D_LU', 1, ZHOOK_HANDLE)

  END SUBROUTINE CREATE_TEMPORARY_LOG2D_LU


END MODULE FIELD_HELPER_MODULE
