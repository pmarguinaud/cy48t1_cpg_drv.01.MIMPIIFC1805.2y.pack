
MODULE MF_PHYS_BASE_STATE_TYPE_MOD

USE PARKIND1, ONLY : JPIM, JPRB
USE CPG_TYPE_MOD, ONLY : CPG_DYN_TYPE, CPG_PHY_TYPE
USE FIELD_MODULE
IMPLICIT NONE


TYPE MF_PHYS_STATE_GSP_SG_TYPE
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: F (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: F (NPROMA, YDCPG_OPTS%YRSURF_DIMS%YSP_GSP_SG)
  TYPE (FIELD_3D), POINTER :: F_F => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: A (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: A (NPROMA, YDCPG_OPTS%YRSURF_DIMS%YSP_GSP_SG)
  TYPE (FIELD_3D), POINTER :: F_A => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: R (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: R (NPROMA, YDCPG_OPTS%YRSURF_DIMS%YSP_GSP_SG)
  TYPE (FIELD_3D), POINTER :: F_R => NULL ()
END TYPE MF_PHYS_STATE_GSP_SG_TYPE

TYPE MF_PHYS_STATE_GSP_RR_TYPE
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: T (:) => NULL ()
!>REAL (KIND=JPRB)                      :: T (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_T => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FC (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FC (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: W (:) => NULL ()
!>REAL (KIND=JPRB)                      :: W (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_W => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: IC (:) => NULL ()
!>REAL (KIND=JPRB)                      :: IC (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_IC => NULL ()
END TYPE MF_PHYS_STATE_GSP_RR_TYPE

TYPE MF_PHYS_STATE_GSP_SB_TYPE
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: Q (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: Q (NPROMA, YDCPG_OPTS%YRSURF_DIMS%YSP_GSP_SB)
  TYPE (FIELD_3D), POINTER :: F_Q => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TL (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: TL (NPROMA, YDCPG_OPTS%YRSURF_DIMS%YSP_GSP_SB)
  TYPE (FIELD_3D), POINTER :: F_TL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: T (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: T (NPROMA, YDCPG_OPTS%YRSURF_DIMS%YSP_GSP_SB)
  TYPE (FIELD_3D), POINTER :: F_T => NULL ()
END TYPE MF_PHYS_STATE_GSP_SB_TYPE


TYPE MF_PHYS_BASE_STATE_TYPE
  TYPE (CPG_DYN_TYPE) :: YCPG_DYN    
!>TYPE (CPG_DYN_TYPE) :: YCPG_DYN
  TYPE (CPG_PHY_TYPE) :: YCPG_PHY    
!>TYPE (CPG_PHY_TYPE) :: YCPG_PHY    
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P1EXT  (:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P1CHEM (:,:,:) => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P1NOGW (:,:)   => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P2NOGW (:,:)   => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P1LIMA (:,:,:) => NULL ()
  
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CVV (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: CVV (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_CVV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIV (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: DIV (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_DIV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EFB1 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: EFB1 (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_EFB1 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EFB2 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: EFB2 (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_EFB2 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EFB3 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: EFB3 (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_EFB3 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: G (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: G (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_G => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: H (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: H (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_H => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: I (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: I (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_I => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: L (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: L (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_L => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: O3 (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: O3 (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_O3 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: Q (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: Q (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_Q => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: R (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: R (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_R => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: S (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: S (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_S => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SRC (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: SRC (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_SRC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: T (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: T (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_T => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TKE (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: TKE (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_TKE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: U (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: U (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_U => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: V (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: V (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_V => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VOR (:,:) => NULL ()
!>REAL (KIND=JPRB)                      :: VOR (NPROMA,1:NLEV)
  TYPE (FIELD_3D), POINTER :: F_VOR => NULL ()

  TYPE (MF_PHYS_STATE_GSP_SG_TYPE) :: YGSP_SG
  TYPE (MF_PHYS_STATE_GSP_RR_TYPE) :: YGSP_RR
  TYPE (MF_PHYS_STATE_GSP_SB_TYPE) :: YGSP_SB

CONTAINS

  PROCEDURE :: INIT => MF_PHYS_BASE_STATE_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => MF_PHYS_BASE_STATE_TYPE_UPDATE_VIEW

END TYPE MF_PHYS_BASE_STATE_TYPE

CONTAINS


SUBROUTINE MF_PHYS_BASE_STATE_TYPE_INIT (SELF, YDCPG_DYN0, YDCPG_DYN9, YDCPG_PHY0, YDCPG_PHY9, YDVARS, YDMF_PHYS_SURF, YDMODEL, PGFL)

USE MF_PHYS_SURFACE_TYPE_MOD,ONLY : MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD, ONLY: FIELD_VARIABLES
USE SC2PRG_MOD         , ONLY : SC2PRG
USE TYPE_MODEL         , ONLY : MODEL
USE YOMCT0             , ONLY : LTWOTL

CLASS (MF_PHYS_BASE_STATE_TYPE)        :: SELF
TYPE (MF_PHYS_SURF_TYPE),INTENT(IN)    :: YDMF_PHYS_SURF
TYPE (CPG_DYN_TYPE),    INTENT (IN)    :: YDCPG_DYN0, YDCPG_DYN9
TYPE (CPG_PHY_TYPE),    INTENT (IN)    :: YDCPG_PHY0, YDCPG_PHY9
TYPE (FIELD_VARIABLES), INTENT (IN)    :: YDVARS
TYPE(MODEL),            INTENT (IN)    :: YDMODEL
REAL (KIND=JPRB), TARGET, OPTIONAL :: PGFL (:,:,:)
REAL (KIND=JPRB), TARGET, SAVE :: ZDUM2 (1, 1), ZDUM3 (1, 1, 1)

REAL(KIND=JPRB), POINTER :: ZP1CHEM0(:,:,:), ZP1CHEM9(:,:,:)
REAL(KIND=JPRB), POINTER :: ZP1EXT0(:,:,:), ZP1EXT9(:,:,:)
REAL(KIND=JPRB), POINTER :: ZP1LIMA0(:,:,:), ZP1LIMA9(:,:,:)
REAL(KIND=JPRB), POINTER :: ZP1NOGW0(:,:), ZP1NOGW9(:,:), ZP2NOGW0(:,:), ZP2NOGW9(:,:)


ZP1CHEM0 => ZDUM3
ZP1CHEM9 => ZDUM3
ZP1LIMA0 => ZDUM3
ZP1LIMA9 => ZDUM3
ZP1EXT0  => ZDUM3
ZP1EXT9  => ZDUM3

ZP1NOGW0 => ZDUM2
ZP1NOGW9 => ZDUM2
ZP2NOGW0 => ZDUM2
ZP2NOGW9 => ZDUM2


IF (PRESENT (PGFL)) THEN
  CALL SC2PRG (1, YDMODEL%YRML_GCONF%YGFL%YCHEM(:)%MP , YDMODEL%YRML_GCONF%YGFL%NCHEM,    PGFL, ZP1CHEM0)    !  YDVARS%CHEM(1)%T0
  CALL SC2PRG (1, YDMODEL%YRML_GCONF%YGFL%YCHEM(:)%MP9, YDMODEL%YRML_GCONF%YGFL%NCHEM,    PGFL, ZP1CHEM9)    !  YDVARS%CHEM(1)%T9
  CALL SC2PRG (1, YDMODEL%YRML_GCONF%YGFL%YLIMA(:)%MP , YDMODEL%YRML_GCONF%YGFL%NLIMA,    PGFL, ZP1LIMA0)    !  YDVARS%LIMA(1)%T0
  CALL SC2PRG (1, YDMODEL%YRML_GCONF%YGFL%YLIMA(:)%MP9, YDMODEL%YRML_GCONF%YGFL%NLIMA,    PGFL, ZP1LIMA9)    !  YDVARS%LIMA(1)%T9
  CALL SC2PRG (1, YDMODEL%YRML_GCONF%YGFL%YEXT(:)%MP  , YDMODEL%YRML_GCONF%YGFL%NGFL_EXT, PGFL, ZP1EXT0 )    !  YDVARS%EXT(1)%T0
  CALL SC2PRG (1, YDMODEL%YRML_GCONF%YGFL%YEXT(:)%MP9 , YDMODEL%YRML_GCONF%YGFL%NGFL_EXT, PGFL, ZP1EXT9 )    !  YDVARS%EXT(1)%T9

  CALL SC2PRG (1, YDMODEL%YRML_GCONF%YGFL%YNOGW(:)%MP , PGFL ,ZP1NOGW0)    !  YDVARS%NOGW(1)%T0
  CALL SC2PRG (1, YDMODEL%YRML_GCONF%YGFL%YNOGW(:)%MP9, PGFL ,ZP1NOGW9)    !  YDVARS%NOGW(1)%T9 
  CALL SC2PRG (2, YDMODEL%YRML_GCONF%YGFL%YNOGW(:)%MP , PGFL ,ZP2NOGW0)    !  YDVARS%NOGW(2)%T0
  CALL SC2PRG (2, YDMODEL%YRML_GCONF%YGFL%YNOGW(:)%MP9, PGFL ,ZP2NOGW9)    !  YDVARS%NOGW(2)%T9 
ENDIF


IF (LTWOTL) THEN
  SELF%YCPG_DYN = YDCPG_DYN0
  SELF%YCPG_PHY = YDCPG_PHY0

  SELF%P1EXT  => ZP1EXT0
  SELF%P1CHEM => ZP1CHEM0
  SELF%P1NOGW => ZP1NOGW0
  SELF%P2NOGW => ZP2NOGW0
  SELF%P1LIMA => ZP1LIMA0

  SELF%CVV (LBOUND (YDVARS%CVV%T0,1):, LBOUND (YDVARS%CVV%T0,2):) => YDVARS%CVV%T0
  SELF%F_CVV => YDVARS%CVV%FT0
  SELF%DIV (LBOUND (YDVARS%DIV%T0,1):, LBOUND (YDVARS%DIV%T0,2):) => YDVARS%DIV%T0
  SELF%F_DIV => YDVARS%DIV%FT0
  SELF%EFB1 (LBOUND (YDVARS%EFB1%T0,1):, LBOUND (YDVARS%EFB1%T0,2):) => YDVARS%EFB1%T0
  SELF%F_EFB1 => YDVARS%EFB1%FT0
  SELF%EFB2 (LBOUND (YDVARS%EFB2%T0,1):, LBOUND (YDVARS%EFB2%T0,2):) => YDVARS%EFB2%T0
  SELF%F_EFB2 => YDVARS%EFB2%FT0
  SELF%EFB3 (LBOUND (YDVARS%EFB3%T0,1):, LBOUND (YDVARS%EFB3%T0,2):) => YDVARS%EFB3%T0
  SELF%F_EFB3 => YDVARS%EFB3%FT0
  SELF%G (LBOUND (YDVARS%G%T0,1):, LBOUND (YDVARS%G%T0,2):) => YDVARS%G%T0
  SELF%F_G => YDVARS%G%FT0
  SELF%H (LBOUND (YDVARS%H%T0,1):, LBOUND (YDVARS%H%T0,2):) => YDVARS%H%T0
  SELF%F_H => YDVARS%H%FT0
  SELF%I (LBOUND (YDVARS%I%T0,1):, LBOUND (YDVARS%I%T0,2):) => YDVARS%I%T0
  SELF%F_I => YDVARS%I%FT0
  SELF%L (LBOUND (YDVARS%L%T0,1):, LBOUND (YDVARS%L%T0,2):) => YDVARS%L%T0
  SELF%F_L => YDVARS%L%FT0
  SELF%O3 (LBOUND (YDVARS%O3%T0,1):, LBOUND (YDVARS%O3%T0,2):) => YDVARS%O3%T0
  SELF%F_O3 => YDVARS%O3%FT0
  SELF%Q (LBOUND (YDVARS%Q%T0,1):, LBOUND (YDVARS%Q%T0,2):) => YDVARS%Q%T0
  SELF%F_Q => YDVARS%Q%FT0
  SELF%R (LBOUND (YDVARS%R%T0,1):, LBOUND (YDVARS%R%T0,2):) => YDVARS%R%T0
  SELF%F_R => YDVARS%R%FT0
  SELF%S (LBOUND (YDVARS%S%T0,1):, LBOUND (YDVARS%S%T0,2):) => YDVARS%S%T0
  SELF%F_S => YDVARS%S%FT0
  SELF%SRC (LBOUND (YDVARS%SRC%T0,1):, LBOUND (YDVARS%SRC%T0,2):) => YDVARS%SRC%T0
  SELF%F_SRC => YDVARS%SRC%FT0
  SELF%T (LBOUND (YDVARS%T%T0,1):, LBOUND (YDVARS%T%T0,2):) => YDVARS%T%T0
  SELF%F_T => YDVARS%T%FT0
  SELF%TKE (LBOUND (YDVARS%TKE%T0,1):, LBOUND (YDVARS%TKE%T0,2):) => YDVARS%TKE%T0
  SELF%F_TKE => YDVARS%TKE%FT0
  SELF%U (LBOUND (YDVARS%U%T0,1):, LBOUND (YDVARS%U%T0,2):) => YDVARS%U%T0
  SELF%F_U => YDVARS%U%FT0
  SELF%V (LBOUND (YDVARS%V%T0,1):, LBOUND (YDVARS%V%T0,2):) => YDVARS%V%T0
  SELF%F_V => YDVARS%V%FT0
  SELF%VOR (LBOUND (YDVARS%VOR%T0,1):, LBOUND (YDVARS%VOR%T0,2):) => YDVARS%VOR%T0
  SELF%F_VOR => YDVARS%VOR%FT0

  SELF%YGSP_SG%F ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_SG%PF_T0, 1):  &
                     & ,LBOUND (YDMF_PHYS_SURF%GSP_SG%PF_T0, 2):  &
                     &  ) => YDMF_PHYS_SURF%GSP_SG%PF_T0
  SELF%YGSP_SG%F_F => YDMF_PHYS_SURF%GSP_SG%F_F_T0

  SELF%YGSP_SG%A ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_SG%PA_T0, 1):  &
                     & ,LBOUND (YDMF_PHYS_SURF%GSP_SG%PA_T0, 2):  &
                     &  ) => YDMF_PHYS_SURF%GSP_SG%PA_T0
  SELF%YGSP_SG%F_A => YDMF_PHYS_SURF%GSP_SG%F_A_T0

  SELF%YGSP_SG%R ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_SG%PR_T0, 1):  &
                     & ,LBOUND (YDMF_PHYS_SURF%GSP_SG%PR_T0, 2):  &
                     &  ) => YDMF_PHYS_SURF%GSP_SG%PR_T0
  SELF%YGSP_SG%F_R => YDMF_PHYS_SURF%GSP_SG%F_R_T0

  SELF%YGSP_RR%T ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_RR%PT_T0, 1):  &
                     &  ) => YDMF_PHYS_SURF%GSP_RR%PT_T0
  SELF%YGSP_RR%F_T => YDMF_PHYS_SURF%GSP_RR%F_T_T0

  SELF%YGSP_RR%FC ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_RR%PFC_T0, 1):  &
                     &  ) => YDMF_PHYS_SURF%GSP_RR%PFC_T0
  SELF%YGSP_RR%F_FC => YDMF_PHYS_SURF%GSP_RR%F_FC_T0

  SELF%YGSP_RR%W ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_RR%PW_T0, 1):  &
                     &  ) => YDMF_PHYS_SURF%GSP_RR%PW_T0
  SELF%YGSP_RR%F_W => YDMF_PHYS_SURF%GSP_RR%F_W_T0

  SELF%YGSP_RR%IC ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_RR%PIC_T0, 1):  &
                     &  ) => YDMF_PHYS_SURF%GSP_RR%PIC_T0
  SELF%YGSP_RR%F_IC => YDMF_PHYS_SURF%GSP_RR%F_IC_T0

  SELF%YGSP_SB%Q ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_SB%PQ_T0, 1):  &
                     & ,LBOUND (YDMF_PHYS_SURF%GSP_SB%PQ_T0, 2):  &
                     &  ) => YDMF_PHYS_SURF%GSP_SB%PQ_T0
  SELF%YGSP_SB%F_Q => YDMF_PHYS_SURF%GSP_SB%F_Q_T0

  SELF%YGSP_SB%TL ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_SB%PTL_T0, 1):  &
                     & ,LBOUND (YDMF_PHYS_SURF%GSP_SB%PTL_T0, 2):  &
                     &  ) => YDMF_PHYS_SURF%GSP_SB%PTL_T0
  SELF%YGSP_SB%F_TL => YDMF_PHYS_SURF%GSP_SB%F_TL_T0

  SELF%YGSP_SB%T ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_SB%PT_T0, 1):  &
                     & ,LBOUND (YDMF_PHYS_SURF%GSP_SB%PT_T0, 2):  &
                     &  ) => YDMF_PHYS_SURF%GSP_SB%PT_T0
  SELF%YGSP_SB%F_T => YDMF_PHYS_SURF%GSP_SB%F_T_T0


ELSE
  SELF%YCPG_DYN = YDCPG_DYN9
  SELF%YCPG_PHY = YDCPG_PHY9

  SELF%P1EXT  => ZP1EXT9
  SELF%P1CHEM => ZP1CHEM9
  SELF%P1NOGW => ZP1NOGW9
  SELF%P2NOGW => ZP2NOGW9
  SELF%P1LIMA => ZP1LIMA9

  SELF%CVV (LBOUND (YDVARS%CVV%T9,1):, LBOUND (YDVARS%CVV%T9,2):) => YDVARS%CVV%T9
  SELF%F_CVV => YDVARS%CVV%FT9
  SELF%DIV (LBOUND (YDVARS%DIV%T9,1):, LBOUND (YDVARS%DIV%T9,2):) => YDVARS%DIV%T9
  SELF%F_DIV => YDVARS%DIV%FT9
  SELF%EFB1 (LBOUND (YDVARS%EFB1%T9,1):, LBOUND (YDVARS%EFB1%T9,2):) => YDVARS%EFB1%T9
  SELF%F_EFB1 => YDVARS%EFB1%FT9
  SELF%EFB2 (LBOUND (YDVARS%EFB2%T9,1):, LBOUND (YDVARS%EFB2%T9,2):) => YDVARS%EFB2%T9
  SELF%F_EFB2 => YDVARS%EFB2%FT9
  SELF%EFB3 (LBOUND (YDVARS%EFB3%T9,1):, LBOUND (YDVARS%EFB3%T9,2):) => YDVARS%EFB3%T9
  SELF%F_EFB3 => YDVARS%EFB3%FT9
  SELF%G (LBOUND (YDVARS%G%T9,1):, LBOUND (YDVARS%G%T9,2):) => YDVARS%G%T9
  SELF%F_G => YDVARS%G%FT9
  SELF%H (LBOUND (YDVARS%H%T9,1):, LBOUND (YDVARS%H%T9,2):) => YDVARS%H%T9
  SELF%F_H => YDVARS%H%FT9
  SELF%I (LBOUND (YDVARS%I%T9,1):, LBOUND (YDVARS%I%T9,2):) => YDVARS%I%T9
  SELF%F_I => YDVARS%I%FT9
  SELF%L (LBOUND (YDVARS%L%T9,1):, LBOUND (YDVARS%L%T9,2):) => YDVARS%L%T9
  SELF%F_L => YDVARS%L%FT9
  SELF%O3 (LBOUND (YDVARS%O3%T9,1):, LBOUND (YDVARS%O3%T9,2):) => YDVARS%O3%T9
  SELF%F_O3 => YDVARS%O3%FT9
  SELF%Q (LBOUND (YDVARS%Q%T9,1):, LBOUND (YDVARS%Q%T9,2):) => YDVARS%Q%T9
  SELF%F_Q => YDVARS%Q%FT9
  SELF%R (LBOUND (YDVARS%R%T9,1):, LBOUND (YDVARS%R%T9,2):) => YDVARS%R%T9
  SELF%F_R => YDVARS%R%FT9
  SELF%S (LBOUND (YDVARS%S%T9,1):, LBOUND (YDVARS%S%T9,2):) => YDVARS%S%T9
  SELF%F_S => YDVARS%S%FT9
  SELF%SRC (LBOUND (YDVARS%SRC%T9,1):, LBOUND (YDVARS%SRC%T9,2):) => YDVARS%SRC%T9
  SELF%F_SRC => YDVARS%SRC%FT9
  SELF%T (LBOUND (YDVARS%T%T9,1):, LBOUND (YDVARS%T%T9,2):) => YDVARS%T%T9
  SELF%F_T => YDVARS%T%FT9
  SELF%TKE (LBOUND (YDVARS%TKE%T9,1):, LBOUND (YDVARS%TKE%T9,2):) => YDVARS%TKE%T9
  SELF%F_TKE => YDVARS%TKE%FT9
  SELF%U (LBOUND (YDVARS%U%T9,1):, LBOUND (YDVARS%U%T9,2):) => YDVARS%U%T9
  SELF%F_U => YDVARS%U%FT9
  SELF%V (LBOUND (YDVARS%V%T9,1):, LBOUND (YDVARS%V%T9,2):) => YDVARS%V%T9
  SELF%F_V => YDVARS%V%FT9
  SELF%VOR (LBOUND (YDVARS%VOR%T9,1):, LBOUND (YDVARS%VOR%T9,2):) => YDVARS%VOR%T9
  SELF%F_VOR => YDVARS%VOR%FT9

  SELF%YGSP_SG%F ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_SG%PF_T9, 1):  &
                     & ,LBOUND (YDMF_PHYS_SURF%GSP_SG%PF_T9, 2):  &
                     &  ) => YDMF_PHYS_SURF%GSP_SG%PF_T9
  SELF%YGSP_SG%F_F => YDMF_PHYS_SURF%GSP_SG%F_F_T9

  SELF%YGSP_SG%A ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_SG%PA_T9, 1):  &
                     & ,LBOUND (YDMF_PHYS_SURF%GSP_SG%PA_T9, 2):  &
                     &  ) => YDMF_PHYS_SURF%GSP_SG%PA_T9
  SELF%YGSP_SG%F_A => YDMF_PHYS_SURF%GSP_SG%F_A_T9

  SELF%YGSP_SG%R ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_SG%PR_T9, 1):  &
                     & ,LBOUND (YDMF_PHYS_SURF%GSP_SG%PR_T9, 2):  &
                     &  ) => YDMF_PHYS_SURF%GSP_SG%PR_T9
  SELF%YGSP_SG%F_R => YDMF_PHYS_SURF%GSP_SG%F_R_T9

  SELF%YGSP_RR%T ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_RR%PT_T9, 1):  &
                     &  ) => YDMF_PHYS_SURF%GSP_RR%PT_T9
  SELF%YGSP_RR%F_T => YDMF_PHYS_SURF%GSP_RR%F_T_T9

  SELF%YGSP_RR%FC ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_RR%PFC_T9, 1):  &
                     &  ) => YDMF_PHYS_SURF%GSP_RR%PFC_T9
  SELF%YGSP_RR%F_FC => YDMF_PHYS_SURF%GSP_RR%F_FC_T9

  SELF%YGSP_RR%W ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_RR%PW_T9, 1):  &
                     &  ) => YDMF_PHYS_SURF%GSP_RR%PW_T9
  SELF%YGSP_RR%F_W => YDMF_PHYS_SURF%GSP_RR%F_W_T9

  SELF%YGSP_RR%IC ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_RR%PIC_T9, 1):  &
                     &  ) => YDMF_PHYS_SURF%GSP_RR%PIC_T9
  SELF%YGSP_RR%F_IC => YDMF_PHYS_SURF%GSP_RR%F_IC_T9

  SELF%YGSP_SB%Q ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_SB%PQ_T9, 1):  &
                     & ,LBOUND (YDMF_PHYS_SURF%GSP_SB%PQ_T9, 2):  &
                     &  ) => YDMF_PHYS_SURF%GSP_SB%PQ_T9
  SELF%YGSP_SB%F_Q => YDMF_PHYS_SURF%GSP_SB%F_Q_T9

  SELF%YGSP_SB%TL ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_SB%PTL_T9, 1):  &
                     & ,LBOUND (YDMF_PHYS_SURF%GSP_SB%PTL_T9, 2):  &
                     &  ) => YDMF_PHYS_SURF%GSP_SB%PTL_T9
  SELF%YGSP_SB%F_TL => YDMF_PHYS_SURF%GSP_SB%F_TL_T9

  SELF%YGSP_SB%T ( &
                     &  LBOUND (YDMF_PHYS_SURF%GSP_SB%PT_T9, 1):  &
                     & ,LBOUND (YDMF_PHYS_SURF%GSP_SB%PT_T9, 2):  &
                     &  ) => YDMF_PHYS_SURF%GSP_SB%PT_T9
  SELF%YGSP_SB%F_T => YDMF_PHYS_SURF%GSP_SB%F_T_T9


ENDIF

END SUBROUTINE MF_PHYS_BASE_STATE_TYPE_INIT

SUBROUTINE MF_PHYS_BASE_STATE_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)
CLASS (MF_PHYS_BASE_STATE_TYPE)              :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

CALL SELF%YCPG_DYN%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%YCPG_PHY%UPDATE_VIEW (BLOCK_INDEX)

IF (ASSOCIATED (SELF%F_CVV)) THEN
  SELF%CVV => SELF%F_CVV%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_DIV)) THEN
  SELF%DIV => SELF%F_DIV%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_EFB1)) THEN
  SELF%EFB1 => SELF%F_EFB1%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_EFB2)) THEN
  SELF%EFB2 => SELF%F_EFB2%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_EFB3)) THEN
  SELF%EFB3 => SELF%F_EFB3%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_G)) THEN
  SELF%G => SELF%F_G%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_H)) THEN
  SELF%H => SELF%F_H%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_I)) THEN
  SELF%I => SELF%F_I%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_L)) THEN
  SELF%L => SELF%F_L%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_O3)) THEN
  SELF%O3 => SELF%F_O3%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_Q)) THEN
  SELF%Q => SELF%F_Q%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_R)) THEN
  SELF%R => SELF%F_R%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_S)) THEN
  SELF%S => SELF%F_S%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_SRC)) THEN
  SELF%SRC => SELF%F_SRC%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_T)) THEN
  SELF%T => SELF%F_T%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_TKE)) THEN
  SELF%TKE => SELF%F_TKE%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_U)) THEN
  SELF%U => SELF%F_U%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_V)) THEN
  SELF%V => SELF%F_V%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%F_VOR)) THEN
  SELF%VOR => SELF%F_VOR%GET_VIEW (BLOCK_INDEX)
ENDIF

IF (ASSOCIATED (SELF%YGSP_SG%F_F)) THEN
  SELF%YGSP_SG%F => SELF%YGSP_SG%F_F%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%YGSP_SG%F_A)) THEN
  SELF%YGSP_SG%A => SELF%YGSP_SG%F_A%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%YGSP_SG%F_R)) THEN
  SELF%YGSP_SG%R => SELF%YGSP_SG%F_R%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%YGSP_RR%F_T)) THEN
  SELF%YGSP_RR%T => SELF%YGSP_RR%F_T%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%YGSP_RR%F_FC)) THEN
  SELF%YGSP_RR%FC => SELF%YGSP_RR%F_FC%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%YGSP_RR%F_W)) THEN
  SELF%YGSP_RR%W => SELF%YGSP_RR%F_W%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%YGSP_RR%F_IC)) THEN
  SELF%YGSP_RR%IC => SELF%YGSP_RR%F_IC%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%YGSP_SB%F_Q)) THEN
  SELF%YGSP_SB%Q => SELF%YGSP_SB%F_Q%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%YGSP_SB%F_TL)) THEN
  SELF%YGSP_SB%TL => SELF%YGSP_SB%F_TL%GET_VIEW (BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%YGSP_SB%F_T)) THEN
  SELF%YGSP_SB%T => SELF%YGSP_SB%F_T%GET_VIEW (BLOCK_INDEX)
ENDIF

END SUBROUTINE MF_PHYS_BASE_STATE_TYPE_UPDATE_VIEW

END MODULE MF_PHYS_BASE_STATE_TYPE_MOD
