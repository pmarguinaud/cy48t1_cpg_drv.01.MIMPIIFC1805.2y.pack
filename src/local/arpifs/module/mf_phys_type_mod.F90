MODULE MF_PHYS_TYPE_MOD

USE PARKIND1, ONLY : JPIM, JPRB
USE FIELD_MODULE
USE FIELD_REGISTRY_MOD
USE PARKIND1, ONLY : JPRB, JPIM, JPIB

IMPLICIT NONE

TYPE MF_PHYS_OUT_TYPE

  INTEGER (KIND=JPIB) :: ISIZE = 0

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIFCQ (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DIFCQ (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_DIFCQ => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIFCQL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DIFCQL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_DIFCQL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIFCQN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DIFCQN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_DIFCQN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIFCS (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DIFCS (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_DIFCS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIFTQ (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DIFTQ (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_DIFTQ => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIFTQL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DIFTQL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_DIFTQL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIFTQN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DIFTQN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_DIFTQN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIFTS (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DIFTS (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_DIFTS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EDR (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: EDR (NPROMA, 1:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_EDR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCCQL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCCQL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCCQL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCCQN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCCQN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCCQN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCSQL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCSQL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCSQL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCSQN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCSQN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCSQN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCQLNG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCQLNG (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCQLNG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCQNNG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCQNNG (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCQNNG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCQNG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCQNG (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCQNG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPLCL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPLCL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPLCL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPLCN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPLCN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPLCN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPLCG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPLCG (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPLCG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPLCH (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPLCH (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPLCH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPLSL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPLSL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPLSL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPLSN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPLSN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPLSN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPLSG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPLSG (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPLSG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPLSH (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPLSH (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPLSH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPFPSL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPFPSL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPFPSL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPFPSN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPFPSN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPFPSN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPFPSG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPFPSG (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPFPSG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPFPCL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPFPCL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPFPCL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPFPCN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPFPCN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPFPCN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPEVPSL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPEVPSL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPEVPSL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPEVPSN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPEVPSN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPEVPSN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPEVPSG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPEVPSG (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPEVPSG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPEVPCL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPEVPCL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPEVPCL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPEVPCN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPEVPCN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPEVPCN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FPEVPCG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FPEVPCG (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FPEVPCG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FRSO (:, :, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FRSO (NPROMA, 0:YDCPG_OPTS%KFLEVG, 1:YDCPG_OPTS%KTSSG+1)
  TYPE (FIELD_4D), POINTER :: F_FRSO => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FRTH (:, :, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FRTH (NPROMA, 0:YDCPG_OPTS%KFLEVG, 1:YDCPG_OPTS%KTSSG+1)
  TYPE (FIELD_4D), POINTER :: F_FRTH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: STRCU (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: STRCU (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_STRCU => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: STRCV (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: STRCV (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_STRCV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: STRDU (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: STRDU (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_STRDU => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: STRDV (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: STRDV (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_STRDV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: STRTU (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: STRTU (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_STRTU => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: STRTV (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: STRTV (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_STRTV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: STRMU (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: STRMU (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_STRMU => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: STRMV (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: STRMV (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_STRMV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIFCQLC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DIFCQLC (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_DIFCQLC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIFCQIC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: DIFCQIC (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_DIFCQIC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FIMCC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FIMCC (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FIMCC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FEDQLC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FEDQLC (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FEDQLC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FEDQIC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FEDQIC (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FEDQIC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FEDQRC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FEDQRC (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FEDQRC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FEDQSC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FEDQSC (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FEDQSC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCNEGQLC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCNEGQLC (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCNEGQLC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCNEGQIC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCNEGQIC (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCNEGQIC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCNEGQRC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCNEGQRC (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCNEGQRC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCNEGQSC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCNEGQSC (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCNEGQSC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FRMH (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FRMH (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FRMH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCHOZ (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCHOZ (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCHOZ => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FDIS (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FDIS (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FDIS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FHPSL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FHPSL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FHPSL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FHPSN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FHPSN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FHPSN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FHPSG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FHPSG (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FHPSG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FHPCL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FHPCL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FHPCL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FHPCN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FHPCN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FHPCN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FHSCL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FHSCL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FHSCL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FHSCN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FHSCN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FHSCN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FHPCG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FHPCG (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FHPCG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FHSSL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FHSSL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FHSSL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FHSSN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FHSSN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FHSSN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FEPFP (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FEPFP (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FEPFP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCMPCQ (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCMPCQ (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCMPCQ => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCMPSN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCMPSN (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCMPSN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FHSSG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FHSSG (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FHSSG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCMPSL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCMPSL (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCMPSL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FRSOC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FRSOC (NPROMA, 0:1)
  TYPE (FIELD_3D), POINTER :: F_FRSOC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FRTHC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FRTHC (NPROMA, 0:1)
  TYPE (FIELD_3D), POINTER :: F_FRTHC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCHSP (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCHSP (NPROMA, 1:YDCPG_OPTS%YRSURF_DIMS%YSP_SBD%NLEVS)
  TYPE (FIELD_3D), POINTER :: F_FCHSP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCLL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCLL (NPROMA, 1:YDCPG_OPTS%KTSSG+1)
  TYPE (FIELD_3D), POINTER :: F_FCLL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCLN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCLN (NPROMA, 1:YDCPG_OPTS%KTSSG+1)
  TYPE (FIELD_3D), POINTER :: F_FCLN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCS (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCS (NPROMA, 1:YDCPG_OPTS%KTSSG+1)
  TYPE (FIELD_3D), POINTER :: F_FCS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FEVL (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FEVL (NPROMA, 1:YDCPG_OPTS%KTSSG+1)
  TYPE (FIELD_3D), POINTER :: F_FEVL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FEVN (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FEVN (NPROMA, 1:YDCPG_OPTS%KTSSG+1)
  TYPE (FIELD_3D), POINTER :: F_FEVN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FEVV (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FEVV (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FEVV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FLWSP (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FLWSP (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FLWSP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FTR (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FTR (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FTR => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FRSODS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FRSODS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FRSODS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FRSOPS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FRSOPS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FRSOPS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FRSDNI (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FRSDNI (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FRSDNI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FRSGNI (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FRSGNI (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FRSGNI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FRTHDS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FRTHDS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FRTHDS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FONTE (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FONTE (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FONTE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FGEL (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FGEL (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FGEL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FGELS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FGELS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FGELS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ALB (:) => NULL ()
!>REAL (KIND=JPRB)                      :: ALB (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_ALB => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GZ0 (:) => NULL ()
!>REAL (KIND=JPRB)                      :: GZ0 (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_GZ0 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GZ0H (:) => NULL ()
!>REAL (KIND=JPRB)                      :: GZ0H (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_GZ0H => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RUISL (:) => NULL ()
!>REAL (KIND=JPRB)                      :: RUISL (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_RUISL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RUISP (:) => NULL ()
!>REAL (KIND=JPRB)                      :: RUISP (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_RUISP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RUISS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: RUISS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_RUISS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FRSOPT (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FRSOPT (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FRSOPT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FRSOLU (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FRSOLU (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FRSOLU => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: QCLS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: QCLS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_QCLS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TCLS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: TCLS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_TCLS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UCLS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: UCLS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_UCLS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VCLS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: VCLS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_VCLS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NUCLS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: NUCLS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_NUCLS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NVCLS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: NVCLS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_NVCLS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RHCLS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: RHCLS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_RHCLS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: MRT (:) => NULL ()
!>REAL (KIND=JPRB)                      :: MRT (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_MRT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CLCH (:) => NULL ()
!>REAL (KIND=JPRB)                      :: CLCH (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_CLCH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CLCM (:) => NULL ()
!>REAL (KIND=JPRB)                      :: CLCM (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_CLCM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CLCL (:) => NULL ()
!>REAL (KIND=JPRB)                      :: CLCL (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_CLCL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CLCC (:) => NULL ()
!>REAL (KIND=JPRB)                      :: CLCC (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_CLCC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CLPH (:) => NULL ()
!>REAL (KIND=JPRB)                      :: CLPH (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_CLPH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VEIN (:) => NULL ()
!>REAL (KIND=JPRB)                      :: VEIN (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_VEIN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DRNSHF (:) => NULL ()
!>REAL (KIND=JPRB)                      :: DRNSHF (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_DRNSHF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CAPE (:) => NULL ()
!>REAL (KIND=JPRB)                      :: CAPE (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_CAPE => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CTOP (:) => NULL ()
!>REAL (KIND=JPRB)                      :: CTOP (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_CTOP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: MOCON (:) => NULL ()
!>REAL (KIND=JPRB)                      :: MOCON (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_MOCON => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: UGST (:) => NULL ()
!>REAL (KIND=JPRB)                      :: UGST (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_UGST => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VGST (:) => NULL ()
!>REAL (KIND=JPRB)                      :: VGST (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_VGST => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CT (:) => NULL ()
!>REAL (KIND=JPRB)                      :: CT (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_CT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TENDU (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TENDU (NPROMA, 1:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_TENDU => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TENDV (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TENDV (NPROMA, 1:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_TENDV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCQRNG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCQRNG (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCQRNG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCQSNG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCQSNG (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCQSNG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FCQGNG (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: FCQGNG (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_FCQGNG => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DIAGH (:) => NULL ()
!>REAL (KIND=JPRB)                      :: DIAGH (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_DIAGH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VISICLD (:) => NULL ()
!>REAL (KIND=JPRB)                      :: VISICLD (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_VISICLD => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: FLASH (:) => NULL ()
!>REAL (KIND=JPRB)                      :: FLASH (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_FLASH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VISIHYD (:) => NULL ()
!>REAL (KIND=JPRB)                      :: VISIHYD (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_VISIHYD => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: MXCLWC (:) => NULL ()
!>REAL (KIND=JPRB)                      :: MXCLWC (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_MXCLWC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TPWCLS (:) => NULL ()
!>REAL (KIND=JPRB)                      :: TPWCLS (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_TPWCLS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: CUCONVCA (:) => NULL ()
!>REAL (KIND=JPRB)                      :: CUCONVCA (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_CUCONVCA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: NLCONVCA (:) => NULL ()
!>REAL (KIND=JPRB)                      :: NLCONVCA (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_NLCONVCA => NULL ()

CONTAINS
  PROCEDURE :: INIT => MF_PHYS_OUT_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => MF_PHYS_OUT_TYPE_UPDATE_VIEW
  PROCEDURE :: INIT_STACK => MF_PHYS_OUT_TYPE_INIT_STACK
  PROCEDURE :: ALLOC_STACK => MF_PHYS_OUT_TYPE_ALLOC_STACK
  PROCEDURE :: UPDATE_VIEW_STACK => MF_PHYS_OUT_TYPE_UPDATE_VIEW_STACK
  PROCEDURE :: SIZE_STACK => MF_PHYS_OUT_TYPE_SIZE_STACK
  PROCEDURE :: FINAL => MF_PHYS_OUT_TYPE_FINAL
END TYPE MF_PHYS_OUT_TYPE
TYPE MF_PHYS_OPT_TYPE

  INTEGER (KIND=JPIB) :: ISIZE = 0
  REAL(KIND=JPRB), POINTER :: GDEOSI_ALL (:, :, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: GUEOSI_ALL (:, :, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: GMU0_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: GMU0_MIN_ALL (:, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: GMU0_MAX_ALL (:, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: GDEOTI_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: GDEOTI2_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: GUEOTI_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: GUEOTI2_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: GEOLT_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: GEOXT_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: GRPROX_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: GMIXP_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: GFLUXC_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: GRSURF_ALL (:, :) => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GDEOSI (:, :, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GDEOSI (NPROMA, 1:YDCPG_OPTS%KFLEVG, 1:2)
  TYPE (FIELD_4D), POINTER :: F_GDEOSI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GUEOSI (:, :, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GUEOSI (NPROMA, 1:YDCPG_OPTS%KFLEVG, 1:2)
  TYPE (FIELD_4D), POINTER :: F_GUEOSI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GMU0 (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GMU0 (NPROMA, 0:YDCPG_OPTS%KSORAYFR-1)
  TYPE (FIELD_3D), POINTER :: F_GMU0 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GMU0_MIN (:) => NULL ()
!>REAL (KIND=JPRB)                      :: GMU0_MIN (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_GMU0_MIN => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GMU0_MAX (:) => NULL ()
!>REAL (KIND=JPRB)                      :: GMU0_MAX (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_GMU0_MAX => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GDEOTI (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GDEOTI (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_GDEOTI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GDEOTI2 (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GDEOTI2 (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_GDEOTI2 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GUEOTI (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GUEOTI (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_GUEOTI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GUEOTI2 (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GUEOTI2 (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_GUEOTI2 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GEOLT (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GEOLT (NPROMA, 1:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_GEOLT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GEOXT (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GEOXT (NPROMA, 1:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_GEOXT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GRPROX (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GRPROX (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_GRPROX => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GMIXP (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GMIXP (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_GMIXP => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GFLUXC (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: GFLUXC (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_GFLUXC => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GRSURF (:) => NULL ()
!>REAL (KIND=JPRB)                      :: GRSURF (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_GRSURF => NULL ()

CONTAINS
  PROCEDURE :: INIT => MF_PHYS_OPT_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => MF_PHYS_OPT_TYPE_UPDATE_VIEW
  PROCEDURE :: INIT_STACK => MF_PHYS_OPT_TYPE_INIT_STACK
  PROCEDURE :: ALLOC_STACK => MF_PHYS_OPT_TYPE_ALLOC_STACK
  PROCEDURE :: UPDATE_VIEW_STACK => MF_PHYS_OPT_TYPE_UPDATE_VIEW_STACK
  PROCEDURE :: SIZE_STACK => MF_PHYS_OPT_TYPE_SIZE_STACK
  PROCEDURE :: FINAL => MF_PHYS_OPT_TYPE_FINAL
END TYPE MF_PHYS_OPT_TYPE
TYPE MF_PHYS_FOR_TYPE

  INTEGER (KIND=JPIB) :: ISIZE = 0
  REAL(KIND=JPRB), POINTER :: U_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: V_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: T_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: Q_ALL (:, :, :) => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: U (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: U (NPROMA, 1:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_U => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: V (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: V (NPROMA, 1:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_V => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: T (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: T (NPROMA, 1:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_T => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: Q (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: Q (NPROMA, 1:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_Q => NULL ()

CONTAINS
  PROCEDURE :: INIT => MF_PHYS_FOR_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => MF_PHYS_FOR_TYPE_UPDATE_VIEW
  PROCEDURE :: INIT_STACK => MF_PHYS_FOR_TYPE_INIT_STACK
  PROCEDURE :: ALLOC_STACK => MF_PHYS_FOR_TYPE_ALLOC_STACK
  PROCEDURE :: UPDATE_VIEW_STACK => MF_PHYS_FOR_TYPE_UPDATE_VIEW_STACK
  PROCEDURE :: SIZE_STACK => MF_PHYS_FOR_TYPE_SIZE_STACK
  PROCEDURE :: FINAL => MF_PHYS_FOR_TYPE_FINAL
END TYPE MF_PHYS_FOR_TYPE
TYPE MF_PHYS_GRA_TYPE

  INTEGER (KIND=JPIB) :: ISIZE = 0
  REAL(KIND=JPRB), POINTER :: G_ALL (:, :, :, :) => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: G (:, :, :) => NULL ()
!>REAL (KIND=JPRB)                      :: G (NPROMA, 1:YDCPG_OPTS%KGRADIENTS, 1:NLEV)
  TYPE (FIELD_4D), POINTER :: F_G => NULL ()

CONTAINS
  PROCEDURE :: INIT => MF_PHYS_GRA_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => MF_PHYS_GRA_TYPE_UPDATE_VIEW
  PROCEDURE :: INIT_STACK => MF_PHYS_GRA_TYPE_INIT_STACK
  PROCEDURE :: ALLOC_STACK => MF_PHYS_GRA_TYPE_ALLOC_STACK
  PROCEDURE :: UPDATE_VIEW_STACK => MF_PHYS_GRA_TYPE_UPDATE_VIEW_STACK
  PROCEDURE :: SIZE_STACK => MF_PHYS_GRA_TYPE_SIZE_STACK
  PROCEDURE :: FINAL => MF_PHYS_GRA_TYPE_FINAL
END TYPE MF_PHYS_GRA_TYPE
TYPE MF_PHYS_RAD_TYPE

  INTEGER (KIND=JPIB) :: ISIZE = 0
  REAL(KIND=JPRB), POINTER :: EMTD_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: EMTU_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: TRSW_ALL (:, :, :) => NULL ()
  REAL(KIND=JPRB), POINTER :: RMOON_ALL (:, :) => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EMTD (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: EMTD (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_EMTD => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: EMTU (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: EMTU (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_EMTU => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TRSW (:, :) => NULL ()
!>REAL (KIND=JPRB)                      :: TRSW (NPROMA, 0:YDCPG_OPTS%KFLEVG)
  TYPE (FIELD_3D), POINTER :: F_TRSW => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: RMOON (:) => NULL ()
!>REAL (KIND=JPRB)                      :: RMOON (NPROMA)
  TYPE (FIELD_2D), POINTER :: F_RMOON => NULL ()

CONTAINS
  PROCEDURE :: INIT => MF_PHYS_RAD_TYPE_INIT
  PROCEDURE :: UPDATE_VIEW => MF_PHYS_RAD_TYPE_UPDATE_VIEW
  PROCEDURE :: INIT_STACK => MF_PHYS_RAD_TYPE_INIT_STACK
  PROCEDURE :: ALLOC_STACK => MF_PHYS_RAD_TYPE_ALLOC_STACK
  PROCEDURE :: UPDATE_VIEW_STACK => MF_PHYS_RAD_TYPE_UPDATE_VIEW_STACK
  PROCEDURE :: SIZE_STACK => MF_PHYS_RAD_TYPE_SIZE_STACK
  PROCEDURE :: FINAL => MF_PHYS_RAD_TYPE_FINAL
END TYPE MF_PHYS_RAD_TYPE

TYPE MF_PHYS_TYPE
  TYPE (MF_PHYS_OUT_TYPE) :: OUT
  TYPE (MF_PHYS_OPT_TYPE) :: OPT
  TYPE (MF_PHYS_FOR_TYPE) :: FOR
  TYPE (MF_PHYS_GRA_TYPE) :: GRA
  TYPE (MF_PHYS_RAD_TYPE) :: RAD
CONTAINS
  PROCEDURE :: UPDATE_VIEW => MF_PHYS_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => MF_PHYS_TYPE_FINAL
END TYPE MF_PHYS_TYPE

REAL(KIND=JPRB),    PRIVATE, SAVE, TARGET :: ZDUM1 (1), ZDUM2 (1, 1), ZDUM3 (1,1,1)
INTEGER(KIND=JPIM), PRIVATE, SAVE, TARGET :: IDUM1 (1), IDUM2 (1, 1), IDUM3 (1,1,1)

CONTAINS




SUBROUTINE MF_PHYS_OUT_TYPE_INIT (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                                & , PERSISTENT &
                           &)


USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_OUT_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT







SELF%F_DIFCQ => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_DIFCQL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_DIFCQN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_DIFCS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_DIFTQ => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_DIFTQL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_DIFTQN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_DIFTS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_EDR => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_FCCQL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCCQN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCSQL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCSQN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCQLNG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCQNNG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCQNG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPLCL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPLCN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPLCG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPLCH => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPLSL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPLSN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPLSG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPLSH => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPFPSL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPFPSN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPFPSG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPFPCL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPFPCN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPEVPSL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPEVPSN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPEVPSG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPEVPCL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPEVPCN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FPEVPCG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FRSO => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, NDIM=YDCPG_OPTS%KTSSG+1, NDIM0=1,&
    & PERSISTENT=PERSISTENT)

SELF%F_FRTH => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, NDIM=YDCPG_OPTS%KTSSG+1, NDIM0=1,&
    & PERSISTENT=PERSISTENT)

SELF%F_STRCU => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_STRCV => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_STRDU => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_STRDV => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_STRTU => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_STRTV => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_STRMU => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_STRMV => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_DIFCQLC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_DIFCQIC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FIMCC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FEDQLC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FEDQIC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FEDQRC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FEDQSC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCNEGQLC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCNEGQIC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCNEGQRC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCNEGQSC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FRMH => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCHOZ => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FDIS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FHPSL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FHPSN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FHPSG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FHPCL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FHPCN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FHSCL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FHSCN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FHPCG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FHSSL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FHSSN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FEPFP => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCMPCQ => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCMPSN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FHSSG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCMPSL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FRSOC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=1+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FRTHC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=1+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCHSP => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%YRSURF_DIMS%YSP_SBD%NLEVS, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_FCLL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KTSSG+1, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_FCLN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KTSSG+1, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_FCS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KTSSG+1, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_FEVL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KTSSG+1, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_FEVN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KTSSG+1, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_FEVV => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FLWSP => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FTR => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FRSODS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FRSOPS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FRSDNI => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FRSGNI => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FRTHDS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FONTE => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FGEL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FGELS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_ALB => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_GZ0 => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_GZ0H => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_RUISL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_RUISP => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_RUISS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FRSOPT => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FRSOLU => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_QCLS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_TCLS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_UCLS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_VCLS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_NUCLS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_NVCLS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_RHCLS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_MRT => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_CLCH => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_CLCM => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_CLCL => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_CLCC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_CLPH => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_VEIN => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_DRNSHF => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_CAPE => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_CTOP => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_MOCON => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_UGST => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_VGST => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_CT => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_TENDU => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_TENDV => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG, NLEV0=1, PERSISTENT=PERSISTENT)

SELF%F_FCQRNG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCQSNG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_FCQGNG => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, NLEV=YDCPG_OPTS%KFLEVG+1, NLEV0=0, PERSISTENT=PERSISTENT)

SELF%F_DIAGH => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_VISICLD => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_FLASH => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_VISIHYD => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_MXCLWC => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_TPWCLS => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_CUCONVCA => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)

SELF%F_NLCONVCA => CREATE_TEMPORARY (GEOM=REGISTRY%GEOM, PERSISTENT=PERSISTENT)


END SUBROUTINE MF_PHYS_OUT_TYPE_INIT

SUBROUTINE MF_PHYS_OUT_TYPE_INIT_STACK (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                           &)


USE STACK_MOD, ONLY : MALIGN

USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_OUT_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS







SELF%ISIZE = 0

!PRINT *, "DIFCQ", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "DIFCQL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "DIFCQN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "DIFCS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "DIFTQ", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "DIFTQL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "DIFTQN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "DIFTS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "EDR", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 1 + 1))

!PRINT *, "FCCQL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCCQN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCSQL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCSQN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCQLNG", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCQNNG", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCQNG", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPLCL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPLCN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPLCG", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPLCH", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPLSL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPLSN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPLSG", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPLSH", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPFPSL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPFPSN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPFPSG", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPFPCL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPFPCN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPEVPSL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPEVPSN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPEVPSG", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPEVPCL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPEVPCN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FPEVPCG", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FRSO", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1) * (YDCPG_OPTS%KTSSG+1 - 1 + 1))

!PRINT *, "FRTH", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1) * (YDCPG_OPTS%KTSSG+1 - 1 + 1))

!PRINT *, "STRCU", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "STRCV", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "STRDU", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "STRDV", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "STRTU", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "STRTV", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "STRMU", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "STRMV", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "DIFCQLC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "DIFCQIC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FIMCC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FEDQLC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FEDQIC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FEDQRC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FEDQSC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCNEGQLC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCNEGQIC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCNEGQRC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCNEGQSC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FRMH", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCHOZ", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FDIS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FHPSL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FHPSN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FHPSG", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FHPCL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FHPCN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FHSCL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FHSCN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FHPCG", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FHSSL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FHSSN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FEPFP", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCMPCQ", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCMPSN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FHSSG", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCMPSL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FRSOC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (1 - 0 + 1))

!PRINT *, "FRTHC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (1 - 0 + 1))

!PRINT *, "FCHSP", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%YRSURF_DIMS%YSP_SBD%NLEVS - 1 + 1))

!PRINT *, "FCLL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KTSSG+1 - 1 + 1))

!PRINT *, "FCLN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KTSSG+1 - 1 + 1))

!PRINT *, "FCS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KTSSG+1 - 1 + 1))

!PRINT *, "FEVL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KTSSG+1 - 1 + 1))

!PRINT *, "FEVN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KTSSG+1 - 1 + 1))

!PRINT *, "FEVV", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "FLWSP", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "FTR", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "FRSODS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "FRSOPS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "FRSDNI", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "FRSGNI", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "FRTHDS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "FONTE", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "FGEL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "FGELS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "ALB", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "GZ0", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "GZ0H", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "RUISL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "RUISP", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "RUISS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "FRSOPT", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "FRSOLU", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "QCLS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "TCLS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "UCLS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "VCLS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "NUCLS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "NVCLS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "RHCLS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "MRT", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "CLCH", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "CLCM", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "CLCL", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "CLCC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "CLPH", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "VEIN", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "DRNSHF", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "CAPE", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "CTOP", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "MOCON", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "UGST", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "VGST", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "CT", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "TENDU", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 1 + 1))

!PRINT *, "TENDV", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 1 + 1))

!PRINT *, "FCQRNG", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCQSNG", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "FCQGNG", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB * (YDCPG_OPTS%KFLEVG - 0 + 1))

!PRINT *, "DIAGH", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "VISICLD", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "FLASH", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "VISIHYD", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "MXCLWC", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "TPWCLS", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "CUCONVCA", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)

!PRINT *, "NLCONVCA", SELF%ISIZE
SELF%ISIZE = SELF%ISIZE + MALIGN (REGISTRY%GEOM%YRDIM%NPROMA * JPRB)


END SUBROUTINE MF_PHYS_OUT_TYPE_INIT_STACK

SUBROUTINE MF_PHYS_OUT_TYPE_ALLOC_STACK (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                                &, YDSTACK &
                           &)


USE STACK_MOD, ONLY : STACK

USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_OUT_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS

TYPE (STACK)                                 :: YDSTACK







!PRINT *, "DIFCQ", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%DIFCQ, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "DIFCQL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%DIFCQL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "DIFCQN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%DIFCQN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "DIFCS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%DIFCS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "DIFTQ", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%DIFTQ, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "DIFTQL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%DIFTQL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "DIFTQN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%DIFTQN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "DIFTS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%DIFTS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "EDR", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%EDR, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 1])

!PRINT *, "FCCQL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCCQL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCCQN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCCQN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCSQL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCSQL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCSQN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCSQN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCQLNG", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCQLNG, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCQNNG", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCQNNG, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCQNG", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCQNG, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPLCL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPLCL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPLCN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPLCN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPLCG", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPLCG, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPLCH", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPLCH, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPLSL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPLSL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPLSN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPLSN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPLSG", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPLSG, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPLSH", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPLSH, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPFPSL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPFPSL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPFPSN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPFPSN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPFPSG", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPFPSG, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPFPCL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPFPCL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPFPCN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPFPCN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPEVPSL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPEVPSL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPEVPSN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPEVPSN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPEVPSG", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPEVPSG, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPEVPCL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPEVPCL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPEVPCN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPEVPCN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FPEVPCG", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FPEVPCG, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FRSO", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FRSO, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KTSSG+1], KLBDS=[1, 0, 1])

!PRINT *, "FRTH", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FRTH, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KTSSG+1], KLBDS=[1, 0, 1])

!PRINT *, "STRCU", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%STRCU, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "STRCV", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%STRCV, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "STRDU", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%STRDU, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "STRDV", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%STRDV, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "STRTU", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%STRTU, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "STRTV", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%STRTV, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "STRMU", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%STRMU, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "STRMV", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%STRMV, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "DIFCQLC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%DIFCQLC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "DIFCQIC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%DIFCQIC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FIMCC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FIMCC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FEDQLC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FEDQLC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FEDQIC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FEDQIC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FEDQRC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FEDQRC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FEDQSC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FEDQSC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCNEGQLC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCNEGQLC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCNEGQIC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCNEGQIC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCNEGQRC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCNEGQRC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCNEGQSC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCNEGQSC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FRMH", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FRMH, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCHOZ", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCHOZ, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FDIS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FDIS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FHPSL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FHPSL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FHPSN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FHPSN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FHPSG", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FHPSG, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FHPCL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FHPCL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FHPCN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FHPCN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FHSCL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FHSCL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FHSCN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FHSCN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FHPCG", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FHPCG, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FHSSL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FHSSL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FHSSN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FHSSN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FEPFP", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FEPFP, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCMPCQ", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCMPCQ, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCMPSN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCMPSN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FHSSG", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FHSSG, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCMPSL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCMPSL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FRSOC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FRSOC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, 1], KLBDS=[1, 0])

!PRINT *, "FRTHC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FRTHC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, 1], KLBDS=[1, 0])

!PRINT *, "FCHSP", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCHSP, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%YRSURF_DIMS%YSP_SBD%NLEVS], KLBDS=[1, 1])

!PRINT *, "FCLL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCLL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KTSSG+1], KLBDS=[1, 1])

!PRINT *, "FCLN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCLN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KTSSG+1], KLBDS=[1, 1])

!PRINT *, "FCS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KTSSG+1], KLBDS=[1, 1])

!PRINT *, "FEVL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FEVL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KTSSG+1], KLBDS=[1, 1])

!PRINT *, "FEVN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FEVN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KTSSG+1], KLBDS=[1, 1])

!PRINT *, "FEVV", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FEVV, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "FLWSP", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FLWSP, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "FTR", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FTR, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "FRSODS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FRSODS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "FRSOPS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FRSOPS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "FRSDNI", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FRSDNI, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "FRSGNI", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FRSGNI, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "FRTHDS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FRTHDS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "FONTE", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FONTE, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "FGEL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FGEL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "FGELS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FGELS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "ALB", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%ALB, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "GZ0", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%GZ0, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "GZ0H", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%GZ0H, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "RUISL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%RUISL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "RUISP", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%RUISP, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "RUISS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%RUISS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "FRSOPT", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FRSOPT, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "FRSOLU", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FRSOLU, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "QCLS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%QCLS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "TCLS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%TCLS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "UCLS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%UCLS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "VCLS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%VCLS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "NUCLS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%NUCLS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "NVCLS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%NVCLS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "RHCLS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%RHCLS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "MRT", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%MRT, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "CLCH", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%CLCH, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "CLCM", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%CLCM, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "CLCL", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%CLCL, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "CLCC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%CLCC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "CLPH", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%CLPH, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "VEIN", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%VEIN, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "DRNSHF", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%DRNSHF, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "CAPE", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%CAPE, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "CTOP", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%CTOP, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "MOCON", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%MOCON, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "UGST", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%UGST, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "VGST", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%VGST, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "CT", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%CT, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "TENDU", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%TENDU, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 1])

!PRINT *, "TENDV", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%TENDV, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 1])

!PRINT *, "FCQRNG", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCQRNG, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCQSNG", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCQSNG, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "FCQGNG", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FCQGNG, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA, YDCPG_OPTS%KFLEVG], KLBDS=[1, 0])

!PRINT *, "DIAGH", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%DIAGH, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "VISICLD", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%VISICLD, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "FLASH", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%FLASH, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "VISIHYD", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%VISIHYD, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "MXCLWC", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%MXCLWC, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "TPWCLS", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%TPWCLS, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "CUCONVCA", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%CUCONVCA, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])

!PRINT *, "NLCONVCA", YDSTACK%IPTR-70785, YDSTACK%IPTR
  CALL YDSTACK%ALLOC (SELF%NLCONVCA, KUBDS=[REGISTRY%GEOM%YRDIM%NPROMA], KLBDS=[1])


END SUBROUTINE MF_PHYS_OUT_TYPE_ALLOC_STACK

SUBROUTINE MF_PHYS_OUT_TYPE_UPDATE_VIEW_STACK (SELF, BLOCK_INDEX)

CLASS (MF_PHYS_OUT_TYPE)                    :: SELF
INTEGER (KIND=JPIM), INTENT (IN)    :: BLOCK_INDEX


END SUBROUTINE MF_PHYS_OUT_TYPE_UPDATE_VIEW_STACK

INTEGER (KIND=JPIB) FUNCTION MF_PHYS_OUT_TYPE_SIZE_STACK (SELF)

CLASS (MF_PHYS_OUT_TYPE)         :: SELF

MF_PHYS_OUT_TYPE_SIZE_STACK = SELF%ISIZE

END FUNCTION MF_PHYS_OUT_TYPE_SIZE_STACK


SUBROUTINE MF_PHYS_OUT_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (MF_PHYS_OUT_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DIFCQ)) THEN
  IF ((.NOT. SELF%F_DIFCQ%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DIFCQ))) THEN
    SELF%DIFCQ  => SELF%F_DIFCQ%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%DIFCQ)) THEN
  SELF%DIFCQ  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DIFCQL)) THEN
  IF ((.NOT. SELF%F_DIFCQL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DIFCQL))) THEN
    SELF%DIFCQL  => SELF%F_DIFCQL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%DIFCQL)) THEN
  SELF%DIFCQL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DIFCQN)) THEN
  IF ((.NOT. SELF%F_DIFCQN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DIFCQN))) THEN
    SELF%DIFCQN  => SELF%F_DIFCQN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%DIFCQN)) THEN
  SELF%DIFCQN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DIFCS)) THEN
  IF ((.NOT. SELF%F_DIFCS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DIFCS))) THEN
    SELF%DIFCS  => SELF%F_DIFCS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%DIFCS)) THEN
  SELF%DIFCS  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DIFTQ)) THEN
  IF ((.NOT. SELF%F_DIFTQ%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DIFTQ))) THEN
    SELF%DIFTQ  => SELF%F_DIFTQ%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%DIFTQ)) THEN
  SELF%DIFTQ  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DIFTQL)) THEN
  IF ((.NOT. SELF%F_DIFTQL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DIFTQL))) THEN
    SELF%DIFTQL  => SELF%F_DIFTQL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%DIFTQL)) THEN
  SELF%DIFTQL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DIFTQN)) THEN
  IF ((.NOT. SELF%F_DIFTQN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DIFTQN))) THEN
    SELF%DIFTQN  => SELF%F_DIFTQN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%DIFTQN)) THEN
  SELF%DIFTQN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DIFTS)) THEN
  IF ((.NOT. SELF%F_DIFTS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DIFTS))) THEN
    SELF%DIFTS  => SELF%F_DIFTS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%DIFTS)) THEN
  SELF%DIFTS  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_EDR)) THEN
  IF ((.NOT. SELF%F_EDR%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%EDR))) THEN
    SELF%EDR  => SELF%F_EDR%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%EDR)) THEN
  SELF%EDR  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCCQL)) THEN
  IF ((.NOT. SELF%F_FCCQL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCCQL))) THEN
    SELF%FCCQL  => SELF%F_FCCQL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCCQL)) THEN
  SELF%FCCQL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCCQN)) THEN
  IF ((.NOT. SELF%F_FCCQN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCCQN))) THEN
    SELF%FCCQN  => SELF%F_FCCQN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCCQN)) THEN
  SELF%FCCQN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCSQL)) THEN
  IF ((.NOT. SELF%F_FCSQL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCSQL))) THEN
    SELF%FCSQL  => SELF%F_FCSQL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCSQL)) THEN
  SELF%FCSQL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCSQN)) THEN
  IF ((.NOT. SELF%F_FCSQN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCSQN))) THEN
    SELF%FCSQN  => SELF%F_FCSQN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCSQN)) THEN
  SELF%FCSQN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCQLNG)) THEN
  IF ((.NOT. SELF%F_FCQLNG%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCQLNG))) THEN
    SELF%FCQLNG  => SELF%F_FCQLNG%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCQLNG)) THEN
  SELF%FCQLNG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCQNNG)) THEN
  IF ((.NOT. SELF%F_FCQNNG%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCQNNG))) THEN
    SELF%FCQNNG  => SELF%F_FCQNNG%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCQNNG)) THEN
  SELF%FCQNNG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCQNG)) THEN
  IF ((.NOT. SELF%F_FCQNG%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCQNG))) THEN
    SELF%FCQNG  => SELF%F_FCQNG%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCQNG)) THEN
  SELF%FCQNG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPLCL)) THEN
  IF ((.NOT. SELF%F_FPLCL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPLCL))) THEN
    SELF%FPLCL  => SELF%F_FPLCL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPLCL)) THEN
  SELF%FPLCL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPLCN)) THEN
  IF ((.NOT. SELF%F_FPLCN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPLCN))) THEN
    SELF%FPLCN  => SELF%F_FPLCN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPLCN)) THEN
  SELF%FPLCN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPLCG)) THEN
  IF ((.NOT. SELF%F_FPLCG%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPLCG))) THEN
    SELF%FPLCG  => SELF%F_FPLCG%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPLCG)) THEN
  SELF%FPLCG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPLCH)) THEN
  IF ((.NOT. SELF%F_FPLCH%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPLCH))) THEN
    SELF%FPLCH  => SELF%F_FPLCH%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPLCH)) THEN
  SELF%FPLCH  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPLSL)) THEN
  IF ((.NOT. SELF%F_FPLSL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPLSL))) THEN
    SELF%FPLSL  => SELF%F_FPLSL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPLSL)) THEN
  SELF%FPLSL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPLSN)) THEN
  IF ((.NOT. SELF%F_FPLSN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPLSN))) THEN
    SELF%FPLSN  => SELF%F_FPLSN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPLSN)) THEN
  SELF%FPLSN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPLSG)) THEN
  IF ((.NOT. SELF%F_FPLSG%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPLSG))) THEN
    SELF%FPLSG  => SELF%F_FPLSG%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPLSG)) THEN
  SELF%FPLSG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPLSH)) THEN
  IF ((.NOT. SELF%F_FPLSH%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPLSH))) THEN
    SELF%FPLSH  => SELF%F_FPLSH%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPLSH)) THEN
  SELF%FPLSH  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPFPSL)) THEN
  IF ((.NOT. SELF%F_FPFPSL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPFPSL))) THEN
    SELF%FPFPSL  => SELF%F_FPFPSL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPFPSL)) THEN
  SELF%FPFPSL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPFPSN)) THEN
  IF ((.NOT. SELF%F_FPFPSN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPFPSN))) THEN
    SELF%FPFPSN  => SELF%F_FPFPSN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPFPSN)) THEN
  SELF%FPFPSN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPFPSG)) THEN
  IF ((.NOT. SELF%F_FPFPSG%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPFPSG))) THEN
    SELF%FPFPSG  => SELF%F_FPFPSG%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPFPSG)) THEN
  SELF%FPFPSG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPFPCL)) THEN
  IF ((.NOT. SELF%F_FPFPCL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPFPCL))) THEN
    SELF%FPFPCL  => SELF%F_FPFPCL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPFPCL)) THEN
  SELF%FPFPCL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPFPCN)) THEN
  IF ((.NOT. SELF%F_FPFPCN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPFPCN))) THEN
    SELF%FPFPCN  => SELF%F_FPFPCN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPFPCN)) THEN
  SELF%FPFPCN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPEVPSL)) THEN
  IF ((.NOT. SELF%F_FPEVPSL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPEVPSL))) THEN
    SELF%FPEVPSL  => SELF%F_FPEVPSL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPEVPSL)) THEN
  SELF%FPEVPSL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPEVPSN)) THEN
  IF ((.NOT. SELF%F_FPEVPSN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPEVPSN))) THEN
    SELF%FPEVPSN  => SELF%F_FPEVPSN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPEVPSN)) THEN
  SELF%FPEVPSN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPEVPSG)) THEN
  IF ((.NOT. SELF%F_FPEVPSG%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPEVPSG))) THEN
    SELF%FPEVPSG  => SELF%F_FPEVPSG%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPEVPSG)) THEN
  SELF%FPEVPSG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPEVPCL)) THEN
  IF ((.NOT. SELF%F_FPEVPCL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPEVPCL))) THEN
    SELF%FPEVPCL  => SELF%F_FPEVPCL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPEVPCL)) THEN
  SELF%FPEVPCL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPEVPCN)) THEN
  IF ((.NOT. SELF%F_FPEVPCN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPEVPCN))) THEN
    SELF%FPEVPCN  => SELF%F_FPEVPCN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPEVPCN)) THEN
  SELF%FPEVPCN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FPEVPCG)) THEN
  IF ((.NOT. SELF%F_FPEVPCG%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FPEVPCG))) THEN
    SELF%FPEVPCG  => SELF%F_FPEVPCG%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FPEVPCG)) THEN
  SELF%FPEVPCG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FRSO)) THEN
  IF ((.NOT. SELF%F_FRSO%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FRSO))) THEN
    SELF%FRSO  => SELF%F_FRSO%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FRSO)) THEN
  SELF%FRSO  => ZDUM3
ENDIF
IF (ASSOCIATED (SELF%F_FRTH)) THEN
  IF ((.NOT. SELF%F_FRTH%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FRTH))) THEN
    SELF%FRTH  => SELF%F_FRTH%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FRTH)) THEN
  SELF%FRTH  => ZDUM3
ENDIF
IF (ASSOCIATED (SELF%F_STRCU)) THEN
  IF ((.NOT. SELF%F_STRCU%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%STRCU))) THEN
    SELF%STRCU  => SELF%F_STRCU%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%STRCU)) THEN
  SELF%STRCU  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_STRCV)) THEN
  IF ((.NOT. SELF%F_STRCV%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%STRCV))) THEN
    SELF%STRCV  => SELF%F_STRCV%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%STRCV)) THEN
  SELF%STRCV  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_STRDU)) THEN
  IF ((.NOT. SELF%F_STRDU%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%STRDU))) THEN
    SELF%STRDU  => SELF%F_STRDU%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%STRDU)) THEN
  SELF%STRDU  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_STRDV)) THEN
  IF ((.NOT. SELF%F_STRDV%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%STRDV))) THEN
    SELF%STRDV  => SELF%F_STRDV%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%STRDV)) THEN
  SELF%STRDV  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_STRTU)) THEN
  IF ((.NOT. SELF%F_STRTU%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%STRTU))) THEN
    SELF%STRTU  => SELF%F_STRTU%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%STRTU)) THEN
  SELF%STRTU  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_STRTV)) THEN
  IF ((.NOT. SELF%F_STRTV%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%STRTV))) THEN
    SELF%STRTV  => SELF%F_STRTV%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%STRTV)) THEN
  SELF%STRTV  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_STRMU)) THEN
  IF ((.NOT. SELF%F_STRMU%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%STRMU))) THEN
    SELF%STRMU  => SELF%F_STRMU%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%STRMU)) THEN
  SELF%STRMU  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_STRMV)) THEN
  IF ((.NOT. SELF%F_STRMV%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%STRMV))) THEN
    SELF%STRMV  => SELF%F_STRMV%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%STRMV)) THEN
  SELF%STRMV  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DIFCQLC)) THEN
  IF ((.NOT. SELF%F_DIFCQLC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DIFCQLC))) THEN
    SELF%DIFCQLC  => SELF%F_DIFCQLC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%DIFCQLC)) THEN
  SELF%DIFCQLC  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DIFCQIC)) THEN
  IF ((.NOT. SELF%F_DIFCQIC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DIFCQIC))) THEN
    SELF%DIFCQIC  => SELF%F_DIFCQIC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%DIFCQIC)) THEN
  SELF%DIFCQIC  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FIMCC)) THEN
  IF ((.NOT. SELF%F_FIMCC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FIMCC))) THEN
    SELF%FIMCC  => SELF%F_FIMCC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FIMCC)) THEN
  SELF%FIMCC  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FEDQLC)) THEN
  IF ((.NOT. SELF%F_FEDQLC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FEDQLC))) THEN
    SELF%FEDQLC  => SELF%F_FEDQLC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FEDQLC)) THEN
  SELF%FEDQLC  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FEDQIC)) THEN
  IF ((.NOT. SELF%F_FEDQIC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FEDQIC))) THEN
    SELF%FEDQIC  => SELF%F_FEDQIC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FEDQIC)) THEN
  SELF%FEDQIC  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FEDQRC)) THEN
  IF ((.NOT. SELF%F_FEDQRC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FEDQRC))) THEN
    SELF%FEDQRC  => SELF%F_FEDQRC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FEDQRC)) THEN
  SELF%FEDQRC  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FEDQSC)) THEN
  IF ((.NOT. SELF%F_FEDQSC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FEDQSC))) THEN
    SELF%FEDQSC  => SELF%F_FEDQSC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FEDQSC)) THEN
  SELF%FEDQSC  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCNEGQLC)) THEN
  IF ((.NOT. SELF%F_FCNEGQLC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCNEGQLC))) THEN
    SELF%FCNEGQLC  => SELF%F_FCNEGQLC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCNEGQLC)) THEN
  SELF%FCNEGQLC  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCNEGQIC)) THEN
  IF ((.NOT. SELF%F_FCNEGQIC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCNEGQIC))) THEN
    SELF%FCNEGQIC  => SELF%F_FCNEGQIC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCNEGQIC)) THEN
  SELF%FCNEGQIC  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCNEGQRC)) THEN
  IF ((.NOT. SELF%F_FCNEGQRC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCNEGQRC))) THEN
    SELF%FCNEGQRC  => SELF%F_FCNEGQRC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCNEGQRC)) THEN
  SELF%FCNEGQRC  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCNEGQSC)) THEN
  IF ((.NOT. SELF%F_FCNEGQSC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCNEGQSC))) THEN
    SELF%FCNEGQSC  => SELF%F_FCNEGQSC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCNEGQSC)) THEN
  SELF%FCNEGQSC  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FRMH)) THEN
  IF ((.NOT. SELF%F_FRMH%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FRMH))) THEN
    SELF%FRMH  => SELF%F_FRMH%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FRMH)) THEN
  SELF%FRMH  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCHOZ)) THEN
  IF ((.NOT. SELF%F_FCHOZ%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCHOZ))) THEN
    SELF%FCHOZ  => SELF%F_FCHOZ%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCHOZ)) THEN
  SELF%FCHOZ  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FDIS)) THEN
  IF ((.NOT. SELF%F_FDIS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FDIS))) THEN
    SELF%FDIS  => SELF%F_FDIS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FDIS)) THEN
  SELF%FDIS  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FHPSL)) THEN
  IF ((.NOT. SELF%F_FHPSL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FHPSL))) THEN
    SELF%FHPSL  => SELF%F_FHPSL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FHPSL)) THEN
  SELF%FHPSL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FHPSN)) THEN
  IF ((.NOT. SELF%F_FHPSN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FHPSN))) THEN
    SELF%FHPSN  => SELF%F_FHPSN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FHPSN)) THEN
  SELF%FHPSN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FHPSG)) THEN
  IF ((.NOT. SELF%F_FHPSG%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FHPSG))) THEN
    SELF%FHPSG  => SELF%F_FHPSG%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FHPSG)) THEN
  SELF%FHPSG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FHPCL)) THEN
  IF ((.NOT. SELF%F_FHPCL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FHPCL))) THEN
    SELF%FHPCL  => SELF%F_FHPCL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FHPCL)) THEN
  SELF%FHPCL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FHPCN)) THEN
  IF ((.NOT. SELF%F_FHPCN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FHPCN))) THEN
    SELF%FHPCN  => SELF%F_FHPCN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FHPCN)) THEN
  SELF%FHPCN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FHSCL)) THEN
  IF ((.NOT. SELF%F_FHSCL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FHSCL))) THEN
    SELF%FHSCL  => SELF%F_FHSCL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FHSCL)) THEN
  SELF%FHSCL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FHSCN)) THEN
  IF ((.NOT. SELF%F_FHSCN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FHSCN))) THEN
    SELF%FHSCN  => SELF%F_FHSCN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FHSCN)) THEN
  SELF%FHSCN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FHPCG)) THEN
  IF ((.NOT. SELF%F_FHPCG%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FHPCG))) THEN
    SELF%FHPCG  => SELF%F_FHPCG%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FHPCG)) THEN
  SELF%FHPCG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FHSSL)) THEN
  IF ((.NOT. SELF%F_FHSSL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FHSSL))) THEN
    SELF%FHSSL  => SELF%F_FHSSL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FHSSL)) THEN
  SELF%FHSSL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FHSSN)) THEN
  IF ((.NOT. SELF%F_FHSSN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FHSSN))) THEN
    SELF%FHSSN  => SELF%F_FHSSN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FHSSN)) THEN
  SELF%FHSSN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FEPFP)) THEN
  IF ((.NOT. SELF%F_FEPFP%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FEPFP))) THEN
    SELF%FEPFP  => SELF%F_FEPFP%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FEPFP)) THEN
  SELF%FEPFP  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCMPCQ)) THEN
  IF ((.NOT. SELF%F_FCMPCQ%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCMPCQ))) THEN
    SELF%FCMPCQ  => SELF%F_FCMPCQ%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCMPCQ)) THEN
  SELF%FCMPCQ  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCMPSN)) THEN
  IF ((.NOT. SELF%F_FCMPSN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCMPSN))) THEN
    SELF%FCMPSN  => SELF%F_FCMPSN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCMPSN)) THEN
  SELF%FCMPSN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FHSSG)) THEN
  IF ((.NOT. SELF%F_FHSSG%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FHSSG))) THEN
    SELF%FHSSG  => SELF%F_FHSSG%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FHSSG)) THEN
  SELF%FHSSG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCMPSL)) THEN
  IF ((.NOT. SELF%F_FCMPSL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCMPSL))) THEN
    SELF%FCMPSL  => SELF%F_FCMPSL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCMPSL)) THEN
  SELF%FCMPSL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FRSOC)) THEN
  IF ((.NOT. SELF%F_FRSOC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FRSOC))) THEN
    SELF%FRSOC  => SELF%F_FRSOC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FRSOC)) THEN
  SELF%FRSOC  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FRTHC)) THEN
  IF ((.NOT. SELF%F_FRTHC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FRTHC))) THEN
    SELF%FRTHC  => SELF%F_FRTHC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FRTHC)) THEN
  SELF%FRTHC  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCHSP)) THEN
  IF ((.NOT. SELF%F_FCHSP%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCHSP))) THEN
    SELF%FCHSP  => SELF%F_FCHSP%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCHSP)) THEN
  SELF%FCHSP  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCLL)) THEN
  IF ((.NOT. SELF%F_FCLL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCLL))) THEN
    SELF%FCLL  => SELF%F_FCLL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCLL)) THEN
  SELF%FCLL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCLN)) THEN
  IF ((.NOT. SELF%F_FCLN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCLN))) THEN
    SELF%FCLN  => SELF%F_FCLN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCLN)) THEN
  SELF%FCLN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCS)) THEN
  IF ((.NOT. SELF%F_FCS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCS))) THEN
    SELF%FCS  => SELF%F_FCS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCS)) THEN
  SELF%FCS  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FEVL)) THEN
  IF ((.NOT. SELF%F_FEVL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FEVL))) THEN
    SELF%FEVL  => SELF%F_FEVL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FEVL)) THEN
  SELF%FEVL  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FEVN)) THEN
  IF ((.NOT. SELF%F_FEVN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FEVN))) THEN
    SELF%FEVN  => SELF%F_FEVN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FEVN)) THEN
  SELF%FEVN  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FEVV)) THEN
  IF ((.NOT. SELF%F_FEVV%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FEVV))) THEN
    SELF%FEVV  => SELF%F_FEVV%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FEVV)) THEN
  SELF%FEVV  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FLWSP)) THEN
  IF ((.NOT. SELF%F_FLWSP%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FLWSP))) THEN
    SELF%FLWSP  => SELF%F_FLWSP%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FLWSP)) THEN
  SELF%FLWSP  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FTR)) THEN
  IF ((.NOT. SELF%F_FTR%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FTR))) THEN
    SELF%FTR  => SELF%F_FTR%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FTR)) THEN
  SELF%FTR  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FRSODS)) THEN
  IF ((.NOT. SELF%F_FRSODS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FRSODS))) THEN
    SELF%FRSODS  => SELF%F_FRSODS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FRSODS)) THEN
  SELF%FRSODS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FRSOPS)) THEN
  IF ((.NOT. SELF%F_FRSOPS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FRSOPS))) THEN
    SELF%FRSOPS  => SELF%F_FRSOPS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FRSOPS)) THEN
  SELF%FRSOPS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FRSDNI)) THEN
  IF ((.NOT. SELF%F_FRSDNI%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FRSDNI))) THEN
    SELF%FRSDNI  => SELF%F_FRSDNI%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FRSDNI)) THEN
  SELF%FRSDNI  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FRSGNI)) THEN
  IF ((.NOT. SELF%F_FRSGNI%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FRSGNI))) THEN
    SELF%FRSGNI  => SELF%F_FRSGNI%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FRSGNI)) THEN
  SELF%FRSGNI  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FRTHDS)) THEN
  IF ((.NOT. SELF%F_FRTHDS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FRTHDS))) THEN
    SELF%FRTHDS  => SELF%F_FRTHDS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FRTHDS)) THEN
  SELF%FRTHDS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FONTE)) THEN
  IF ((.NOT. SELF%F_FONTE%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FONTE))) THEN
    SELF%FONTE  => SELF%F_FONTE%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FONTE)) THEN
  SELF%FONTE  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FGEL)) THEN
  IF ((.NOT. SELF%F_FGEL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FGEL))) THEN
    SELF%FGEL  => SELF%F_FGEL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FGEL)) THEN
  SELF%FGEL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FGELS)) THEN
  IF ((.NOT. SELF%F_FGELS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FGELS))) THEN
    SELF%FGELS  => SELF%F_FGELS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FGELS)) THEN
  SELF%FGELS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_ALB)) THEN
  IF ((.NOT. SELF%F_ALB%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%ALB))) THEN
    SELF%ALB  => SELF%F_ALB%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%ALB)) THEN
  SELF%ALB  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_GZ0)) THEN
  IF ((.NOT. SELF%F_GZ0%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GZ0))) THEN
    SELF%GZ0  => SELF%F_GZ0%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GZ0)) THEN
  SELF%GZ0  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_GZ0H)) THEN
  IF ((.NOT. SELF%F_GZ0H%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GZ0H))) THEN
    SELF%GZ0H  => SELF%F_GZ0H%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GZ0H)) THEN
  SELF%GZ0H  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_RUISL)) THEN
  IF ((.NOT. SELF%F_RUISL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%RUISL))) THEN
    SELF%RUISL  => SELF%F_RUISL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%RUISL)) THEN
  SELF%RUISL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_RUISP)) THEN
  IF ((.NOT. SELF%F_RUISP%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%RUISP))) THEN
    SELF%RUISP  => SELF%F_RUISP%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%RUISP)) THEN
  SELF%RUISP  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_RUISS)) THEN
  IF ((.NOT. SELF%F_RUISS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%RUISS))) THEN
    SELF%RUISS  => SELF%F_RUISS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%RUISS)) THEN
  SELF%RUISS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FRSOPT)) THEN
  IF ((.NOT. SELF%F_FRSOPT%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FRSOPT))) THEN
    SELF%FRSOPT  => SELF%F_FRSOPT%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FRSOPT)) THEN
  SELF%FRSOPT  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FRSOLU)) THEN
  IF ((.NOT. SELF%F_FRSOLU%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FRSOLU))) THEN
    SELF%FRSOLU  => SELF%F_FRSOLU%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FRSOLU)) THEN
  SELF%FRSOLU  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_QCLS)) THEN
  IF ((.NOT. SELF%F_QCLS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%QCLS))) THEN
    SELF%QCLS  => SELF%F_QCLS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%QCLS)) THEN
  SELF%QCLS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_TCLS)) THEN
  IF ((.NOT. SELF%F_TCLS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%TCLS))) THEN
    SELF%TCLS  => SELF%F_TCLS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%TCLS)) THEN
  SELF%TCLS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_UCLS)) THEN
  IF ((.NOT. SELF%F_UCLS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%UCLS))) THEN
    SELF%UCLS  => SELF%F_UCLS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%UCLS)) THEN
  SELF%UCLS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_VCLS)) THEN
  IF ((.NOT. SELF%F_VCLS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VCLS))) THEN
    SELF%VCLS  => SELF%F_VCLS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%VCLS)) THEN
  SELF%VCLS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_NUCLS)) THEN
  IF ((.NOT. SELF%F_NUCLS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%NUCLS))) THEN
    SELF%NUCLS  => SELF%F_NUCLS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%NUCLS)) THEN
  SELF%NUCLS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_NVCLS)) THEN
  IF ((.NOT. SELF%F_NVCLS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%NVCLS))) THEN
    SELF%NVCLS  => SELF%F_NVCLS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%NVCLS)) THEN
  SELF%NVCLS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_RHCLS)) THEN
  IF ((.NOT. SELF%F_RHCLS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%RHCLS))) THEN
    SELF%RHCLS  => SELF%F_RHCLS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%RHCLS)) THEN
  SELF%RHCLS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_MRT)) THEN
  IF ((.NOT. SELF%F_MRT%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%MRT))) THEN
    SELF%MRT  => SELF%F_MRT%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%MRT)) THEN
  SELF%MRT  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_CLCH)) THEN
  IF ((.NOT. SELF%F_CLCH%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%CLCH))) THEN
    SELF%CLCH  => SELF%F_CLCH%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%CLCH)) THEN
  SELF%CLCH  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_CLCM)) THEN
  IF ((.NOT. SELF%F_CLCM%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%CLCM))) THEN
    SELF%CLCM  => SELF%F_CLCM%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%CLCM)) THEN
  SELF%CLCM  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_CLCL)) THEN
  IF ((.NOT. SELF%F_CLCL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%CLCL))) THEN
    SELF%CLCL  => SELF%F_CLCL%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%CLCL)) THEN
  SELF%CLCL  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_CLCC)) THEN
  IF ((.NOT. SELF%F_CLCC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%CLCC))) THEN
    SELF%CLCC  => SELF%F_CLCC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%CLCC)) THEN
  SELF%CLCC  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_CLPH)) THEN
  IF ((.NOT. SELF%F_CLPH%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%CLPH))) THEN
    SELF%CLPH  => SELF%F_CLPH%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%CLPH)) THEN
  SELF%CLPH  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_VEIN)) THEN
  IF ((.NOT. SELF%F_VEIN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VEIN))) THEN
    SELF%VEIN  => SELF%F_VEIN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%VEIN)) THEN
  SELF%VEIN  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_DRNSHF)) THEN
  IF ((.NOT. SELF%F_DRNSHF%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DRNSHF))) THEN
    SELF%DRNSHF  => SELF%F_DRNSHF%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%DRNSHF)) THEN
  SELF%DRNSHF  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_CAPE)) THEN
  IF ((.NOT. SELF%F_CAPE%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%CAPE))) THEN
    SELF%CAPE  => SELF%F_CAPE%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%CAPE)) THEN
  SELF%CAPE  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_CTOP)) THEN
  IF ((.NOT. SELF%F_CTOP%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%CTOP))) THEN
    SELF%CTOP  => SELF%F_CTOP%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%CTOP)) THEN
  SELF%CTOP  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_MOCON)) THEN
  IF ((.NOT. SELF%F_MOCON%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%MOCON))) THEN
    SELF%MOCON  => SELF%F_MOCON%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%MOCON)) THEN
  SELF%MOCON  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_UGST)) THEN
  IF ((.NOT. SELF%F_UGST%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%UGST))) THEN
    SELF%UGST  => SELF%F_UGST%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%UGST)) THEN
  SELF%UGST  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_VGST)) THEN
  IF ((.NOT. SELF%F_VGST%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VGST))) THEN
    SELF%VGST  => SELF%F_VGST%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%VGST)) THEN
  SELF%VGST  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_CT)) THEN
  IF ((.NOT. SELF%F_CT%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%CT))) THEN
    SELF%CT  => SELF%F_CT%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%CT)) THEN
  SELF%CT  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_TENDU)) THEN
  IF ((.NOT. SELF%F_TENDU%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%TENDU))) THEN
    SELF%TENDU  => SELF%F_TENDU%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%TENDU)) THEN
  SELF%TENDU  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_TENDV)) THEN
  IF ((.NOT. SELF%F_TENDV%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%TENDV))) THEN
    SELF%TENDV  => SELF%F_TENDV%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%TENDV)) THEN
  SELF%TENDV  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCQRNG)) THEN
  IF ((.NOT. SELF%F_FCQRNG%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCQRNG))) THEN
    SELF%FCQRNG  => SELF%F_FCQRNG%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCQRNG)) THEN
  SELF%FCQRNG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCQSNG)) THEN
  IF ((.NOT. SELF%F_FCQSNG%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCQSNG))) THEN
    SELF%FCQSNG  => SELF%F_FCQSNG%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCQSNG)) THEN
  SELF%FCQSNG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_FCQGNG)) THEN
  IF ((.NOT. SELF%F_FCQGNG%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FCQGNG))) THEN
    SELF%FCQGNG  => SELF%F_FCQGNG%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FCQGNG)) THEN
  SELF%FCQGNG  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_DIAGH)) THEN
  IF ((.NOT. SELF%F_DIAGH%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DIAGH))) THEN
    SELF%DIAGH  => SELF%F_DIAGH%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%DIAGH)) THEN
  SELF%DIAGH  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_VISICLD)) THEN
  IF ((.NOT. SELF%F_VISICLD%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VISICLD))) THEN
    SELF%VISICLD  => SELF%F_VISICLD%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%VISICLD)) THEN
  SELF%VISICLD  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_FLASH)) THEN
  IF ((.NOT. SELF%F_FLASH%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%FLASH))) THEN
    SELF%FLASH  => SELF%F_FLASH%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%FLASH)) THEN
  SELF%FLASH  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_VISIHYD)) THEN
  IF ((.NOT. SELF%F_VISIHYD%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VISIHYD))) THEN
    SELF%VISIHYD  => SELF%F_VISIHYD%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%VISIHYD)) THEN
  SELF%VISIHYD  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_MXCLWC)) THEN
  IF ((.NOT. SELF%F_MXCLWC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%MXCLWC))) THEN
    SELF%MXCLWC  => SELF%F_MXCLWC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%MXCLWC)) THEN
  SELF%MXCLWC  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_TPWCLS)) THEN
  IF ((.NOT. SELF%F_TPWCLS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%TPWCLS))) THEN
    SELF%TPWCLS  => SELF%F_TPWCLS%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%TPWCLS)) THEN
  SELF%TPWCLS  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_CUCONVCA)) THEN
  IF ((.NOT. SELF%F_CUCONVCA%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%CUCONVCA))) THEN
    SELF%CUCONVCA  => SELF%F_CUCONVCA%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%CUCONVCA)) THEN
  SELF%CUCONVCA  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_NLCONVCA)) THEN
  IF ((.NOT. SELF%F_NLCONVCA%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%NLCONVCA))) THEN
    SELF%NLCONVCA  => SELF%F_NLCONVCA%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%NLCONVCA)) THEN
  SELF%NLCONVCA  => ZDUM1
ENDIF

END SUBROUTINE MF_PHYS_OUT_TYPE_UPDATE_VIEW

SUBROUTINE MF_PHYS_OUT_TYPE_FINAL (SELF)
CLASS (MF_PHYS_OUT_TYPE)         :: SELF

IF (ASSOCIATED (SELF%F_DIFCQ)) CALL DELETE_TEMPORARY (SELF%F_DIFCQ) 
IF (ASSOCIATED (SELF%F_DIFCQL)) CALL DELETE_TEMPORARY (SELF%F_DIFCQL) 
IF (ASSOCIATED (SELF%F_DIFCQN)) CALL DELETE_TEMPORARY (SELF%F_DIFCQN) 
IF (ASSOCIATED (SELF%F_DIFCS)) CALL DELETE_TEMPORARY (SELF%F_DIFCS) 
IF (ASSOCIATED (SELF%F_DIFTQ)) CALL DELETE_TEMPORARY (SELF%F_DIFTQ) 
IF (ASSOCIATED (SELF%F_DIFTQL)) CALL DELETE_TEMPORARY (SELF%F_DIFTQL) 
IF (ASSOCIATED (SELF%F_DIFTQN)) CALL DELETE_TEMPORARY (SELF%F_DIFTQN) 
IF (ASSOCIATED (SELF%F_DIFTS)) CALL DELETE_TEMPORARY (SELF%F_DIFTS) 
IF (ASSOCIATED (SELF%F_EDR)) CALL DELETE_TEMPORARY (SELF%F_EDR) 
IF (ASSOCIATED (SELF%F_FCCQL)) CALL DELETE_TEMPORARY (SELF%F_FCCQL) 
IF (ASSOCIATED (SELF%F_FCCQN)) CALL DELETE_TEMPORARY (SELF%F_FCCQN) 
IF (ASSOCIATED (SELF%F_FCSQL)) CALL DELETE_TEMPORARY (SELF%F_FCSQL) 
IF (ASSOCIATED (SELF%F_FCSQN)) CALL DELETE_TEMPORARY (SELF%F_FCSQN) 
IF (ASSOCIATED (SELF%F_FCQLNG)) CALL DELETE_TEMPORARY (SELF%F_FCQLNG) 
IF (ASSOCIATED (SELF%F_FCQNNG)) CALL DELETE_TEMPORARY (SELF%F_FCQNNG) 
IF (ASSOCIATED (SELF%F_FCQNG)) CALL DELETE_TEMPORARY (SELF%F_FCQNG) 
IF (ASSOCIATED (SELF%F_FPLCL)) CALL DELETE_TEMPORARY (SELF%F_FPLCL) 
IF (ASSOCIATED (SELF%F_FPLCN)) CALL DELETE_TEMPORARY (SELF%F_FPLCN) 
IF (ASSOCIATED (SELF%F_FPLCG)) CALL DELETE_TEMPORARY (SELF%F_FPLCG) 
IF (ASSOCIATED (SELF%F_FPLCH)) CALL DELETE_TEMPORARY (SELF%F_FPLCH) 
IF (ASSOCIATED (SELF%F_FPLSL)) CALL DELETE_TEMPORARY (SELF%F_FPLSL) 
IF (ASSOCIATED (SELF%F_FPLSN)) CALL DELETE_TEMPORARY (SELF%F_FPLSN) 
IF (ASSOCIATED (SELF%F_FPLSG)) CALL DELETE_TEMPORARY (SELF%F_FPLSG) 
IF (ASSOCIATED (SELF%F_FPLSH)) CALL DELETE_TEMPORARY (SELF%F_FPLSH) 
IF (ASSOCIATED (SELF%F_FPFPSL)) CALL DELETE_TEMPORARY (SELF%F_FPFPSL) 
IF (ASSOCIATED (SELF%F_FPFPSN)) CALL DELETE_TEMPORARY (SELF%F_FPFPSN) 
IF (ASSOCIATED (SELF%F_FPFPSG)) CALL DELETE_TEMPORARY (SELF%F_FPFPSG) 
IF (ASSOCIATED (SELF%F_FPFPCL)) CALL DELETE_TEMPORARY (SELF%F_FPFPCL) 
IF (ASSOCIATED (SELF%F_FPFPCN)) CALL DELETE_TEMPORARY (SELF%F_FPFPCN) 
IF (ASSOCIATED (SELF%F_FPEVPSL)) CALL DELETE_TEMPORARY (SELF%F_FPEVPSL) 
IF (ASSOCIATED (SELF%F_FPEVPSN)) CALL DELETE_TEMPORARY (SELF%F_FPEVPSN) 
IF (ASSOCIATED (SELF%F_FPEVPSG)) CALL DELETE_TEMPORARY (SELF%F_FPEVPSG) 
IF (ASSOCIATED (SELF%F_FPEVPCL)) CALL DELETE_TEMPORARY (SELF%F_FPEVPCL) 
IF (ASSOCIATED (SELF%F_FPEVPCN)) CALL DELETE_TEMPORARY (SELF%F_FPEVPCN) 
IF (ASSOCIATED (SELF%F_FPEVPCG)) CALL DELETE_TEMPORARY (SELF%F_FPEVPCG) 
IF (ASSOCIATED (SELF%F_FRSO)) CALL DELETE_TEMPORARY (SELF%F_FRSO) 
IF (ASSOCIATED (SELF%F_FRTH)) CALL DELETE_TEMPORARY (SELF%F_FRTH) 
IF (ASSOCIATED (SELF%F_STRCU)) CALL DELETE_TEMPORARY (SELF%F_STRCU) 
IF (ASSOCIATED (SELF%F_STRCV)) CALL DELETE_TEMPORARY (SELF%F_STRCV) 
IF (ASSOCIATED (SELF%F_STRDU)) CALL DELETE_TEMPORARY (SELF%F_STRDU) 
IF (ASSOCIATED (SELF%F_STRDV)) CALL DELETE_TEMPORARY (SELF%F_STRDV) 
IF (ASSOCIATED (SELF%F_STRTU)) CALL DELETE_TEMPORARY (SELF%F_STRTU) 
IF (ASSOCIATED (SELF%F_STRTV)) CALL DELETE_TEMPORARY (SELF%F_STRTV) 
IF (ASSOCIATED (SELF%F_STRMU)) CALL DELETE_TEMPORARY (SELF%F_STRMU) 
IF (ASSOCIATED (SELF%F_STRMV)) CALL DELETE_TEMPORARY (SELF%F_STRMV) 
IF (ASSOCIATED (SELF%F_DIFCQLC)) CALL DELETE_TEMPORARY (SELF%F_DIFCQLC) 
IF (ASSOCIATED (SELF%F_DIFCQIC)) CALL DELETE_TEMPORARY (SELF%F_DIFCQIC) 
IF (ASSOCIATED (SELF%F_FIMCC)) CALL DELETE_TEMPORARY (SELF%F_FIMCC) 
IF (ASSOCIATED (SELF%F_FEDQLC)) CALL DELETE_TEMPORARY (SELF%F_FEDQLC) 
IF (ASSOCIATED (SELF%F_FEDQIC)) CALL DELETE_TEMPORARY (SELF%F_FEDQIC) 
IF (ASSOCIATED (SELF%F_FEDQRC)) CALL DELETE_TEMPORARY (SELF%F_FEDQRC) 
IF (ASSOCIATED (SELF%F_FEDQSC)) CALL DELETE_TEMPORARY (SELF%F_FEDQSC) 
IF (ASSOCIATED (SELF%F_FCNEGQLC)) CALL DELETE_TEMPORARY (SELF%F_FCNEGQLC) 
IF (ASSOCIATED (SELF%F_FCNEGQIC)) CALL DELETE_TEMPORARY (SELF%F_FCNEGQIC) 
IF (ASSOCIATED (SELF%F_FCNEGQRC)) CALL DELETE_TEMPORARY (SELF%F_FCNEGQRC) 
IF (ASSOCIATED (SELF%F_FCNEGQSC)) CALL DELETE_TEMPORARY (SELF%F_FCNEGQSC) 
IF (ASSOCIATED (SELF%F_FRMH)) CALL DELETE_TEMPORARY (SELF%F_FRMH) 
IF (ASSOCIATED (SELF%F_FCHOZ)) CALL DELETE_TEMPORARY (SELF%F_FCHOZ) 
IF (ASSOCIATED (SELF%F_FDIS)) CALL DELETE_TEMPORARY (SELF%F_FDIS) 
IF (ASSOCIATED (SELF%F_FHPSL)) CALL DELETE_TEMPORARY (SELF%F_FHPSL) 
IF (ASSOCIATED (SELF%F_FHPSN)) CALL DELETE_TEMPORARY (SELF%F_FHPSN) 
IF (ASSOCIATED (SELF%F_FHPSG)) CALL DELETE_TEMPORARY (SELF%F_FHPSG) 
IF (ASSOCIATED (SELF%F_FHPCL)) CALL DELETE_TEMPORARY (SELF%F_FHPCL) 
IF (ASSOCIATED (SELF%F_FHPCN)) CALL DELETE_TEMPORARY (SELF%F_FHPCN) 
IF (ASSOCIATED (SELF%F_FHSCL)) CALL DELETE_TEMPORARY (SELF%F_FHSCL) 
IF (ASSOCIATED (SELF%F_FHSCN)) CALL DELETE_TEMPORARY (SELF%F_FHSCN) 
IF (ASSOCIATED (SELF%F_FHPCG)) CALL DELETE_TEMPORARY (SELF%F_FHPCG) 
IF (ASSOCIATED (SELF%F_FHSSL)) CALL DELETE_TEMPORARY (SELF%F_FHSSL) 
IF (ASSOCIATED (SELF%F_FHSSN)) CALL DELETE_TEMPORARY (SELF%F_FHSSN) 
IF (ASSOCIATED (SELF%F_FEPFP)) CALL DELETE_TEMPORARY (SELF%F_FEPFP) 
IF (ASSOCIATED (SELF%F_FCMPCQ)) CALL DELETE_TEMPORARY (SELF%F_FCMPCQ) 
IF (ASSOCIATED (SELF%F_FCMPSN)) CALL DELETE_TEMPORARY (SELF%F_FCMPSN) 
IF (ASSOCIATED (SELF%F_FHSSG)) CALL DELETE_TEMPORARY (SELF%F_FHSSG) 
IF (ASSOCIATED (SELF%F_FCMPSL)) CALL DELETE_TEMPORARY (SELF%F_FCMPSL) 
IF (ASSOCIATED (SELF%F_FRSOC)) CALL DELETE_TEMPORARY (SELF%F_FRSOC) 
IF (ASSOCIATED (SELF%F_FRTHC)) CALL DELETE_TEMPORARY (SELF%F_FRTHC) 
IF (ASSOCIATED (SELF%F_FCHSP)) CALL DELETE_TEMPORARY (SELF%F_FCHSP) 
IF (ASSOCIATED (SELF%F_FCLL)) CALL DELETE_TEMPORARY (SELF%F_FCLL) 
IF (ASSOCIATED (SELF%F_FCLN)) CALL DELETE_TEMPORARY (SELF%F_FCLN) 
IF (ASSOCIATED (SELF%F_FCS)) CALL DELETE_TEMPORARY (SELF%F_FCS) 
IF (ASSOCIATED (SELF%F_FEVL)) CALL DELETE_TEMPORARY (SELF%F_FEVL) 
IF (ASSOCIATED (SELF%F_FEVN)) CALL DELETE_TEMPORARY (SELF%F_FEVN) 
IF (ASSOCIATED (SELF%F_FEVV)) CALL DELETE_TEMPORARY (SELF%F_FEVV) 
IF (ASSOCIATED (SELF%F_FLWSP)) CALL DELETE_TEMPORARY (SELF%F_FLWSP) 
IF (ASSOCIATED (SELF%F_FTR)) CALL DELETE_TEMPORARY (SELF%F_FTR) 
IF (ASSOCIATED (SELF%F_FRSODS)) CALL DELETE_TEMPORARY (SELF%F_FRSODS) 
IF (ASSOCIATED (SELF%F_FRSOPS)) CALL DELETE_TEMPORARY (SELF%F_FRSOPS) 
IF (ASSOCIATED (SELF%F_FRSDNI)) CALL DELETE_TEMPORARY (SELF%F_FRSDNI) 
IF (ASSOCIATED (SELF%F_FRSGNI)) CALL DELETE_TEMPORARY (SELF%F_FRSGNI) 
IF (ASSOCIATED (SELF%F_FRTHDS)) CALL DELETE_TEMPORARY (SELF%F_FRTHDS) 
IF (ASSOCIATED (SELF%F_FONTE)) CALL DELETE_TEMPORARY (SELF%F_FONTE) 
IF (ASSOCIATED (SELF%F_FGEL)) CALL DELETE_TEMPORARY (SELF%F_FGEL) 
IF (ASSOCIATED (SELF%F_FGELS)) CALL DELETE_TEMPORARY (SELF%F_FGELS) 
IF (ASSOCIATED (SELF%F_ALB)) CALL DELETE_TEMPORARY (SELF%F_ALB) 
IF (ASSOCIATED (SELF%F_GZ0)) CALL DELETE_TEMPORARY (SELF%F_GZ0) 
IF (ASSOCIATED (SELF%F_GZ0H)) CALL DELETE_TEMPORARY (SELF%F_GZ0H) 
IF (ASSOCIATED (SELF%F_RUISL)) CALL DELETE_TEMPORARY (SELF%F_RUISL) 
IF (ASSOCIATED (SELF%F_RUISP)) CALL DELETE_TEMPORARY (SELF%F_RUISP) 
IF (ASSOCIATED (SELF%F_RUISS)) CALL DELETE_TEMPORARY (SELF%F_RUISS) 
IF (ASSOCIATED (SELF%F_FRSOPT)) CALL DELETE_TEMPORARY (SELF%F_FRSOPT) 
IF (ASSOCIATED (SELF%F_FRSOLU)) CALL DELETE_TEMPORARY (SELF%F_FRSOLU) 
IF (ASSOCIATED (SELF%F_QCLS)) CALL DELETE_TEMPORARY (SELF%F_QCLS) 
IF (ASSOCIATED (SELF%F_TCLS)) CALL DELETE_TEMPORARY (SELF%F_TCLS) 
IF (ASSOCIATED (SELF%F_UCLS)) CALL DELETE_TEMPORARY (SELF%F_UCLS) 
IF (ASSOCIATED (SELF%F_VCLS)) CALL DELETE_TEMPORARY (SELF%F_VCLS) 
IF (ASSOCIATED (SELF%F_NUCLS)) CALL DELETE_TEMPORARY (SELF%F_NUCLS) 
IF (ASSOCIATED (SELF%F_NVCLS)) CALL DELETE_TEMPORARY (SELF%F_NVCLS) 
IF (ASSOCIATED (SELF%F_RHCLS)) CALL DELETE_TEMPORARY (SELF%F_RHCLS) 
IF (ASSOCIATED (SELF%F_MRT)) CALL DELETE_TEMPORARY (SELF%F_MRT) 
IF (ASSOCIATED (SELF%F_CLCH)) CALL DELETE_TEMPORARY (SELF%F_CLCH) 
IF (ASSOCIATED (SELF%F_CLCM)) CALL DELETE_TEMPORARY (SELF%F_CLCM) 
IF (ASSOCIATED (SELF%F_CLCL)) CALL DELETE_TEMPORARY (SELF%F_CLCL) 
IF (ASSOCIATED (SELF%F_CLCC)) CALL DELETE_TEMPORARY (SELF%F_CLCC) 
IF (ASSOCIATED (SELF%F_CLPH)) CALL DELETE_TEMPORARY (SELF%F_CLPH) 
IF (ASSOCIATED (SELF%F_VEIN)) CALL DELETE_TEMPORARY (SELF%F_VEIN) 
IF (ASSOCIATED (SELF%F_DRNSHF)) CALL DELETE_TEMPORARY (SELF%F_DRNSHF) 
IF (ASSOCIATED (SELF%F_CAPE)) CALL DELETE_TEMPORARY (SELF%F_CAPE) 
IF (ASSOCIATED (SELF%F_CTOP)) CALL DELETE_TEMPORARY (SELF%F_CTOP) 
IF (ASSOCIATED (SELF%F_MOCON)) CALL DELETE_TEMPORARY (SELF%F_MOCON) 
IF (ASSOCIATED (SELF%F_UGST)) CALL DELETE_TEMPORARY (SELF%F_UGST) 
IF (ASSOCIATED (SELF%F_VGST)) CALL DELETE_TEMPORARY (SELF%F_VGST) 
IF (ASSOCIATED (SELF%F_CT)) CALL DELETE_TEMPORARY (SELF%F_CT) 
IF (ASSOCIATED (SELF%F_TENDU)) CALL DELETE_TEMPORARY (SELF%F_TENDU) 
IF (ASSOCIATED (SELF%F_TENDV)) CALL DELETE_TEMPORARY (SELF%F_TENDV) 
IF (ASSOCIATED (SELF%F_FCQRNG)) CALL DELETE_TEMPORARY (SELF%F_FCQRNG) 
IF (ASSOCIATED (SELF%F_FCQSNG)) CALL DELETE_TEMPORARY (SELF%F_FCQSNG) 
IF (ASSOCIATED (SELF%F_FCQGNG)) CALL DELETE_TEMPORARY (SELF%F_FCQGNG) 
IF (ASSOCIATED (SELF%F_DIAGH)) CALL DELETE_TEMPORARY (SELF%F_DIAGH) 
IF (ASSOCIATED (SELF%F_VISICLD)) CALL DELETE_TEMPORARY (SELF%F_VISICLD) 
IF (ASSOCIATED (SELF%F_FLASH)) CALL DELETE_TEMPORARY (SELF%F_FLASH) 
IF (ASSOCIATED (SELF%F_VISIHYD)) CALL DELETE_TEMPORARY (SELF%F_VISIHYD) 
IF (ASSOCIATED (SELF%F_MXCLWC)) CALL DELETE_TEMPORARY (SELF%F_MXCLWC) 
IF (ASSOCIATED (SELF%F_TPWCLS)) CALL DELETE_TEMPORARY (SELF%F_TPWCLS) 
IF (ASSOCIATED (SELF%F_CUCONVCA)) CALL DELETE_TEMPORARY (SELF%F_CUCONVCA) 
IF (ASSOCIATED (SELF%F_NLCONVCA)) CALL DELETE_TEMPORARY (SELF%F_NLCONVCA) 

END SUBROUTINE MF_PHYS_OUT_TYPE_FINAL




SUBROUTINE MF_PHYS_OPT_TYPE_INIT (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                                & , PERSISTENT &
                                & , LDMF_PHYS &
                           &, PGDEOSI &
                           &, PGUEOSI &
                           &, PGMU0 &
                           &, PGMU0_MIN &
                           &, PGMU0_MAX &
                           &, PGDEOTI &
                           &, PGDEOTI2 &
                           &, PGUEOTI &
                           &, PGUEOTI2 &
                           &, PGEOLT &
                           &, PGEOXT &
                           &, PGRPROX &
                           &, PGMIXP &
                           &, PGFLUXC &
                           &, PGRSURF &
                           &)


USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_OPT_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS

REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGDEOSI(:, :, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGUEOSI(:, :, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGMU0(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGMU0_MIN(:, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGMU0_MAX(:, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGDEOTI(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGDEOTI2(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGUEOTI(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGUEOTI2(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGEOLT(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGEOXT(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGRPROX(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGMIXP(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGFLUXC(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGRSURF(:, :)

LOGICAL :: LLMF_PHYS




LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGDEOSI)) THEN
      SELF%F_GDEOSI => CREATE_FIELD_WRAP (PGDEOSI, LBOUNDS=[1, 1, 1, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGUEOSI)) THEN
      SELF%F_GUEOSI => CREATE_FIELD_WRAP (PGUEOSI, LBOUNDS=[1, 1, 1, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGMU0)) THEN
      SELF%F_GMU0 => CREATE_FIELD_WRAP (PGMU0, LBOUNDS=[1, 0, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGMU0_MIN)) THEN
      SELF%F_GMU0_MIN => CREATE_FIELD_WRAP (PGMU0_MIN, LBOUNDS=[1, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGMU0_MAX)) THEN
      SELF%F_GMU0_MAX => CREATE_FIELD_WRAP (PGMU0_MAX, LBOUNDS=[1, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGDEOTI)) THEN
      SELF%F_GDEOTI => CREATE_FIELD_WRAP (PGDEOTI, LBOUNDS=[1, 0, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGDEOTI2)) THEN
      SELF%F_GDEOTI2 => CREATE_FIELD_WRAP (PGDEOTI2, LBOUNDS=[1, 0, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGUEOTI)) THEN
      SELF%F_GUEOTI => CREATE_FIELD_WRAP (PGUEOTI, LBOUNDS=[1, 0, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGUEOTI2)) THEN
      SELF%F_GUEOTI2 => CREATE_FIELD_WRAP (PGUEOTI2, LBOUNDS=[1, 0, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGEOLT)) THEN
      SELF%F_GEOLT => CREATE_FIELD_WRAP (PGEOLT, LBOUNDS=[1, 1, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGEOXT)) THEN
      SELF%F_GEOXT => CREATE_FIELD_WRAP (PGEOXT, LBOUNDS=[1, 1, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGRPROX)) THEN
      SELF%F_GRPROX => CREATE_FIELD_WRAP (PGRPROX, LBOUNDS=[1, 0, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGMIXP)) THEN
      SELF%F_GMIXP => CREATE_FIELD_WRAP (PGMIXP, LBOUNDS=[1, 0, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGFLUXC)) THEN
      SELF%F_GFLUXC => CREATE_FIELD_WRAP (PGFLUXC, LBOUNDS=[1, 0, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PGRSURF)) THEN
      SELF%F_GRSURF => CREATE_FIELD_WRAP (PGRSURF, LBOUNDS=[1, 1])
  ENDIF
ENDIF


END SUBROUTINE MF_PHYS_OPT_TYPE_INIT

SUBROUTINE MF_PHYS_OPT_TYPE_INIT_STACK (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                                & , LDMF_PHYS &
                           &, PGDEOSI &
                           &, PGUEOSI &
                           &, PGMU0 &
                           &, PGMU0_MIN &
                           &, PGMU0_MAX &
                           &, PGDEOTI &
                           &, PGDEOTI2 &
                           &, PGUEOTI &
                           &, PGUEOTI2 &
                           &, PGEOLT &
                           &, PGEOXT &
                           &, PGRPROX &
                           &, PGMIXP &
                           &, PGFLUXC &
                           &, PGRSURF &
                           &)


USE STACK_MOD, ONLY : MALIGN

USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_OPT_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS

REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGDEOSI(:, :, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGUEOSI(:, :, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGMU0(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGMU0_MIN(:, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGMU0_MAX(:, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGDEOTI(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGDEOTI2(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGUEOTI(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGUEOTI2(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGEOLT(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGEOXT(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGRPROX(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGMIXP(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGFLUXC(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGRSURF(:, :)

LOGICAL :: LLMF_PHYS




LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

SELF%ISIZE = 0

!PRINT *, "GDEOSI", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGDEOSI)) THEN
  ENDIF
ENDIF

!PRINT *, "GUEOSI", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGUEOSI)) THEN
  ENDIF
ENDIF

!PRINT *, "GMU0", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGMU0)) THEN
  ENDIF
ENDIF

!PRINT *, "GMU0_MIN", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGMU0_MIN)) THEN
  ENDIF
ENDIF

!PRINT *, "GMU0_MAX", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGMU0_MAX)) THEN
  ENDIF
ENDIF

!PRINT *, "GDEOTI", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGDEOTI)) THEN
  ENDIF
ENDIF

!PRINT *, "GDEOTI2", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGDEOTI2)) THEN
  ENDIF
ENDIF

!PRINT *, "GUEOTI", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGUEOTI)) THEN
  ENDIF
ENDIF

!PRINT *, "GUEOTI2", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGUEOTI2)) THEN
  ENDIF
ENDIF

!PRINT *, "GEOLT", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGEOLT)) THEN
  ENDIF
ENDIF

!PRINT *, "GEOXT", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGEOXT)) THEN
  ENDIF
ENDIF

!PRINT *, "GRPROX", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGRPROX)) THEN
  ENDIF
ENDIF

!PRINT *, "GMIXP", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGMIXP)) THEN
  ENDIF
ENDIF

!PRINT *, "GFLUXC", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGFLUXC)) THEN
  ENDIF
ENDIF

!PRINT *, "GRSURF", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGRSURF)) THEN
  ENDIF
ENDIF


END SUBROUTINE MF_PHYS_OPT_TYPE_INIT_STACK

SUBROUTINE MF_PHYS_OPT_TYPE_ALLOC_STACK (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                                & , LDMF_PHYS &
                                &, PGDEOSI &
                                &, PGUEOSI &
                                &, PGMU0 &
                                &, PGMU0_MIN &
                                &, PGMU0_MAX &
                                &, PGDEOTI &
                                &, PGDEOTI2 &
                                &, PGUEOTI &
                                &, PGUEOTI2 &
                                &, PGEOLT &
                                &, PGEOXT &
                                &, PGRPROX &
                                &, PGMIXP &
                                &, PGFLUXC &
                                &, PGRSURF &
                                &, YDSTACK &
                           &)


USE STACK_MOD, ONLY : STACK

USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_OPT_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS

REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGDEOSI(:, :, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGUEOSI(:, :, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGMU0(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGMU0_MIN(:, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGMU0_MAX(:, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGDEOTI(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGDEOTI2(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGUEOTI(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGUEOTI2(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGEOLT(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGEOXT(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGRPROX(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGMIXP(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGFLUXC(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PGRSURF(:, :)
TYPE (STACK)                                 :: YDSTACK

LOGICAL :: LLMF_PHYS





LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

!PRINT *, "GDEOSI", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGDEOSI)) THEN
   SELF%GDEOSI_ALL  => PGDEOSI 
  ENDIF
ENDIF

!PRINT *, "GUEOSI", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGUEOSI)) THEN
   SELF%GUEOSI_ALL  => PGUEOSI 
  ENDIF
ENDIF

!PRINT *, "GMU0", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGMU0)) THEN
   SELF%GMU0_ALL (1:,0:, 1:) => PGMU0 
  ENDIF
ENDIF

!PRINT *, "GMU0_MIN", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGMU0_MIN)) THEN
   SELF%GMU0_MIN_ALL  => PGMU0_MIN 
  ENDIF
ENDIF

!PRINT *, "GMU0_MAX", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGMU0_MAX)) THEN
   SELF%GMU0_MAX_ALL  => PGMU0_MAX 
  ENDIF
ENDIF

!PRINT *, "GDEOTI", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGDEOTI)) THEN
   SELF%GDEOTI_ALL (1:,0:, 1:) => PGDEOTI 
  ENDIF
ENDIF

!PRINT *, "GDEOTI2", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGDEOTI2)) THEN
   SELF%GDEOTI2_ALL (1:,0:, 1:) => PGDEOTI2 
  ENDIF
ENDIF

!PRINT *, "GUEOTI", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGUEOTI)) THEN
   SELF%GUEOTI_ALL (1:,0:, 1:) => PGUEOTI 
  ENDIF
ENDIF

!PRINT *, "GUEOTI2", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGUEOTI2)) THEN
   SELF%GUEOTI2_ALL (1:,0:, 1:) => PGUEOTI2 
  ENDIF
ENDIF

!PRINT *, "GEOLT", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGEOLT)) THEN
   SELF%GEOLT_ALL  => PGEOLT 
  ENDIF
ENDIF

!PRINT *, "GEOXT", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGEOXT)) THEN
   SELF%GEOXT_ALL  => PGEOXT 
  ENDIF
ENDIF

!PRINT *, "GRPROX", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGRPROX)) THEN
   SELF%GRPROX_ALL (1:,0:, 1:) => PGRPROX 
  ENDIF
ENDIF

!PRINT *, "GMIXP", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGMIXP)) THEN
   SELF%GMIXP_ALL (1:,0:, 1:) => PGMIXP 
  ENDIF
ENDIF

!PRINT *, "GFLUXC", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGFLUXC)) THEN
   SELF%GFLUXC_ALL (1:,0:, 1:) => PGFLUXC 
  ENDIF
ENDIF

!PRINT *, "GRSURF", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PGRSURF)) THEN
   SELF%GRSURF_ALL  => PGRSURF 
  ENDIF
ENDIF


END SUBROUTINE MF_PHYS_OPT_TYPE_ALLOC_STACK

SUBROUTINE MF_PHYS_OPT_TYPE_UPDATE_VIEW_STACK (SELF, BLOCK_INDEX)

CLASS (MF_PHYS_OPT_TYPE)                    :: SELF
INTEGER (KIND=JPIM), INTENT (IN)    :: BLOCK_INDEX

IF (ASSOCIATED (SELF%GDEOSI_ALL)) THEN
  SELF%GDEOSI  => SELF%GDEOSI_ALL (:, :, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%GUEOSI_ALL)) THEN
  SELF%GUEOSI  => SELF%GUEOSI_ALL (:, :, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%GMU0_ALL)) THEN
  SELF%GMU0 (1:,0:) => SELF%GMU0_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%GMU0_MIN_ALL)) THEN
  SELF%GMU0_MIN  => SELF%GMU0_MIN_ALL (:, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%GMU0_MAX_ALL)) THEN
  SELF%GMU0_MAX  => SELF%GMU0_MAX_ALL (:, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%GDEOTI_ALL)) THEN
  SELF%GDEOTI (1:,0:) => SELF%GDEOTI_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%GDEOTI2_ALL)) THEN
  SELF%GDEOTI2 (1:,0:) => SELF%GDEOTI2_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%GUEOTI_ALL)) THEN
  SELF%GUEOTI (1:,0:) => SELF%GUEOTI_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%GUEOTI2_ALL)) THEN
  SELF%GUEOTI2 (1:,0:) => SELF%GUEOTI2_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%GEOLT_ALL)) THEN
  SELF%GEOLT  => SELF%GEOLT_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%GEOXT_ALL)) THEN
  SELF%GEOXT  => SELF%GEOXT_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%GRPROX_ALL)) THEN
  SELF%GRPROX (1:,0:) => SELF%GRPROX_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%GMIXP_ALL)) THEN
  SELF%GMIXP (1:,0:) => SELF%GMIXP_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%GFLUXC_ALL)) THEN
  SELF%GFLUXC (1:,0:) => SELF%GFLUXC_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%GRSURF_ALL)) THEN
  SELF%GRSURF  => SELF%GRSURF_ALL (:, BLOCK_INDEX)
ENDIF

END SUBROUTINE MF_PHYS_OPT_TYPE_UPDATE_VIEW_STACK

INTEGER (KIND=JPIB) FUNCTION MF_PHYS_OPT_TYPE_SIZE_STACK (SELF)

CLASS (MF_PHYS_OPT_TYPE)         :: SELF

MF_PHYS_OPT_TYPE_SIZE_STACK = SELF%ISIZE

END FUNCTION MF_PHYS_OPT_TYPE_SIZE_STACK


SUBROUTINE MF_PHYS_OPT_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (MF_PHYS_OPT_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_GDEOSI)) THEN
  IF ((.NOT. SELF%F_GDEOSI%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GDEOSI))) THEN
    SELF%GDEOSI  => SELF%F_GDEOSI%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GDEOSI)) THEN
  SELF%GDEOSI  => ZDUM3
ENDIF
IF (ASSOCIATED (SELF%F_GUEOSI)) THEN
  IF ((.NOT. SELF%F_GUEOSI%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GUEOSI))) THEN
    SELF%GUEOSI  => SELF%F_GUEOSI%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GUEOSI)) THEN
  SELF%GUEOSI  => ZDUM3
ENDIF
IF (ASSOCIATED (SELF%F_GMU0)) THEN
  IF ((.NOT. SELF%F_GMU0%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GMU0))) THEN
    SELF%GMU0  => SELF%F_GMU0%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GMU0)) THEN
  SELF%GMU0  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GMU0_MIN)) THEN
  IF ((.NOT. SELF%F_GMU0_MIN%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GMU0_MIN))) THEN
    SELF%GMU0_MIN  => SELF%F_GMU0_MIN%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GMU0_MIN)) THEN
  SELF%GMU0_MIN  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_GMU0_MAX)) THEN
  IF ((.NOT. SELF%F_GMU0_MAX%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GMU0_MAX))) THEN
    SELF%GMU0_MAX  => SELF%F_GMU0_MAX%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GMU0_MAX)) THEN
  SELF%GMU0_MAX  => ZDUM1
ENDIF
IF (ASSOCIATED (SELF%F_GDEOTI)) THEN
  IF ((.NOT. SELF%F_GDEOTI%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GDEOTI))) THEN
    SELF%GDEOTI  => SELF%F_GDEOTI%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GDEOTI)) THEN
  SELF%GDEOTI  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GDEOTI2)) THEN
  IF ((.NOT. SELF%F_GDEOTI2%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GDEOTI2))) THEN
    SELF%GDEOTI2  => SELF%F_GDEOTI2%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GDEOTI2)) THEN
  SELF%GDEOTI2  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GUEOTI)) THEN
  IF ((.NOT. SELF%F_GUEOTI%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GUEOTI))) THEN
    SELF%GUEOTI  => SELF%F_GUEOTI%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GUEOTI)) THEN
  SELF%GUEOTI  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GUEOTI2)) THEN
  IF ((.NOT. SELF%F_GUEOTI2%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GUEOTI2))) THEN
    SELF%GUEOTI2  => SELF%F_GUEOTI2%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GUEOTI2)) THEN
  SELF%GUEOTI2  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GEOLT)) THEN
  IF ((.NOT. SELF%F_GEOLT%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GEOLT))) THEN
    SELF%GEOLT  => SELF%F_GEOLT%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GEOLT)) THEN
  SELF%GEOLT  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GEOXT)) THEN
  IF ((.NOT. SELF%F_GEOXT%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GEOXT))) THEN
    SELF%GEOXT  => SELF%F_GEOXT%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GEOXT)) THEN
  SELF%GEOXT  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GRPROX)) THEN
  IF ((.NOT. SELF%F_GRPROX%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GRPROX))) THEN
    SELF%GRPROX  => SELF%F_GRPROX%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GRPROX)) THEN
  SELF%GRPROX  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GMIXP)) THEN
  IF ((.NOT. SELF%F_GMIXP%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GMIXP))) THEN
    SELF%GMIXP  => SELF%F_GMIXP%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GMIXP)) THEN
  SELF%GMIXP  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GFLUXC)) THEN
  IF ((.NOT. SELF%F_GFLUXC%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GFLUXC))) THEN
    SELF%GFLUXC  => SELF%F_GFLUXC%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GFLUXC)) THEN
  SELF%GFLUXC  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_GRSURF)) THEN
  IF ((.NOT. SELF%F_GRSURF%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GRSURF))) THEN
    SELF%GRSURF  => SELF%F_GRSURF%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%GRSURF)) THEN
  SELF%GRSURF  => ZDUM1
ENDIF

END SUBROUTINE MF_PHYS_OPT_TYPE_UPDATE_VIEW

SUBROUTINE MF_PHYS_OPT_TYPE_FINAL (SELF)
CLASS (MF_PHYS_OPT_TYPE)         :: SELF

IF (ASSOCIATED (SELF%F_GDEOSI)) CALL DELETE_TEMPORARY (SELF%F_GDEOSI) 
IF (ASSOCIATED (SELF%F_GUEOSI)) CALL DELETE_TEMPORARY (SELF%F_GUEOSI) 
IF (ASSOCIATED (SELF%F_GMU0)) CALL DELETE_TEMPORARY (SELF%F_GMU0) 
IF (ASSOCIATED (SELF%F_GMU0_MIN)) CALL DELETE_TEMPORARY (SELF%F_GMU0_MIN) 
IF (ASSOCIATED (SELF%F_GMU0_MAX)) CALL DELETE_TEMPORARY (SELF%F_GMU0_MAX) 
IF (ASSOCIATED (SELF%F_GDEOTI)) CALL DELETE_TEMPORARY (SELF%F_GDEOTI) 
IF (ASSOCIATED (SELF%F_GDEOTI2)) CALL DELETE_TEMPORARY (SELF%F_GDEOTI2) 
IF (ASSOCIATED (SELF%F_GUEOTI)) CALL DELETE_TEMPORARY (SELF%F_GUEOTI) 
IF (ASSOCIATED (SELF%F_GUEOTI2)) CALL DELETE_TEMPORARY (SELF%F_GUEOTI2) 
IF (ASSOCIATED (SELF%F_GEOLT)) CALL DELETE_TEMPORARY (SELF%F_GEOLT) 
IF (ASSOCIATED (SELF%F_GEOXT)) CALL DELETE_TEMPORARY (SELF%F_GEOXT) 
IF (ASSOCIATED (SELF%F_GRPROX)) CALL DELETE_TEMPORARY (SELF%F_GRPROX) 
IF (ASSOCIATED (SELF%F_GMIXP)) CALL DELETE_TEMPORARY (SELF%F_GMIXP) 
IF (ASSOCIATED (SELF%F_GFLUXC)) CALL DELETE_TEMPORARY (SELF%F_GFLUXC) 
IF (ASSOCIATED (SELF%F_GRSURF)) CALL DELETE_TEMPORARY (SELF%F_GRSURF) 

END SUBROUTINE MF_PHYS_OPT_TYPE_FINAL




SUBROUTINE MF_PHYS_FOR_TYPE_INIT (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                                & , PERSISTENT &
                                & , LDMF_PHYS &
                           &, PU &
                           &, PV &
                           &, PT &
                           &, PQ &
                           &)


USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_FOR_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS

REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PU(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PV(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PT(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PQ(:, :, :)

LOGICAL :: LLMF_PHYS




LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PU)) THEN
      SELF%F_U => CREATE_FIELD_WRAP (PU, LBOUNDS=[1, 1, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PV)) THEN
      SELF%F_V => CREATE_FIELD_WRAP (PV, LBOUNDS=[1, 1, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PT)) THEN
      SELF%F_T => CREATE_FIELD_WRAP (PT, LBOUNDS=[1, 1, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PQ)) THEN
      SELF%F_Q => CREATE_FIELD_WRAP (PQ, LBOUNDS=[1, 1, 1])
  ENDIF
ENDIF


END SUBROUTINE MF_PHYS_FOR_TYPE_INIT

SUBROUTINE MF_PHYS_FOR_TYPE_INIT_STACK (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                                & , LDMF_PHYS &
                           &, PU &
                           &, PV &
                           &, PT &
                           &, PQ &
                           &)


USE STACK_MOD, ONLY : MALIGN

USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_FOR_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS

REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PU(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PV(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PT(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PQ(:, :, :)

LOGICAL :: LLMF_PHYS




LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

SELF%ISIZE = 0

!PRINT *, "U", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PU)) THEN
  ENDIF
ENDIF

!PRINT *, "V", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PV)) THEN
  ENDIF
ENDIF

!PRINT *, "T", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PT)) THEN
  ENDIF
ENDIF

!PRINT *, "Q", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PQ)) THEN
  ENDIF
ENDIF


END SUBROUTINE MF_PHYS_FOR_TYPE_INIT_STACK

SUBROUTINE MF_PHYS_FOR_TYPE_ALLOC_STACK (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                                & , LDMF_PHYS &
                                &, PU &
                                &, PV &
                                &, PT &
                                &, PQ &
                                &, YDSTACK &
                           &)


USE STACK_MOD, ONLY : STACK

USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_FOR_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS

REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PU(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PV(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PT(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PQ(:, :, :)
TYPE (STACK)                                 :: YDSTACK

LOGICAL :: LLMF_PHYS





LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

!PRINT *, "U", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PU)) THEN
   SELF%U_ALL  => PU 
  ENDIF
ENDIF

!PRINT *, "V", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PV)) THEN
   SELF%V_ALL  => PV 
  ENDIF
ENDIF

!PRINT *, "T", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PT)) THEN
   SELF%T_ALL  => PT 
  ENDIF
ENDIF

!PRINT *, "Q", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PQ)) THEN
   SELF%Q_ALL  => PQ 
  ENDIF
ENDIF


END SUBROUTINE MF_PHYS_FOR_TYPE_ALLOC_STACK

SUBROUTINE MF_PHYS_FOR_TYPE_UPDATE_VIEW_STACK (SELF, BLOCK_INDEX)

CLASS (MF_PHYS_FOR_TYPE)                    :: SELF
INTEGER (KIND=JPIM), INTENT (IN)    :: BLOCK_INDEX

IF (ASSOCIATED (SELF%U_ALL)) THEN
  SELF%U  => SELF%U_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%V_ALL)) THEN
  SELF%V  => SELF%V_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%T_ALL)) THEN
  SELF%T  => SELF%T_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%Q_ALL)) THEN
  SELF%Q  => SELF%Q_ALL (:, :, BLOCK_INDEX)
ENDIF

END SUBROUTINE MF_PHYS_FOR_TYPE_UPDATE_VIEW_STACK

INTEGER (KIND=JPIB) FUNCTION MF_PHYS_FOR_TYPE_SIZE_STACK (SELF)

CLASS (MF_PHYS_FOR_TYPE)         :: SELF

MF_PHYS_FOR_TYPE_SIZE_STACK = SELF%ISIZE

END FUNCTION MF_PHYS_FOR_TYPE_SIZE_STACK


SUBROUTINE MF_PHYS_FOR_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (MF_PHYS_FOR_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_U)) THEN
  IF ((.NOT. SELF%F_U%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%U))) THEN
    SELF%U  => SELF%F_U%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%U)) THEN
  SELF%U  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_V)) THEN
  IF ((.NOT. SELF%F_V%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%V))) THEN
    SELF%V  => SELF%F_V%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%V)) THEN
  SELF%V  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_T)) THEN
  IF ((.NOT. SELF%F_T%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%T))) THEN
    SELF%T  => SELF%F_T%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%T)) THEN
  SELF%T  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_Q)) THEN
  IF ((.NOT. SELF%F_Q%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%Q))) THEN
    SELF%Q  => SELF%F_Q%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%Q)) THEN
  SELF%Q  => ZDUM2
ENDIF

END SUBROUTINE MF_PHYS_FOR_TYPE_UPDATE_VIEW

SUBROUTINE MF_PHYS_FOR_TYPE_FINAL (SELF)
CLASS (MF_PHYS_FOR_TYPE)         :: SELF

IF (ASSOCIATED (SELF%F_U)) CALL DELETE_TEMPORARY (SELF%F_U) 
IF (ASSOCIATED (SELF%F_V)) CALL DELETE_TEMPORARY (SELF%F_V) 
IF (ASSOCIATED (SELF%F_T)) CALL DELETE_TEMPORARY (SELF%F_T) 
IF (ASSOCIATED (SELF%F_Q)) CALL DELETE_TEMPORARY (SELF%F_Q) 

END SUBROUTINE MF_PHYS_FOR_TYPE_FINAL




SUBROUTINE MF_PHYS_GRA_TYPE_INIT (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                                & , PERSISTENT &
                                & , LDMF_PHYS &
                           &, PG &
                           &)


USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_GRA_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS

REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PG(:, :, :, :)

LOGICAL :: LLMF_PHYS




LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PG)) THEN
      SELF%F_G => CREATE_FIELD_WRAP (PG, LBOUNDS=[1, 1, 1, 1])
  ENDIF
ENDIF


END SUBROUTINE MF_PHYS_GRA_TYPE_INIT

SUBROUTINE MF_PHYS_GRA_TYPE_INIT_STACK (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                                & , LDMF_PHYS &
                           &, PG &
                           &)


USE STACK_MOD, ONLY : MALIGN

USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_GRA_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS

REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PG(:, :, :, :)

LOGICAL :: LLMF_PHYS




LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

SELF%ISIZE = 0

!PRINT *, "G", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PG)) THEN
  ENDIF
ENDIF


END SUBROUTINE MF_PHYS_GRA_TYPE_INIT_STACK

SUBROUTINE MF_PHYS_GRA_TYPE_ALLOC_STACK (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                                & , LDMF_PHYS &
                                &, PG &
                                &, YDSTACK &
                           &)


USE STACK_MOD, ONLY : STACK

USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_GRA_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS

REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PG(:, :, :, :)
TYPE (STACK)                                 :: YDSTACK

LOGICAL :: LLMF_PHYS





LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

!PRINT *, "G", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PG)) THEN
   SELF%G_ALL  => PG 
  ENDIF
ENDIF


END SUBROUTINE MF_PHYS_GRA_TYPE_ALLOC_STACK

SUBROUTINE MF_PHYS_GRA_TYPE_UPDATE_VIEW_STACK (SELF, BLOCK_INDEX)

CLASS (MF_PHYS_GRA_TYPE)                    :: SELF
INTEGER (KIND=JPIM), INTENT (IN)    :: BLOCK_INDEX

IF (ASSOCIATED (SELF%G_ALL)) THEN
  SELF%G  => SELF%G_ALL (:, :, :, BLOCK_INDEX)
ENDIF

END SUBROUTINE MF_PHYS_GRA_TYPE_UPDATE_VIEW_STACK

INTEGER (KIND=JPIB) FUNCTION MF_PHYS_GRA_TYPE_SIZE_STACK (SELF)

CLASS (MF_PHYS_GRA_TYPE)         :: SELF

MF_PHYS_GRA_TYPE_SIZE_STACK = SELF%ISIZE

END FUNCTION MF_PHYS_GRA_TYPE_SIZE_STACK


SUBROUTINE MF_PHYS_GRA_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (MF_PHYS_GRA_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_G)) THEN
  IF ((.NOT. SELF%F_G%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%G))) THEN
    SELF%G  => SELF%F_G%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%G)) THEN
  SELF%G  => ZDUM3
ENDIF

END SUBROUTINE MF_PHYS_GRA_TYPE_UPDATE_VIEW

SUBROUTINE MF_PHYS_GRA_TYPE_FINAL (SELF)
CLASS (MF_PHYS_GRA_TYPE)         :: SELF

IF (ASSOCIATED (SELF%F_G)) CALL DELETE_TEMPORARY (SELF%F_G) 

END SUBROUTINE MF_PHYS_GRA_TYPE_FINAL




SUBROUTINE MF_PHYS_RAD_TYPE_INIT (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                                & , PERSISTENT &
                                & , LDMF_PHYS &
                           &, PEMTD &
                           &, PEMTU &
                           &, PTRSW &
                           &, PRMOON &
                           &)


USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_RAD_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS
LOGICAL, OPTIONAL,            INTENT (IN)    :: PERSISTENT
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS

REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PEMTD(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PEMTU(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PTRSW(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PRMOON(:, :)

LOGICAL :: LLMF_PHYS




LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PEMTD)) THEN
      SELF%F_EMTD => CREATE_FIELD_WRAP (PEMTD, LBOUNDS=[1, 0, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PEMTU)) THEN
      SELF%F_EMTU => CREATE_FIELD_WRAP (PEMTU, LBOUNDS=[1, 0, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PTRSW)) THEN
      SELF%F_TRSW => CREATE_FIELD_WRAP (PTRSW, LBOUNDS=[1, 0, 1])
  ENDIF
ENDIF

IF (LLMF_PHYS) THEN
  IF (PRESENT (PRMOON)) THEN
      SELF%F_RMOON => CREATE_FIELD_WRAP (PRMOON, LBOUNDS=[1, 1])
  ENDIF
ENDIF


END SUBROUTINE MF_PHYS_RAD_TYPE_INIT

SUBROUTINE MF_PHYS_RAD_TYPE_INIT_STACK (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                                & , LDMF_PHYS &
                           &, PEMTD &
                           &, PEMTU &
                           &, PTRSW &
                           &, PRMOON &
                           &)


USE STACK_MOD, ONLY : MALIGN

USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_RAD_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS

REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PEMTD(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PEMTU(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PTRSW(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PRMOON(:, :)

LOGICAL :: LLMF_PHYS




LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

SELF%ISIZE = 0

!PRINT *, "EMTD", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PEMTD)) THEN
  ENDIF
ENDIF

!PRINT *, "EMTU", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PEMTU)) THEN
  ENDIF
ENDIF

!PRINT *, "TRSW", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PTRSW)) THEN
  ENDIF
ENDIF

!PRINT *, "RMOON", SELF%ISIZE
IF (LLMF_PHYS) THEN
  IF (PRESENT (PRMOON)) THEN
  ENDIF
ENDIF


END SUBROUTINE MF_PHYS_RAD_TYPE_INIT_STACK

SUBROUTINE MF_PHYS_RAD_TYPE_ALLOC_STACK (SELF &
                                & , REGISTRY &
                                & , YDCPG_OPTS &
                                & , LDMF_PHYS &
                                &, PEMTD &
                                &, PEMTU &
                                &, PTRSW &
                                &, PRMOON &
                                &, YDSTACK &
                           &)


USE STACK_MOD, ONLY : STACK

USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE


CLASS (MF_PHYS_RAD_TYPE)                    :: SELF
TYPE (FIELD_REGISTRY),        INTENT (INOUT) :: REGISTRY
TYPE (CPG_OPTS_TYPE),         INTENT (IN)    :: YDCPG_OPTS
LOGICAL, OPTIONAL,            INTENT (IN)    :: LDMF_PHYS

REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PEMTD(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PEMTU(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PTRSW(:, :, :)
REAL(KIND=JPRB),       INTENT (IN), OPTIONAL, TARGET  :: PRMOON(:, :)
TYPE (STACK)                                 :: YDSTACK

LOGICAL :: LLMF_PHYS





LLMF_PHYS = .FALSE.
IF (PRESENT (LDMF_PHYS)) THEN
  LLMF_PHYS = LDMF_PHYS
ENDIF

!PRINT *, "EMTD", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PEMTD)) THEN
   SELF%EMTD_ALL (1:,0:, 1:) => PEMTD 
  ENDIF
ENDIF

!PRINT *, "EMTU", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PEMTU)) THEN
   SELF%EMTU_ALL (1:,0:, 1:) => PEMTU 
  ENDIF
ENDIF

!PRINT *, "TRSW", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PTRSW)) THEN
   SELF%TRSW_ALL (1:,0:, 1:) => PTRSW 
  ENDIF
ENDIF

!PRINT *, "RMOON", YDSTACK%IPTR-70785, YDSTACK%IPTR
IF (LLMF_PHYS) THEN
  IF (PRESENT (PRMOON)) THEN
   SELF%RMOON_ALL  => PRMOON 
  ENDIF
ENDIF


END SUBROUTINE MF_PHYS_RAD_TYPE_ALLOC_STACK

SUBROUTINE MF_PHYS_RAD_TYPE_UPDATE_VIEW_STACK (SELF, BLOCK_INDEX)

CLASS (MF_PHYS_RAD_TYPE)                    :: SELF
INTEGER (KIND=JPIM), INTENT (IN)    :: BLOCK_INDEX

IF (ASSOCIATED (SELF%EMTD_ALL)) THEN
  SELF%EMTD (1:,0:) => SELF%EMTD_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%EMTU_ALL)) THEN
  SELF%EMTU (1:,0:) => SELF%EMTU_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%TRSW_ALL)) THEN
  SELF%TRSW (1:,0:) => SELF%TRSW_ALL (:, :, BLOCK_INDEX)
ENDIF
IF (ASSOCIATED (SELF%RMOON_ALL)) THEN
  SELF%RMOON  => SELF%RMOON_ALL (:, BLOCK_INDEX)
ENDIF

END SUBROUTINE MF_PHYS_RAD_TYPE_UPDATE_VIEW_STACK

INTEGER (KIND=JPIB) FUNCTION MF_PHYS_RAD_TYPE_SIZE_STACK (SELF)

CLASS (MF_PHYS_RAD_TYPE)         :: SELF

MF_PHYS_RAD_TYPE_SIZE_STACK = SELF%ISIZE

END FUNCTION MF_PHYS_RAD_TYPE_SIZE_STACK


SUBROUTINE MF_PHYS_RAD_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (MF_PHYS_RAD_TYPE)         :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_EMTD)) THEN
  IF ((.NOT. SELF%F_EMTD%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%EMTD))) THEN
    SELF%EMTD  => SELF%F_EMTD%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%EMTD)) THEN
  SELF%EMTD  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_EMTU)) THEN
  IF ((.NOT. SELF%F_EMTU%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%EMTU))) THEN
    SELF%EMTU  => SELF%F_EMTU%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%EMTU)) THEN
  SELF%EMTU  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_TRSW)) THEN
  IF ((.NOT. SELF%F_TRSW%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%TRSW))) THEN
    SELF%TRSW  => SELF%F_TRSW%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%TRSW)) THEN
  SELF%TRSW  => ZDUM2
ENDIF
IF (ASSOCIATED (SELF%F_RMOON)) THEN
  IF ((.NOT. SELF%F_RMOON%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%RMOON))) THEN
    SELF%RMOON  => SELF%F_RMOON%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (SELF%RMOON)) THEN
  SELF%RMOON  => ZDUM1
ENDIF

END SUBROUTINE MF_PHYS_RAD_TYPE_UPDATE_VIEW

SUBROUTINE MF_PHYS_RAD_TYPE_FINAL (SELF)
CLASS (MF_PHYS_RAD_TYPE)         :: SELF

IF (ASSOCIATED (SELF%F_EMTD)) CALL DELETE_TEMPORARY (SELF%F_EMTD) 
IF (ASSOCIATED (SELF%F_EMTU)) CALL DELETE_TEMPORARY (SELF%F_EMTU) 
IF (ASSOCIATED (SELF%F_TRSW)) CALL DELETE_TEMPORARY (SELF%F_TRSW) 
IF (ASSOCIATED (SELF%F_RMOON)) CALL DELETE_TEMPORARY (SELF%F_RMOON) 

END SUBROUTINE MF_PHYS_RAD_TYPE_FINAL

SUBROUTINE MF_PHYS_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (MF_PHYS_TYPE) :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

CALL SELF%OUT%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%OPT%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%FOR%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%GRA%UPDATE_VIEW (BLOCK_INDEX)
CALL SELF%RAD%UPDATE_VIEW (BLOCK_INDEX)

END SUBROUTINE MF_PHYS_TYPE_UPDATE_VIEW

SUBROUTINE MF_PHYS_TYPE_FINAL (SELF)

CLASS (MF_PHYS_TYPE) :: SELF

CALL SELF%OUT%FINAL ()
CALL SELF%OPT%FINAL ()
CALL SELF%FOR%FINAL ()
CALL SELF%GRA%FINAL ()
CALL SELF%RAD%FINAL ()

END SUBROUTINE MF_PHYS_TYPE_FINAL

END MODULE MF_PHYS_TYPE_MOD

