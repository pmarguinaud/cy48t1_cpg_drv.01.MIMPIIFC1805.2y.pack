MODULE YOETHF

USE PARKIND1  ,ONLY : JPIM     ,JPRB

IMPLICIT NONE

SAVE

!     ------------------------------------------------------------------
!*     *YOETHF* DERIVED CONSTANTS SPECIFIC TO ECMWF THERMODYNAMICS
!     ------------------------------------------------------------------

REAL(KIND=JPRB) :: R2ES
REAL(KIND=JPRB) :: R3LES
REAL(KIND=JPRB) :: R3IES
REAL(KIND=JPRB) :: R4LES
REAL(KIND=JPRB) :: R4IES
REAL(KIND=JPRB) :: R5LES
REAL(KIND=JPRB) :: R5IES
REAL(KIND=JPRB) :: RVTMP2
REAL(KIND=JPRB) :: RHOH2O
REAL(KIND=JPRB) :: R5ALVCP
REAL(KIND=JPRB) :: R5ALSCP
REAL(KIND=JPRB) :: RALVDCP
REAL(KIND=JPRB) :: RALSDCP
REAL(KIND=JPRB) :: RALFDCP
REAL(KIND=JPRB) :: RTWAT
REAL(KIND=JPRB) :: RTBER
REAL(KIND=JPRB) :: RTBERCU
REAL(KIND=JPRB) :: RTICE
REAL(KIND=JPRB) :: RTICECU
REAL(KIND=JPRB) :: RTWAT_RTICE_R
REAL(KIND=JPRB) :: RTWAT_RTICECU_R
REAL(KIND=JPRB) :: RKOOP1
REAL(KIND=JPRB) :: RKOOP2

TYPE TTHF
  REAL(KIND=JPRB) :: R2ES
  REAL(KIND=JPRB) :: R3LES
  REAL(KIND=JPRB) :: R3IES
  REAL(KIND=JPRB) :: R4LES
  REAL(KIND=JPRB) :: R4IES
  REAL(KIND=JPRB) :: R5LES
  REAL(KIND=JPRB) :: R5IES
  REAL(KIND=JPRB) :: RVTMP2
  REAL(KIND=JPRB) :: RHOH2O
  REAL(KIND=JPRB) :: R5ALVCP
  REAL(KIND=JPRB) :: R5ALSCP
  REAL(KIND=JPRB) :: RALVDCP
  REAL(KIND=JPRB) :: RALSDCP
  REAL(KIND=JPRB) :: RALFDCP
  REAL(KIND=JPRB) :: RTWAT
  REAL(KIND=JPRB) :: RTBER
  REAL(KIND=JPRB) :: RTBERCU
  REAL(KIND=JPRB) :: RTICE
  REAL(KIND=JPRB) :: RTICECU
  REAL(KIND=JPRB) :: RTWAT_RTICE_R
  REAL(KIND=JPRB) :: RTWAT_RTICECU_R
  REAL(KIND=JPRB) :: RKOOP1
  REAL(KIND=JPRB) :: RKOOP2
END TYPE TTHF

!     J.-J. MORCRETTE                   91/07/14  ADAPTED TO I.F.S.

!      NAME     TYPE      PURPOSE
!      ----     ----      -------

!     *R__ES*   REAL      *CONSTANTS USED FOR COMPUTATION OF SATURATION
!                         MIXING RATIO OVER LIQUID WATER(*R_LES*) OR
!                         ICE(*R_IES*).
!     *RVTMP2*  REAL      *RVTMP2=RCPV/RCPD-1.
!     *RHOH2O*  REAL      *DENSITY OF LIQUID WATER.   (RATM/100.)
!     *R5ALVCP* REAL      *R5LES*RLVTT/RCPD
!     *R5ALSCP* REAL      *R5IES*RLSTT/RCPD
!     *RALVDCP* REAL      *RLVTT/RCPD
!     *RALSDCP* REAL      *RLSTT/RCPD
!     *RALFDCP* REAL      *RLMLT/RCPD
!     *RTWAT*   REAL      *RTWAT=RTT
!     *RTBER*   REAL      *RTBER=RTT-0.05
!     *RTBERCU  REAL      *RTBERCU=RTT-5.0
!     *RTICE*   REAL      *RTICE=RTT-0.1
!     *RTICECU* REAL      *RTICECU=RTT-23.0
!     *RKOOP?   REAL      *CONSTANTS TO DESCRIBE KOOP FORM FOR NUCLEATION
!     *RTWAT_RTICE_R*   REAL      *RTWAT_RTICE_R=1./(RTWAT-RTICE)
!     *RTWAT_RTICECU_R* REAL      *RTWAT_RTICECU_R=1./(RTWAT-RTICECU)

!       ----------------------------------------------------------------

TYPE(TTHF), POINTER :: YRTHF => NULL ()

CONTAINS

TYPE (TTHF) FUNCTION TTHF_INIT () RESULT (YDTHF)

YDTHF%R2ES            = R2ES
YDTHF%R3LES           = R3LES
YDTHF%R3IES           = R3IES
YDTHF%R4LES           = R4LES
YDTHF%R4IES           = R4IES
YDTHF%R5LES           = R5LES
YDTHF%R5IES           = R5IES
YDTHF%RVTMP2          = RVTMP2
YDTHF%RHOH2O          = RHOH2O
YDTHF%R5ALVCP         = R5ALVCP
YDTHF%R5ALSCP         = R5ALSCP
YDTHF%RALVDCP         = RALVDCP
YDTHF%RALSDCP         = RALSDCP
YDTHF%RALFDCP         = RALFDCP
YDTHF%RTWAT           = RTWAT
YDTHF%RTBER           = RTBER
YDTHF%RTBERCU         = RTBERCU
YDTHF%RTICE           = RTICE
YDTHF%RTICECU         = RTICECU
YDTHF%RTWAT_RTICE_R   = RTWAT_RTICE_R
YDTHF%RTWAT_RTICECU_R = RTWAT_RTICECU_R
YDTHF%RKOOP1          = RKOOP1
YDTHF%RKOOP2          = RKOOP2

END FUNCTION TTHF_INIT


END MODULE YOETHF
