SUBROUTINE APL_ARPEGE_INIT (YDGEOMETRY, YDCST, YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, &
& YDMF_PHYS, YDMF_PHYS_SURF, YDVARS, YDMODEL, KMOC_CLPH, KNLAB_CVPP, PAER, PAERINDS, PAIPCMT, PALBD,     &
& PALBP, PALPHA1, PCEMTR, PCFATH, PCFAU, PCFBTH, PCFBU, PCFBV, PCOEFA, PCONDCVPPI, PCONDCVPPL, PCTRSO,   &
& PDECRD, PDIFCVPPQ, PDIFCVPPS, PDIFCVPPU, PDIFCVPPV, PDIFWQ, PDIFWS, PEDMFQ, PEDMFS, PEDMFU, PEDMFV,    &
& PEPS0, PEPSNEB, PFPCOR, PKQLROV, PKQROV, PKTROV, PKUROV, PLVT, PMF_UP, PMRIPP, PNEBC0, PNEBCH,         &
& PNEBDIFF, PNEBS, PNEBS0, PNEB_CVPP, PPFL_FPLCH, PPFL_FPLSH, PPOID, PPRODTH_CVPP, PQC_DET_PCMT, PQI,    &
& PQIC, PQICE, PQL, PQLC, PQLIS, PQLIS0, PQLI_CVP, PQLI_CVPP, PQO3, PQR, PQS, PQV, PSC_FCLL,             &
& PSC_FCLN, PSC_FEVI, PSC_FEVN, PSEDIQI, PSEDIQL, PSFSWDIF, PSFSWDIR, PSUDU, PTENHA, PTENQVA, PTENT,     &
& PTRSOD, PTRSODIF, PTRSODIR, PUNEBH, PXDROV, PXHROV, PXQRO, PXTRO, PXTROV, PXURO, PXUROV)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK
USE PARKIND1, ONLY : JPIM, JPRB

USE GEOMETRY_MOD       , ONLY : GEOMETRY
USE MF_PHYS_BASE_STATE_TYPE_MOD &
                       , ONLY : MF_PHYS_BASE_STATE_TYPE
USE CPG_OPTS_TYPE_MOD   , ONLY : CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD       , ONLY : CPG_MISC_TYPE, CPG_DYN_TYPE, &
                              & CPG_SL2_TYPE, CPG_GPAR_TYPE
USE MF_PHYS_TYPE_MOD   , ONLY : MF_PHYS_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD &
                       , ONLY : MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD, ONLY : FIELD_VARIABLES
USE TYPE_MODEL         , ONLY : MODEL
USE YOMCST,              ONLY : TCST
   

IMPLICIT NONE

TYPE(GEOMETRY),                 INTENT(IN)    :: YDGEOMETRY
TYPE(TCST),                     INTENT(IN)    :: YDCST
TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT(IN)    :: YDMF_PHYS_BASE_STATE
TYPE(CPG_BNDS_TYPE),            INTENT(IN)    :: YDCPG_BNDS
TYPE(CPG_OPTS_TYPE),            INTENT(IN)    :: YDCPG_OPTS
TYPE(CPG_MISC_TYPE),            INTENT(INOUT) :: YDCPG_MISC
TYPE(MF_PHYS_TYPE),             INTENT(INOUT) :: YDMF_PHYS
TYPE(MF_PHYS_SURF_TYPE),        INTENT(INOUT) :: YDMF_PHYS_SURF
TYPE(FIELD_VARIABLES),          INTENT(INOUT) :: YDVARS
TYPE(MODEL),                    INTENT(IN)    :: YDMODEL
INTEGER(KIND=JPIM),             INTENT(OUT)   :: KMOC_CLPH (YDCPG_OPTS%KLON)
INTEGER(KIND=JPIM),             INTENT(OUT)   :: KNLAB_CVPP(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PAER(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG,6)
REAL(KIND=JPRB),                INTENT(OUT)   :: PAERINDS(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PAIPCMT(YDCPG_OPTS%KLON)
REAL(KIND=JPRB),                INTENT(OUT)   :: PALBD(YDCPG_OPTS%KLON,YDCPG_OPTS%KSW)
REAL(KIND=JPRB),                INTENT(OUT)   :: PALBP(YDCPG_OPTS%KLON,YDCPG_OPTS%KSW)
REAL(KIND=JPRB),                INTENT(OUT)   :: PALPHA1(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PCEMTR(YDCPG_OPTS%KLON,0:1)
REAL(KIND=JPRB),                INTENT(OUT)   :: PCFATH(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PCFAU(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PCFBTH(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PCFBU(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PCFBV(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PCOEFA (YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PCONDCVPPI(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PCONDCVPPL(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PCTRSO(YDCPG_OPTS%KLON,0:1)
REAL(KIND=JPRB),                INTENT(OUT)   :: PDECRD   (YDCPG_OPTS%KLON)
REAL(KIND=JPRB),                INTENT(OUT)   :: PDIFCVPPQ(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PDIFCVPPS(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PDIFCVPPU(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PDIFCVPPV(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PDIFWQ (YDCPG_OPTS%KLON)
REAL(KIND=JPRB),                INTENT(OUT)   :: PDIFWS (YDCPG_OPTS%KLON)
REAL(KIND=JPRB),                INTENT(OUT)   :: PEDMFQ(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PEDMFS(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PEDMFU(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PEDMFV(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PEPS0
REAL(KIND=JPRB),                INTENT(OUT)   :: PEPSNEB
REAL(KIND=JPRB),                INTENT(OUT)   :: PFPCOR(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PKQLROV(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PKQROV(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PKTROV(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PKUROV(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PLVT   (YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PMF_UP(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PMRIPP(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PNEBC0(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PNEBCH(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PNEBDIFF(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PNEBS(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PNEBS0(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PNEB_CVPP(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PPFL_FPLCH (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PPFL_FPLSH (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PPOID(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PPRODTH_CVPP(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PQC_DET_PCMT(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PQI(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PQIC(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PQICE  (YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PQL(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PQLC(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PQLIS(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PQLIS0(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PQLI_CVP(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PQLI_CVPP(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PQO3(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PQR(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PQS(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PQV(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PSC_FCLL(YDCPG_OPTS%KLON)
REAL(KIND=JPRB),                INTENT(OUT)   :: PSC_FCLN(YDCPG_OPTS%KLON)
REAL(KIND=JPRB),                INTENT(OUT)   :: PSC_FEVI (YDCPG_OPTS%KLON)
REAL(KIND=JPRB),                INTENT(OUT)   :: PSC_FEVN(YDCPG_OPTS%KLON)
REAL(KIND=JPRB),                INTENT(OUT)   :: PSEDIQI(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PSEDIQL(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PSFSWDIF (YDCPG_OPTS%KLON,YDCPG_OPTS%KSW)
REAL(KIND=JPRB),                INTENT(OUT)   :: PSFSWDIR (YDCPG_OPTS%KLON,YDCPG_OPTS%KSW)
REAL(KIND=JPRB),                INTENT(OUT)   :: PSUDU(YDCPG_OPTS%KLON)
REAL(KIND=JPRB),                INTENT(OUT)   :: PTENHA(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PTENQVA(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PTENT(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PTRSOD(YDCPG_OPTS%KLON)
REAL(KIND=JPRB),                INTENT(OUT)   :: PTRSODIF (YDCPG_OPTS%KLON,YDCPG_OPTS%KSW)
REAL(KIND=JPRB),                INTENT(OUT)   :: PTRSODIR (YDCPG_OPTS%KLON,YDCPG_OPTS%KSW)
REAL(KIND=JPRB),                INTENT(OUT)   :: PUNEBH(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PXDROV(YDCPG_OPTS%KLON)
REAL(KIND=JPRB),                INTENT(OUT)   :: PXHROV(YDCPG_OPTS%KLON)
REAL(KIND=JPRB),                INTENT(OUT)   :: PXQRO(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PXTRO(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PXTROV(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PXURO(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),                INTENT(OUT)   :: PXUROV(YDCPG_OPTS%KLON,0:YDCPG_OPTS%KFLEVG)

#include "fcttrm.ycst.h"
#include "radozcmf.intfb.h"
#include "suozon.intfb.h"

REAL(KIND=JPRB) :: ZDQC
REAL(KIND=JPRB) :: ZDQI
REAL(KIND=JPRB) :: ZDQL
REAL(KIND=JPRB) :: ZDQR
REAL(KIND=JPRB) :: ZDQS
REAL(KIND=JPRB) :: ZDQV
REAL(KIND=JPRB) :: ZEPSO3
REAL(KIND=JPRB) :: ZGDT
REAL(KIND=JPRB) :: ZGDTI
REAL(KIND=JPRB) :: ZIPOI(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB) :: ZQV0
REAL(KIND=JPRB) :: ZROZ(YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)

INTEGER (KIND=JPIM) :: JCHA
INTEGER (KIND=JPIM) :: JLEV
INTEGER (KIND=JPIM) :: JLON
INTEGER (KIND=JPIM) :: JSG

REAL (KIND=JPRB) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT', 0, ZHOOK_HANDLE)

!=PARALLEL

PAIPCMT(:)=0._JPRB

!*        1.0 DECORRELATION DEPTH FOR CLOUD OVERLAPS
IF ( YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD <= 0._JPRB .OR. YDMODEL%YRML_PHY_MF%YRPHY%LRNUEXP ) THEN
  DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
    PDECRD(JLON)=YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD1+YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD2* &
     & EXP(-((ASIN(YDVARS%GEOMETRY%GEMU%T0(JLON))-YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD3*YDMODEL%YRML_GCONF%YRRIP%RDECLI)/YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD4)**2)
  ENDDO
ENDIF

!=END PARALLEL


!*        1.1 INITIALISATION DE L'OZONE

!=PARALLEL

IF (YDMODEL%YRML_PHY_G%YRDPHY%NVCLIS == 1) THEN
  ZEPSO3=1.E-11_JPRB
  DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
    PQO3(JLON,0)=1.E-9_JPRB
  ENDDO
  DO JLEV=YDCPG_OPTS%KTDIA,YDCPG_OPTS%KFLEVG
    DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
      PQO3(JLON,JLEV) = YDCPG_MISC%KOZO(JLON,JLEV,1)
    ENDDO
  ENDDO

ELSEIF (YDMODEL%YRML_PHY_RAD%YRERAD%NOZOCL == 1) THEN
  IF (MOD(YDCPG_OPTS%KSTEP,YDMODEL%YRML_PHY_RAD%YRERAD%NRADFR) == 0) THEN
    CALL RADOZCMF(YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDMF_PHYS_BASE_STATE%YCPG_PHY%PREHYD, &
    & YDVARS%GEOMETRY%GEMU%T0, ZROZ)
    DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
      PQO3(JLON,0)=1.E-9_JPRB
    ENDDO
    DO JLEV=YDCPG_OPTS%KTDIA,YDCPG_OPTS%KFLEVG
      DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
        PQO3(JLON,JLEV)=ZROZ(JLON,JLEV)*YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%RDELP(JLON,JLEV)
      ENDDO
    ENDDO
  ENDIF

ELSE
  CALL SUOZON(YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, PQO3, .FALSE.,                 &
  & YDMF_PHYS_BASE_STATE%YCPG_PHY%PREHYD, YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%RDELP, YDMODEL%YRML_PHY_MF%YRPHY%LO3ABC, &
  & YDMF_PHYS_SURF%GSD_VC%PA, YDMF_PHYS_SURF%GSD_VC%PB, YDMF_PHYS_SURF%GSD_VC%PC)
ENDIF

!=END PARALLEL

! INCREMENTAL CORRECTION FLUX FOR NEGATIVE HUMIDITY VALUES

!=PARALLEL

PPRODTH_CVPP(:,:)=0.0_JPRB

ZGDT=YDCST%RG*YDMODEL%YRML_PHY_MF%YRPHY2%TSPHY
ZGDTI=1.0_JPRB/ZGDT

DO JLEV=YDCPG_OPTS%KTDIA,YDCPG_OPTS%KFLEVG
  DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA

!     LAYER WEIGHTS

    PPOID(JLON,JLEV)=YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%DELP(JLON,JLEV)*ZGDTI
    ZIPOI(JLON,JLEV)=YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%RDELP(JLON,JLEV)*ZGDT

  ENDDO
ENDDO

!=END PARALLEL


!     ------------------------------------------------------------------
!     2.- MISES A ZERO DE SECURITE EN CAS DE NON-APPEL DES PARAMETRIS.
!     ------------------------------------------------------------------
PEPS0=1.E-12_JPRB
PEPSNEB=1.E-10_JPRB

! To profitize from the vectorization collapsing the (:,:) form is preferable.
! (Even better would be to completely avoid any useless initialization.)

! arrays dimensioned from 0:KLEV (half level quantities)

!=PARALLEL

PFPCOR  (:,:) = 0.0_JPRB
PXTROV  (:,:) = 1.0_JPRB
PXUROV  (:,:) = 1.0_JPRB
PKTROV  (:,:) = 0.0_JPRB
PKQROV  (:,:) = 0.0_JPRB
PKQLROV (:,:) = 0.0_JPRB
PKUROV  (:,:) = 0.0_JPRB
PDIFCVPPQ (:,:) = 0.0_JPRB
PDIFCVPPS (:,:) = 0.0_JPRB
PDIFCVPPU (:,:) = 0.0_JPRB
PDIFCVPPV (:,:) = 0.0_JPRB
PCONDCVPPL(:,:) = 0.0_JPRB
PCONDCVPPI(:,:) = 0.0_JPRB
PSEDIQL(:,:) = 0.0_JPRB
PSEDIQI(:,:) = 0.0_JPRB

PXURO   (:,:) = 0.0_JPRB
PXQRO   (:,:) = 0.0_JPRB
PXTRO   (:,:) = 0.0_JPRB

PALPHA1 (:,:) = 0.0_JPRB
PCOEFA  (:,:) = 0.0_JPRB
PLVT    (:,:) = 0.0_JPRB
PQICE   (:,:) = 0.0_JPRB

PMRIPP (:,:) = 1.E-12_JPRB

PDIFWQ  (:) = 0.0_JPRB
PDIFWS  (:) = 0.0_JPRB
PSC_FEVI(:) = 1.0_JPRB     
PSC_FEVN(:) = 1.0_JPRB     
PSC_FCLL(:) = 1.0_JPRB     
PSC_FCLN(:) = 1.0_JPRB

! arrays dimensioned from 1:KLEV (full level quantities)
PTENT   (:,:) = 0.0_JPRB
PNEBS   (:,:) = PEPS0
PNEBS0  (:,:) = PEPS0
PNEBC0  (:,:) = PEPS0
PNEBCH  (:,:) = 0.0_JPRB
PUNEBH  (:,:) = 0.0_JPRB
PNEBDIFF(:,:) = 0.0_JPRB
PQLIS   (:,:) = 0.0_JPRB
PQLIS0  (:,:) = 0.0_JPRB
PCFATH  (:,:) = 0.0_JPRB
PCFAU   (:,:) = 0.0_JPRB
PCFBTH  (:,:) = 0.0_JPRB
PCFBU   (:,:) = 0.0_JPRB
PCFBV   (:,:) = 0.0_JPRB
KNLAB_CVPP(:,:) = 0
PQLI_CVPP(:,:) = 0.0_JPRB
PNEB_CVPP(:,:) = PEPS0

PEDMFQ  (:,:)  = 0.0_JPRB
PEDMFS  (:,:)  = 0.0_JPRB
PEDMFU  (:,:)  = 0.0_JPRB
PEDMFV  (:,:)  = 0.0_JPRB
PMF_UP  (:,: ) = 0.0_JPRB
PQLI_CVP(:,:) = 0.0_JPRB
PQC_DET_PCMT(:,:) = 0.0_JPRB
PTENHA(:,:)   = 0.0_JPRB
PTENQVA(:,:)  = 0.0_JPRB
PQIC   (:,:)  = 0.0_JPRB
PQLC   (:,:)  = 0.0_JPRB

!=END PARALLEL

!  ---------------------------------------------------------------------
!  Correction of negative advected humidity and precipitation values
!  ---------------------------------------------------------------------

!=PARALLEL
    
DO JLEV = 1, YDCPG_OPTS%KFLEVG
  DO JLON = YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
    PQI(JLON,JLEV)=MAX(0.0_JPRB,YDMF_PHYS_BASE_STATE%I(JLON,JLEV))
    PQL(JLON,JLEV)=MAX(0.0_JPRB,YDMF_PHYS_BASE_STATE%L(JLON,JLEV))
    PQR(JLON,JLEV)=MAX(0.0_JPRB,YDMF_PHYS_BASE_STATE%R(JLON,JLEV))
    PQS(JLON,JLEV)=MAX(0.0_JPRB,YDMF_PHYS_BASE_STATE%S(JLON,JLEV))

    ! CORRECTION OF NEGATIVE ADVECTED VALUES:
    !                         VAPOUR PUT IN PFCQVNG
    !                         LIQUID,ICE PUT IN PFCQL/ING
    !                         FOR RAIN/SNOW PUT IN PFCQR/SNG

    ZDQI=PQI(JLON,JLEV)-YDMF_PHYS_BASE_STATE%I(JLON,JLEV)
    ZDQL=PQL(JLON,JLEV)-YDMF_PHYS_BASE_STATE%L(JLON,JLEV)
    ZDQR=PQR(JLON,JLEV)-YDMF_PHYS_BASE_STATE%R(JLON,JLEV)
    ZDQS=PQS(JLON,JLEV)-YDMF_PHYS_BASE_STATE%S(JLON,JLEV)
    ZDQC=ZDQI+ZDQL+ZDQR+ZDQS

    ZQV0=YDMF_PHYS_BASE_STATE%Q(JLON,JLEV)-ZIPOI(JLON,JLEV)*(0.0_JPRB- YDMF_PHYS%OUT%FCQNG(JLON,JLEV-1)&
    & -YDMF_PHYS%OUT%FCQNNG(JLON,JLEV-1)-YDMF_PHYS%OUT%FCQLNG(JLON,JLEV-1)-YDMF_PHYS%OUT%FCQRNG(JLON,JLEV-1)&
    & -YDMF_PHYS%OUT%FCQSNG(JLON,JLEV-1))
    PQV(JLON,JLEV)=MAX(0.0_JPRB,ZQV0-ZDQC)
    ZDQV=MAX(0.0_JPRB,ZQV0-ZDQC)-YDMF_PHYS_BASE_STATE%Q(JLON,JLEV)

    YDMF_PHYS%OUT%FCQNG(JLON,JLEV)=YDMF_PHYS%OUT%FCQNG(JLON,JLEV-1)-ZDQV*PPOID(JLON,JLEV)
    YDMF_PHYS%OUT%FCQNNG(JLON,JLEV)=YDMF_PHYS%OUT%FCQNNG(JLON,JLEV-1)-ZDQI*PPOID(JLON,JLEV)
    YDMF_PHYS%OUT%FCQLNG(JLON,JLEV)=YDMF_PHYS%OUT%FCQLNG(JLON,JLEV-1)-ZDQL*PPOID(JLON,JLEV)
    YDMF_PHYS%OUT%FCQRNG(JLON,JLEV)=YDMF_PHYS%OUT%FCQRNG(JLON,JLEV-1)-ZDQR*PPOID(JLON,JLEV)
    YDMF_PHYS%OUT%FCQSNG(JLON,JLEV)=YDMF_PHYS%OUT%FCQSNG(JLON,JLEV-1)-ZDQS*PPOID(JLON,JLEV)
  ENDDO
ENDDO

!=END PARALLEL
    
!=PARALLEL

DO JCHA = 1, 6
  DO JLEV = YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
    DO JLON = 1, YDCPG_OPTS%KLON
      PAER(JLON,JLEV,JCHA)=0.0_JPRB
    ENDDO
  ENDDO
ENDDO

DO JLEV = YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
  DO JLON = 1, YDCPG_OPTS%KLON
    PAERINDS(JLON,JLEV)=0.0_JPRB
  ENDDO
ENDDO

DO JLON = YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
  PCEMTR  (JLON,0) = 0.0_JPRB
  PCEMTR  (JLON,1) = 0.0_JPRB
  PCTRSO  (JLON,0) = 0.0_JPRB
  PCTRSO  (JLON,1) = 0.0_JPRB
  PTRSOD  (JLON)   = 0.0_JPRB
  PSUDU   (JLON)   = 0.0_JPRB
  PXDROV  (JLON)   = 1.0_JPRB
  PXHROV  (JLON)   = 1.0_JPRB
  KMOC_CLPH   (JLON)   = YDCPG_OPTS%KFLEVG
ENDDO

DO JSG = 1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
  DO JLON = YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
    PALBD   (JLON,JSG) = 0.0_JPRB
    PALBP   (JLON,JSG) = 0.0_JPRB
    PSFSWDIF(JLON,JSG) = 0.0_JPRB
    PSFSWDIR(JLON,JSG) = 0.0_JPRB
    PTRSODIF(JLON,JSG) = 0.0_JPRB
    PTRSODIR(JLON,JSG) = 0.0_JPRB
  ENDDO
ENDDO

!=END PARALLEL

!  -------------------------------------------------------
!  Security values for pseudo-historical arrays at KSTEP=0
!  -------------------------------------------------------

!=PARALLEL

IF((YDMODEL%YRML_PHY_MF%YRPHY%LNEBN.OR.YDMODEL%YRML_PHY_MF%YRPHY%LRRGUST).AND.YDCPG_OPTS%KSTEP == 0) THEN
  DO JLEV=YDCPG_OPTS%KTDIA-1,YDCPG_OPTS%KFLEVG
    DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
      PPFL_FPLCH(JLON,JLEV)=0.0_JPRB
    ENDDO
  ENDDO
ENDIF
IF(YDMODEL%YRML_PHY_MF%YRPHY%LRRGUST.AND.YDCPG_OPTS%KSTEP == 0) THEN
  DO JLEV=YDCPG_OPTS%KTDIA-1,YDCPG_OPTS%KFLEVG
    DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
      PPFL_FPLSH(JLON,JLEV)=0.0_JPRB
    ENDDO
  ENDDO
ENDIF

!=END PARALLEL

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT', 1, ZHOOK_HANDLE)

END SUBROUTINE APL_ARPEGE_INIT
