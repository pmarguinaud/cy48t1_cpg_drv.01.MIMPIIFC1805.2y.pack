SUBROUTINE MF_PHYS_NHQE_EPILOG (YDGEOMETRY, YDMF_PHYS, YDVARS, KST, KEND)

USE PARKIND1, ONLY : JPIM, JPRB

USE YOMCT0             , ONLY : LTWOTL
USE GEOMETRY_MOD       , ONLY : GEOMETRY
USE MF_PHYS_TYPE_MOD   , ONLY : MF_PHYS_TYPE
USE FIELD_VARIABLES_MOD, ONLY : FIELD_VARIABLES


IMPLICIT NONE

TYPE(GEOMETRY)    ,INTENT(IN)    :: YDGEOMETRY
TYPE(MF_PHYS_TYPE),INTENT(INOUT) :: YDMF_PHYS
TYPE(FIELD_VARIABLES),INTENT(INOUT) :: YDVARS
INTEGER(KIND=JPIM),INTENT(IN)    :: KST
INTEGER(KIND=JPIM),INTENT(IN)    :: KEND


INTEGER (KIND=JPIM) :: JLEV
INTEGER (KIND=JPIM) :: JROF

  ! At instant t (with the derivatives):
  DO JLEV=1,YDGEOMETRY%YRDIMV%NFLEVG
    DO JROF=KST,KEND
      YDVARS%T%T0(JROF,JLEV)=YDMF_PHYS%TMP%NHQ%TT0(JROF,JLEV)
      YDVARS%T%DL(JROF,JLEV)=YDMF_PHYS%TMP%NHQ%TT0L(JROF,JLEV)
      YDVARS%T%DM(JROF,JLEV)=YDMF_PHYS%TMP%NHQ%TT0M(JROF,JLEV)
    ENDDO
  ENDDO
  ! At instant t-dt for leap-frog advections (without the derivatives):
  IF (.NOT.LTWOTL) THEN
    DO JLEV=1,YDGEOMETRY%YRDIMV%NFLEVG
      DO JROF=KST,KEND
        YDVARS%T%T9(JROF,JLEV)=YDMF_PHYS%TMP%NHQ%TT9(JROF,JLEV)
      ENDDO
    ENDDO
  ENDIF
  

END SUBROUTINE
