SUBROUTINE MF_PHYS_SAVE_PHSURF_EPILOG (YDMF_PHYS, YDMF_PHYS_SURF, YDVARS, YDSURF, YDMODEL, LDCDDPRO, LDCVPRO, LDGPCMT, KPROMA)

USE PARKIND1, ONLY : JPIM, JPRB

USE MF_PHYS_TYPE_MOD   , ONLY : MF_PHYS_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY : MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD, ONLY : FIELD_VARIABLES
USE SURFACE_FIELDS_MIX , ONLY : TSURF
USE TYPE_MODEL         , ONLY : MODEL


IMPLICIT NONE

TYPE(MF_PHYS_TYPE),INTENT(INOUT) :: YDMF_PHYS
TYPE(MF_PHYS_SURF_TYPE),INTENT(INOUT) :: YDMF_PHYS_SURF
TYPE(FIELD_VARIABLES),INTENT(INOUT) :: YDVARS
TYPE(TSURF)       ,INTENT(INOUT) :: YDSURF
TYPE(MODEL)       ,INTENT(INOUT) :: YDMODEL
LOGICAL, INTENT (IN) :: LDCDDPRO
LOGICAL, INTENT (IN) :: LDCVPRO
LOGICAL, INTENT (IN) :: LDGPCMT
INTEGER (KIND=JPIM), INTENT (IN) :: KPROMA



  IF(YDSURF%YSD_VV%YHV%LSET) YDMF_PHYS_SURF%GSD_VV%PHV(1:KPROMA)=YDMF_PHYS%TMP%SAV%HV(1:KPROMA)
  IF(YDSURF%YSD_VF%YZ0F%LSET) YDMF_PHYS_SURF%GSD_VF%PZ0F(1:KPROMA)=YDMF_PHYS%TMP%SAV%GZ0F(1:KPROMA)
  IF(YDSURF%YSD_VV%YZ0H%LSET) YDMF_PHYS_SURF%GSD_VV%PZ0H(1:KPROMA)=YDMF_PHYS%TMP%SAV%GZ0HF(1:KPROMA)
  IF(YDSURF%YSD_VH%YPBLH%LSET) YDMF_PHYS_SURF%GSD_VH%PPBLH(1:KPROMA)=YDMF_PHYS%TMP%SAV%PBLH(1:KPROMA)
  IF(YDSURF%YSD_VH%YSPSH%LSET) YDMF_PHYS_SURF%GSD_VH%PSPSH(1:KPROMA)=YDMF_PHYS%TMP%SAV%FHPS(1:KPROMA)
  IF(YDSURF%YSD_VH%YQSH%LSET)  YDMF_PHYS_SURF%GSD_VH%PQSH(1:KPROMA)=YDMF_PHYS%TMP%SAV%QSH(1:KPROMA)
  IF(YDSURF%YSD_VK%YUDGRO%LSET) YDMF_PHYS_SURF%GSD_VK%PUDGRO(1:KPROMA)=YDMF_PHYS%TMP%SAV%UDGRO(1:KPROMA)
  IF(LDCVPRO.OR.LDGPCMT) THEN
    YDVARS%UAL%T0(:,:)=YDMF_PHYS%TMP%SAV%UDAL(:,:)
    YDVARS%UOM%T0(:,:)=YDMF_PHYS%TMP%SAV%UDOM(:,:)
    IF(LDCDDPRO) THEN
      YDVARS%DAL%T0(:,:)=YDMF_PHYS%TMP%SAV%DDAL(:,:)
      YDVARS%DOM%T0(:,:)=YDMF_PHYS%TMP%SAV%DDOM(:,:)
    ENDIF
  ENDIF
  IF(YDMODEL%YRML_GCONF%YGFL%YUNEBH%LACTIVE) YDVARS%UNEBH%T0(:,:)=YDMF_PHYS%TMP%SAV%UNEBH(:,:)
  IF(YDMODEL%YRML_GCONF%YGFL%YUEN%LACTIVE)   YDVARS%UEN%T0(:,:)=YDMF_PHYS%TMP%SAV%ENTCH(:,:)
  

END SUBROUTINE
