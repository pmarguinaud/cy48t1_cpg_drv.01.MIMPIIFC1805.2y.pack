SUBROUTINE MF_PHYS_SAVE_PHSURF_PART2 (YDCPG_DIM, PSAV_DDAL, PSAV_DDOM, PSAV_ENTCH, PSAV_FHPS,        &
& PSAV_GZ0F, PSAV_GZ0HF, PSAV_HV, PSAV_PBLH, PSAV_QSH, PSAV_UDAL, PSAV_UDGRO, PSAV_UDOM, PSAV_UNEBH, &
& YDMF_PHYS_SURF, PDAL_T0, PDOM_T0, PUAL_T0, PUEN_T0, PUNEBH_T0, PUOM_T0, YDSURF, YDMODEL)

USE PARKIND1, ONLY : JPIM, JPRB

USE CPG_DIM_TYPE_MOD   , ONLY : CPG_DIM_TYPE
USE MF_PHYS_TYPE_MOD   , ONLY : MF_PHYS_TMP_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY : MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD, ONLY : FIELD_VARIABLES
USE SURFACE_FIELDS_MIX , ONLY : TSURF
USE TYPE_MODEL         , ONLY : MODEL


IMPLICIT NONE

TYPE(CPG_DIM_TYPE),INTENT(IN)    :: YDCPG_DIM

REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_DDAL  (YDCPG_DIM%KLON, 1:YDCPG_DIM%KFLEVG)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_DDOM  (YDCPG_DIM%KLON, 1:YDCPG_DIM%KFLEVG)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_ENTCH (YDCPG_DIM%KLON, 1:YDCPG_DIM%KFLEVG)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_FHPS  (YDCPG_DIM%KLON)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_GZ0F  (YDCPG_DIM%KLON)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_GZ0HF (YDCPG_DIM%KLON)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_HV    (YDCPG_DIM%KLON)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_PBLH  (YDCPG_DIM%KLON)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_QSH   (YDCPG_DIM%KLON)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_UDAL  (YDCPG_DIM%KLON, 1:YDCPG_DIM%KFLEVG)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_UDGRO (YDCPG_DIM%KLON)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_UDOM  (YDCPG_DIM%KLON, 1:YDCPG_DIM%KFLEVG)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_UNEBH (YDCPG_DIM%KLON, 1:YDCPG_DIM%KFLEVG)
TYPE(MF_PHYS_SURF_TYPE),INTENT(INOUT) :: YDMF_PHYS_SURF

REAL (KIND=JPRB) :: PDAL_T0 (YDCPG_DIM%KLON,YDCPG_DIM%KFLEVG)
REAL (KIND=JPRB) :: PDOM_T0 (YDCPG_DIM%KLON,YDCPG_DIM%KFLEVG)
REAL (KIND=JPRB) :: PUAL_T0 (YDCPG_DIM%KLON,YDCPG_DIM%KFLEVG)
REAL (KIND=JPRB) :: PUEN_T0 (YDCPG_DIM%KLON,YDCPG_DIM%KFLEVG)
REAL (KIND=JPRB) :: PUNEBH_T0 (YDCPG_DIM%KLON,YDCPG_DIM%KFLEVG)
REAL (KIND=JPRB) :: PUOM_T0 (YDCPG_DIM%KLON,YDCPG_DIM%KFLEVG)
TYPE(TSURF)       ,INTENT(INOUT) :: YDSURF
TYPE(MODEL)       ,INTENT(INOUT) :: YDMODEL

ASSOCIATE (YDPHY=>YDMODEL%YRML_PHY_MF%YRPHY)

ASSOCIATE (LCDDPRO=>YDPHY%LCDDPRO, LCVPRO=>YDPHY%LCVPRO, LGPCMT=>YDPHY%LGPCMT)

  IF(YDSURF%YSD_VV%YHV%LSET) YDMF_PHYS_SURF%GSD_VV%PHV(1:YDCPG_DIM%KLON)=PSAV_HV(1:YDCPG_DIM%KLON)
  IF(YDSURF%YSD_VF%YZ0F%LSET) YDMF_PHYS_SURF%GSD_VF%PZ0F(1:YDCPG_DIM%KLON)=PSAV_GZ0F(1:YDCPG_DIM%KLON)
  IF(YDSURF%YSD_VV%YZ0H%LSET) YDMF_PHYS_SURF%GSD_VV%PZ0H(1:YDCPG_DIM%KLON)=PSAV_GZ0HF(1:YDCPG_DIM%KLON)
  IF(YDSURF%YSD_VH%YPBLH%LSET) YDMF_PHYS_SURF%GSD_VH%PPBLH(1:YDCPG_DIM%KLON)=PSAV_PBLH(1:YDCPG_DIM%KLON)
  IF(YDSURF%YSD_VH%YSPSH%LSET) YDMF_PHYS_SURF%GSD_VH%PSPSH(1:YDCPG_DIM%KLON)=PSAV_FHPS(1:YDCPG_DIM%KLON)
  IF(YDSURF%YSD_VH%YQSH%LSET)  YDMF_PHYS_SURF%GSD_VH%PQSH(1:YDCPG_DIM%KLON)=PSAV_QSH(1:YDCPG_DIM%KLON)
  IF(YDSURF%YSD_VK%YUDGRO%LSET) YDMF_PHYS_SURF%GSD_VK%PUDGRO(1:YDCPG_DIM%KLON)=PSAV_UDGRO(1:YDCPG_DIM%KLON)
  IF(LCVPRO.OR.LGPCMT) THEN
    PUAL_T0(:,:)=PSAV_UDAL(:,:)
    PUOM_T0(:,:)=PSAV_UDOM(:,:)
    IF(LCDDPRO) THEN
      PDAL_T0(:,:)=PSAV_DDAL(:,:)
      PDOM_T0(:,:)=PSAV_DDOM(:,:)
    ENDIF
  ENDIF
  IF(YDMODEL%YRML_GCONF%YGFL%YUNEBH%LACTIVE) PUNEBH_T0(:,:)=PSAV_UNEBH(:,:)
  IF(YDMODEL%YRML_GCONF%YGFL%YUEN%LACTIVE)   PUEN_T0(:,:)=PSAV_ENTCH(:,:)
  
END ASSOCIATE

END ASSOCIATE

END SUBROUTINE
