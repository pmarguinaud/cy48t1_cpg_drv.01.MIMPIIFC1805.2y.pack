SUBROUTINE MF_PHYS_SAVE_PHSURF_PART2 (YDCPG_DIM, YDCPG_OPTS, PSAV_DDAL, PSAV_DDOM, PSAV_ENTCH, PSAV_FHPS,        &
& PSAV_GZ0F, PSAV_GZ0HF, PSAV_HV, PSAV_PBLH, PSAV_QSH, PSAV_UDAL, PSAV_UDGRO, PSAV_UDOM, PSAV_UNEBH, &
& PGSD_VF_PZ0F, PGSD_VH_PPBLH, PGSD_VH_PQSH, PGSD_VH_PSPSH, PGSD_VK_PUDGRO, PGSD_VV_PHV, PGSD_VV_PZ0H, &
& PDAL_T0, PDOM_T0, PUAL_T0, PUEN_T0, PUNEBH_T0, PUOM_T0, YDSURF, YDMODEL)

USE PARKIND1, ONLY : JPIM, JPRB

USE CPG_DIM_TYPE_MOD   , ONLY : CPG_DIM_TYPE, CPG_OPTS_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY : MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD, ONLY : FIELD_VARIABLES
USE SURFACE_FIELDS_MIX , ONLY : TSURF
USE TYPE_MODEL         , ONLY : MODEL


IMPLICIT NONE

TYPE(CPG_DIM_TYPE),INTENT(IN)    :: YDCPG_DIM
TYPE(CPG_OPTS_TYPE),INTENT(IN)   :: YDCPG_OPTS

REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_DDAL  (YDCPG_OPTS%KLON, 1:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_DDOM  (YDCPG_OPTS%KLON, 1:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_ENTCH (YDCPG_OPTS%KLON, 1:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_FHPS  (YDCPG_OPTS%KLON)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_GZ0F  (YDCPG_OPTS%KLON)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_GZ0HF (YDCPG_OPTS%KLON)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_HV    (YDCPG_OPTS%KLON)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_PBLH  (YDCPG_OPTS%KLON)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_QSH   (YDCPG_OPTS%KLON)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_UDAL  (YDCPG_OPTS%KLON, 1:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_UDGRO (YDCPG_OPTS%KLON)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_UDOM  (YDCPG_OPTS%KLON, 1:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB),  INTENT(IN)    :: PSAV_UNEBH (YDCPG_OPTS%KLON, 1:YDCPG_OPTS%KFLEVG)
REAL(KIND=JPRB),   INTENT(OUT)   :: PGSD_VF_PZ0F (YDCPG_OPTS%KLON)
REAL(KIND=JPRB),   INTENT(OUT)   :: PGSD_VH_PPBLH (YDCPG_OPTS%KLON)
REAL(KIND=JPRB),   INTENT(OUT)   :: PGSD_VH_PQSH (YDCPG_OPTS%KLON)
REAL(KIND=JPRB),   INTENT(OUT)   :: PGSD_VH_PSPSH (YDCPG_OPTS%KLON)
REAL(KIND=JPRB),   INTENT(OUT)   :: PGSD_VK_PUDGRO (YDCPG_OPTS%KLON)
REAL(KIND=JPRB),   INTENT(OUT)   :: PGSD_VV_PHV (YDCPG_OPTS%KLON)
REAL(KIND=JPRB),   INTENT(OUT)   :: PGSD_VV_PZ0H (YDCPG_OPTS%KLON)

REAL (KIND=JPRB) :: PDAL_T0 (YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB) :: PDOM_T0 (YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB) :: PUAL_T0 (YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB) :: PUEN_T0 (YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB) :: PUNEBH_T0 (YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB) :: PUOM_T0 (YDCPG_OPTS%KLON,YDCPG_OPTS%KFLEVG)
TYPE(TSURF)       ,INTENT(IN)    :: YDSURF
TYPE(MODEL)       ,INTENT(IN)    :: YDMODEL

ASSOCIATE (YDPHY=>YDMODEL%YRML_PHY_MF%YRPHY)

ASSOCIATE (LCDDPRO=>YDPHY%LCDDPRO, LCVPRO=>YDPHY%LCVPRO, LGPCMT=>YDPHY%LGPCMT)

  IF(YDSURF%YSD_VV%YHV%LSET) PGSD_VV_PHV(1:YDCPG_OPTS%KLON)=PSAV_HV(1:YDCPG_OPTS%KLON)
  IF(YDSURF%YSD_VF%YZ0F%LSET) PGSD_VF_PZ0F(1:YDCPG_OPTS%KLON)=PSAV_GZ0F(1:YDCPG_OPTS%KLON)
  IF(YDSURF%YSD_VV%YZ0H%LSET) PGSD_VV_PZ0H(1:YDCPG_OPTS%KLON)=PSAV_GZ0HF(1:YDCPG_OPTS%KLON)
  IF(YDSURF%YSD_VH%YPBLH%LSET) PGSD_VH_PPBLH(1:YDCPG_OPTS%KLON)=PSAV_PBLH(1:YDCPG_OPTS%KLON)
  IF(YDSURF%YSD_VH%YSPSH%LSET) PGSD_VH_PSPSH(1:YDCPG_OPTS%KLON)=PSAV_FHPS(1:YDCPG_OPTS%KLON)
  IF(YDSURF%YSD_VH%YQSH%LSET)  PGSD_VH_PQSH(1:YDCPG_OPTS%KLON)=PSAV_QSH(1:YDCPG_OPTS%KLON)
  IF(YDSURF%YSD_VK%YUDGRO%LSET) PGSD_VK_PUDGRO(1:YDCPG_OPTS%KLON)=PSAV_UDGRO(1:YDCPG_OPTS%KLON)
  IF(LCVPRO.OR.LGPCMT) THEN
    PUAL_T0(:,:)=PSAV_UDAL(:,:)
    PUOM_T0(:,:)=PSAV_UDOM(:,:)
    IF(LCDDPRO) THEN
      PDAL_T0(:,:)=PSAV_DDAL(:,:)
      PDOM_T0(:,:)=PSAV_DDOM(:,:)
    ENDIF
  ENDIF
  IF(YDMODEL%YRML_GCONF%YGFL%YUNEBH%LACTIVE) PUNEBH_T0(:,:)=PSAV_UNEBH(:,:)
  IF(YDMODEL%YRML_GCONF%YGFL%YUEN%LACTIVE)   PUEN_T0(:,:)=PSAV_ENTCH(:,:)
  
END ASSOCIATE

END ASSOCIATE

END SUBROUTINE
