SUBROUTINE WRITEPHYSIO(YDGEOMETRY,&
 & YDCPG_MISC,YDCPG_PHY0,YDCPG_PHY9,YDMF_PHYS,YDCPG_DYN0,YDCPG_DYN9,YDMF_PHYS_SURF,YDVARS,&
 & YDSURF,YDDPHY,YDRIP,YDML_PHY_MF,KEND, KST, KGL1, KGL2, KSTGLO,&
 & KSTEP  , KSGST  , KCSS   , PGELAM, PGEMU,&
 & PGM, PMU0, POROG, POROGL, POROGM, PRCORI, PRATATH, PRATATX,&
 & PAPHI  , PAPRS  , PAPHIF , PAPRSF , PALPH, PDELP, PLNPR, PRDELP,&
 & PLSM, PARG,  PSAB, PD2, PIVEG, PLAI, PCT,&
 & PALV, PALB, PALBF, PALBSF, PALBH, PEMISF,&
 & PGZ0F, PGZ0HF, PGZ0RLF, PGETRL, PVRLAN, PVRLDI, PRSMIN, PVEG0, PHV,&
 & PAESEA, PAELAN, PAESOO, PAEDES, PVO3ABC,&
 & PSPT0, PSPT0L, PSPT0M, PTT0, PTT0L, PTT0M, PQT0, PQT0L, PQT0M,&
 & PQI, PQL, PQSN, PQR, PQG, PECT,PEFB1,PEFB2,PEFB3,PCP,PR,&
 & PUT0, PVT0, PVORT0, PDIVT0, PCVGQ, PLCVQ,&
 & PTS0, PTP0, PWL0, PWS0, PWSI0, PWP0, PWPI0, PSNS0,&
 & PALBNS, PRHONS, PVERVEL,&
 & PEMTD  , PEMTU  , PTRSO  , PCLON  , PSLON,&
 & PDIFCQ, PDIFCQI, PDIFCQL, PDIFCS, PDIFTQ, PDIFTQI, PDIFTQL,&
 & PDIFTS, PFCCQL, PFCCQN, PFCSQL, PFCSQN, PFCQNG, PFCQING,&
 & PFCQLNG, PFCQRNG, PFCQSNG, PFPLCL, PFPLCN, PFPLSL, PFPLSN, PFPLSG, PFPLSHL,&
 & PFPFPSL, PFPFPSN, PFPFPCL, PFPFPCN, PFPEVPSL,PFPEVPSN,PFPEVPCL, PFPEVPCN,&
 & PFTKE, PFEFB1,PFEFB2,PFEFB3,PFRSO, PFRSOC, PFRTH, PFRTHC, PFRSOLU,&
 & PSTRCU, PSTRCV, PSTRDU, PSTRDV, PSTRTU, PSTRTV, PSTRMU, PSTRMV,&
 & PFRMH, PFRMQ, PFCHOZ, PNEB, PQICE, PQLI, PRH,&
 & PFCS, PFCLL, PFCLN, PFEVL, PFEVN, PFEVI, PFEVV, PFTR, PFLWSP, PFONTE,&
 & PFGEL, PFGELS, PFCHSP, PFRSODS, PFRSOPS, PFRSOPT, PFRTHDS,&
 & PCD, PCDN, PCH, PC1, PC2, PEMISH, PGZ0, PGZ0H, PNEIJ, PVEG ,&
 & PCPS, PLHS, PRS, PLH, PLSCPE, PQSAT, PQW, PTW,&
 & PQS, PQSATS, PRUISL, PRUISP, PRUISS,&
 & PUCLS, PVCLS, PTCLS, PQCLS, PRHCLS,&
 & PCLCT, PCLCH, PCLCM, PCLCL, PCLCC,&
 & PCAPE, PCTOP, KCLPH  , PCLPH  , PUGST  , PVGST,&
 & PFPLCH, PFPLSH, PTCCH, PSCCH, PBCCH, PBLH )

! --------------------------------------------------------------
! **** *writephysio* Write SCM input/output of physics on file.
! --------------------------------------------------------------
! Subject:
!     Write on files all inputs and some outputs from MF_PHYS
!     for profiles matching a given criteria.

! Method:
! Authors:  1999-03, J.M. Piriou / F. Bouyssel.
! Modifications:
!   2000-10, J.M. Piriou: use of a namelist for SCM extractions.
!   2002-03, J.M. Piriou: same arguments for writephysio as for MF_PHYS.
!        M.Hamrud      01-Oct-2003 CY28 Cleaning
!   2004-03: T. Kovacic : extracted subroutine WRITEPROFILE
!   2004-10, F. Bouyssel : cleaning
!   2007-05, F. Bouyssel : add PFCLL, PFCLN
!   2011-08, E. Bazile : add fields for WRITEMUSC (old recopie).
!   2013-11, Y. Bouteloup : EFB fields
!   K. Yessad (July 2014): Move some variables.
! --------------------------------------------------------------

USE MF_PHYS_TYPE_MOD   , ONLY : MF_PHYS_TYPE
USE CPG_TYPE_MOD       , ONLY : CPG_DYN_TYPE, CPG_PHY_TYPE, &
                              & CPG_MISC_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY : MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD, ONLY : FIELD_VARIABLES
USE MODEL_PHYSICS_MF_MOD , ONLY : MODEL_PHYSICS_MF_TYPE
USE GEOMETRY_MOD , ONLY : GEOMETRY
USE SURFACE_FIELDS_MIX , ONLY : TSURF
USE PARKIND1  ,ONLY : JPIM    ,JPRB
USE YOMHOOK   ,ONLY : LHOOK   ,DR_HOOK
USE YOMLUN    ,ONLY : NULOUT
USE YOMRIP    ,ONLY : TRIP
USE YOMSCM    ,ONLY : NFRSCM, NSCMTS, NSCM_SPACE_S, GSCM_LON1, GSCM_LON2&
 & , GSCM_LAT1, GSCM_LAT2, GSCM_RADIUS, NSCM_ADD_SAMPL , LGSCM 
USE YOMDPHY   ,ONLY : TDPHY
USE YOMCST    ,ONLY : RA  
USE YOMCT3    ,ONLY : NSTEP
USE YOMLSFORC, ONLY : LMUSCLFA

! --------------------------------------------------------------

IMPLICIT NONE

TYPE(GEOMETRY)    ,INTENT(IN)    :: YDGEOMETRY
TYPE(CPG_MISC_TYPE),INTENT(INOUT):: YDCPG_MISC
TYPE(CPG_PHY_TYPE),INTENT(INOUT) :: YDCPG_PHY0
TYPE(CPG_PHY_TYPE),INTENT(INOUT) :: YDCPG_PHY9
TYPE(MF_PHYS_TYPE),INTENT(INOUT) :: YDMF_PHYS
TYPE(CPG_DYN_TYPE),INTENT(INOUT) :: YDCPG_DYN0
TYPE(CPG_DYN_TYPE),INTENT(INOUT) :: YDCPG_DYN9
TYPE(MF_PHYS_SURF_TYPE),INTENT(INOUT) :: YDMF_PHYS_SURF
TYPE(FIELD_VARIABLES),INTENT(INOUT) :: YDVARS
TYPE(TSURF)       ,INTENT(INOUT) :: YDSURF
TYPE(TDPHY)       ,INTENT(INOUT) :: YDDPHY
TYPE(MODEL_PHYSICS_MF_TYPE),INTENT(INOUT):: YDML_PHY_MF
TYPE(TRIP)        ,INTENT(INOUT) :: YDRIP
INTEGER(KIND=JPIM),INTENT(IN)    :: KEND 
INTEGER(KIND=JPIM),INTENT(IN)    :: KST 
INTEGER(KIND=JPIM),INTENT(IN)    :: KGL1
INTEGER(KIND=JPIM),INTENT(IN)    :: KGL2
INTEGER(KIND=JPIM),INTENT(IN)    :: KSTGLO
INTEGER(KIND=JPIM),INTENT(IN)    :: KSTEP,  KSGST, KCSS
REAL(KIND=JPRB)   ,INTENT(IN)    :: PGELAM(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PGEMU(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PGM(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PMU0(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB)   ,INTENT(IN)    :: POROG(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB)   ,INTENT(IN)    :: POROGL(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB)   ,INTENT(IN)    :: POROGM(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PRCORI(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PRATATH(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PRATATX(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PAPHI(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG),&
 & PAPRS(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PAPHIF(YDGEOMETRY%YRDIM%NPROMM,YDGEOMETRY%YRDIMV%NFLEVG) ,&
 & PAPRSF(YDGEOMETRY%YRDIM%NPROMM,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PALPH(YDGEOMETRY%YRDIM%NPROMM,YDGEOMETRY%YRDIMV%NFLEVG) ,&
 &  PDELP(YDGEOMETRY%YRDIM%NPROMM,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PLNPR(YDGEOMETRY%YRDIM%NPROMM,YDGEOMETRY%YRDIMV%NFLEVG),&
 &  PRDELP(YDGEOMETRY%YRDIM%NPROMM,YDGEOMETRY%YRDIMV%NFLEVG) 
REAL(KIND=JPRB),INTENT(IN)    :: PLSM(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PARG(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PSAB(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PALV(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PALB(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PALBF(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PALBSF(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PALBH(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PEMISF(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PD2(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PIVEG(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PLAI(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PCT(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PGZ0F(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PGZ0HF(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PGZ0RLF(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PGETRL(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PVRLAN(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PVRLDI(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PRSMIN(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PVEG0(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PHV(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PAESEA(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PAELAN(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PAESOO(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PAEDES(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PVO3ABC(YDGEOMETRY%YRDIM%NPROMA,3)
REAL(KIND=JPRB),INTENT(IN)    :: PSPT0(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PSPT0L(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PSPT0M(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PTT0(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PTT0L(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PTT0M(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PQT0(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PQT0L(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PQT0M(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PQI(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PQL(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PQSN(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PQR(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PQG(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PECT(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PEFB1(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PEFB2(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PEFB3(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PCP(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PR(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PUT0(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PVT0(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PVORT0(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PDIVT0(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PCVGQ(YDGEOMETRY%YRDIM%NPROMM,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PLCVQ(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PTS0(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PTP0(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PWL0(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PWS0(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PWSI0(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PWP0(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PWPI0(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PSNS0(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PALBNS(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PRHONS(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PVERVEL(YDGEOMETRY%YRDIM%NPROMM,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PEMTD(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PEMTU(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PTRSO(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PCLON(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PSLON(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PDIFCQ(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PDIFCQI(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PDIFCQL(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PDIFCS(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PDIFTQ(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PDIFTQI(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PDIFTQL(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PDIFTS(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFCCQL(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFCCQN(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFCSQL(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFCSQN(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFCQNG(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFCQING(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFCQLNG(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFCQRNG(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFCQSNG(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFPLCL(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFPLCN(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFPLSL(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFPLSN(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFPLSG(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFPLSHL(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN) :: PFPFPSL(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG),&
  & PFPFPSN(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG),&
  & PFPFPCL(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG),PFPFPCN(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG),&
  & PFPEVPSL(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG),PFPEVPSN(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG),&
  & PFPEVPCL(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG),PFPEVPCN(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG),&
  & PFTKE(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFEFB1(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)  
REAL(KIND=JPRB),INTENT(IN)    :: PFEFB2(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)  
REAL(KIND=JPRB),INTENT(IN)    :: PFEFB3(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFRSO(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG,YDDPHY%NTSSG+1)
REAL(KIND=JPRB),INTENT(IN)    :: PFRSOC(YDGEOMETRY%YRDIM%NPROMM,0:1)
REAL(KIND=JPRB),INTENT(IN)    :: PFRTH(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG,YDDPHY%NTSSG+1)
REAL(KIND=JPRB),INTENT(IN)    :: PFRTHC(YDGEOMETRY%YRDIM%NPROMM,0:1)
REAL(KIND=JPRB),INTENT(IN)    :: PSTRCU(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PSTRCV(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PSTRDU(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PSTRDV(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PSTRTU(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PSTRTV(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PSTRMU(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PSTRMV(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFRMH(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFRMQ(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFCHOZ(YDGEOMETRY%YRDIM%NPROMM,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PNEB(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PQICE(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PQLI(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PRH(YDGEOMETRY%YRDIM%NPROMA,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFCS(YDGEOMETRY%YRDIM%NPROMM,YDDPHY%NTSSG+1)
REAL(KIND=JPRB),INTENT(IN)    :: PFCLL(YDGEOMETRY%YRDIM%NPROMM,YDDPHY%NTSSG+1)
REAL(KIND=JPRB),INTENT(IN)    :: PFCLN(YDGEOMETRY%YRDIM%NPROMM,YDDPHY%NTSSG+1)
REAL(KIND=JPRB),INTENT(IN)    :: PFEVL(YDGEOMETRY%YRDIM%NPROMM,YDDPHY%NTSSG+1)
REAL(KIND=JPRB),INTENT(IN)    :: PFEVN(YDGEOMETRY%YRDIM%NPROMM,YDDPHY%NTSSG+1)
REAL(KIND=JPRB),INTENT(IN)    :: PFEVI(YDGEOMETRY%YRDIM%NPROMM,YDDPHY%NTSSG+1)
REAL(KIND=JPRB),INTENT(IN)    :: PFEVV(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PFTR(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PFLWSP(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PFONTE(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PFGEL(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PFGELS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PFCHSP(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PFRSODS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PFRSOPS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PFRSOLU(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PFRSOPT(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PFRTHDS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PCD(YDGEOMETRY%YRDIM%NPROMM), PCDN(YDGEOMETRY%YRDIM%NPROMM), PCH(YDGEOMETRY%YRDIM%NPROMM) 
REAL(KIND=JPRB),INTENT(IN)    :: PC1(YDGEOMETRY%YRDIM%NPROMM), PC2(YDGEOMETRY%YRDIM%NPROMM), PEMISH(YDGEOMETRY%YRDIM%NPROMM) 
REAL(KIND=JPRB),INTENT(IN)    :: PGZ0(YDGEOMETRY%YRDIM%NPROMM), PGZ0H(YDGEOMETRY%YRDIM%NPROMM), PNEIJ(YDGEOMETRY%YRDIM%NPROMM) 
REAL(KIND=JPRB),INTENT(IN)    :: PVEG(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PQS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PQSATS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PCPS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PLHS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PRS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PLH(YDGEOMETRY%YRDIM%NPROMM,YDGEOMETRY%YRDIMV%NFLEVG),&
 & PLSCPE(YDGEOMETRY%YRDIM%NPROMM,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PQSAT(YDGEOMETRY%YRDIM%NPROMM,YDGEOMETRY%YRDIMV%NFLEVG),&
 & PQW(YDGEOMETRY%YRDIM%NPROMM,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PTW(YDGEOMETRY%YRDIM%NPROMM,YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PRUISL(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PRUISP(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PRUISS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PUCLS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PVCLS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PTCLS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PQCLS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PRHCLS(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PCLCT(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PCLCH(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PCLCM(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PCLCL(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PCLCC(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PCAPE(YDGEOMETRY%YRDIM%NPROMM),PCLPH(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PCTOP(YDGEOMETRY%YRDIM%NPROMM)
INTEGER(KIND=JPIM),INTENT(IN) :: KCLPH(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PUGST(YDGEOMETRY%YRDIM%NPROMM),PVGST(YDGEOMETRY%YRDIM%NPROMM)
REAL(KIND=JPRB),INTENT(IN)    :: PFPLCH(YDGEOMETRY%YRDIM%NPROMA,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PFPLSH(YDGEOMETRY%YRDIM%NPROMA,0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL(KIND=JPRB),INTENT(IN)    :: PTCCH(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PSCCH(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PBCCH(YDGEOMETRY%YRDIM%NPROMA)
REAL(KIND=JPRB),INTENT(IN)    :: PBLH(YDGEOMETRY%YRDIM%NPROMA)
! --------------------------------------------------------------
INTEGER(KIND=JPIM) :: JSTEP,JLON
LOGICAL :: LLOK, LLTIME_OK
REAL(KIND=JPRB) :: ZLAT_MODELE,ZLON_MODELE,ZD,ZHOUR,ZRR,ZPI,ZREQUIRED
REAL(KIND=JPRB) :: ZHOOK_HANDLE

! --------------------------------------------------------------

#include "abor1.intfb.h"
#include "writeprofile.intfb.h"
#include "writemusc.intfb.h"

! --------------------------------------------------------------
IF (LHOOK) CALL DR_HOOK('WRITEPHYSIO',0,ZHOOK_HANDLE)
ASSOCIATE(YDDIM=>YDGEOMETRY%YRDIM,YDDIMV=>YDGEOMETRY%YRDIMV,YDGEM=>YDGEOMETRY%YRGEM, &
  & YDMP=>YDGEOMETRY%YRMP, YDVAB=>YDGEOMETRY%YRVAB, YDVETA=>YDGEOMETRY%YRVETA, YDVFE=>YDGEOMETRY%YRVFE)
ASSOCIATE(NPROMA=>YDDIM%NPROMA, NPROMM=>YDDIM%NPROMM, &
 & NFLEVG=>YDDIMV%NFLEVG, &
 & NTSSG=>YDDPHY%NTSSG, &
 & RSTATI=>YDRIP%RSTATI, TSTEP=>YDRIP%TSTEP)
! --------------------------------------------------------------

IF (LGSCM) THEN
! -------------------------------------------------
! Define criteria for choosing profiles.
! -------------------------------------------------

!-------------------------------------------------
! 1. Time sampling.
!-------------------------------------------------
ZHOUR=RSTATI/3600._JPRB ! time since the beginning of the prediction in hours.
IF(NSCMTS(0) == 0) THEN
  !
  ! -------------------------------------------------
  ! One time step over nfrscm.
  ! -------------------------------------------------
  !
  LLTIME_OK=MOD(NSTEP,NFRSCM) == 0
  WRITE(NULOUT,*) 'writephysio: nscmts(0) == 0: lltime_ok=',LLTIME_OK
ELSEIF(NSCMTS(0) > 0) THEN
  !
  ! -------------------------------------------------
  ! Explicit list of time steps.
  ! -------------------------------------------------
  !
  LLTIME_OK=.FALSE.
  DO JSTEP=1,NSCMTS(0)
    IF(NFRSCM*NSCMTS(JSTEP) == NSTEP) LLTIME_OK=.TRUE.
  ENDDO
  WRITE(NULOUT,*) 'writephysio: nscmts(0) > 0: NSTEP=',NSTEP,' lltime_ok=',LLTIME_OK
ELSE
  !
  ! -------------------------------------------------
  ! Explicit list of hours.
  ! -------------------------------------------------
  !
  LLTIME_OK=.FALSE.
  DO JSTEP=1,-NSCMTS(0)
    ZREQUIRED=-REAL(NFRSCM,JPRB)*NSCMTS(JSTEP) ! required time in hours.
    IF(ABS(ZHOUR-ZREQUIRED) <= TSTEP) LLTIME_OK=.TRUE.
  ENDDO
  WRITE(NULOUT,*) 'writephysio: expl list hours: lltime_ok=',LLTIME_OK
ENDIF

!-------------------------------------------------
! 2. Space sampling.
!-------------------------------------------------

! RAPPEL: en t042: 8000 pdg, en T199: 180000 pdg.

IF (LLTIME_OK) THEN
  DO JLON=KST,KEND
    !
    ! -------------------------------------------------
    ! Compute model grid-point lat/lon coordinates.
    ! -------------------------------------------------
    !
    ZLAT_MODELE=ASIN(PGEMU(JLON))
    ZPI=4._JPRB*ATAN(1.0_JPRB)
    ZLON_MODELE=MODULO(PGELAM(JLON)+ZPI,2.0_JPRB*ZPI)-ZPI
    !
    ! -------------------------------------------------
    ! Is this profile required by the user?
    ! -------------------------------------------------
    !
    LLOK=.FALSE.
    IF(NSCM_SPACE_S == 0) THEN
      !
      ! -------------------------------------------------
      ! Choose profiles close to a given location.
      ! -------------------------------------------------
      !
      ! Compute othodromic distance (in meters) between searched point and model grid-point.
      !
      ZD=COS(ZLAT_MODELE)*COS(GSCM_LAT1)*COS(ZLON_MODELE-GSCM_LON1)&
       & + SIN(ZLAT_MODELE)*SIN(GSCM_LAT1)  
      ZD=ACOS(ZD)*RA
      LLOK=ZD < GSCM_RADIUS

    ELSEIF(NSCM_SPACE_S == 1) THEN
      !
      ! -------------------------------------------------
      ! Choose profiles inside a given box (in (lon, lat)),
      ! with additional regular sampling inside that box.
      ! -------------------------------------------------
      !
      LLOK=ZLON_MODELE > GSCM_LON1&
       & .AND. ZLON_MODELE < GSCM_LON2&
       & .AND. ZLAT_MODELE > GSCM_LAT1&
       & .AND. ZLAT_MODELE < GSCM_LAT2&
       & .AND.MOD(JLON,NSCM_ADD_SAMPL) == 0  
    ELSEIF(NSCM_SPACE_S == 10) THEN
      !
      ! -------------------------------------------------
      ! Choose profiles depending on physical output.
      ! -------------------------------------------------
      !
      ZRR=PFPLCL(JLON,NFLEVG)+PFPLCN(JLON,NFLEVG)
      LLOK=ZRR > 0.0_JPRB
    ELSEIF(NSCM_SPACE_S < 0) THEN
      !
      ! -------------------------------------------------
      ! Choose one profile over -NSCM_SPACE_S.
      ! -------------------------------------------------
      !
      LLOK=MOD(JLON,-NSCM_SPACE_S) == 0
    ELSE
      WRITE (NULOUT,*) 'writephysio/ERROR: NSCM_SPACE_S unexpected!...'
      WRITE (NULOUT,*) NSCM_SPACE_S
      CALL ABOR1('writephysio/ERROR: NSCM_SPACE_S unexpected!')
    ENDIF
    IF (LLOK) THEN
      !
      ! -------------------------------------------------
      ! The grid-point is a desired profile.
      ! -------------------------------------------------
      !
      CALL WRITEPROFILE(YDGEOMETRY,YDSURF,YDDPHY,YDRIP,YDML_PHY_MF,'Profile.',JLON,ZLAT_MODELE,ZLON_MODELE,ZD,PGELAM, &
& PGEMU,PGM,PMU0,&
& POROG,POROGL,POROGM,PRCORI,PRATATH,PRATATX,PLSM,PARG,PSAB,PALBF,PALBSF,PEMISF,PD2,PIVEG,PLAI,PCT,PGZ0F,PGZ0HF,PGZ0RLF, &
& PGETRL,PVRLAN,&
& PVRLDI,PRSMIN,PVEG0,PHV,PAESEA,PAELAN,PAESOO,PAEDES,PVO3ABC,PSPT0,PSPT0L,PSPT0M,PTT0,PTT0L,PTT0M,PQT0,PQT0L,PQT0M,PUT0, &
& PVT0,PVORT0,&
& PDIVT0,PCVGQ,PLCVQ,PTS0,PTP0,PWL0,PWS0,PWSI0,PWP0,PWPI0,PSNS0,PDIFCQ,PDIFCQI,PDIFCQL,PDIFCS,PDIFTQ,PDIFTQI,PDIFTQL,PDIFTS, &
& PFCCQL,&
& PFCCQN,PFCSQL,PFCSQN,PFCQNG,PFCQING,PFCQLNG,PFPLCL,PFPLCN,PFPLSL,PFPLSN,PFRSO,PFRTH,PSTRCU,PSTRCV,PSTRDU,PSTRDV,PSTRTU, &
& PSTRTV,PSTRMU,&
& PSTRMV,PFRMH,PFCHOZ,PNEB,PQICE,PQLI,PRH,PFCS,PFCLL,PFCLN,PFEVL,PFEVN,PFEVV,PFTR,PFLWSP,PFONTE,PFGEL,PFGELS,PFRSODS, &
& PFRSOPS,PFRSOPT,&
& PFRTHDS,PQS,PRUISL,PRUISP,PRUISS,PUCLS,PVCLS,PTCLS,PQCLS,PRHCLS,PCLCT,PCLCH,PCLCM,PCLCL,PCLCC,PFPLCH,PFPLSH,PTCCH,PSCCH, &
& PBCCH,PBLH)
    ENDIF
  ENDDO
ENDIF

ENDIF ! (LGSCM)

IF (LMUSCLFA) THEN
   CALL WRITEMUSC(YDVETA,YDRIP,YDML_PHY_MF,KST,KEND,NPROMA,1,NFLEVG,KGL1,KGL2,KSTEP,KSGST,KCSS,PAPHI,PAPRS,PAPHIF,PAPRSF, &
& PALPH,PARG,PD2,&
& PDELP,PIVEG,PLAI,PLNPR,PRDELP,PRSMIN,PSAB,PGZ0HF,PUT0,PVT0,PTT0,PQT0,PQI,PQL,PQSN,PQR,PQG,PECT,PEFB1,PEFB2,PEFB3,PCP,PCVGQ,&
& PR,PBLH,PSNS0,&
& PALBNS,PRHONS,PTP0,PTS0,PWL0,PWP0,PWPI0,PWS0,PWSI0,PHV,PVERVEL,PEMTD,PEMTU,PTRSO,PCLON,PSLON,PALV,PALBF,PALBSF,PEMISF, &
& PGETRL,PLSM,PVEG0,&
& PGZ0F,PGZ0RLF,PVRLAN,PVRLDI,PMU0,PGELAM,PGEMU,PGM,POROG,PDIFCQ,PDIFCQI,PDIFCQL,PDIFCS,PDIFTQ,PDIFTQI,PDIFTQL,PDIFTS, &
& PFCCQL,PFCCQN,PFCSQL,&
& PFCSQN,PFCQNG,PFCQING,PFCQLNG,PFCQRNG,PFCQSNG,PFPLCL,PFPLCN,PFPLSL,PFPLSN,PFPLSG,PFPLSHL,PFRSO,PFRSOC,PFRTH,PFRTHC, &
& PSTRCU,PSTRCV,PSTRDU,&
& PSTRDV,PSTRTU,PSTRTV,PSTRMU,PSTRMV,PFRMH,PFRMQ,PFCHOZ,PCPS,PLHS,PRS,PLH,PLSCPE,PNEB,PQICE,PQLI,PQSAT,PQW,PRH,PTW,PALB,PCD, &
& PCDN,PCH,PC1,&
& PC2,PCT,PEMISH,PFCHSP,PFCLL,PFCLN,PFCS,PFEVI,PFEVL,PFEVN,PFEVV,PFTR,PFLWSP,PFONTE,PALBH,PFGEL,PFGELS,PFRSODS,PFRSOPS, &
& PFRSOPT,PFRSOLU,&
& PFRTHDS,PFPFPSL,PFPFPSN,PFPFPCL,PFPFPCN,PFPEVPSL,PFPEVPSN,PFPEVPCL,PFPEVPCN,PFTKE,PFEFB1,PFEFB2,PFEFB3,PGZ0,PGZ0H,PNEIJ, &
& PVEG,PQS,PQSATS,&
& PRUISL,PRUISP,PRUISS,PUCLS,PVCLS,PTCLS,PQCLS,PRHCLS,PCLCT,PCLCH,PCLCM,PCLCL,PCLCC,PCAPE,PCTOP,KCLPH,PCLPH,PUGST,PVGST,'WRITEMUSC')

ENDIF

! --------------------------------------------------------------
END ASSOCIATE
END ASSOCIATE
IF (LHOOK) CALL DR_HOOK('WRITEPHYSIO',1,ZHOOK_HANDLE)
END SUBROUTINE WRITEPHYSIO
