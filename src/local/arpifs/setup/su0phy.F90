SUBROUTINE SU0PHY(YDMODEL,KULOUT)

!**** *SU0PHY*   - Initialize common YOxPHY controlling physics

!     Purpose.
!     --------
!           Initialize YOxPHY, the common that includes the
!           basic switches for the physics of the model.

!**   Interface.
!     ----------
!        *CALL* *SU0PHY(...) from SU0YOMA

!        Explicit arguments :
!        --------------------
!        KULOUT : Logical unit for the output

!        Implicit arguments :
!        --------------------

!     Method.
!     -------
!        See documentation

!     Externals.
!     ----------

!     Reference.
!     ----------
!        ECMWF Research Department documentation of the IFS

!        or

!        Documentation ARPEGE (depending on which physics will be used)

!     Author.
!     -------
!      J.-J. Morcrette                    *ECMWF*
!      J.-F. Geleyn for the ARPEGE rewriting.
!      Original : 91-11-12

!     Modifications.
!     --------------
!      G. Balsamo  20070115 New Hydrology (Van Genuchten+Orog. runoff)
!      M. Drusch   20070925 Wave model re-initialization
!      R. Brozkova: 20070219   : Cleaning cond./evap. switches.
!      E. Bazile :  20070510   : New logical LNEBECT, LEDMF
!      Modified by A.Alias : 2007/03 LMLH/LNODIFQC added
!                              P. Marquet : ACNEBR,ACDIFUS
!      R. El Khatib: 31-Aug-2007 Initialise uninitialised variable
!      Modified by P. Tulet    : add LRCO2
!      E. Bazile : 20080221    : New logical LCVGQKF
!      Y. Seity: 10-02-2008 Put LSOLV and LFGEL T for AROME Assim with LAROME T
!      S. Malardel : Feb 2008 add switch for MFSHAL in NAMARPHY/YOMARPHY
!      F. Bouyssel : Mars 2008 add LACDIFUS
!      Modified by A.Alias : 2008/04 Printing LZ0HSREL added
!      F. Bouyssel : May 2008 add LFLUSO, LFLCHCE, LFLWEG, NITERFL
!      F. Bouyssel : June 2008 add LO3FL
!      Y. Bouteloup : Juil 2008 add LECSHAL and LECDEEP
!      F. Bouyssel : Sept 2008 remove LFLCHCE, LFLWEG
!      F. Bouyssel : Oct 2008 removal of abort linked with ozone
!      D. Banciu   : Oct 2008 Additional checking for LENTCH
!      M. Janiskova: 2008-05-01 switches for new TL/AD lw radiation
!      S. Boussetta/G.Balsamo May 2009 Add variable LAI
!      C. Wittmann : 2009-03 add LACPANMX
!      E. Bazile   : July 2009 Switch for 2 microphysics
!      JF. Gueremy  : Aug 2009 New logical LNCVPGY,LDIFCEP,LSQRML
!      M. Leutbecher: 20081009 clipping of humidity at initial time (LECLIP*T0 )
!      I. Bastak Duran, F. Vana : 12-Oct-2009 p/eTKE switches update
!      K. Yessad (Jan 2010): remove useless variables.
!      I. Bastak Duran, F. Vana : 22-Feb-2011 TOUCANS switches update
!      P. Marguinaud : 29-Jun-2010 Add KSURFEXCTL flag (disable SURFEX surface scheme)
!      S. Boussetta/G.Balsamo Nov 2010 Add CTESSEL and RLAIINT
!      Y. Bouteloup  : 4-jan-2011 Add LEDKF
!      A. Alias  (Feb 2011) : test on LSFXLSM and LMSE use
!      M. Mokhtari (Feb 2011): add the key LMDUST
!      I. Bastak Duran, F. Vana : 15-Mar-2011 TOUCANS switches update
!      F. Bouyssel : Dec 2010 Modification of LADJCLD default
!      Y. Bouteloup : Feb 2011 add LRMU0M
!      Y. Boutelooup 01/04/2001 : NCALLRAD no call to radiation scheme at last time step
!      O.Riviere June 2011: New options for MF simplified physics
!      N.Semane+P.Bechtold 04-10-2012 LREASUR RESET TO .TRUE. FOR LAQUA
!      JF. Gueremy : Nov 2011 Dry Conv. Adj. (LAJUCV)
!      R. El Khatib : 01-Mar-2012 LFPSPEC => NFPOS
!      I. Bastak Duran, F. Vana : 26-Jan-2012 : LCOEFK_RIM for Ri_moist/Ri_s1
!      R. Brozkova 02/2012      : options for microphysics and cloudiness.
!      R. El Khatib : 26-Jul-2012 NFPOS==927 replaced by NFPOS/10==92
!      JJMorcrette 20110726 AEROU9
!      E. Bazile 12/2012      : LGLACIERS for soil inertia of ice cap.
!      F. Vana  15-Mar-2013  Removed NEPHYS_PCFULL, fix for lin. phys used in c001.
!      2013-11, J. Masek: Introduction of ACRANEB2 scheme.
!      Y. Bouteloup 28-11-2013 LEFB for EFB parameterization
!      Y. Bouteloup (January 2014) : change initialization of LEDKFI from .TRUE. to .FALSE.
!      M. Janiskova : May 2013 Set-up for ECMWF simplified surface scheme
!      K. Yessad (July 2013): move YOMRCOEF setup in SU0PHY (formerly in SUDIM2).
!      T. Wilhelmsson and K. Yessad (Oct 2013) Geometry and setup refactoring.
!      JJMorcrette 20130709 AEROU17
!      F. Vana & M. Kharoutdinov 09-Feb-2015: Setup for super-parametrization scheme.
!      A. Agusti-Panareda   09-08-2013  Add LBFASCO2 flag for GPP/REC flux adjustment
!      R. El Khatib 24-Apr-2015 Reset LRAY=.FALSE. if the atmosphere is
!      adiabatic => enable the surface to be unconditionally initialized.
!      P. Lopez 24-Jul-2015 Added set-up parameters for lightning parameterization.
!      L. Gerard (Mar 2016) non saturated downdraft, CSD updraft+ triggering, 
!                           LCOMOD/LCAMOD replace GCOMOD of yomphy0
!      J. Masek, Apr-2016: Exponential-random overlap and true direct flux
!      for ACRANEB2 radiation.
!      N. Gustafsson 13 Apr 2016: Add LOBSC1 to Minim and screening
!             to enable surfex in trajectory run for 4D-Var
!      2016-09, M. Mokhtari & A. Ambar: add the key LMDUST as LOGICAL POINTER
!      K. Yessad (Dec 2016): Prune obsolete options.
!      D. Saint-Martin (Sep 2018) LNORGWD added
!      R. Roehrig, (Sept 2018): add LCVTURB,LCVTURB,LDIFQL,LDISTUR
!                               change default value to .TRUE. for LNODIFQC (from JF Gueremy)
!      R. Hogan  (Jan 2019): Replaced LE4ALB with NALBEDOSCHEME
!      P. Bechtold Feb-2019 : Adding 2 EDR fileds
!      R. Hogan  (Mar 2019): Added RALFMINPSN, albedo of permanent snow
!      I. Etchevers (April 2019) : add NDPRECPERIOD and LDPRECIPS for precipitation type
!      R. Honnert & R. El Khatib (Nov 2019) : add LGRADHPHY for 3D parametrisations
!      R. El Khatib 29-Sep-2020 Derived type for variables shared between post-processing and model physics
!      J. Masek (Oct 2020) : removed LCOEFK_RIH
! End Modifications
!-------------------------------------------------------------------------------

USE TYPE_MODEL , ONLY : MODEL
USE PARKIND1   , ONLY : JPIM     ,JPRB
USE YOMHOOK    ,  ONLY : LHOOK,   DR_HOOK

USE YOMLUN     , ONLY : NULOUT   ,NULNAM
USE YOMPHY     , ONLY : JPHYEC,JPHYMF,JPHYARO,JPBP002
USE YOMCT0     , ONLY : LECMWF    ,NCONF    ,LR3D     ,LR2D     ,LARPEGEF,&
 &                      LAROME,LOBSC1,LSCREEN,LSFXLSM, LELAM, CNMEXP
USE YOMVRTL    , ONLY : L131TL
USE YOMVAR     , ONLY : LREPRO4DVAR

USE YOMDYNCORE , ONLY : LAQUA, LHELDSUAREZ
USE CRMDIMS    , ONLY : CRMBUFSIZE
USE YOMFPC     , ONLY : TNAMFPMPHYS

!     ------------------------------------------------------------------

IMPLICIT NONE

TYPE(MODEL),TARGET,INTENT(INOUT) :: YDMODEL
INTEGER(KIND=JPIM),INTENT(IN)    :: KULOUT

!     ------------------------------------------------------------------

TYPE(TNAMFPMPHYS) :: YLNAMFPMPHYS
INTEGER(KIND=JPIM) :: IERR
REAL(KIND=JPRB) :: ZHOOK_HANDLE

!     ------------------------------------------------------------------

#include "abor1.intfb.h"
#include "posnam.intfb.h"
#include "suscm.intfb.h"
#include "sufpc.intfb.h"

!     ------------------------------------------------------------------
LOGICAL , POINTER ::  LSTRA
LOGICAL , POINTER ::  LEFB
LOGICAL , POINTER ::  LNEBECT
LOGICAL , POINTER ::  LRRMES
INTEGER (KIND=JPIM) , POINTER :: NPRRI
INTEGER (KIND=JPIM) , POINTER :: NPRAC
LOGICAL , POINTER ::  LPTKE
LOGICAL , POINTER ::  LCOEFK_PTTE
LOGICAL , POINTER ::  LCVRA
LOGICAL , POINTER ::  LCVTDK
LOGICAL , POINTER ::  LSEDLAG
LOGICAL , POINTER ::  LNEBNXR
LOGICAL , POINTER ::  LSEDCL
LOGICAL , POINTER ::  LPHSPSH
LOGICAL , POINTER ::  LCAMOD
LOGICAL , POINTER ::  LCOMOD
LOGICAL , POINTER ::  LACDIFUS
LOGICAL , POINTER ::  LAFGD_A
INTEGER (KIND=JPIM) , POINTER ::  NRAUTOEV
LOGICAL , POINTER ::  LRELAXW
LOGICAL , POINTER ::  LCVPGY
LOGICAL , POINTER ::  LO3ABC
LOGICAL , POINTER ::  LRSTAB
LOGICAL , POINTER ::  LCVDD
INTEGER (KIND=JPIM) , POINTER ::  NDIFFNEB
LOGICAL , POINTER ::  LRAY
LOGICAL , POINTER ::  LMLH
INTEGER(KIND=JPIM) , POINTER ::  NOIR
LOGICAL , POINTER ::  LRAYPL
INTEGER (KIND=JPIM) , POINTER ::  NSORAYFR
LOGICAL , POINTER ::  LCLSATUR
LOGICAL , POINTER ::  LCVCAS
LOGICAL , POINTER ::  LFSFIX
LOGICAL , POINTER ::  LHUCN
LOGICAL , POINTER ::  LNEWD
LOGICAL , POINTER ::  LNEBCV
LOGICAL , POINTER ::  LGWD
LOGICAL , POINTER ::  LAEROVOL
LOGICAL , POINTER ::  LCVPRO
LOGICAL , POINTER ::  LCAPE
LOGICAL , POINTER ::  LCVGQ
LOGICAL , POINTER ::  LRCVOTT
LOGICAL , POINTER ::  LSMITH_CDEV
LOGICAL , POINTER ::  LCONDWT
LOGICAL , POINTER ::  LSTRAS
LOGICAL , POINTER ::  LRAYLU
LOGICAL , POINTER ::  LMPHYS
LOGICAL , POINTER ::  LCOEFK_THS1
LOGICAL , POINTER ::  LSMTPS
LOGICAL , POINTER ::  LCOLLEC
LOGICAL , POINTER ::  LCOEFK_PL
LOGICAL , POINTER ::  LGWDC
LOGICAL , POINTER ::  LNORGWD
LOGICAL , POINTER ::  LSMGCDEV
LOGICAL , POINTER ::  LRAYFM
LOGICAL , POINTER ::  LNEWSTAT
CHARACTER (LEN = 20) ::   CGMIXLEN
INTEGER (KIND=JPIM) , POINTER ::  NIMELIT
LOGICAL , POINTER ::  LNEBN
LOGICAL , POINTER ::  LCVPPKF
LOGICAL , POINTER ::  LECTREP
LOGICAL , POINTER ::  LACPANMX
LOGICAL , POINTER ::  LRPROX
LOGICAL , POINTER ::  LCVGQM
LOGICAL , POINTER ::  LCVGQD
LOGICAL , POINTER ::  LCVRAV3
LOGICAL , POINTER ::  LSNV
LOGICAL , POINTER ::  LARPMPS
LOGICAL , POINTER ::  LECTFL0
LOGICAL , POINTER ::  LNODIFQC
LOGICAL , POINTER ::  LSQRML
LOGICAL , POINTER ::  LGLACIERS
LOGICAL , POINTER ::  LPRGML
LOGICAL , POINTER ::  LECSHAL
LOGICAL , POINTER ::  LRSTAER
LOGICAL , POINTER ::  LCOEFKSURF
LOGICAL , POINTER ::  LCVLIS
LOGICAL , POINTER ::  LA0MPS
LOGICAL , POINTER ::  LCOEFK_RIS
LOGICAL , POINTER ::  LAEROSEA
LOGICAL , POINTER ::  LSOLV
LOGICAL , POINTER ::  LEDMFI
LOGICAL , POINTER ::  LEDMFS
LOGICAL , POINTER ::  LSMOOTHMELT
LOGICAL , POINTER ::  LAEROSOO
LOGICAL , POINTER ::  LSEDSTA
LOGICAL , POINTER ::  LFLUSO
LOGICAL , POINTER ::  LRKCDEV
LOGICAL , POINTER ::  LNEBCO
LOGICAL , POINTER ::  LNEIGE
LOGICAL , POINTER ::  LQXRTGH
LOGICAL , POINTER ::  LCOEFK_SCQ
LOGICAL , POINTER ::  LZ0HSREL
LOGICAL , POINTER ::  LVGSN
LOGICAL , POINTER ::  LCOEFK_MSC
LOGICAL , POINTER ::  LRRGUST
LOGICAL , POINTER ::  LRAYFM15
LOGICAL , POINTER ::  LDAYD
LOGICAL , POINTER ::  LEDKF
LOGICAL , POINTER ::  LNEBINS
LOGICAL , POINTER ::  LPHCDPI
LOGICAL , POINTER ::  LECTFL
LOGICAL , POINTER ::  LVOIGT
LOGICAL , POINTER ::  LSCMF
LOGICAL , POINTER ::  LVFULL
LOGICAL , POINTER ::  LO3FL
LOGICAL , POINTER ::  LSMNIMBT
LOGICAL , POINTER ::  LNOIAS
LOGICAL , POINTER ::  LCVPP
LOGICAL , POINTER ::  LNCVPGY
LOGICAL , POINTER ::  LECDEEP
LOGICAL , POINTER ::  LCOEFK_F1
LOGICAL , POINTER ::  LAERODES
LOGICAL , POINTER ::  LECTQ1
INTEGER (KIND=JPIM) , POINTER ::  NTHRAYFR
LOGICAL , POINTER ::  LADJCLD
LOGICAL , POINTER ::  LGCHECKMV
LOGICAL , POINTER ::  LRTPP
LOGICAL , POINTER ::  L3MT
LOGICAL , POINTER ::  LDIFCONS
LOGICAL , POINTER ::  LAEROSUL
INTEGER(KIND=JPIM) , POINTER ::  NBITER
LOGICAL , POINTER ::  LGPCMT
LOGICAL , POINTER ::  LPROCLD
LOGICAL , POINTER ::  LFGEL
LOGICAL , POINTER ::  LXRCDEV
LOGICAL , POINTER ::  LENTCH
INTEGER (KIND=JPIM) , POINTER ::  NCALLRAD
LOGICAL , POINTER ::  LCOEFKTKE
LOGICAL , POINTER ::  LFSVAR
LOGICAL , POINTER ::  LSTRAPRO
LOGICAL , POINTER ::  LFPCOR
LOGICAL , POINTER ::  LRELAXT
LOGICAL , POINTER ::  LAEROLAN
LOGICAL , POINTER ::  L2MICRO
LOGICAL , POINTER ::  LCDDEVPRO
LOGICAL , POINTER ::  LVDIF
LOGICAL , POINTER ::  LDIFCEXP
LOGICAL , POINTER ::  LCVTURB
LOGICAL , POINTER ::  LNEBRIC
LOGICAL , POINTER ::  LDIFQL
LOGICAL , POINTER ::  LDISTUR
LOGICAL , POINTER ::  LNEBR
LOGICAL , POINTER ::  LPTOPC
LOGICAL , POINTER ::  LCVGQKF
LOGICAL , POINTER ::  LREWS
LOGICAL , POINTER ::  LPBLE
INTEGER(KIND=JPIM) , POINTER ::  NDPSFI
LOGICAL , POINTER ::  LCDDPRO
LOGICAL , POINTER ::  LRMIX
LOGICAL , POINTER ::  LOZONE
LOGICAL , POINTER ::  LECT
INTEGER (KIND=JPIM) , POINTER ::  NSMTBOT
INTEGER(KIND=JPIM) , POINTER ::  NPHYREP
LOGICAL , POINTER ::  LSSD
INTEGER(KIND=JPIM) , POINTER ::  NITERFL
LOGICAL , POINTER ::  LNEBGY
LOGICAL , POINTER ::  LAB12
LOGICAL , POINTER ::  LEVAPP
LOGICAL , POINTER ::  LRMU0M
LOGICAL , POINTER ::  LNEBGR
LOGICAL , POINTER ::  LAJUCV
LOGICAL , POINTER ::  LBLVAR
INTEGER (KIND=JPIM) , POINTER ::  NSMDNEB
INTEGER (KIND=JPIM) , POINTER ::  NRAY
CHARACTER (LEN = 20) ::   CGTURS
CHARACTER (LEN = 20) ::   CGTRG
LOGICAL , POINTER ::  LCDDCSD
LOGICAL , POINTER ::  LCVCSD
LOGICAL , POINTER ::  LCVSHCU
LOGICAL , POINTER ::  LNSDO
LOGICAL , POINTER ::  LPEC
LOGICAL , POINTER ::  LUDEVOL
LOGICAL , POINTER ::  LUSL
INTEGER (KIND=JPIM) , POINTER ::  NCLOMIX
INTEGER (KIND=JPIM) , POINTER ::  NFSIG
LOGICAL , POINTER ::  LCOEFK_FLX
LOGICAL , POINTER ::  LREASUR
LOGICAL , POINTER ::  LSLC
LOGICAL , POINTER ::  LCOEFK_TOMS
LOGICAL , POINTER ::  LCOEFK_ML
LOGICAL , POINTER ::  LCVGQP
LOGICAL , POINTER ::  LSFHYD
LOGICAL , POINTER ::  LRTDL
LOGICAL , POINTER ::  LNEB_FP
LOGICAL , POINTER ::  LRNUMX
LOGICAL , POINTER ::  LRNUEXP
LOGICAL , POINTER ::  LRTRUEBBC
LOGICAL , POINTER ::  LRTRUEDIR
LOGICAL , POINTER ::  LGLT
LOGICAL , POINTER ::  LEDR
LOGICAL , POINTER ::  LHLRADUPD
LOGICAL , POINTER ::  LGRAPRO
INTEGER (KIND=JPIM) , POINTER ::  NLEND

INTEGER(KIND=JPIM), POINTER :: NLWFR, NLOOPLW, NCO2CLIMYY1, NCO2CLIMYY2, &
 & NCO2CLIMN1, NCO2CLIMN2, NCO2CLIMFRQ, NSTPW, NPRACCL, NLIMODE, NATMFLX, NSNMLWS, &
 & NALBEDOSCHEME, NEMISSSCHEME, NTEND_DIAG_POS, NTEND_DIAG_FREQ_RESET

LOGICAL, POINTER :: LWLCLHR, LOPTLWPR, LETRAJP, LETRAJPT, LERADI2, LERADS2, &
 & LERADSW2, LERADLW2, LERADN2, LERADFL2, LEDCLD2, LENCLD2, LEVAPLS2, &
 & LEVDIF2, LEGWDG2, LECUMF2, LECOND2, LEGWWMS2, LEQNGT2, LESURF2, &
 & LEKPERT, LEKPERTS, LENOPERT, LTRACLNPH, LEPHYS, LSLPHY,LECOND, LECUMF, LEDCLD, &
 & LEEVAP, LEGWDG, LEOZOC, LEQNGT, LERADI, LERADS, LESICE, LESURF, LEGWWMS, &
 & LEVDIF, LEVGEN, LESSRO, LELAIV, LESN09, LESNML, LECTESSEL, LEAGS, LEFLAKE, &
 & LEPCLD, LAGPHY, LEO3CH, LO3CH_SAFE, LO3CH_OLDVER, LO3CH_BMS, LO3CH_HLO, LECO2DIU, LNEEONLINE, LBFASCO2, LWCOU, LWCOU2W, &
 & LWCUR, LWSTOKES, LBUD23, LPPTILES, LBUDCYCLE, LEMETHOX, LERAIN, LVDFTRAC, LMFTRAC, & 
 & LMFSCAV, LEOCWA, LEOCCO, LEOCML, LEOCLAKE, LEOBC, LEOBCICE, LEOLAKESST, &
 & LOCMLTKE, LEOCSA, LEOCLA, LECURR, LEMWAVE, LESURFTRAJ, &
 & LECLIPQT0, LECLIPCLDT0, LDUCTDIA, LEGBRAD, LERAINGG, LESMOS, INVML, &
 & LSPHLC, LVDFLC, LSDRLC, LZMCON, LKEXP, LVDFDS, LSDRDS, LREGWWMS, LREGSF, &
 & LNCLIN, LREGCL, LRCOEF, LTLADDIA, LGLOBRAD, LSPCRM, LELIGHT, LEOBCMAX, LRAD_CLOUD_INHOMOG, LDIAGTURB_EC

CHARACTER(LEN=4) :: CO3CHEM

REAL(KIND=JPRB), POINTER :: RLAIINT, RSOUTW, RNORTW, RDEGREW, RTHRFRTI, RCIMIN, &
 & RCLDTOPP, RNORTHML, RSOUTHML, REASTML, RWESTML, ALPHA, AH0, USTARL, USTARS, &
 & ALANDZ0, ASEAZ0, REOBCMAX, RALFMINPSN

LOGICAL, POINTER :: LDPRECIPS
INTEGER(KIND=JPIM), POINTER :: NDPRECPERIOD
LOGICAL, POINTER :: LDPRECIPS2
INTEGER(KIND=JPIM), POINTER :: NDPRECPERIOD2

#include "namtrajp.nam.h"
#include "namphy.nam.h"
#include "sudprecips.intfb.h"
#include "sudvisi.intfb.h"

LOGICAL , POINTER ::  LGRADHPHY
LOGICAL , POINTER ::  LMFSHAL
LOGICAL , POINTER ::  LMSE
LOGICAL , POINTER ::  LINITCHEM
LOGICAL , POINTER ::  LORILAM
LOGICAL , POINTER ::  LUSECHEM
LOGICAL , POINTER ::  LMPA
LOGICAL , POINTER ::  LKFBCONV
LOGICAL , POINTER ::  LINITORILAM
LOGICAL , POINTER ::  LRCO2
LOGICAL , POINTER ::  LBUFLUX
LOGICAL , POINTER ::  LSURFEX_KFROM
LOGICAL , POINTER ::  LRDUST
LOGICAL , POINTER ::  LINITDUST
LOGICAL , POINTER ::  LRDEPOS
LOGICAL , POINTER ::  LMDUST
LOGICAL , POINTER ::  LAPL_ARPEGE
LOGICAL , POINTER ::  LMICRO

INTEGER(KIND=JPIM) , POINTER ::  NSURFEX_ITER
LOGICAL , POINTER ::  LTURB
LOGICAL , POINTER ::  LSURFEX_CRITICAL
LOGICAL , POINTER ::  LKFBD
LOGICAL , POINTER ::  LKFBS
LOGICAL , POINTER ::  LCVRASBM,LCONSENTH,LAPPROXCONV
REAL(KIND=JPRB) , POINTER :: RHCRIT1S,RHCRIT2S,TADJ,RMINEVP,DELTAH
CHARACTER(LEN=1) ::  CCOUPLING
#include "namarphy.nam.h"

#include "naephy.nam.h"
#include "naphlc.nam.h"

LOGICAL , POINTER ::  LVDIFSP
LOGICAL , POINTER ::  LNEBCVPPKF
LOGICAL , POINTER ::  LCVRASP
LOGICAL , POINTER ::  LSMOOTHB
LOGICAL , POINTER ::  LRAYSP
LOGICAL , POINTER ::  LGWDSP
LOGICAL , POINTER ::  LMICROTL
LOGICAL , POINTER ::  LSMOOTHD
LOGICAL , POINTER ::  LSTRASPN
REAL(KIND=JPRB), POINTER ::  RMODULQCPROG
LOGICAL , POINTER ::  LSTRASP
LOGICAL , POINTER ::  LTRAJRAIN
LOGICAL , POINTER ::  LMELTTL
LOGICAL , POINTER ::  LMELTNL
LOGICAL , POINTER ::  LEVAPTL
LOGICAL , POINTER ::  LCOLLECTL
LOGICAL , POINTER ::  LTRAJPST
LOGICAL , POINTER ::  LPROCLDTL
LOGICAL , POINTER ::  LGWDSPNL
LOGICAL , POINTER ::  LIGELREPRO
LOGICAL , POINTER ::  LSMOOTHA
LOGICAL , POINTER ::  LTRAJCOND
LOGICAL , POINTER ::  LSMOOTHEVP
LOGICAL , POINTER ::  LVDIFSPNL
LOGICAL , POINTER ::  LCLOUDS
LOGICAL , POINTER ::  LRRMESSP
LOGICAL , POINTER ::  LSIMPH
LOGICAL , POINTER ::  LTRAJPS
#include "namsimphl.nam.h"

#include "namrcoef.nam.h"

!     ------------------------------------------------------------------

IF (LHOOK) CALL DR_HOOK('SU0PHY',0,ZHOOK_HANDLE)

ASSOCIATE(YDPHY=>YDMODEL%YRML_PHY_MF%YRPHY,YGFL=>YDMODEL%YRML_GCONF%YGFL,YDMSE=>YDMODEL%YRML_PHY_MF%YRMSE, &
 & YDRCOEF=>YDMODEL%YRML_PHY_RAD%YRRCOEF,YDEWCOU=>YDMODEL%YREWCOU,YDARPHY=>YDMODEL%YRML_PHY_MF%YRARPHY, &
 & YDSIMPHL=>YDMODEL%YRML_PHY_MF%YRSIMPHL, YDPHNC=>YDMODEL%YRML_PHY_SLIN%YRPHNC, YDPHLC=>YDMODEL%YRML_PHY_SLIN%YRPHLC,&
 & YDELWRAD=>YDMODEL%YRML_PHY_RAD%YRELWRAD,YDEPHY=>YDMODEL%YRML_PHY_EC%YREPHY, YDECLDP=>YDMODEL%YRML_PHY_EC%YRECLDP,&
 & YDRIP=>YDMODEL%YRML_GCONF%YRRIP)
ASSOCIATE( &
 & NSURFEXCTLMAX=>YDMSE%NSURFEXCTLMAX, NSURFEXCTL=>YDMSE%NSURFEXCTL, &
 & NNOGW=>YGFL%NNOGW, NEDRP=>YGFL%NEDRP, LUVPOUT=>YGFL%LUVPOUT, LAEROUT=>YGFL%LAEROUT, &
 & NUVP=>YGFL%NUVP, NAEROUT=>YGFL%NAEROUT, &
 & NFPSURFEX=>YLNAMFPMPHYS%NFPSURFEX, &
 & LHMTO=>YDPHY%LHMTO, NPHY=>YDPHY%NPHY, LTHERMO=>YDPHY%LTHERMO, &
 & LWFLUX=>YDEWCOU%LWFLUX, LWFRSTIME=>YDEWCOU%LWFRSTIME, &
 & LWINIT=>YDEWCOU%LWINIT, &
 & NADV_WAVE=>YDEWCOU%NADV_WAVE, NG3SR=>YDRCOEF%NG3SR, &
 & NGMTR=>YDRCOEF%NGMTR, NLATRD=>YDRCOEF%NLATRD, &
 & NLATWR=>YDRCOEF%NLATWR,NFSD=>YGFL%NFSD,TSTEP=>YDRIP%TSTEP)
NTEND_DIAG_FREQ_RESET=>YDPHY%NTEND_DIAG_FREQ_RESET
NTEND_DIAG_POS=>YDPHY%NTEND_DIAG_POS
NSMDNEB => YDPHY%NSMDNEB
LSTRA => YDPHY%LSTRA
LEVAPP => YDPHY%LEVAPP
LAEROSOO => YDPHY%LAEROSOO
LCDDPRO => YDPHY%LCDDPRO
LRKCDEV => YDPHY%LRKCDEV
L2MICRO => YDPHY%L2MICRO
LNEBINS => YDPHY%LNEBINS
LHUCN => YDPHY%LHUCN
LCOEFK_TOMS => YDPHY%LCOEFK_TOMS
LRRMES => YDPHY%LRRMES
LCDDEVPRO => YDPHY%LCDDEVPRO
LECTFL0 => YDPHY%LECTFL0
NLEND => YDPHY%NLEND
LCOLLEC => YDPHY%LCOLLEC
LRSTAB => YDPHY%LRSTAB
LPTKE => YDPHY%LPTKE
LREASUR => YDPHY%LREASUR
LPBLE => YDPHY%LPBLE
LCOEFK_RIS => YDPHY%LCOEFK_RIS
LVOIGT => YDPHY%LVOIGT
LSEDLAG => YDPHY%LSEDLAG
LAEROLAN => YDPHY%LAEROLAN
LNEBECT => YDPHY%LNEBECT
NOIR => YDPHY%NOIR
LCVPGY => YDPHY%LCVPGY
LCOEFK_SCQ => YDPHY%LCOEFK_SCQ
LRMU0M => YDPHY%LRMU0M
NBITER => YDPHY%NBITER
LAERODES => YDPHY%LAERODES
LCVLIS => YDPHY%LCVLIS
LMLH => YDPHY%LMLH
LECT => YDPHY%LECT
LRSTAER => YDPHY%LRSTAER
LO3FL => YDPHY%LO3FL
LRRGUST => YDPHY%LRRGUST
LGLT => YDPHY%LGLT
LEDR => YDPHY%LEDR
LSLC => YDPHY%LSLC
LSEDSTA => YDPHY%LSEDSTA
NPHYREP => YDPHY%NPHYREP
LPHSPSH => YDPHY%LPHSPSH
LCAMOD => YDPHY%LCAMOD
LCOMOD => YDPHY%LCOMOD
LECTFL => YDPHY%LECTFL
LNEBGY => YDPHY%LNEBGY
LCVDD => YDPHY%LCVDD
LSEDCL => YDPHY%LSEDCL
LNEBGR => YDPHY%LNEBGR
LSNV => YDPHY%LSNV
LCVGQM => YDPHY%LCVGQM
LECSHAL => YDPHY%LECSHAL
LNEWSTAT => YDPHY%LNEWSTAT
LCVCAS => YDPHY%LCVCAS
LNODIFQC => YDPHY%LNODIFQC
LREWS => YDPHY%LREWS
LSTRAPRO => YDPHY%LSTRAPRO
LNOIAS => YDPHY%LNOIAS
LAEROVOL => YDPHY%LAEROVOL
NDPSFI => YDPHY%NDPSFI
LVDIF => YDPHY%LVDIF
LOZONE => YDPHY%LOZONE
NCALLRAD => YDPHY%NCALLRAD
LNCVPGY => YDPHY%LNCVPGY
LRAYLU => YDPHY%LRAYLU
LCVPRO => YDPHY%LCVPRO
LNEIGE => YDPHY%LNEIGE
LAEROSUL => YDPHY%LAEROSUL
LO3ABC => YDPHY%LO3ABC
LXRCDEV => YDPHY%LXRCDEV
LCLSATUR => YDPHY%LCLSATUR
LSTRAS => YDPHY%LSTRAS
NIMELIT => YDPHY%NIMELIT
LEDMFI => YDPHY%LEDMFI
LEDMFS => YDPHY%LEDMFS
LDIFCEXP => YDPHY%LDIFCEXP
LCVTURB => YDPHY%LCVTURB
LNEBRIC => YDPHY%LNEBRIC
LDIFQL => YDPHY%LDIFQL
LDISTUR => YDPHY%LDISTUR
LACPANMX => YDPHY%LACPANMX
LCOEFK_PTTE => YDPHY%LCOEFK_PTTE
LSFHYD => YDPHY%LSFHYD
NTHRAYFR => YDPHY%NTHRAYFR
LAEROSEA => YDPHY%LAEROSEA
NDIFFNEB => YDPHY%NDIFFNEB
LRCVOTT => YDPHY%LRCVOTT
LCOEFK_MSC => YDPHY%LCOEFK_MSC
LEDKF => YDPHY%LEDKF
LFLUSO => YDPHY%LFLUSO
LNEBNXR => YDPHY%LNEBNXR
LAFGD_A => YDPHY%LAFGD_A
LCVGQP => YDPHY%LCVGQP
LSMGCDEV => YDPHY%LSMGCDEV
LRAYPL => YDPHY%LRAYPL
LAJUCV => YDPHY%LAJUCV
LNEBR => YDPHY%LNEBR
LPTOPC => YDPHY%LPTOPC
LRMIX => YDPHY%LRMIX
LNEBN => YDPHY%LNEBN
LMPHYS => YDPHY%LMPHYS
NITERFL => YDPHY%NITERFL
LFSFIX => YDPHY%LFSFIX
LFSVAR => YDPHY%LFSVAR
LBLVAR => YDPHY%LBLVAR
NSORAYFR => YDPHY%NSORAYFR
LCONDWT => YDPHY%LCONDWT
LVFULL => YDPHY%LVFULL
LEFB => YDPHY%LEFB
LNEB_FP => YDPHY%LNEB_FP
LSMITH_CDEV => YDPHY%LSMITH_CDEV
LRAY => YDPHY%LRAY
LZ0HSREL => YDPHY%LZ0HSREL
NPRRI => YDPHY%NPRRI
LGWD => YDPHY%LGWD
LGLACIERS => YDPHY%LGLACIERS
LSCMF => YDPHY%LSCMF
LCVCSD => YDPHY%LCVCSD
LCVSHCU => YDPHY%LCVSHCU
NCLOMIX => YDPHY%NCLOMIX
NFSIG => YDPHY%NFSIG
LPEC => YDPHY%LPEC
LUDEVOL => YDPHY%LUDEVOL
LNSDO => YDPHY%LNSDO
LCDDCSD => YDPHY%LCDDCSD
LUSL => YDPHY%LUSL
LCVRA => YDPHY%LCVRA
LCVTDK => YDPHY%LCVTDK
LPHCDPI => YDPHY%LPHCDPI
LRTPP => YDPHY%LRTPP
LSOLV => YDPHY%LSOLV
L3MT => YDPHY%L3MT
LRAYFM => YDPHY%LRAYFM
LECTQ1 => YDPHY%LECTQ1
LPRGML => YDPHY%LPRGML
LCOEFK_FLX => YDPHY%LCOEFK_FLX
LCOEFK_PL => YDPHY%LCOEFK_PL
LCAPE => YDPHY%LCAPE
LCVGQ => YDPHY%LCVGQ
LCOEFK_F1 => YDPHY%LCOEFK_F1
LECDEEP => YDPHY%LECDEEP
LCOEFK_THS1 => YDPHY%LCOEFK_THS1
LCVGQD => YDPHY%LCVGQD
LDIFCONS => YDPHY%LDIFCONS
LFGEL => YDPHY%LFGEL
LGWDC => YDPHY%LGWDC
LNORGWD => YDPHY%LNORGWD
LSQRML => YDPHY%LSQRML
LNEBCO => YDPHY%LNEBCO
NSMTBOT => YDPHY%NSMTBOT
LQXRTGH => YDPHY%LQXRTGH
LAB12 => YDPHY%LAB12
NPRAC => YDPHY%NPRAC
LNEBCV => YDPHY%LNEBCV
LENTCH => YDPHY%LENTCH
LRELAXT => YDPHY%LRELAXT
LRELAXW => YDPHY%LRELAXW
LCOEFKSURF => YDPHY%LCOEFKSURF
LDAYD => YDPHY%LDAYD
NRAY => YDPHY%NRAY
LSMTPS => YDPHY%LSMTPS
LSMNIMBT => YDPHY%LSMNIMBT
LCOEFKTKE => YDPHY%LCOEFKTKE
NRAUTOEV => YDPHY%NRAUTOEV
LNEWD => YDPHY%LNEWD
LA0MPS => YDPHY%LA0MPS
LRTDL => YDPHY%LRTDL
LCVPP => YDPHY%LCVPP
LCOEFK_ML => YDPHY%LCOEFK_ML
LGPCMT => YDPHY%LGPCMT
LFPCOR => YDPHY%LFPCOR
LRPROX => YDPHY%LRPROX
LCVGQKF => YDPHY%LCVGQKF
LECTREP => YDPHY%LECTREP
LPROCLD => YDPHY%LPROCLD
LACDIFUS => YDPHY%LACDIFUS
LSSD => YDPHY%LSSD
LARPMPS => YDPHY%LARPMPS
LRNUMX => YDPHY%LRNUMX
LRNUEXP => YDPHY%LRNUEXP
LRTRUEBBC => YDPHY%LRTRUEBBC
LRTRUEDIR => YDPHY%LRTRUEDIR
LCVRAV3 => YDPHY%LCVRAV3
LRAYFM15 => YDPHY%LRAYFM15
LVGSN => YDPHY%LVGSN
LCVPPKF => YDPHY%LCVPPKF
LSMOOTHMELT => YDPHY%LSMOOTHMELT
LADJCLD => YDPHY%LADJCLD
LGCHECKMV => YDPHY%LGCHECKMV
LHLRADUPD => YDPHY%LHLRADUPD
LGRAPRO => YDPHY%LGRAPRO

LDPRECIPS    => YDPHY%LDPRECIPS
NDPRECPERIOD => YDPHY%NDPRECPERIOD
LDPRECIPS2    => YDPHY%LDPRECIPS2
NDPRECPERIOD2 => YDPHY%NDPRECPERIOD2

LRDUST => YDARPHY%LRDUST
LBUFLUX => YDARPHY%LBUFLUX
LINITDUST => YDARPHY%LINITDUST
LMPA => YDARPHY%LMPA
LUSECHEM => YDARPHY%LUSECHEM
LRDEPOS => YDARPHY%LRDEPOS
LKFBD => YDARPHY%LKFBD
LKFBCONV => YDARPHY%LKFBCONV
LINITORILAM => YDARPHY%LINITORILAM
LMFSHAL => YDARPHY%LMFSHAL
LGRADHPHY => YDARPHY%LGRADHPHY
LMICRO => YDARPHY%LMICRO

LTURB => YDARPHY%LTURB
LRCO2 => YDARPHY%LRCO2
LINITCHEM => YDARPHY%LINITCHEM
LORILAM => YDARPHY%LORILAM
NSURFEX_ITER => YDARPHY%NSURFEX_ITER
LSURFEX_CRITICAL => YDARPHY%LSURFEX_CRITICAL
LMSE => YDARPHY%LMSE
LSURFEX_KFROM => YDARPHY%LSURFEX_KFROM
LKFBS => YDARPHY%LKFBS
LMDUST => YDARPHY%LMDUST
LAPL_ARPEGE => YDARPHY%LAPL_ARPEGE

LTRAJPST => YDSIMPHL%LTRAJPST
LVDIFSPNL => YDSIMPHL%LVDIFSPNL
LCOLLECTL => YDSIMPHL%LCOLLECTL
LPROCLDTL => YDSIMPHL%LPROCLDTL
LIGELREPRO => YDSIMPHL%LIGELREPRO
LCONSENTH => YDSIMPHL%LCONSENTH
TADJ => YDSIMPHL%TADJ
DELTAH => YDSIMPHL%DELTAH
RMODULQCPROG => YDSIMPHL%RMODULQCPROG
LNEBCVPPKF => YDSIMPHL%LNEBCVPPKF
LMICROTL => YDSIMPHL%LMICROTL
LGWDSPNL => YDSIMPHL%LGWDSPNL
LRRMESSP => YDSIMPHL%LRRMESSP
LGWDSP => YDSIMPHL%LGWDSP
RHCRIT1S => YDSIMPHL%RHCRIT1S
LVDIFSP => YDSIMPHL%LVDIFSP
LSMOOTHEVP => YDSIMPHL%LSMOOTHEVP
LTRAJCOND => YDSIMPHL%LTRAJCOND
LTRAJRAIN => YDSIMPHL%LTRAJRAIN
LSTRASPN => YDSIMPHL%LSTRASPN
RMINEVP => YDSIMPHL%RMINEVP
LMELTNL => YDSIMPHL%LMELTNL
LEVAPTL => YDSIMPHL%LEVAPTL
LCLOUDS => YDSIMPHL%LCLOUDS
LCVRASP => YDSIMPHL%LCVRASP
LRAYSP => YDSIMPHL%LRAYSP
LAPPROXCONV => YDSIMPHL%LAPPROXCONV
LCVRASBM => YDSIMPHL%LCVRASBM
LSMOOTHB => YDSIMPHL%LSMOOTHB
LMELTTL => YDSIMPHL%LMELTTL
LSMOOTHA => YDSIMPHL%LSMOOTHA
LSMOOTHD => YDSIMPHL%LSMOOTHD
LSIMPH => YDSIMPHL%LSIMPH
LSTRASP => YDSIMPHL%LSTRASP
LTRAJPS => YDSIMPHL%LTRAJPS
RHCRIT2S => YDSIMPHL%RHCRIT2S

! Associate pointers for variables in namelist NAMTRAJP
LETRAJP         => YDPHNC%LETRAJP
LETRAJPT        => YDPHNC%LETRAJPT
NLWFR           => YDELWRAD%NLWFR
NLOOPLW         => YDELWRAD%NLOOPLW
LERADI2         => YDPHNC%LERADI2
LERADS2         => YDPHNC%LERADS2
LERADSW2        => YDPHNC%LERADSW2
LERADLW2        => YDPHNC%LERADLW2
LERADN2         => YDPHNC%LERADN2
LERADFL2        => YDPHNC%LERADFL2
LOPTLWPR        => YDELWRAD%LOPTLWPR
LWLCLHR         => YDELWRAD%LWLCLHR
LEDCLD2         => YDPHNC%LEDCLD2
LENCLD2         => YDPHNC%LENCLD2
LEVAPLS2        => YDPHNC%LEVAPLS2
LEVDIF2         => YDPHNC%LEVDIF2
LEGWDG2         => YDPHNC%LEGWDG2
LECUMF2         => YDPHNC%LECUMF2
LECOND2         => YDPHNC%LECOND2
LEGWWMS2        => YDPHNC%LEGWWMS2
LREGWWMS        => YDMODEL%YRML_PHY_SLIN%YREGWDWMS%LREGWWMS
LEQNGT2         => YDPHNC%LEQNGT2
LESURF2         => YDPHNC%LESURF2
LREGSF          => YDMODEL%YRML_PHY_SLIN%YRSRFTLAD%LREGSF
LEKPERT         => YDPHNC%LEKPERT
LEKPERTS        => YDPHNC%LEKPERTS
LENOPERT        => YDMODEL%YRML_PHY_SLIN%YREPHLI%LENOPERT
LNCLIN          => YDMODEL%YRML_PHY_SLIN%YRNCL%LNCLIN
LREGCL          => YDMODEL%YRML_PHY_SLIN%YRNCL%LREGCL
LTRACLNPH       => YDPHNC%LTRACLNPH

! Associate pointers for variables in namelist NAEPHY
LEPHYS          => YDEPHY%LEPHYS
LSLPHY          => YDEPHY%LSLPHY
LECOND          => YDEPHY%LECOND
LECUMF          => YDEPHY%LECUMF
LEDCLD          => YDEPHY%LEDCLD
LEEVAP          => YDEPHY%LEEVAP
LEGWDG          => YDEPHY%LEGWDG
LEOZOC          => YDEPHY%LEOZOC
LEQNGT          => YDEPHY%LEQNGT
LERADI          => YDEPHY%LERADI
LERADS          => YDEPHY%LERADS
LESICE          => YDEPHY%LESICE
LESURF          => YDEPHY%LESURF
LEGWWMS         => YDEPHY%LEGWWMS
LEVDIF          => YDEPHY%LEVDIF
LEVGEN          => YDEPHY%LEVGEN
LESSRO          => YDEPHY%LESSRO
LELAIV          => YDEPHY%LELAIV
LESN09          => YDEPHY%LESN09
LESNML          => YDEPHY%LESNML
LECTESSEL       => YDEPHY%LECTESSEL
LEAGS           => YDEPHY%LEAGS
RLAIINT         => YDEPHY%RLAIINT
LEFLAKE         => YDEPHY%LEFLAKE
LEPCLD          => YDEPHY%LEPCLD
LAGPHY          => YDEPHY%LAGPHY
LEO3CH          => YDEPHY%LEO3CH
LO3CH_SAFE     => YDEPHY%LO3CH_SAFE
LO3CH_OLDVER    => YDEPHY%LO3CH_OLDVER
LO3CH_BMS       => YDEPHY%LO3CH_BMS
LO3CH_HLO       => YDEPHY%LO3CH_HLO
LECO2DIU        => YDEPHY%LECO2DIU
LNEEONLINE      => YDEPHY%LNEEONLINE
LBFASCO2        => YDEPHY%LBFASCO2
NCO2CLIMYY1     => YDEPHY%NCO2CLIMYY1
NCO2CLIMYY2     => YDEPHY%NCO2CLIMYY2
NCO2CLIMN1      => YDEPHY%NCO2CLIMN1
NCO2CLIMN2      => YDEPHY%NCO2CLIMN2
NCO2CLIMFRQ     => YDEPHY%NCO2CLIMFRQ
NALBEDOSCHEME   => YDEPHY%NALBEDOSCHEME
NEMISSSCHEME    => YDEPHY%NEMISSSCHEME
RALFMINPSN      => YDEPHY%RALFMINPSN
NATMFLX         => YDEWCOU%NATMFLX
LWCOU           => YDEWCOU%LWCOU
LWCOU2W         => YDEWCOU%LWCOU2W
LWCUR           => YDEWCOU%LWCUR
LWSTOKES        => YDEWCOU%LWSTOKES
LBUD23          => YDEPHY%LBUD23
LPPTILES        => YDEPHY%LPPTILES
LBUDCYCLE       => YDEPHY%LBUDCYCLE
LEMETHOX        => YDEPHY%LEMETHOX
LERAIN          => YDEPHY%LERAIN
LVDFTRAC        => YDEPHY%LVDFTRAC
LMFTRAC         => YDEPHY%LMFTRAC
LMFSCAV         => YDEPHY%LMFSCAV
LEOCWA          => YDEPHY%LEOCWA
LEOCCO          => YDEPHY%LEOCCO
LEOCML          => YDEPHY%LEOCML
LEOCLAKE        => YDEPHY%LEOCLAKE
LEOBC           => YDEPHY%LEOBC
LEOBCICE        => YDEPHY%LEOBCICE
LEOBCMAX        => YDEPHY%LEOBCMAX
REOBCMAX        => YDEPHY%REOBCMAX
LEOLAKESST      => YDEPHY%LEOLAKESST
LOCMLTKE        => YDEPHY%LOCMLTKE
LEOCSA          => YDEPHY%LEOCSA
LEOCLA          => YDEPHY%LEOCLA
NSTPW           => YDEWCOU%NSTPW
RSOUTW          => YDEWCOU%RSOUTW
RNORTW          => YDEWCOU%RNORTW
RDEGREW         => YDEWCOU%RDEGREW
LECURR          => YDEPHY%LECURR
LESURFTRAJ      => YDEPHY%LESURFTRAJ
RTHRFRTI        => YDEPHY%RTHRFRTI
RCIMIN          => YDEPHY%RCIMIN
RCLDTOPP        => YDECLDP%RCLDTOPP
LEMWAVE         => YDEPHY%LEMWAVE
LECLIPQT0       => YDEPHY%LECLIPQT0
LECLIPCLDT0     => YDEPHY%LECLIPCLDT0
LDUCTDIA        => YDEPHY%LDUCTDIA
LEGBRAD         => YDEPHY%LEGBRAD
NPRACCL         => YDEPHY%NPRACCL
LERAINGG        => YDEPHY%LERAINGG
LSPCRM          => YDEPHY%LSPCRM
LESMOS          => YDEPHY%LESMOS
RNORTHML        => YDEPHY%RNORTHML
RSOUTHML        => YDEPHY%RSOUTHML
REASTML         => YDEPHY%REASTML
RWESTML         => YDEPHY%RWESTML
INVML           => YDEPHY%INVML
LELIGHT         => YDEPHY%LELIGHT
NLIMODE         => YDEPHY%NLIMODE
NSNMLWS         => YDEPHY%NSNMLWS
LRAD_CLOUD_INHOMOG => YDEPHY%LRAD_CLOUD_INHOMOG
LDIAGTURB_EC    => YDEPHY%LDIAGTURB_EC


! Associate pointers for variables in namelist NAPHLC
LSPHLC          => YDPHLC%LSPHLC
LVDFLC          => YDPHLC%LVDFLC
LSDRLC          => YDPHLC%LSDRLC
LZMCON          => YDPHLC%LZMCON
LKEXP           => YDPHLC%LKEXP
LVDFDS          => YDPHLC%LVDFDS
LSDRDS          => YDPHLC%LSDRDS
ALPHA           => YDPHLC%ALPHA
AH0             => YDPHLC%AH0
USTARL          => YDPHLC%USTARL
USTARS          => YDPHLC%USTARS
ALANDZ0         => YDPHLC%ALANDZ0
ASEAZ0          => YDPHLC%ASEAZ0

! Associate pointers for variables in namelist NAPHLC
LRCOEF          => YDRCOEF%LRCOEF
LTLADDIA        => YDRCOEF%LTLADDIA
LGLOBRAD        => YDRCOEF%LGLOBRAD


!     ------------------------------------------------------------------

!*       1.    Set default values.
!              -------------------

LECO2DIU=.FALSE.
LNEEONLINE=.TRUE.
LBFASCO2=.FALSE.
LEO3CH=.FALSE.
LO3CH_SAFE=.TRUE.
LO3CH_OLDVER=.FALSE.
LO3CH_BMS=.FALSE.
LO3CH_HLO=.FALSE.
CO3CHEM='H1.0'

!*       1.1.1 Set default values for Meteo-France physics
!              -------------------------------------------

LMPHYS=.FALSE.
LREASUR=.TRUE.
LSMOOTHMELT=.FALSE.
CGMIXLEN='Z'
CGTURS='MD2'
LPRGML=.FALSE.
LCAPE=.FALSE.
LCVGQ=.TRUE.
LCVGQD=.FALSE.
LCVGQM=.FALSE.
LCVGQP=.FALSE.
LCOMOD=.TRUE.
LCONDWT=.FALSE.
LCVCAS=.FALSE.
LCVLIS=.FALSE.
LCVPP=.FALSE.
LCVPPKF=.FALSE.
LEDKF=.FALSE.
LEDMFI=.FALSE.
LCVGQKF=.TRUE.
LCVDD=.FALSE.
LNEIGE=.TRUE.
LRNUMX=.FALSE.
LRNUEXP=.FALSE.
LACPANMX=.FALSE.
LRTRUEBBC=.FALSE.
LRTRUEDIR=.FALSE.
LCLSATUR=.FALSE.
LGLACIERS=.FALSE.
LRRGUST=.FALSE.
LO3ABC=.FALSE.
LO3FL=.FALSE.
LECSHAL=.FALSE.
LECDEEP=.FALSE.
LAEROSEA=.FALSE.
LAEROLAN=.FALSE.
LAEROSOO=.FALSE.
LAERODES=.FALSE.
LAEROVOL=.FALSE.
LAEROSUL=.FALSE.
LRELAXT=.FALSE.
LRELAXW=.FALSE.
LEVGEN=.FALSE.
LESSRO=.FALSE.
LELAIV=.FALSE.
LECTESSEL=.FALSE.
RLAIINT=0.0_JPRB
LEFLAKE=.FALSE.
LEOCML=.FALSE.
LEOBC=.FALSE.
LEOBCICE=.FALSE.
LEOBCMAX=.FALSE.
REOBCMAX=50.0_JPRB
LEOCLAKE=.FALSE.
LEOLAKESST=.FALSE.
LOCMLTKE=.FALSE.
LESN09=.FALSE.
LESNML=.FALSE.
LGLT=.FALSE.
LNEWD=.FALSE.
LDIFCONS=.FALSE.
LDIFQL=.FALSE.
LDISTUR=.FALSE.
LECT=.FALSE.
NLEND=0
LEFB=.FALSE.
LECTQ1=.FALSE.
LECTREP=.TRUE.
LECTFL=.FALSE.
LECTFL0=.FALSE.
LPBLE=.FALSE.
LCVPGY=.FALSE.
L3MT=.FALSE.
LGPCMT=.FALSE.
LRCVOTT=.FALSE.

LCVRA=.FALSE.
LCVTDK=.FALSE.
LDAYD=.FALSE.
LGWDC=.FALSE.
LNORGWD=.FALSE.
LGWD=.FALSE.
LHMTO=.FALSE.
LNEBCO=.FALSE.
LNEBN=.FALSE.
LNEBNXR=.FALSE.
LNEBR=.FALSE.
LPTOPC=.FALSE.
LNEBECT=.FALSE.
LNEB_FP=.FALSE.
LQXRTGH=.FALSE.
LHUCN=.FALSE.
LOZONE=.FALSE.
LRAYFM=.FALSE.
LRMU0M=.FALSE.
LRAYFM15=.FALSE.
LRRMES=.FALSE.
LSFHYD=.FALSE.
LSNV=.FALSE.
LSOLV=.FALSE.
LFGEL=.FALSE.
LSLC=.FALSE.
LSTRA=.FALSE.
LSTRAS=.FALSE.
LTHERMO=.FALSE.
LVDIF=.FALSE.
LVGSN=.FALSE.
LFPCOR=.FALSE.
LNOIAS=.FALSE.
LPHCDPI=.FALSE.
LBLVAR=.FALSE.
LACDIFUS=.FALSE.
LFLUSO=.FALSE.
L2MICRO=.FALSE.

!HIRLAM RADIATION SUGGESTIONS (SWITCH IN YOMPHY, NAMPHY)
LHLRADUPD=.FALSE.
LZ0HSREL=.FALSE.

LCVTURB=.FALSE.
LNEBRIC=.TRUE.

NBITER=2
NITERFL=6
NDPSFI=0
NPHYREP=1
NOIR=0
NCALLRAD=0
LGCHECKMV=.TRUE.

! ---------------------------------------------------
! ACRANEB radiation
! ---------------------------------------------------
LRAY=.FALSE.
LRAYLU=.FALSE.
LREWS=.FALSE.
LRPROX=.FALSE.
LRMIX=.FALSE.
LRSTAB=.FALSE.
LRSTAER=.TRUE.
LRTPP=.FALSE.
LRTDL=.FALSE.
LRAYPL=.FALSE.
LVOIGT=.FALSE.
LVFULL=.FALSE.
NRAY=1
NRAUTOEV=0
NSORAYFR=1
NTHRAYFR=-1

! ---------------------------------------------------
! ALARO turbulence (TOUCANS)
! ---------------------------------------------------
LPTKE      =.FALSE.
LCOEFKTKE  =.FALSE.
LCOEFKSURF =.FALSE.
LCOEFK_F1  =.TRUE.
LCOEFK_TOMS=.FALSE.
LCOEFK_THS1=.FALSE.
LCOEFK_RIS=.TRUE.
LCOEFK_PL=.FALSE.
LCOEFK_ML=.FALSE.
LCOEFK_PTTE=.FALSE.
LCOEFK_FLX=.FALSE.
LCOEFK_SCQ=.FALSE.
LCOEFK_MSC=.FALSE.
LAFGD_A    =.TRUE.

! ---------------------------------------------------
! ALARO-0 (cloud)
! ---------------------------------------------------
LSTRAPRO=.FALSE.
LNEWSTAT=.TRUE.
LPHSPSH=.FALSE. ! Pseudo Historic Surface Precip Sensible Heat Flux
LCAMOD=.FALSE.
LSMTPS=.FALSE.
LSMGCDEV=.FALSE.
LXRCDEV=.FALSE.
LRKCDEV=.FALSE.
LNEBCV=.FALSE.
LNEBINS=.FALSE.
LSMNIMBT=.FALSE.
NSMTBOT=0 ! interpolate
NSMDNEB=2 ! gradient limitation
NDIFFNEB=0
NIMELIT=1
NPRAC=1
NPRRI=1

! ---------------------------------------------------
! ALARO-0 (microphysics)
! ---------------------------------------------------
LSEDSTA=.TRUE.
LSEDLAG=.FALSE.
LSEDCL=.FALSE.
LFSVAR=.TRUE.
LFSFIX=.FALSE.
LA0MPS=.TRUE.
LARPMPS=.FALSE.
LAB12=.FALSE.
! ---------------------------------------------------
! ALARO-0 (prognostic convection)
! ---------------------------------------------------
LCVPRO=.FALSE.
LCDDPRO=.FALSE.
LENTCH=.FALSE.
LCDDEVPRO=.TRUE.
LSCMF=.FALSE.

! ---------------------------------------------------
! ALARO-1 (prognostic convection)
! ---------------------------------------------------
LCVCSD=.FALSE.
LNSDO=.FALSE.
LCDDCSD=.TRUE.
LCVSHCU=.TRUE.
LPEC=.FALSE.
LUDEVOL=.TRUE.
NCLOMIX=4_JPIM
NFSIG=2_JPIM
LUSL=.TRUE.
CGTRG='RC'

! ---------------------------------------------------
! ALARO (prognostic graupel)
! ---------------------------------------------------
LGRAPRO=.FALSE.

! - - - - - - - - - - - - - - - - - - - - - - - - - -
! Cloud and precipitation prognostic scheme (Lopez) :
! - - - - - - - - - - - - - - - - - - - - - - - - - -

LPROCLD=.FALSE.
LSMITH_CDEV=.FALSE.
LEVAPP=.TRUE.
LCOLLEC=.TRUE.
LADJCLD=.FALSE.
LSSD=.FALSE.

!AROME physics
LMPA=.FALSE.
LMICRO=.FALSE.

LTURB=.FALSE.
LMSE=.FALSE.
NSURFEXCTL=NSURFEXCTLMAX
NSURFEX_ITER=1
LKFBCONV=.FALSE.
LKFBD=.FALSE.
LKFBS=.FALSE.
LMFSHAL=.FALSE.
LGRADHPHY=.FALSE.
LUSECHEM=.FALSE.
LINITCHEM=.FALSE.
LINITDUST=.FALSE.
LINITORILAM=.FALSE.
LORILAM=.FALSE.
LRDUST=.FALSE.
LRDEPOS=.FALSE.
LRCO2=.FALSE.
LBUFLUX=.TRUE.
CCOUPLING='E'
LSURFEX_CRITICAL=.FALSE.
LSURFEX_KFROM=.FALSE.
LMDUST=.FALSE.
! - - - - - - - - - - -
! Module YOMPHY :
! - - - - - - - - - - -

LAJUCV=.FALSE.
LNEBGR=.FALSE.
LNEBGY=.FALSE.

LCVRAV3=.FALSE.

LMLH=.FALSE.
LNODIFQC=.TRUE.
LDIFCEXP=.FALSE.
LSQRML=.FALSE.
LNCVPGY=.FALSE.

!*    1.1.2  Set default values for simplified physical parametrization
!            of Meteo-France
!     -----------------------------------------------------------------

LSIMPH=.FALSE.
LTRAJPS=.FALSE.
LTRAJPST=.FALSE.
LSMOOTHD=.FALSE.
LSMOOTHA=.FALSE.
LSMOOTHB=.FALSE.
LCLOUDS=.FALSE.

LCVRASP=.FALSE.
LGWDSP=.FALSE.
LGWDSPNL=.FALSE.
LRAYSP=.FALSE.
LSTRASP=.FALSE.
LSTRASPN=.FALSE.
LVDIFSP=.FALSE.
LVDIFSPNL=.FALSE.
LRRMESSP=.FALSE.
LMELTTL=.FALSE.
LMELTNL=.FALSE.
LEVAPTL=.FALSE.
LTRAJRAIN=.FALSE.
LTRAJCOND=.FALSE.
LNEBCVPPKF=.FALSE.
DELTAH=0.3_JPRB
LCOLLECTL=.FALSE.
RMINEVP=10.0E-15
LSMOOTHEVP=.TRUE.
LPROCLDTL=.FALSE.
RHCRIT1S=0.7_JPRB
RHCRIT2S=0.7_JPRB
LPROCLDTL=.FALSE.
LMICROTL=.FALSE.
LCVRASBM=.FALSE.
TADJ=70.0_JPRB
LCONSENTH=.FALSE.
LAPPROXCONV=.TRUE.
LRCOEF=.FALSE.
LTLADDIA=.FALSE.
LGLOBRAD=.FALSE.
RMODULQCPROG=0.75_JPRB
LIGELREPRO=.TRUE.

!*    1.2.1  Set default values for ECMWF physics package
!            --------------------------------------------

LEPHYS=.FALSE.
LAGPHY=.TRUE.
LSLPHY=.FALSE.
LECOND=.FALSE.
LEPCLD=.FALSE.
LECUMF=.FALSE.
LEDCLD=.FALSE.
LEEVAP=.TRUE.
LEGWDG=.FALSE.
LEGWWMS=.FALSE.
LDIAGTURB_EC=.FALSE.
LEOZOC=.FALSE.
LEQNGT=.FALSE.
LERADI=.FALSE.
LERADS=.FALSE.
LESICE=.TRUE.
LESURF=.FALSE.
LEVDIF=.FALSE.
LEOCWA=.FALSE.
LEOCCO=.FALSE.
LEOCSA=.FALSE.
LEOCLA=.FALSE.
LEMETHOX=.FALSE.
LBUD23=.FALSE.
LPPTILES=.FALSE.
LBUDCYCLE=.FALSE.
LECURR=.FALSE.
LESURFTRAJ=.FALSE.
LVDFTRAC=.TRUE.
LMFTRAC=.TRUE.
LMFSCAV=.FALSE.
LERAIN=.FALSE.
LEMWAVE=.FALSE.
LEGBRAD=.FALSE.
LECLIPQT0=.FALSE.
LECLIPCLDT0=.FALSE.
LEVGEN=.FALSE.
LESSRO=.FALSE.
LELAIV=.TRUE.
LECTESSEL=.FALSE.
RLAIINT=0.0_JPRB
LEFLAKE=.FALSE.
LEOCML=.FALSE.
LEOBC=.FALSE.
LEOBCICE=.FALSE.
LEOBCMAX=.FALSE.
REOBCMAX=50.0_JPRB
LOCMLTKE=.FALSE.
LESN09=.FALSE.
LESNML=.FALSE.
LDUCTDIA=.FALSE.
RTHRFRTI=0.0_JPRB
RCIMIN=-1.0_JPRB
LESMOS=.FALSE.
NPRACCL=21600
LERAINGG=.FALSE.
LSPCRM=.FALSE.
LELIGHT=.FALSE.
NLIMODE=6
LRAD_CLOUD_INHOMOG=.FALSE.
NSNMLWS=1

!-------------------------------------------------------
! pressure above which cloud scheme is not called
RCLDTOPP=100.0_JPRB

!--------------------------------------------------------

!*     1.2.2  Set-up linearized physical parametrization of ECMWF
!             ---------------------------------------------------

LETRAJP = .FALSE.
LETRAJPT= .FALSE.
LERADI2 = .FALSE.
LERADS2 = .FALSE.
LERADSW2= .FALSE.
LERADLW2= .FALSE.
LERADN2 = .FALSE.
LERADFL2= .FALSE.
LEDCLD2 = .FALSE.
LENCLD2 = .FALSE.
LEVAPLS2= .FALSE.
LEVDIF2 = .FALSE.
LEGWDG2 = .FALSE.
LECUMF2 = .FALSE.
LECOND2 = .FALSE.
LEGWWMS2= .FALSE.
LEQNGT2 = .FALSE.
LESURF2 = .FALSE.

LEKPERT = .FALSE.
LEKPERTS= .FALSE. 
LNCLIN  = .FALSE.
LREGCL  = .FALSE.
LREGWWMS = .FALSE.
LREGSF  = .FALSE.
LWLCLHR = .FALSE.
LTRACLNPH = .TRUE.

! No perturbation of surface arrays
LENOPERT = .TRUE.

! Frequency of calling TL/AD of LW radiation
NLWFR = 4

! Using few shorter loops inside of nproma-loop for TL/AD of LW radiation
LOPTLWPR = .FALSE.
NLOOPLW  = 3

!     LOGICAL FOR THE VERT DIFF SCHEME VDIFLCZ USED IN CONF 601

LSPHLC  = .FALSE.
LVDFLC  = .FALSE.
LVDFDS  = .TRUE.
LSDRLC  = .TRUE.
LSDRDS  = .FALSE.
LZMCON  = .TRUE.
LKEXP   = .TRUE.
ALPHA   = 3._JPRB
AH0     = 1000.0_JPRB
USTARL  = 0.5_JPRB
USTARS  = 0.2_JPRB
ALANDZ0 = 0.05_JPRB
ASEAZ0  = 0.0005_JPRB

NSTPW=2
!     NSTPW=30

LWCOU=.FALSE.
LWCOU2W=.FALSE.
LWCUR=.FALSE.
LWSTOKES=.FALSE.
LWFLUX=.FALSE.

NATMFLX = 3

!  Setup for 1.5 degree resolution wave model
!  This is obsolete since the introduction of wvwaminit
!  in suwcou (RNORTW,RSOUTW,RDEGREW should be removed from namelist
!  naephy but they are still produced by prepIFS when generating
!  ifsnam.fc.h for a forecast run).

RNORTW= 81.0_JPRB
RSOUTW=-81.0_JPRB
RDEGREW=1.5_JPRB

! Boundaries of the ocean mixed layer domain

RSOUTHML=-40.0_JPRB
RNORTHML=40.0_JPRB
RWESTML=0.0_JPRB
REASTML=360.0_JPRB

INVML=.FALSE.

!  Default setup for wave model
LWFRSTIME=.TRUE.
LWINIT=.FALSE.
NADV_WAVE=0

! 3D diagnostics
LEDR=.FALSE.
LDPRECIPS=.FALSE.
NDPRECPERIOD=3600_JPIM ! precipitation type diag calculated over that time
LDPRECIPS2=.FALSE.
NDPRECPERIOD2=900_JPIM ! precipitation type diag2 calculated over that time


! Land-surface albedo scheme to use: 0 = ERBE, 1 = 4-component MODIS
! climatology with nearest neighbour mapping to SW bands of radiation
! scheme, 2 = 6-component MODIS climatology with weighted mapping to
! SW bands, 3 = 2-component MODIS climatology (diffuse parts of
! 4-component MODIS) with weighted mapping to SW bands
IF (LECMWF .AND. .NOT.LARPEGEF) THEN ! LECMWF+LARPEGEF means fullpos conversion from IFS GRIB to ARPEGE.
  NALBEDOSCHEME=2
ELSE
  NALBEDOSCHEME=0
ENDIF
! Land-surface emissivity scheme: 0 = 2-intervals, 1 = 6-intervals.
! Note that only ecRad can deal with 6 intervals; the other radiation
! schemes will get the values averaged back to 2 intervals.
NEMISSSCHEME=0

! Albedo of permanent snow, used in Antarctica, Greenland and on
! glaciers. 
! * 0.8 is the most defensible value, e.g. Balsamo et al. (2010 rd
!   memo), from Pirazzini (2004).
! * 0.85 was used up to CY46R1, although because of the effective
!   crossover between UV/Vis and Near-IR being 0.625 microns at that
!   time, rather than the more consistent 0.69 microns from CY47R1,
!   the effective broadband seen by the radiation scheme was 0.835.
!   To reproduce the older behaviour, use a value of 0.835 here.  The
!   imact of moving from 0.835 to 0.8 here is a warming of several
!   degrees in 2-m temperature over Antarctica and Greenland.
RALFMINPSN=0.835_JPRB

!        1.3 Modify default values according to LECMWF

IF (LECMWF) THEN
  LEPCLD=.TRUE.
  LEVDIF=.TRUE.
  LEOCWA=.TRUE.
  LEOCCO=.TRUE.
  LEOCSA=.TRUE.
  LEOCLA=.TRUE.
  LESURF=.TRUE.
  LECOND=.FALSE.
  LECUMF=.TRUE.
  LMFSCAV=.TRUE.
  LEEVAP=.TRUE.
  LEGWDG=.TRUE.
  LEGWWMS=.TRUE.
  LDIAGTURB_EC=.FALSE.
  LEOZOC=.TRUE.
  LEQNGT=.TRUE.
  LERADI=.TRUE.
  LERADS=.TRUE.
  LESICE=.TRUE.
  LEDCLD=.TRUE.
  NCO2CLIMYY1=0_JPIM
  NCO2CLIMYY2=0_JPIM
  NCO2CLIMN1=0_JPIM
  NCO2CLIMN2=0_JPIM
  NCO2CLIMFRQ=0_JPIM
  LEMETHOX=.TRUE.
  LEVGEN=.TRUE.
  LESSRO=.TRUE.
  LELAIV=.TRUE.
  LECTESSEL=.TRUE.
  LEAGS=.FALSE.
  RLAIINT=0.0_JPRB
  LEFLAKE=.TRUE.
  LEOCML=.FALSE.
  LEOBC=.FALSE.
  LEOBCICE=.FALSE.
  LEOBCMAX=.TRUE.
  REOBCMAX=50.0_JPRB
  LEOCLAKE=.FALSE.
  LEOLAKESST=.TRUE.
  LOCMLTKE=.FALSE.
  IF (LOCMLTKE) THEN
    LEOCWA=.FALSE.
    LEOCML=.FALSE.
  ENDIF
  LESN09=.TRUE.
  LESNML=.FALSE.
  RSOUTHML=-40._JPRB
  RNORTHML=40._JPRB
  RWESTML=0._JPRB
  REASTML=360._JPRB
  INVML=.FALSE.
  IF(NCONF == 1.OR.NCONF == 302) THEN
    LEPHYS=.TRUE.
  ENDIF
  LSLPHY=.TRUE.
  IF (NCONF == 501 .OR. NCONF == 131) LSLPHY=.FALSE.
   IF(NCONF == 131) THEN
    LERADI2 = .TRUE.
    LERADS2 = .TRUE.
    LEVDIF2 = .TRUE.
    LEGWDG2 = .TRUE.
    LECUMF2 = .TRUE.
    LECOND2 = .TRUE.
    IF(L131TL) THEN
      LEPHYS=.TRUE.
      LECOND=.TRUE.
      LEPCLD=.FALSE.
    ENDIF
    LSPHLC=.TRUE.
    LVDFLC=.TRUE.
    LSDRLC=.TRUE.
    LZMCON=.TRUE.
    LKEXP =.TRUE.
  ENDIF
  IF (NCONF == 401 .OR. NCONF == 501) THEN
    LEPHYS = .TRUE.
    LECOND = .TRUE.
    LEPCLD = .FALSE.

    LETRAJP = .TRUE.
    LERADI2 = .TRUE.
    LERADS2 = .TRUE.
    LEVDIF2 = .TRUE.
    LEGWDG2 = .TRUE.
    LECUMF2 = .TRUE.
    LECOND2 = .TRUE.
  ENDIF

  IF(NCONF == 601.OR.NCONF == 801) THEN

!      Full physics when computing the trajectory

    LEPHYS=.TRUE.

!      Simple scheme for TL and ADJ

    LSPHLC  = .TRUE.
    LVDFLC  = .TRUE.
    LVDFDS  = .TRUE.
    LSDRLC  = .TRUE.
    LSDRDS  = .TRUE.
    LZMCON  = .TRUE.
    LKEXP   = .TRUE.
    ALPHA   = 3._JPRB
    AH0     = 1000.0_JPRB
    USTARL  = 0.5_JPRB
    USTARS  = 0.2_JPRB
    ALANDZ0 = 0.05_JPRB
    ASEAZ0  = 0.0005_JPRB

  ENDIF
  NPHY = JPHYEC
ELSE
  IF (LR3D.OR.(NCONF == 701)) THEN
    LAGPHY=.FALSE.
    LCVCAS=.TRUE.
    LCVDD=.TRUE.
    LCVLIS=.TRUE.
    LCVPP=.TRUE.
    LCVRA=.TRUE.
    LFGEL=.TRUE.
    LGWD=.TRUE.
    LHMTO=.TRUE.
    LMPHYS=.TRUE.
    LNEBN=.TRUE.
    LNEBNXR=.FALSE.
    LNEIGE=.TRUE.
    LRAY=.TRUE.
    LRAYLU=.TRUE.
    LRAYPL=.TRUE.
    LRRMES=.TRUE.
    LSFHYD=.TRUE.
    LSOLV=.TRUE.
    LSTRA=.TRUE.
    LTHERMO=.TRUE.
    LVDIF=.TRUE.
    NPHY = JPHYMF
    IF ( L3MT.OR.LGPCMT.OR.LSTRAPRO ) NPHY = JPBP002
    IF(LAROME) THEN
!     Switch off MF physics in AROME forecast:
      LCVRA=.FALSE.
      LGWD=.FALSE.
      LGWDC=.FALSE.
      LNORGWD=.FALSE.
      LNEBCO=.FALSE.
      LNEBN=.FALSE.
      LNEBR=.FALSE.
      LPTOPC=.FALSE.
      LOZONE=.FALSE.
      LRAY=.FALSE.
      LRAYLU=.FALSE.
      LRAYPL=.FALSE.
      LRAYFM=.FALSE.
      LRAYFM15=.FALSE.
      LRRMES=.FALSE.
      LSFHYD=.FALSE.
      LSNV=.FALSE.
      LSOLV=.FALSE.
      LFGEL=.FALSE.
      LSTRA=.FALSE.
      LSTRAS=.FALSE.
      LVDIF=.FALSE.
      !initialisation of AROME's physic ones
      LMPA=.TRUE.
      LMICRO=.FALSE.
      LTURB=.FALSE.
      LMSE=.FALSE.
      LKFBCONV=.FALSE.
      LUSECHEM=.FALSE.
      LKFBD=.FALSE.
      LKFBS=.FALSE.
      LMFSHAL=.FALSE.
      LGRADHPHY=.FALSE.
      LUSECHEM=.FALSE.
      LORILAM=.FALSE.
      LRDUST=.FALSE.
      LINITCHEM=.FALSE.
      LINITDUST=.FALSE.
      LINITORILAM=.FALSE.
      LRDEPOS=.FALSE.
      LRCO2=.FALSE.
      NPHY = JPHYARO
      IF (LSCREEN .OR. (NCONF == 131) .OR. LOBSC1 .OR. &
          & ((NCONF == 001) .AND. (CNMEXP(1:4) == 'TRAJ')) ) THEN
        LSOLV=.TRUE.
        LFGEL=.TRUE.
      ENDIF
    ENDIF
  ENDIF
ENDIF

!     ------------------------------------------------------------------

!*       2.    Modify default values.
!              ----------------------

CALL POSNAM(NULNAM,'NAMPHY')
READ(NULNAM,NAMPHY)
! Work-around for PGI compiler bug
YDPHY%CGMIXLEN=CGMIXLEN
YDPHY%CGTURS=CGTURS
YDPHY%CGTRG=CGTRG

!  Control of NCALLRAD
IF ((NCALLRAD /= 0).AND.(NCALLRAD /= 2)) THEN
  WRITE(NULOUT,'("SU0PHY: NCALLRAD MUST BE 0 OR 2")')
  WRITE(NULOUT,'("SU0PHY: NCALLRAD=",I2)')NCALLRAD
  CALL ABOR1('SUECRAD: NCALLRAD MUST BE 0 OR 2')
ENDIF

IF(LDPRECIPS.AND.MOD(REAL(NDPRECPERIOD),TSTEP)/=0._JPRB) THEN
  WRITE(KULOUT,*)'WARNING NDPRECPERIOD DO NOT EXACTLY DIVIDE TSTEP ', TSTEP
  WRITE(KULOUT,*)'PRECIPS TYPE CALCULATION MAY BE WRONG',&
                       &MOD(REAL(NDPRECPERIOD),TSTEP)
ENDIF

IF(LDPRECIPS2.AND.MOD(REAL(NDPRECPERIOD2),TSTEP)/=0._JPRB) THEN
  WRITE(KULOUT,*)'WARNING NDPRECPERIOD2 DO NOT EXACTLY DIVIDE TSTEP'
  WRITE(KULOUT,*)'PRECIPS TYPE CALCULATION MAY BE WRONG',&
                       &MOD(REAL(NDPRECPERIOD2),TSTEP)
ENDIF

!  Precipitation type diagnostic
IF (LDPRECIPS .OR. LDPRECIPS2) THEN
  CALL SUDPRECIPS(YDPHY,YDRIP,KULOUT)
ENDIF

! Visibilities
CALL SUDVISI(YDPHY,YDARPHY,KULOUT)

CALL POSNAM(NULNAM,'NAMARPHY')
READ(NULNAM,NAMARPHY)

CALL SUFPC(YDNAMFPMPHYS=YLNAMFPMPHYS,LDPRINT=.FALSE.)

IF (LMSE .AND. NFPSURFEX==1) THEN
  ! nfpsurfex==1 is to transforms isba fields into surfex fields ; therefore lmse cannot be true :
  LMSE=.FALSE.
  WRITE(NULOUT,'('' NFPSURFEX==1 => LMSE reset to .F. '')')
ENDIF

! Work-around for PGI compiler bug
YDARPHY%CCOUPLING=CCOUPLING
IF(LMSE .AND. .NOT.(LSCREEN .OR. (NCONF == 131) .OR. LOBSC1 .OR. &
          & ((NCONF == 001) .AND. (CNMEXP(1:4) == 'TRAJ')) )  ) THEN
  LSOLV=.FALSE.
  LFGEL=.FALSE.
  LSNV=.FALSE.
  LVGSN=.FALSE.
  WRITE(NULOUT,'('' INFO -old isba-lsolv,lfgel,lsnv,lvgsn- reset to .F. '',&
                 &'' when using lground i.e. surfex '')')
ENDIF

IF(LSFXLSM.AND..NOT.LMSE) THEN
  WRITE(NULOUT,FMT='('' LMSE/LSFXLSM switches not COHERENT : LMSE='',L5,&
   & '' LSFLSM='',L5)') LMSE,LSFXLSM
    CALL ABOR1(' SU0PHY: LSFXLSM/LMSE')
ENDIF

CALL POSNAM(NULNAM,'NAEPHY')
READ(NULNAM,NAEPHY)

! Work-around for PGI compiler bug
YDEPHY%CO3CHEM=CO3CHEM

! Make sure the adiabatic model will initialize the surface.
! Indeed, there can be a surface scheme in the adiabatic atmospheric model.
IF (.NOT.(LMPHYS.OR.LEPHYS)) LRAY=.FALSE.

NNOGW=0
IF(LEGWWMS) NNOGW=2
NEDRP=0
IF(LDIAGTURB_EC) NEDRP=2
NFSD=0
IF (LRAD_CLOUD_INHOMOG) NFSD=1
NUVP=0
IF(LUVPOUT) NUVP=1
NAEROUT=0
IF(LR2D) THEN
  LREASUR=.FALSE.
ENDIF
IF(LAQUA) THEN
  LREASUR=.TRUE. 
  WRITE(NULOUT,'('' INFO - LREASUR RESET TO .TRUE. FOR LAQUA '')')
ENDIF
IF(.NOT.(LEPHYS.OR.LMPHYS.OR.LHELDSUAREZ)) THEN
  LAGPHY=.FALSE.
  LSLPHY=.FALSE.
  WRITE(NULOUT,'('' INFO - LSLPHY RESET TO .FALSE. '')')
ENDIF
IF((.NOT.LEPHYS).AND.LEPCLD) THEN
  ! LEPCLD must be off when LEPHYS=.F. 
  ! (to set properly thermodynamic activity for GFL fields)
  LEPCLD=.FALSE.
  WRITE(NULOUT,'('' WARNING - LEPCLD RESET TO .FALSE. '')')
ENDIF
IF(LEPCLD) THEN
  LECOND=.FALSE.
ENDIF
IF(LAGPHY.AND.NDPSFI /= 0) THEN
  NDPSFI=0
  WRITE(NULOUT,'('' WARNING - NDPSFI RESET TO 0 '')')
ENDIF

IF(LWCOU2W .AND. LWCOU) THEN
  IF(LEOCWA .AND. LEOCLA) LWSTOKES=.TRUE. ! Stokes drift only needed for the warm skin layer parameterisation
                                          ! with LEOCLA=.true.
  IF(LOCMLTKE) LWFLUX=.TRUE.  ! currently the only reason to return the wave fluxes is if LOCMLTKE is true
ENDIF

IF(.NOT. LWSTOKES) THEN
  LEOCLA=.FALSE.
ENDIF

CALL POSNAM(NULNAM,'NAPHLC')
READ(NULNAM,NAPHLC)

CALL POSNAM (NULNAM,'NAMTRAJP')
READ (NULNAM,NAMTRAJP)

! To run 4D-Var in bit reproducible mode, computation of cloudy
! effects on LW radiation must be done for all levels, i.e.
! re-setting LWLCLHR to false
IF (LREPRO4DVAR) THEN
  LWLCLHR = .FALSE.
ENDIF

CALL POSNAM(NULNAM,'NAMSIMPHL')
READ(NULNAM,NAMSIMPHL)

CALL POSNAM(NULNAM,'NAMRCOEF')
READ(NULNAM,NAMRCOEF)

!-------------------------------------------------
! Initialize profile extractions for the Single Column Model .
!-------------------------------------------------

CALL SUSCM(KULOUT)

!     ------------------------------------------------------------------

!*       3.    Do tests of consistency.
!              ------------------------

IERR=0

! * Test that adequate physics is activated when LRCOEF,is set to .TRUE.
IF( LRCOEF .AND. ((.NOT.LMPHYS).OR.LEPHYS.OR.LAGPHY) ) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SU0PHY: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,'(1X,A,A,A)') ' SU0PHY: options ',&
   & 'LRCOEF ',&
   & 'require the following options for physics:'
  WRITE(KULOUT,'(1X,A)') '         - LMPHYS=.TRUE. '
  WRITE(KULOUT,'(1X,A)') '         - LEPHYS=.FALSE. '
  WRITE(KULOUT,'(1X,A)') '         - LAGPHY=.FALSE. '
  IF(.NOT.LRAYSP) THEN
    WRITE(KULOUT,'(1X,A,A,A)') ' SU0PHY: options ',&
     & 'LRCOEF ',&
     & 'require the following option for simplified physics:'
    WRITE(KULOUT,'(1X,A)') '         - LRAYSP=.TRUE. '
  ENDIF
ENDIF

! * Use NDPSFI=1 when not available or inconsistent with some other options?
IF(YDMODEL%YRML_DYN%YRDYNA%LGWADV .AND. (NDPSFI==1)) THEN
  ! * these two options actually can run together on an informatic
  !   point of view, but the current assumptions done with LGWADV=T
  !   are that a particle which is on the Earth surface remains
  !   on the Earth surface; this is equivalent to assume that "etadot_surf"
  !   is always zero. This condition is satisfied when NDPSFI=0
  !   but not when NDPSFI=1 which gives a non-zero value to "etadot_surf".
  !   So one forbids combination "LGWADV .AND. (NDPSFI==1)" which leads
  !   to inconsistencies in the model at the surface.
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SU0PHY: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,'(1X,A,A,A)') ' SU0PHY: options ',&
   & 'NDPSFI=1 ',&
   & 'require that:'
  WRITE(KULOUT,'(1X,A)') '         - LGWADV=.FALSE. '
ENDIF

! Test for Super-Parametrization scheme
IF (LSPCRM) THEN
  IF (CRMBUFSIZE == 0) THEN
    IERR=IERR+1
    WRITE(KULOUT,'(1X,A,I3,A)') ' ! SU0PHY: ERROR NR ',IERR,' !!!'
    WRITE(KULOUT,'(1X,A,A,A)') ' When asking for super-parametrization ',&
   &  'make sure your code is compilled ',&
   &  'with SPCRM option for cpp pre-processing. '
  ENDIF
  IF (.NOT. LEPHYS) THEN
    IERR=IERR+1
    WRITE(KULOUT,'(1X,A,I3,A)') ' ! SU0PHY: ERROR NR ',IERR,' !!!'
    WRITE(KULOUT,'(1X,A,A)') ' The super-parametrization package ',&
   &  'is only available for ECMWF physics so far!'
  ENDIF
  WRITE(KULOUT,'(1X,A,A)') '*** SUPER-PARAMETRIZATION CRM ',&
   & 'SCHEME IS ACTIVATED. *** '
  WRITE(KULOUT,'(1X,A)')&
   & 'NOTE: All the other moist processes are turned off then.'
ENDIF


! TESTS FOR ALARO-0 (prognostic convection)
IF (LCVPRO) THEN
  LCDDPRO=.TRUE.
  IF (NCONF /= 1)THEN
    WRITE(KULOUT,'(1X, A)') 'WARNING: LCVPRO requires NCONF=1'
    LCVPRO=.FALSE.
    LCDDPRO=.FALSE.
  ENDIF
ENDIF
IF (LENTCH.AND.((.NOT.LCVPRO).OR.(.NOT.LCDDPRO))) THEN
  LENTCH=.FALSE.
  WRITE(KULOUT,'(1X, A)') 'WARNING: LENTCH requires BOTH LCVPRO AND LCDDPRO TRUE'
ENDIF
IF (L3MT.AND.LCOMOD) THEN
    WRITE(UNIT=KULOUT,FMT='(A)') 'IF L3MT REQUIRES LCOMOD=F'
    CALL ABOR1('3MT && LCOMOD settings inconsistency')
ENDIF

! TESTS FOR ALARO (TKE scheme)
IF (LCOEFKTKE.AND.(.NOT.LPTKE)) THEN
  ! * When emulated TKE is required, the (TKE) solver must be active too
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SU0PHY: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,'(1X,A)')&
   & ' SU0PHY: LCOEFKTKE=.T. has only meaning when LPTKE=.T.'
ENDIF
IF (LCOEFK_TOMS.AND.(.NOT.LCOEFKTKE)) THEN
  ! * TOM terms can be computed only with full TKE scheme
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SU0PHY: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,'(1X,A)')&
   & ' SU0PHY: TOMs can be activated only in TOUCANS (LCOEFKTKE=.T.)'
ENDIF
IF (LCOEFK_PTTE.AND.(.NOT.LCOEFKTKE)) THEN
  ! * Prognostic TTE scheme only in TOUCANS
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SU0PHY: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,'(1X,A)')&
   & ' SU0PHY: PTTE can be activated only in TOUCANS (LCOEFKTKE=.T.)'
ENDIF
IF (LCOEFK_TOMS.AND.(CGMIXLEN /= 'EL0').AND.&
   & (CGMIXLEN /= 'EL1').AND.(CGMIXLEN /= 'EL2')) THEN
  ! * TOM terms can be computed only with a TKE mixing length
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SU0PHY: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,'(1X,A)')&
   & ' SU0PHY: TOMS can be activated only with mixing lengths EL0-EL2'
ENDIF

IF (LCOEFKTKE.AND.LCOEFK_PTTE.AND.(.NOT.LCOEFK_FLX)) THEN
  ! * When prognostic TTE source terms must be computed from Fluxes
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SU0PHY: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,'(1X,A)')&
   & ' SU0PHY: LCOEFK_PTTE=.T. needs LCOEFK_FLX=.T.'
ENDIF

IF (LCOEFK_RIS.AND.LCOEFK_MSC) THEN
  ! * non precipitating convection should be computed by one method only
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SU0PHY: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,'(1X,A)')&
   & ' SU0PHY: LCOEFK_RIS=.T. needs LCOEFK_MSC=.F. or the opposite'
ENDIF

! * Use simplified physics with LMPA=T?
IF(LMPA.AND.LSIMPH) THEN
  ! * Simplified physics is not consistent with AROME physics
  !   concerning most of the physical parameterizations.
!  IERR=IERR+1
!  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SU0PHY: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,'(1X,A)') ' SU0PHY: LMPA and LSIMPH both set to T.'
ENDIF

! * Choice for shallow convection in Arome
IF(LMPA.AND.LKFBCONV.AND.LKFBS.AND.LMFSHAL) THEN
  ! * Only one shallow convection scheme should be switch on
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SU0PHY: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,'(1X,A)') ' SU0PHY: LKFBS and LMFSHAL cannot be both to T.'
ENDIF

IF (LGRADHPHY .AND. .NOT. LELAM) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SU0PHY: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,'(1X,A)') ' SU0PHY: With LGRADHPHY LELAM should be TRUE '
ENDIF

IF (IERR >= 1) THEN
  CALL FLUSH(KULOUT)
  CALL ABOR1(' SU0PHY: ABOR1 CALLED')
ENDIF

!     ------------------------------------------------------------------

!*       4.    Compute some YOMRCOEF dimensions.
!              ---------------------------------

IF (LRCOEF) THEN
  NG3SR=17
  NGMTR=1
ELSE
  NG3SR=0
  NGMTR=0
ENDIF

NLATWR=0
NLATRD=0

!     ------------------------------------------------------------------

!*       5.    Print final values.
!              -------------------

WRITE(UNIT=KULOUT,FMT='('' COMMON YOMPHY '')')
WRITE(UNIT=KULOUT,FMT='('' LMPHYS= '',L5,'' LREASUR = '',L5)')LMPHYS,LREASUR
WRITE(UNIT=KULOUT,FMT='('' LCONDWT='',L5,'' LCVPP = '',L5,&
 & '' LCVPPKF = '',L5,'' LEDKF = '',L5,'' LEDMFI = '',L5,'' LCVGQKF = '',L5,&
 & '' LNEIGE = '',L5,'' LRNUMX = '',L5,'' LRNUEXP = '',L5,'' LACPANMX = '',L5,&
 & '' LCLSATUR = '',L5,'' LVOIGT = '',L5,'' LVFULL = '',L5,&
 & '' LCVDD = '',L5,'' LCAPE= '',L5,'' LCVGQ= '',L5,&
 & '' LCVGQD= '',L5,'' LCVGQM= '',L5,'' LCVGQP= '',L5,&
 & '' LCVLIS = '',L5,'' LCVCAS= '',L5,'' LO3ABC= '',L5,'' LO3FL= '',L5,&
 & '' LECSHAL = '',L5,'' LECDEEP= '',L5,&
 & '' LAEROSEA = '',L5,'' LAEROLAN = '',L5,'' LAEROSOO = '',L5,&
 & '' LAERODES = '',L5,'' LAEROVOL = '',L5,'' LAEROSUL = '',L5,&
 & '' LRELAXT  = '',L5,'' LRELAXW  = '',L5,&
 & '' LSLC = '',L5,'' LRRGUST= '',L5,&
 & '' LNEWD = '',L5,'' LGLT= '',L5,'' LDIFCONS= '',L5, '' LDIFQL= '',L5, '' LDISTUR= '',L5,&
 & '' LECT = '',L5,'' LEFB = '',L5,'' LECTFL = '',L5,'' LECTFL0 = '',L5, '' NLEND = '',I2,&
 & '' LPBLE = '',L5,'' LCVPGY= '',L5,'' LCVTURB= '',L5,&
 & '' LPTKE= '',L5,'' L3MT= '',L5 ,'' LGPCMT= '',L5 ,'' LACDIFUS = '',L5,'' LZ0HSREL= '',L5,&
 & '' LFLUSO= '',L5, '' L2MICRO= '',L5 ,&
 & '' LECTQ1= '',L5,'' LECTREP= '',L5,&
 & '' LPROCLDTL= '',L5, '' LGLACIERS= '',L5,&
 & '' LCOEFKTKE= '',L5,'' LAFGD_A= '',L5,&
 & '' LCOEFK_TOMS= '',L5,'' LCOEFK_THS1= '',L5, '' LCOEFKSURF= '',L5,&
 & '' LCOEFK_PL= '',L5,'' LCOEFK_PTTE= '',L5,'' LCOEFK_MSC= '',L5,&
 & '' LCOEFK_RIS= '',L5,'' LCOEFK_F1= '',L5,&
 & '' LCOEFK_FLX= '',L5,'' LCOEFK_SCQ= '',L5,'' LCOEFK_ML= '',L5)')&
 & LCONDWT,LCVPP,LCVPPKF,LEDKF,LEDMFI,LCVGQKF,LNEIGE,&
 & LRNUMX,LRNUEXP,LACPANMX,LCLSATUR,LVOIGT,LVFULL,LCVDD,&
 & LCAPE,LCVGQ,LCVGQD,LCVGQM,LCVGQP,LCVLIS,LCVCAS,LO3ABC,LO3FL,&
 & LECSHAL,LECDEEP,LAEROSEA,LAEROLAN,LAEROSOO,&
 & LAERODES,LAEROVOL,LAEROSUL,LRELAXT,LRELAXW,LSLC,LRRGUST,LNEWD,LGLT,&
 & LDIFCONS,LDIFQL,LDISTUR,LECT,LEFB,LECTFL,LECTFL0,NLEND,&
 & LPBLE,LCVPGY,LCVTURB,LPTKE,L3MT,LGPCMT,&
 & LACDIFUS,LZ0HSREL,LFLUSO, L2MICRO,&
 & LECTQ1,LECTREP,LPROCLDTL,LGLACIERS,LCOEFKTKE,LAFGD_A,&
 & LCOEFK_TOMS,LCOEFK_THS1,LCOEFKSURF,LCOEFK_PL,&
 & LCOEFK_PTTE,LCOEFK_MSC,LCOEFK_RIS,LCOEFK_F1,LCOEFK_FLX,&
 & LCOEFK_SCQ,LCOEFK_ML
WRITE(UNIT=KULOUT,FMT='('' LCVRA = '',L5 ,'' LCVTDK = '',L5 ,'' LFPCOR = '',L5&
 & ,'' LNOIAS = '',L5&
 & ,'' LGWD = '',L5,'' LHMTO = '',L5,'' LRAY = '',L5&
 & ,'' LSFHYD = '',L5,'' LSTRA = '',L5,'' LTHERMO = '',L5,/&
 & ,'' LVDIF = '',L5,'' LNEBCO = '',L5,'' LNEBECT = '',L5,'' LNEB_FP = '',L5,/&
 & ,'' LRRMES = '',L5,'' LOZONE = '',L5,'' LNEBR = '',L5,'' LPTOPC = '',L5,/&
 & ,'' LSNV = '',L5,'' LSOLV = '',L5,'' LFGEL = '',L5,/&
 & ,'' LVGSN ='',L5,/&
 & ,'' LNEBN = '',L5,'' LNEBNXR = '',L5,'' LQXRTGH = '',L5,'' LSTRAS = '',L5,/&
 & ,'' LHUCN = '',L5,'' LGWDC = '',L5,'' LNORGWD = '',L5,'' LRAYFM = '',L5,'' LRAYFM15 = '',L5,/&
 & ,'' LRMU0M = '',L5,'' LRAYLU = '',L5,'' LRPROX = '',L5 /&
 & ,'' LRSTAER = '',L5,'' LRTPP = '',L5,'' LRAYPL = '',L5&
 & )')&
 & LCVRA,LCVTDK,LFPCOR,LNOIAS,LGWD,LHMTO,LRAY,LSFHYD,LSTRA,LTHERMO,LVDIF,LNEBCO,&
 & LNEBECT,LNEB_FP,LRRMES,LOZONE,LNEBR,LPTOPC,LSNV,LSOLV,LFGEL,LVGSN,&
 & LNEBN,LNEBNXR,LQXRTGH,LSTRAS,LHUCN,LGWDC,LNORGWD,&
 & LRAYFM,LRAYFM15,LRMU0M,LRAYLU,LRPROX,LRSTAER,LRTPP,LRAYPL
IF ( NRAY == 1 ) THEN
  WRITE(UNIT=KULOUT,FMT='('' LREWS  = '',L5,'' LRSTAB = '',L5)') LREWS,LRSTAB
  WRITE(UNIT=KULOUT,FMT='('' LRMIX  = '',L5,'' LRTDL  = '',L5)') LRMIX,LRTDL
ELSE
  WRITE(UNIT=KULOUT,FMT='('' LRTRUEBBC = '',L5,'' LRTRUEDIR = '',L5)') LRTRUEBBC,LRTRUEDIR
  IF ( NSORAYFR < 0 ) THEN
    WRITE(KULOUT,'('' NSORAYFR (to be modified in SUDYN) = '',I5)')&
     & NSORAYFR   
  ELSE 
    WRITE(KULOUT,'('' NSORAYFR = '',I5)') NSORAYFR
  ENDIF
  IF ( NTHRAYFR < 0 ) THEN
    WRITE(KULOUT,'('' NTHRAYFR (to be modified in SUDYN) = '',I5)')&
     & NTHRAYFR
  ELSE
    WRITE(KULOUT,'('' NTHRAYFR = '',I5)') NTHRAYFR
  ENDIF
ENDIF
WRITE(UNIT=KULOUT,FMT='('' NBITER = '',I2,'' NDPSFI = '',I2,'' NPHYREP = '',I2)')&
 & NBITER,NDPSFI,NPHYREP
WRITE(UNIT=KULOUT,FMT='('' NOIR = '',I2,'' NRAY = '',I1)') NOIR,NRAY
WRITE(UNIT=KULOUT,FMT='('' NRAUTOEV= '',I2)') NRAUTOEV
WRITE(UNIT=KULOUT,FMT='('' NITERFL = '',I2)') NITERFL
WRITE(UNIT=KULOUT,FMT='('' NCALLRAD= '',I2)') NCALLRAD
WRITE(UNIT=KULOUT,FMT=*) 'LDAYD=',LDAYD

WRITE(UNIT=KULOUT,FMT='('' - - - - - - - - - -'')')
WRITE(UNIT=KULOUT,FMT='('' COMMON YOMPHY'')')
WRITE(UNIT=KULOUT,FMT='('' - - - - - - - - - -'')')
WRITE(UNIT=KULOUT,FMT='(&
 & '' LAJUCV  = '',L5,'' LCVRAV3 = '',L5,&
 & '' LNEBGR  = '',L5,'' LNEBGY  = '',L5&
 & )') LAJUCV,LCVRAV3, LNEBGR, LNEBGY
WRITE(UNIT=KULOUT,FMT='(&
 & '' LMLH    = '',L5,'' LNODIFQC= '',L5,'' LDIFCEXP= '',L5,&
 & '' LSQRML  = '',L5,'' LNCVPGY = '',L5&
 & )') LMLH, LNODIFQC, LDIFCEXP, LSQRML, LNCVPGY

WRITE(UNIT=KULOUT,FMT='('' - - - - - - - - -'')')
WRITE(UNIT=KULOUT,FMT='('' MICROPHYSICS KEY '')')
WRITE(UNIT=KULOUT,FMT='('' - - - - - - - - -'')')
WRITE(UNIT=KULOUT,FMT='(  '' LPROCLD = '',L5&
 &,'' LEVAPP  = '',L5,'' LCOLLEC = '',L5,'' LSMITH_CDEV = '',L5&
 &,'' LNEBRIC  = '',L5 &
 &,'' LADJCLD  = '',L5,'' LSSD = '',L5,'' LSMOOTHMELT='',L5)')&
 &LPROCLD,LEVAPP,LCOLLEC,LSMITH_CDEV,LNEBRIC,LADJCLD,LSSD,LSMOOTHMELT

WRITE(UNIT=KULOUT,FMT='(  '' LSEDSTA = '',L5&
 &,'' LSEDLAG  = '',L5,'' LSEDCL = '',L5,'' LFSVAR = '',L5&
 &,'' LFSFIX  = '',L5,'' LA0MPS = '',L5,'' LARPMPS ='',L5)')&
 &LSEDSTA,LSEDLAG,LSEDCL,LFSVAR,LFSFIX,LA0MPS,LARPMPS

WRITE(UNIT=KULOUT,FMT='('' ALARO-0 cloud '')')
WRITE(UNIT=KULOUT,FMT='('' LSTRAPRO = '',L5&
  &,'' LNEWSTAT = '',L5,'' LPHSPSH = '',L5&
  &,'' LCAMOD = '',L5,'' LCOMOD = '',L5&
  &,'' LSMTPS = '',L5 ,'' LSMNIMBT = '',L5&
  &,'' LSMGCDEV = '',L5 ,'' LXRCDEV = '',L5,'' LRKCDEV = '',L5&
  &,'' LNEBCV = '',L5 ,'' LNEBINS = '',L5&
  &,'' NSMTBOT = '',I2,'' NSMDNEB = '',I2,'' NDIFFNEB = '',I2&
  &,'' NPRAC = '',I2,'' NPRRI = '',I2&
  &) ')LSTRAPRO,LNEWSTAT,LPHSPSH,LCAMOD,LCOMOD,LSMTPS, LSMNIMBT,&
  &LSMGCDEV,LXRCDEV,&
  &    LRKCDEV,LNEBCV,LNEBINS,NSMTBOT,NSMDNEB,NDIFFNEB,NPRAC,NPRRI

WRITE(UNIT=KULOUT,FMT='('' ALARO-0 prognostic convection  '')')
WRITE(UNIT=KULOUT,&
  &FMT='('' LCVPRO ='',L1,'' LCDDPRO ='',L1,'' LSCMF ='',L1,&
  &'' LCDDEVPRO ='',L1,'' LENTCH ='',L1,&
  &'' LRCVOTT ='',L1,'' NIMELIT ='',I2)')&
  &    LCVPRO,LCDDPRO,LSCMF,LCDDEVPRO,LENTCH,LRCVOTT,NIMELIT

WRITE(UNIT=KULOUT,FMT='('' ALARO-1 prognostic convection  '')')
WRITE(UNIT=KULOUT,&
  &FMT='('' LCVCSD ='',L1,'' LNSDO ='',L1,'' LCDDCSD ='',L1,&
  &'' LCVSHCU, ='',L1,'' LUDEVOL ='',L1,'' LPEC ='',L1,&
  &'' NCLOMIX, ='',I2,'' NFSIG ='',I2)')&
  & LCVCSD,LNSDO,LCDDCSD,LCVSHCU,LUDEVOL,LPEC,NCLOMIX,NFSIG
WRITE(KULOUT,'('' LUSL='',L1,'' CGTRG='',A8)')&
   & LUSL,  TRIM(CGTRG)

WRITE(UNIT=KULOUT,FMT='('' ALARO prognostic graupel  '')')
WRITE(UNIT=KULOUT,FMT='('' LGRAPRO ='',L1)') LGRAPRO

WRITE(UNIT=KULOUT,FMT='('' COMMON YOMSIMPHL '')')
WRITE(UNIT=KULOUT,FMT='('' LSIMPH= '',L5,'' LTRAJPS = '',L5&
 & ,'' LTRAJPST = '',L5&
 & ,'' LSMOOTHD = '',L5,'' LSMOOTHA = '',L5,'' LSMOOTHB = '',L5&
 & ,'' LCLOUDS = '',L5 )')&
 & LSIMPH,LTRAJPS,LTRAJPST,LSMOOTHD,LSMOOTHA,&
 & LSMOOTHB,LCLOUDS
WRITE(UNIT=KULOUT,FMT='('' LCVRASP = '',L5,'' LGWDSP = '',L5&
 & ,'' LRAYSP = '',L5,'' LSTRASP = '',L5,'' LVDIFSP = '',L5&
 & ,'' LVDIFSPNL = '',L5,'' LRRMESSP = '',L5,'' LSTRASPN = '',L5&
 & ,'' LPROCLDTL = '',L5,'' LMICROTL = '',L5,'' LCOLLECTL = '',L5&
 & ,'' LEVAPTL   = '',L5,'' LMELTNL  = '',L5,'' LMELTTL   = '',L5&
 & ,'' LSMOOTHEVP= '',L5,'' LTRAJRAIN= '',L5,'' LTRAJCOND = '',L5&
 & ,'' LNEBCVPPKF= '',L5)')&
 & LCVRASP,LGWDSP,LRAYSP,LSTRASP,LVDIFSP,LVDIFSPNL,LRRMESSP,&
 & LSTRASPN, LPROCLDTL,LMICROTL,LCOLLECTL,LEVAPTL,LMELTNL,&
 & LMELTTL,LSMOOTHEVP,LTRAJRAIN,LTRAJCOND,LNEBCVPPKF
WRITE(UNIT=KULOUT,FMT='('' COMMON YOMRCOEF '')')
WRITE(UNIT=KULOUT,FMT='('' LRCOEF= '',L5&
 & ,'' LTLADDIA = '',L5,'' LGLOBRAD = '',L5)')&
 & LRCOEF,LTLADDIA,LGLOBRAD
WRITE(UNIT=KULOUT,FMT=*) 'LGCHECKMV=',LGCHECKMV

! TEST OF CONSISTENCY FOR RADIATION SCHEMES

IF (LMPHYS) THEN
  IF((LRAY.AND.LRAYFM).OR.(LRAY.AND.LRAYFM15).OR.(LRAYFM15.AND.LRAYFM)) THEN
    WRITE(NULOUT,'('' WARNING - 2 RADIATION SCHEMES... '')')
    CALL ABOR1('SU0PHY: ABOR1 CALLED')
  ENDIF
  IF ( LRAY ) THEN
    IF ( NRAY < 1.OR.NRAY > 2 ) THEN
      WRITE(NULOUT,'(A)') 'NRAY must be 1 or 2!'
      CALL ABOR1(' SU0PHY: ABOR1 CALLED')
    ENDIF
    IF ( NRAY == 1.AND.LMPA ) THEN
      WRITE(NULOUT,'(A)') 'Old ACRANEB radiation not available in AROME!'
      WRITE(NULOUT,'(A)') 'Set NRAY=2 to use ACRANEB2 instead.'
      CALL ABOR1('SU0PHY: ABOR1 CALLED')
    ENDIF
    IF ( NRAY == 2.AND.LMPA.AND.(.NOT.LMSE) ) THEN
      WRITE(NULOUT,'(A)')&
       & 'ACRANEB2 radiation in AROME cannot run without LMSE!'
      CALL ABOR1('SU0PHY: ABOR1 CALLED')
    ENDIF
    IF ( NRAY > 1.AND.NSORAYFR == 0 ) THEN
      WRITE(NULOUT,'(A)') 'NSORAYFR must not be 0!'
      CALL ABOR1('SU0PHY: ABOR1 CALLED')
    ENDIF
    IF ( NRAY > 1.AND.LRAYLU.AND.NSORAYFR /= 1 ) THEN
      WRITE(NULOUT,'(A)') 'Solar intermittency not implemented for LRAYLU!'
      CALL ABOR1('SU0PHY: ABOR1 CALLED') 
    ENDIF
    IF ( NRAY > 1.AND.NTHRAYFR == 0 ) THEN
      WRITE(NULOUT,'(A)') 'NTHRAYFR must not be 0!'
      CALL ABOR1('SU0PHY: ABOR1 CALLED')
    ENDIF 
    IF ( NRAUTOEV < 0 ) THEN
      WRITE(NULOUT,'(A)') 'NRAUTOEV must not be negative!'
      CALL ABOR1('SU0PHY: ABOR1 CALLED')
    ELSEIF ( NRAY == 1.AND.NRAUTOEV > 1 ) THEN
      WRITE(NULOUT,'(A)') 'For NRAY=1, NRAUTOEV must be 0 or 1!'
      CALL ABOR1('SU0PHY: ABOR1 CALLED')
    ENDIF
    IF ( NRAY > 1.AND.NRAUTOEV == 0.AND.(.NOT.LRPROX) ) THEN
      WRITE(NULOUT,'(A)') 'ACRANEB2 statistical model (NRAY>1, NRAUTOEV=0)'
      WRITE(NULOUT,'(A)') 'must be used with LRPROX=.T.!'
      CALL ABOR1('SU0PHY: ABOR1 CALLED')
    ENDIF
  ENDIF
ENDIF

!     TESTS OF CONSISTENCY INSIDE YOMPHY

IF(LSTRAS.AND.LRNUMX)THEN
  WRITE(NULOUT,FMT='('' ACPLUIS AND LRNUMX ARE NOT COMPATIBLE''&
   & ,''      FOR THE MOMENT'')')
  CALL ABOR1('SU0PHY: ABOR1 CALLED')
ENDIF

IF((LSMGCDEV.AND.LXRCDEV).OR.(LSMGCDEV.AND.LRKCDEV).OR.&
 &(LXRCDEV.AND.LRKCDEV))THEN
  WRITE(NULOUT,FMT='('' WARNING - 2 CONDENSATION SCHEMES ...''&
   & ,'' Choose Smith-Gerard OR Xu-Randall-type OR Rasch-Kristjansson! '')')
  CALL ABOR1('SU0PHY: ABOR1 CALLED')
ENDIF

IF(LACPANMX.AND.(.NOT.LRNUMX))THEN
  WRITE(NULOUT,FMT='('' LACPANMX MUST BE USED WITH LRNUMX!'')')
  CALL ABOR1('SU0PHY: ABOR1 CALLED')
ENDIF

IF(LRNUEXP.AND.(.NOT.LRNUMX))THEN
  WRITE(NULOUT,FMT='('' LRNUEXP MUST BE USED WITH LRNUMX!'')')
  CALL ABOR1('SU0PHY: ABOR1 CALLED')
ENDIF

IF(LACPANMX.AND.LRNUEXP)THEN
  WRITE(NULOUT,FMT='('' LACPANMX AND LRNUEXP ARE MUTUALLY EXCLUSIVE!'')')
  CALL ABOR1('SU0PHY: ABOR1 CALLED')
ENDIF

!     RESULTING CLOUD OVERLAP MODE
IF (LMPHYS) THEN
  IF (LACPANMX) THEN
    WRITE(NULOUT,'(A)') 'CLOUD OVERLAP IN ACNPART : NEARLY MAXIMUM-RANDOM'
  ELSEIF (LRNUEXP) THEN
    WRITE(NULOUT,'(A)') 'CLOUD OVERLAP IN ACNPART : EXPONENTIAL-RANDOM'
  ELSEIF (LRNUMX) THEN
    WRITE(NULOUT,'(A)') 'CLOUD OVERLAP IN ACNPART : MAXIMUM-RANDOM'
  ELSE
    WRITE(NULOUT,'(A)') 'CLOUD OVERLAP IN ACNPART : RANDOM'
  ENDIF
  IF (LRAY.AND.NRAY==1) THEN
    IF (LRNUMX) THEN
      WRITE(NULOUT,'(A)') 'CLOUD OVERLAP IN ACRANEB : MAXIMUM-RANDOM'
    ELSE
      WRITE(NULOUT,'(A)') 'CLOUD OVERLAP IN ACRANEB : RANDOM'
    ENDIF
  ELSEIF (LRAY.AND.NRAY==2) THEN
    IF (LRNUEXP) THEN
      WRITE(NULOUT,'(A)') 'CLOUD OVERLAP IN ACRANEB2: EXPONENTIAL-RANDOM'
    ELSEIF (LRNUMX) THEN
      WRITE(NULOUT,'(A)') 'CLOUD OVERLAP IN ACRANEB2: MAXIMUM-RANDOM'
    ELSE
      WRITE(NULOUT,'(A)') 'CLOUD OVERLAP IN ACRANEB2: RANDOM'
    ENDIF
  ENDIF
ENDIF

WRITE(UNIT=KULOUT,FMT='('' COMMON YOMARPHY '')')
WRITE(UNIT=KULOUT,FMT='('' LMPA = '',L5,&
 & '' LMICRO = '',L5,'' LTURB = '',L5,&
 & '' LMSE = '',L5,'' NSURFEXCTL = '',I5,'' NSURFEX_ITER = '',I5,'' LKFBCONV = '',L5,&
 & '' LKFBD = '',L5,'' LKFBS = '',L5,&
 & '' LMFSHAL = '',L5,&
 & '' LUSECHEM = '',L5,'' LGRADHPHY = '', L5,'' LORILAM = '',L5,'' LRDUST = '',L5,&
 & '' LINITCHEM = '',L5,'' LINITORILAM = '',L5,'' LINITDUST = '',L5,&
 & '' LRDEPOS = '',L5,'' LRCO2 = '',L5,'' LMDUST = '',L5)')&
 & LMPA,LMICRO,LTURB,LMSE,NSURFEXCTL,NSURFEX_ITER,LKFBCONV,LKFBD,LKFBS,LMFSHAL,LUSECHEM,&
 & LGRADHPHY,&
 & LORILAM,LRDUST,LINITCHEM,LINITORILAM,LINITDUST,LRDEPOS,LRCO2,LMDUST


WRITE(UNIT=KULOUT,FMT='('' COMMON YOEPHY '')')
WRITE(UNIT=KULOUT,FMT='('' LEPHYS = '',L5,'' LSLPHY = '',L5,&
 & '' LECOND = '',L5,'' LECUMF = '',L5&
 & )')&
 & LEPHYS,LSLPHY,LECOND,LECUMF
WRITE(UNIT=KULOUT,FMT='('' LECLIPQT0 = '',L5,'' LECLIPCLDT0 = '',L5)')&
 & LECLIPQT0, LECLIPCLDT0
WRITE(NULOUT,'("RCLDTOPP=",F10.2)') RCLDTOPP
WRITE(UNIT=KULOUT,FMT='('' LEDCLD = '',L5,'' LEGWDG = '',L5&
 & ,'' LEGWWMS = '',L5,'' LEOZOC = '',L5,'' LEQNGT = '',L5&
 & ,'' LBUDCYCLE = '',L5,'' LMFSCAV = '',L5,'' LNEEONLINE = '',L5&
 & ,'' LBFASCO2 = '',L5&
 & ,'' LEO3CH = '',L5,'' LO3CH_SAFE = '',L5,'' LO3CH_OLDVER = '',L5&
 & ,'' LO3CH_HLO = '',L5,'' CO3CHEM = '',A4,'' LECO2DIU = '',L5,'' LDIAGTURB_EC = '',L5)')&
 & LEDCLD,LEGWDG,LEGWWMS,LEOZOC,LEQNGT,LBUDCYCLE,LMFSCAV,LNEEONLINE,&
 & LBFASCO2,LEO3CH,LO3CH_SAFE,LO3CH_OLDVER,LO3CH_HLO,CO3CHEM,LECO2DIU,LDIAGTURB_EC
WRITE(UNIT=KULOUT,FMT='('' LERADI = '',L5&
 & ,'' LESURF = '',L5,'' LEVDIF = '',L5&
 & ,'' LEOCWA = '',L5,'' LEOCCO = '',L5,'' LEOCSA = '',L5&
 & ,'' LEOCLA = '',L5,'' LECURR = '',L5,'' LESURFTRAJ = '',L5,'' RTHRFRTI = '',F7.2&
 & ,'' RCIMIN = '',F7.2, '' LESICE = '',L5&
 & )')&
 & LERADI,LESURF,LEVDIF,LEOCWA,LEOCCO,LEOCSA,LEOCLA,LECURR,LESURFTRAJ,RTHRFRTI,RCIMIN,&
 & LESICE
WRITE(UNIT=KULOUT,FMT='('' LEPCLD = '',L5,'' LEMETHOX= '',L5&
 & ,'' LEVGEN = '',L5,'' LESSRO = '',L5&
 & ,'' LELAIV = '',L5,'' LECTESSEL = '',L5&
 & ,'' LEFLAKE = '',L5,'' LEOCML = '',L5,'' LEOBC = '',L5&
 & ,'' LEOBCICE = '',L5,'' LOCMLTKE = '',L5&
 & ,'' LSPCRM = '',L5&
 & ,'' LESN09 = '',L5,'' LESNML = '',L5,'' LDUCTDIA = '',L5,'' RLAIINT = '',F7.2&
 & ,'' LEOCLAKE = '',L5,'' LEOLAKESST= '',L5,'' LELIGHT= '',L5,'' NLIMODE = '',I3&
 & ,'' NSNMLWS = '',I3&
 & )')&
 & LEPCLD,LEMETHOX,LEVGEN,LESSRO,LELAIV,LECTESSEL,&
 & LEFLAKE,LEOCML,LEOBC,LEOBCICE,LOCMLTKE,LSPCRM,&
 & LESN09,LESNML,LDUCTDIA,RLAIINT,LEOCLAKE,LEOLAKESST,LELIGHT,NLIMODE,NSNMLWS
WRITE(UNIT=KULOUT,FMT='('' LEOBCMAX = '',L5,'' REOBCMAX = '',F7.2)') LEOBCMAX,REOBCMAX

IF (LECMWF .AND. .NOT.LEFLAKE .AND. .NOT.LARPEGEF) THEN
  ! LECMWF+LARPEGEF means fullpos conversion from IFS GRIB to ARPEGE.
  ! More robust than using nconf in this OOPS world. REK
  WRITE(NULOUT,'("SU0PHY: AT ECMWF LEFLAKE is a MUST")')
  CALL ABOR1('SU0PHY: LEFLAKE MUST BE TRUE')
ENDIF

WRITE(UNIT=KULOUT,FMT='('' LERAIN = '',L5,'' LEMWAVE = '',L5)')&
  & LERAIN,LEMWAVE
WRITE(UNIT=KULOUT,FMT='('' LEGBRAD = '',L5,'' NPRACCL = '',I5,''s'')') LEGBRAD,NPRACCL
WRITE(UNIT=KULOUT,FMT='('' LERAINGG = '',L5)') LERAINGG 

! Do not allow storage of trajectory in TL physics if tracers
! are to be included in linearized physics (temporary)
IF (LETRAJP .AND. LETRAJPT .AND. LTRACLNPH) THEN
  WRITE(UNIT=KULOUT,FMT='('' CAUTION : STORAGE OF TRAJECTORY IN LINEAR. PHYSICS NOT YET '')')
  WRITE(UNIT=KULOUT,FMT='('' IMPLEMENTED FOR TRACERS: LETRAJPT WILL BE RESET TO .FALSE. '')')
ENDIF

WRITE(UNIT=KULOUT,FMT='('' NALBEDOSCHEME = '',I4,'' NEMISSSCHEME = '',I4,'' RALFMINPSN = '',F8.3)') &
     &  NALBEDOSCHEME, NEMISSSCHEME, RALFMINPSN


IF (LETRAJP) THEN
  WRITE(UNIT=KULOUT,FMT='('' ======================== '')')
  WRITE(UNIT=KULOUT,FMT='('' LINEAR PHYSICS ACTIVATED '')')
  WRITE(UNIT=KULOUT,FMT='('' ======================== '')')
  WRITE(UNIT=KULOUT,FMT='('' LERADI2 = '',L4&
   & ,'' LERADS2 = '',L4&
   & )')&
   & LERADI2,LERADS2
  WRITE(UNIT=KULOUT,FMT='('' LERADSW2='',L4&
   & ,'' LERADLW2= '',L4&
   & ,'' LERADN2 = '',L4&
   & ,'' LERADFL2= '',L4&
   & )')&
   & LERADSW2,LERADLW2,LERADN2,LERADFL2
  WRITE(UNIT=KULOUT,FMT='('' NLWFR   = '',I4&
   & ,'' NLOOPLW = '',I4&
   & ,'' LOPTLWPR= '',L4&
   & ,'' LWLCLHR = '',L4&
   & )')&
   & NLWFR,NLOOPLW,LOPTLWPR,LWLCLHR
  WRITE(UNIT=KULOUT,FMT='('' LEDCLD2 = '',L4&
   & ,'' LENCLD2 = '',L4&
   & ,'' LEVAPLS2= '',L4&
   & ,'' LREGCL  = '',L4&
   & ,'' LNCLIN  = '',L4&
   & )')&
   & LEDCLD2,LENCLD2,LEVAPLS2,LREGCL,LNCLIN
  WRITE(UNIT=KULOUT,FMT='('' LECUMF2 = '',L4&
   & ,'' LECOND2 = '',L4&
   & )')&
   & LECUMF2,LECOND2
  WRITE(UNIT=KULOUT,FMT='('' LEVDIF2 = '',L4&
   & ,'' LEGWDG2 = '',L4&
   & ,'' LEGWWMS2= '',L4&
   & ,'' LREGWWMS= '',L4&
   & ,'' LEQNGT2 = '',L4&
   & )')&
   & LEVDIF2,LEGWDG2,LEGWWMS2,LREGWWMS,LEQNGT2
  WRITE(UNIT=KULOUT,FMT='('' LESURF2 = '',L4&
   & ,'' LREGSF  = '',L4&
   & ,'' LEKPERT = '',L4&
   & ,'' LEKPERTS = '',L4&
   & ,'' LENOPERT = '',L4&
   & )')&
   & LESURF2,LREGSF,LEKPERT,LEKPERTS,LENOPERT
  WRITE(UNIT=KULOUT,FMT='('' ======================== '')')
  WRITE(UNIT=KULOUT,FMT='('' LETRAJPT = '',L4)')LETRAJPT
  WRITE(UNIT=KULOUT,FMT='('' ======================== '')')
  WRITE(UNIT=KULOUT,FMT='('' LTRACLNPH = '',L4)')LTRACLNPH
  WRITE(UNIT=KULOUT,FMT='('' ======================== '')')
ELSE
  WRITE(UNIT=KULOUT,FMT='('' ============================ '')')
  WRITE(UNIT=KULOUT,FMT='('' LINEAR PHYSICS NOT ACTIVATED '')')
  WRITE(UNIT=KULOUT,FMT='('' ============================ '')')
  WRITE(UNIT=KULOUT,FMT='('' LENCLD2 = '',L4)')LENCLD2
  WRITE(UNIT=KULOUT,FMT='('' LEVAPLS2= '',L4)')LEVAPLS2
ENDIF

WRITE(UNIT=KULOUT,FMT='('' LSPHLC = '',L5,'' LVDFLC = '',L5&
 & ,'' LVDFDS = '',L5,'' LSDRLC = '',L5,'' LSDRDS = '',L5)')&
 & LSPHLC,LVDFLC,LVDFDS,LSDRLC,LSDRDS
WRITE(UNIT=KULOUT,FMT='('' LZMCON = '',L5,'' LKEXP  = '',L5)')&
 & LZMCON,LKEXP
WRITE(UNIT=KULOUT,FMT='('' ALPHA  = '',E16.6)') ALPHA
WRITE(UNIT=KULOUT,FMT='('' AH0    = '',E16.6,''m'')') AH0
WRITE(UNIT=KULOUT,FMT='('' USTARL = '',E16.6,''m s-1'')') USTARL
WRITE(UNIT=KULOUT,FMT='('' USTARS = '',E16.6,''m s-1'')') USTARS
WRITE(UNIT=KULOUT,FMT='('' ALANDZ0= '',E16.6,''m'')') ALANDZ0
WRITE(UNIT=KULOUT,FMT='('' ASEAZ0 = '',E16.6,''m'')') ASEAZ0

IF (LAGPHY) THEN
  WRITE(UNIT=KULOUT,FMT='('' LAGPHY = '',L5,'' THE PHYSICS PAC&
   & KAGE IS CALLED AFTER THE DYNAMICS IN LAGGED MODE'')')LAGPHY
ELSE
  WRITE(UNIT=KULOUT,FMT='('' LAGPHY = '',L5,'' THE PHYSICS PAC&
   & KAGE IS CALLED BEFORE THE DYNAMICS '')')LAGPHY
ENDIF
WRITE(UNIT=KULOUT,FMT=*) 'CGMIXLEN=',TRIM(CGMIXLEN)
WRITE(UNIT=KULOUT,FMT=*) 'CGTURS=',TRIM(CGTURS)
WRITE(UNIT=KULOUT,FMT='('' LPRGML = '',L4)') LPRGML

IF (LGPCMT .AND. .NOT.LNCVPGY) THEN
  WRITE(NULOUT,'("SU0PHY: IF LGPCMT=T, LNCVPGY MUST BE T")')
  CALL ABOR1('SU0PHY: IF LGPCMT=T, LNCVPGY MUST BE T')
ENDIF

WRITE(KULOUT,'('' YOMRCOEF DIMENSIONS '')')
WRITE(UNIT=KULOUT,FMT='('' NG3SR = '',I6,'' NGMTR = '',I6)') NG3SR,NGMTR

WRITE(UNIT=KULOUT,FMT='('' LEDR = '',L2)') LEDR
WRITE(UNIT=KULOUT,FMT='('' LDPRECIPS = '',L2, '' NDPRECPERIOD ='',I8)') LDPRECIPS, NDPRECPERIOD
WRITE(UNIT=KULOUT,FMT='('' LDPRECIPS2= '',L2, '' NDPRECPERIOD2='',I8)') LDPRECIPS2, NDPRECPERIOD2

!     ------------------------------------------------------------------

END ASSOCIATE
END ASSOCIATE
IF (LHOOK) CALL DR_HOOK('SU0PHY',1,ZHOOK_HANDLE)
END SUBROUTINE SU0PHY
