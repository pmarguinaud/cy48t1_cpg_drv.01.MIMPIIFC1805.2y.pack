SUBROUTINE SUAPL_ARPEGE (YDMODEL, YDXFU, KULOUT)

!**** *SUAPL_ARPEGE*   - Check consistency of namelist settings

!     Author.
!     -------
!      P. Marguinaud 08/02/2022

!-------------------------------------------------------------------------------

USE TYPE_MODEL , ONLY : MODEL
USE PARKIND1   , ONLY : JPIM     ,JPRB
USE YOMHOOK    , ONLY : LHOOK    ,DR_HOOK
USE YOMDYNA    , ONLY : L3DTURB
USE YOMSCM     , ONLY : LGSCM
USE INTFLEX_MOD, ONLY : LINTFLEX
USE YOMLSFORC  , ONLY : LMUSCLFA
USE YOMCT0     , ONLY : LSFORCS
USE YOMXFU     , ONLY : TXFU


!     ------------------------------------------------------------------

IMPLICIT NONE

TYPE(MODEL),         INTENT(IN) :: YDMODEL
INTEGER(KIND=JPIM),  INTENT(IN) :: KULOUT
TYPE(TXFU),          INTENT(IN) :: YDXFU

REAL(KIND=JPRB) :: ZHOOK_HANDLE

!     ------------------------------------------------------------------

#include "abor1.intfb.h"

!     ------------------------------------------------------------------

IF (LHOOK) CALL DR_HOOK('SUAPL_ARPEGE',0,ZHOOK_HANDLE)

IF (YDMODEL%YRML_CHEM%YRCHEM%LCHEM_ARPCLIM   .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LCHEM_ARPCLIM MISMATCH')
IF (YDMODEL%YRML_GCONF%YGFL%NGFL_EXT         /=       0                   ) CALL ABOR1('SUAPL_ARPEGE: NGFL_EXT MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRARPHY%LMDUST       .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LMDUST MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPARAR%NSWB_MNH     /=       6                   ) CALL ABOR1('SUAPL_ARPEGE: NSWB_MNH MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%CGMIXLEN       /=       'AY'                ) CALL ABOR1('SUAPL_ARPEGE: CGMIXLEN MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%L3MT           .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: L3MT MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LACDIFUS       .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LACDIFUS MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LADJCLD        .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LADJCLD MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROSUL       .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LAEROSUL MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROVOL       .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LAEROVOL MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LAJUCV         .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LAJUCV MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCAMOD         .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LCAMOD MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCAPE          .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LCAPE MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCDDPRO        .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LCDDPRO MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCOEFKSURF     .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LCOEFKSURF MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCOEFKTKE      .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LCOEFKTKE MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCOEFK_PTTE    .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LCOEFK_PTTE MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCOEFK_TOMS    .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LCOEFK_TOMS MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCOMOD         .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LCOMOD MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCONDWT        .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LCONDWT MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVCSD         .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LCVCSD MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVGQD         .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LCVGQD MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVPGY         .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LCVPGY MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVPPKF        .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LCVPPKF MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVPRO         .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LCVPRO MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVRA          .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LCVRA MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVRAV3        .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LCVRAV3 MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVTDK         .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LCVTDK MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LDIFCONS       .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LDIFCONS MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LDPRECIPS      .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LDPRECIPS MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LDPRECIPS2     .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LDPRECIPS2 MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LECDEEP        .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LECDEEP MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LECSHAL        .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LECSHAL MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LECT           .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LECT MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LEDKF          .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LEDKF MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LEDMFI         .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LEDMFI MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LFLUSO         .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LFLUSO MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LFPCOR         .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LFPCOR MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LGPCMT         .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LGPCMT MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LGRAPRO        .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LGRAPRO MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LGWD           .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LGWD MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LGWDC          .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LGWDC MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LHMTO          .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LHMTO MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LMPHYS         .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LMPHYS MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LNCVPGY        .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LNCVPGY MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LNEBCO         .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LNEBCO MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LNEBECT        .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LNEBECT MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LNEBR          .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LNEBR MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LNEWSTAT       .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LNEWSTAT MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LNORGWD        .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LNORGWD MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LNSDO          .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LNSDO MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LO3FL          .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LO3FL MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LOZONE         .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LOZONE MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LPHSPSH        .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LPHSPSH MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LPROCLD        .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LPROCLD MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LPTKE          .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LPTKE MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LRAY           .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LRAY MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LRAYFM         .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LRAYFM MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LRAYFM15       .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LRAYFM15 MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LRAYLU         .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LRAYLU MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LRCVOTT        .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LRCVOTT MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LRPROX         .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LRPROX MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LRRMES         .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LRRMES MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LRSTAER        .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LRSTAER MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LSFHYD         .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LSFHYD MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LSNV           .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LSNV MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LSTRA          .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LSTRA MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LSTRAPRO       .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LSTRAPRO MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LTHERMO        .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LTHERMO MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LVDIF          .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LVDIF MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LVGSN          .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LVGSN MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LZ0HSREL       .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LZ0HSREL MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%NCALLRAD       /=       2                   ) CALL ABOR1('SUAPL_ARPEGE: NCALLRAD MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%NRAY           /=       1                   ) CALL ABOR1('SUAPL_ARPEGE: NRAY MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD        /=       20000._JPRB         ) CALL ABOR1('SUAPL_ARPEGE: RDECRD MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY1%LALBMERCLIM   .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LALBMERCLIM MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY2%LRAFTUR       .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LRAFTUR MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRSIMPHL%LRAYSP      .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LRAYSP MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRSIMPHL%LTRAJPS     .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LTRAJPS MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRSIMPHL%LVDIFSPNL   .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LVDIFSPNL MISMATCH')
IF (YDMODEL%YRML_PHY_RAD%YRERAD%NAER         /=       1                   ) CALL ABOR1('SUAPL_ARPEGE: NAER MISMATCH')
IF (YDMODEL%YRML_PHY_RAD%YRERAD%NOZOCL       /=       1                   ) CALL ABOR1('SUAPL_ARPEGE: NOZOCL MISMATCH')
IF (YDMODEL%YRML_PHY_RAD%YRERAD%NRADFR       /=       15                  ) CALL ABOR1('SUAPL_ARPEGE: NRADFR MISMATCH')
IF (YDMODEL%YRML_PHY_RAD%YRERAD%NSW          /=       6                   ) CALL ABOR1('SUAPL_ARPEGE: NSW MISMATCH')
IF (YDMODEL%YRML_PHY_RAD%YRRCOEF%LRCOEF      .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LRCOEF MISMATCH')
IF (YDMODEL%YRML_PHY_G%YRDPHY%NVCLIS         /=       0                   ) CALL ABOR1('SUAPL_ARPEGE: NVCLIS MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY%LRKCDEV        .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LRKCDEV MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD        /=       20000               ) CALL ABOR1('SUAPL_ARPEGE: RDECRD MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD1       /=       10000               ) CALL ABOR1('SUAPL_ARPEGE: RDECRD1 MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD2       /=       20000               ) CALL ABOR1('SUAPL_ARPEGE: RDECRD2 MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD3       /=       0.3_JPRB            ) CALL ABOR1('SUAPL_ARPEGE: RDECRD3 MISMATCH')
IF (YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD4       /=       0.45_JPRB           ) CALL ABOR1('SUAPL_ARPEGE: RDECRD4 MISMATCH')
IF (YDMODEL%YRML_PHY_RAD%YRERAD%NOZOCL       /=       1                   ) CALL ABOR1('SUAPL_ARPEGE: NOZOCL MISMATCH')


IF (L3DTURB                                  .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: L3DTURB MISMATCH')
IF (LGSCM                                    .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LGSCM MISMATCH')
IF (LINTFLEX                                 .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LINTFLEX MISMATCH')
IF (LMUSCLFA                                 .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LMUSCLFA MISMATCH')
IF (LSFORCS                                  .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LSFORCS MISMATCH')
IF (YDXFU%LXMRT                              .NEQV.   .FALSE.             ) CALL ABOR1('SUAPL_ARPEGE: LXMRT MISMATCH')
IF (YDXFU%LXVISI                             .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LXVISI MISMATCH')
IF (YDXFU%LXVISI2                            .NEQV.   .TRUE.              ) CALL ABOR1('SUAPL_ARPEGE: LXVISI2 MISMATCH')

IF (LHOOK) CALL DR_HOOK('SUAPL_ARPEGE',1,ZHOOK_HANDLE)

END SUBROUTINE SUAPL_ARPEGE
