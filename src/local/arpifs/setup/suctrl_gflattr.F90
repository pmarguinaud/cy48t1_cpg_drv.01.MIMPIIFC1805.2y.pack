SUBROUTINE SUCTRL_GFLATTR(YDEPHY,YDML_GCONF,YDARPHY,YDPHY,YDSIMPHL)

!     ----------------------------------------------------------------------
!**** *SUCTRL_GFLATTR * - Checking of the consistency of the GFL attributes.

!     Purpose.
!     --------

!**   Interface.
!     ----------
!        *CALL* *SUCTRL_GFLATTR*

!        Explicit arguments :
!        --------------------

!        Implicit arguments :
!        --------------------

!     Method.
!     -------

!     Externals.
!     ----------

!     Reference.
!     ----------
!        ECMWF Research Department documentation of the IFS

!     Author.
!     -------
!        K. Yessad, after
!        - old part 1.2.2 of SUDIM1 (current parts 1. to 1.4)
!        - old part 1.2.4 of SUDIM1 (current part 2)
!        - old part 1.3.3 of SUDIM1 (current part 3)
!        - old parts 1.9.1 to 1.9.4 of SUDIM1 (current parts 4.1 to 4.4)
!        - old parts 1.10.1 to 1.10.6 of SUDIM1 (current parts 5.1 to 5.6)
!        - some SUDYN checkings (ex: current part 1.5)

!     Modifications.
!     --------------
!      Original : 31-01-2007
!      28-Aug-2007 F. Vana: removing LRSPLINE attribute
!      J.Haseler     27-Feb-2007 Modify defaults for LTRAJIO and LGPINGP
!      JJMorcrette   20060925    DU, BC, OM, SO2, VOL, SOA climatological flds
!      JJMorcrette   20061020    diagnostic of aerosol physical fluxes
!      22-Mar-2007 S.Serrar  : defaults for ERA40 GFL fields
!      27-Jun-2007 E.Holm    : default option for GFL SL TL/AD LADV5 attribute
!      12-Dec-2007 Y.Seity   : add GFL Hail
!      30-Jun-2008 J. Masek  : Setup of SLHD and LSHDQUAD
!      16-Mar-2009 K. Yessad : Prevent forbidden case (LPT,LADV)=(T,F).
!      K. Yessad (Aug 2009)  : prune conf 912, externalise conf 911.
!      15-Oct-2009 Y. Bouteloup : add radiative cloud water and ice (YIRAD and YLRAD)
!      F.Vana  22-Feb-2011 : check for LTDIABLIN and LHORTURB attributes
!      J.M. Piriou and E. Bazile (Sep 2011): new GFL variables (LCONV, ICONV, RCONV, SCONV)
!      R. El Khatib 22-Mar-2012 Fix uninitialized variables
!      R. El Khatib 30-Mar-2012 No abort => go to nulout
!      K. Yessad (Sep 2013): final value of LSLHD and LSLHDQUAD set-up in SUDYNA
!      S. Malardel (Nov 2013): COMAD weights for SL interpolations
!      Y. Bouteloup 28-11-2013 EFB parameterization EFB1, EFB2, EFB3
!      K. Yessad (July 2014): Move some variables.
!      K. Yessad (Aug 2014): add additional testings on LSLHD
!      M.Diamantakis Feb-2014   Check for mass fixer option flags
!      F. Vana & M. Kharoutdinov 09-Feb-2015 extra fields for CRM model.
!      R. El Khatib 10-Nov-2015 Bufix on LSPRT vs Q%LLGP checking
!      R. El Khatib 08-Dec-2015 Interoperability GRIB2 vs FA
!      F. Vana  7-Nov-2016  Removed useless check of LINTLIN.
!      M Ahlgrimm 2017-05-11 cloud heterogeneity FSD
!   R. El Khatib  03-Sep-2018 new configuration 904 which is a test program for change of resolution of an object FIELDS
!      D. St-Martin (Sep 2018) Security test for LNORGWD
!      P. Bechtold 14-Feb-2019 EDR Parameter turbulence diagnostics
!      F. Vana 20-Feb-2019: Quintic vertical interpolation of WENO family
!     ----------------------------------------------------------------------

USE MODEL_GENERAL_CONF_MOD , ONLY : MODEL_GENERAL_CONF_TYPE
USE PARKIND1     , ONLY : JPIM, JPRB
USE YOMHOOK      , ONLY : LHOOK, DR_HOOK
USE YOMLUN       , ONLY : NULERR, NULOUT
USE YOMCT0       , ONLY : NCONF, LRPLANE, LSLAG, LSPRT, &
 &                        LSFORC, LECMWF, LR3D, LR2D
USE YOMARG       , ONLY : NGRIBFILE
USE YOMPHY       , ONLY : TPHY
USE YOMSIMPHL    , ONLY : TSIMPHL
USE YOMARPHY     , ONLY : TARPHY
USE YOEPHY       , ONLY : TEPHY
USE YOMINI       , ONLY : LDFI
USE YOMDYNA      , ONLY : YRDYNA
USE YOM_YGFL     , ONLY : JPEZDIAG,JPAERO,JPFORC,JPCHEM,JPAEROUT,JPNOGW,JPGHG,JPUVP,JPERA40,JPSLDIA,JPCRM, JPLIMA,&
 &                        JPEDRP
USE CRMDIMS      , ONLY : CRMBUFSIZE
USE YOE_AERODIAG , ONLY : NPAERAOT, NPAERLISI_VAR, NPAERLISI_WVL, &
 &                        NPAERO_WVL_DIAG, NPAERO_WVL_DIAG_TYPES


!     ------------------------------------------------------------------

IMPLICIT NONE

TYPE(TARPHY),INTENT(INOUT):: YDARPHY
TYPE(TEPHY),INTENT(INOUT):: YDEPHY
TYPE(MODEL_GENERAL_CONF_TYPE),INTENT(INOUT):: YDML_GCONF
TYPE(TPHY),INTENT(INOUT):: YDPHY
TYPE(TSIMPHL),INTENT(INOUT):: YDSIMPHL
INTEGER(KIND=JPIM) :: JGFL, JWVL
LOGICAL :: LLCOMPUTE_CVGQ,LLSLHD_GFL,LLCOMAD_GFL,LLSLDMAD, &
         & LLSLDHV,LLSLDLIN, LLTRCMFABOR, LLRHSVWENO_GFL


LOGICAL :: LLTESTLIMA
 
REAL(KIND=JPRB) :: ZHOOK_HANDLE

!     ------------------------------------------------------------------

#include "abor1.intfb.h"

!     ------------------------------------------------------------------

IF (LHOOK) CALL DR_HOOK('SUCTRL_GFLATTR',0,ZHOOK_HANDLE)


ASSOCIATE(LMPA=>YDARPHY%LMPA, &
 & YEXT_NL=>YDML_GCONF%YGFL%YEXT_NL, YLRAD_NL=>YDML_GCONF%YGFL%YLRAD_NL, YI_NL=>YDML_GCONF%YGFL%YI_NL, &
 & NGFL_FORC=>YDML_GCONF%YGFL%NGFL_FORC, YCPF_NL=>YDML_GCONF%YGFL%YCPF_NL, YQVA_NL=>YDML_GCONF%YGFL%YQVA_NL, &
 & YCVGQ_NL=>YDML_GCONF%YGFL%YCVGQ_NL, YMXL_NL=>YDML_GCONF%YGFL%YMXL_NL, &
 & NUVP=>YDML_GCONF%YGFL%NUVP, YLCONV_NL=>YDML_GCONF%YGFL%YLCONV_NL, NNOGW=>YDML_GCONF%YGFL%NNOGW, &
 & YSDSAT_NL=>YDML_GCONF%YGFL%YSDSAT_NL, YCHEM_NL=>YDML_GCONF%YGFL%YCHEM_NL, YEFB2_NL=>YDML_GCONF%YGFL%YEFB2_NL, &
 & YUVP_NL=>YDML_GCONF%YGFL%YUVP_NL, YRKTQC_NL=>YDML_GCONF%YGFL%YRKTQC_NL, YSHTUR_NL=>YDML_GCONF%YGFL%YSHTUR_NL, &
 & YRCONV_NL=>YDML_GCONF%YGFL%YRCONV_NL, YH_NL=>YDML_GCONF%YGFL%YH_NL, YICONV_NL=>YDML_GCONF%YGFL%YICONV_NL, &
 & NCHEM=>YDML_GCONF%YGFL%NCHEM, YO3_NL=>YDML_GCONF%YGFL%YO3_NL, NGHG=>YDML_GCONF%YGFL%NGHG, &
 & YFSTUR_NL=>YDML_GCONF%YGFL%YFSTUR_NL, YAEROUT_NL=>YDML_GCONF%YGFL%YAEROUT_NL, &
 & YAERAOT_NL=>YDML_GCONF%YGFL%YAERAOT_NL, YAERLISI_NL=>YDML_GCONF%YGFL%YAERLISI_NL, &
 & YSCONV_NL=>YDML_GCONF%YGFL%YSCONV_NL, YCVV_NL=>YDML_GCONF%YGFL%YCVV_NL, &
 & YUAL_NL=>YDML_GCONF%YGFL%YUAL_NL, YL_NL=>YDML_GCONF%YGFL%YL_NL, &
 & YR_NL=>YDML_GCONF%YGFL%YR_NL, YQ_NL=>YDML_GCONF%YGFL%YQ_NL, &
 & NGFL_EXT=>YDML_GCONF%YGFL%NGFL_EXT, YEFB1_NL=>YDML_GCONF%YGFL%YEFB1_NL, YLRCH4_NL=>YDML_GCONF%YGFL%YLRCH4_NL, &
 & YEZDIAG_NL=>YDML_GCONF%YGFL%YEZDIAG_NL, YG_NL=>YDML_GCONF%YGFL%YG_NL, YERA40_NL=>YDML_GCONF%YGFL%YERA40_NL, &
 & YTTE_NL=>YDML_GCONF%YGFL%YTTE_NL, NSLDIA=>YDML_GCONF%YGFL%NSLDIA, YNOGW_NL=>YDML_GCONF%YGFL%YNOGW_NL, &
 & NGFL_EZDIAG=>YDML_GCONF%YGFL%NGFL_EZDIAG, YIRAD_NL=>YDML_GCONF%YGFL%YIRAD_NL, &
 & YUNEBH_NL=>YDML_GCONF%YGFL%YUNEBH_NL, NERA40=>YDML_GCONF%YGFL%NERA40, YDAL_NL=>YDML_GCONF%YGFL%YDAL_NL, &
 & YRKTQV_NL=>YDML_GCONF%YGFL%YRKTQV_NL, YAERO_NL=>YDML_GCONF%YGFL%YAERO_NL, &
 & NAERO=>YDML_GCONF%YGFL%NAERO, YTKE_NL=>YDML_GCONF%YGFL%YTKE_NL, &
 & YFQTUR_NL=>YDML_GCONF%YGFL%YFQTUR_NL, YFORC_NL=>YDML_GCONF%YGFL%YFORC_NL, YRKTH_NL=>YDML_GCONF%YGFL%YRKTH_NL, &
 & YS_NL=>YDML_GCONF%YGFL%YS_NL, YEFB3_NL=>YDML_GCONF%YGFL%YEFB3_NL, &
 & NAEROUT=>YDML_GCONF%YGFL%NAEROUT, YA_NL=>YDML_GCONF%YGFL%YA_NL, YGHG_NL=>YDML_GCONF%YGFL%YGHG_NL, &
 & YUOM_NL=>YDML_GCONF%YGFL%YUOM_NL, YDOM_NL=>YDML_GCONF%YGFL%YDOM_NL, YSPF_NL=>YDML_GCONF%YGFL%YSPF_NL, &
 & YSRC_NL=>YDML_GCONF%YGFL%YSRC_NL, YSLDIA_NL=>YDML_GCONF%YGFL%YSLDIA_NL, YUEN_NL=>YDML_GCONF%YGFL%YUEN_NL, &
 & L3MT=>YDPHY%L3MT, LGPCMT=>YDPHY%LGPCMT, LNEBR=>YDPHY%LNEBR, &
 & LCDDPRO=>YDPHY%LCDDPRO, LNEBN=>YDPHY%LNEBN, LMPHYS=>YDPHY%LMPHYS, &
 & LPROCLD=>YDPHY%LPROCLD, LENTCH=>YDPHY%LENTCH, LCVPRO=>YDPHY%LCVPRO, &
 & LRKCDEV=>YDPHY%LRKCDEV, LECT=>YDPHY%LECT, LCVRA=>YDPHY%LCVRA, &
 & LNORGWD=>YDPHY%LNORGWD, &
 & LSTRAPRO=>YDPHY%LSTRAPRO, LRRGUST=>YDPHY%LRRGUST, &
 & LTRCMFBC=>YDML_GCONF%YGFL%LTRCMFBC, LTRCMFIX=>YDML_GCONF%YGFL%LTRCMFIX, &
 & LTRCMFMG=>YDML_GCONF%YGFL%LTRCMFMG, LTRCMFPR=>YDML_GCONF%YGFL%LTRCMFPR, &
 & NCRM=>YDML_GCONF%YGFL%NCRM, NOPTMFBC=>YDML_GCONF%YGFL%NOPTMFBC, NOPTMFPR=>YDML_GCONF%YGFL%NOPTMFPR, &
 & YCRM_NL=>YDML_GCONF%YGFL%YCRM_NL, &
 & NAERO_WVL_DIAG=>YDML_GCONF%YGFL%NAERO_WVL_DIAG, &
 & NAERO_WVL_DIAG_TYPES=>YDML_GCONF%YGFL%NAERO_WVL_DIAG_TYPES, &
 & LEO3CH=>YDEPHY%LEO3CH, LEPCLD=>YDEPHY%LEPCLD, LEPHYS=>YDEPHY%LEPHYS, &
 & NSTOP=>YDML_GCONF%YRRIP%NSTOP, YFSD_NL=>YDML_GCONF%YGFL%YFSD_NL, &
 & NEDRP=>YDML_GCONF%YGFL%NEDRP, YEDRP_NL=>YDML_GCONF%YGFL%YEDRP_NL, &
 & YLIMA_NL=>YDML_GCONF%YGFL%YLIMA_NL, NLIMA=>YDML_GCONF%YGFL%NLIMA, &
 & LSIMPH=>YDSIMPHL%LSIMPH )
!     ------------------------------------------------------------------

!*       0.   Check semi-Lagrangian diagnostics fields.
!             -----------------------------------------

IF(NSLDIA > JPSLDIA) THEN
  WRITE(NULERR,*)' Too many semi-Lagrangian diagnostics fields have been asked for&
   &!',' Increase parameter JPSLDIA in yom_ygfl.F90',&
   &' and JPOSSLDIA in parfpos.F90 to at least NSLDIA.'
  CALL ABOR1('SUCTRL_GFLATTR 0.')
ENDIF

!*       1.     Some consistency checks for GFL attributes.
!               -------------------------------------------

!        1.1    Attribute LVSPLIP:

! * Attribute LVSPLIP:
!   - Is currently coded only for ozone O3.
!   - Excludes some semi-Lagrangian interpolators.
!   - Variable LVSPLIP is set to .TRUE. if the attribute LVSPLIP
!     is .TRUE. for at least one of the GFL variables.

IF (YQ_NL%LVSPLIP&
 & .OR. YA_NL%LVSPLIP .OR. YI_NL%LVSPLIP .OR. YL_NL%LVSPLIP&
 & .OR. YLCONV_NL%LVSPLIP .OR. YICONV_NL%LVSPLIP .OR. YRCONV_NL%LVSPLIP .OR. YSCONV_NL%LVSPLIP&
 & .OR. YIRAD_NL%LVSPLIP .OR. YLRAD_NL%LVSPLIP&
 & .OR. YR_NL%LVSPLIP .OR. YS_NL%LVSPLIP .OR. YG_NL%LVSPLIP&
 & .OR. YH_NL%LVSPLIP&
 & .OR. YTKE_NL%LVSPLIP .OR. YEFB1_NL%LVSPLIP .OR. YEFB2_NL%LVSPLIP .OR. YEFB3_NL%LVSPLIP&
 & .OR. YSRC_NL%LVSPLIP .OR. YCPF_NL%LVSPLIP&
 & .OR. YSPF_NL%LVSPLIP .OR. YCVGQ_NL%LVSPLIP.OR. YQVA_NL%LVSPLIP&
 & .OR. YSDSAT_NL%LVSPLIP .OR. YCVV_NL%LVSPLIP&
 & .OR. YUOM_NL%LVSPLIP .OR. YUAL_NL%LVSPLIP&
 & .OR. YDOM_NL%LVSPLIP .OR. YDAL_NL%LVSPLIP&
 & .OR. YUEN_NL%LVSPLIP .OR. YUNEBH_NL%LVSPLIP&
 & .OR. YTTE_NL%LVSPLIP .OR. YMXL_NL%LVSPLIP&
 & .OR. YSHTUR_NL%LVSPLIP .OR. YFQTUR_NL%LVSPLIP .OR. YFSTUR_NL%LVSPLIP&
 & .OR. YRKTH_NL%LVSPLIP .OR. YRKTQV_NL%LVSPLIP .OR. YRKTQC_NL%LVSPLIP&
 & .OR. YLRCH4_NL%LVSPLIP .OR. YFSD_NL%LVSPLIP&
 & .OR. ANY(YGHG_NL(:)%LVSPLIP)&
 & .OR. ANY(YCHEM_NL(:)%LVSPLIP)&
 & .OR. ANY(YAERO_NL(:)%LVSPLIP)&
 & .OR. ANY(YERA40_NL(:)%LVSPLIP)&
 & .OR. ANY(YNOGW_NL(:)%LVSPLIP)&
 & .OR. ANY(YUVP_NL(:)%LVSPLIP)&
 & .OR. ANY(YAERAOT_NL(:)%LVSPLIP)&
 & .OR. ANY(YAERLISI_NL(:,:)%LVSPLIP)&
 & .OR. ANY(YAEROUT_NL(:)%LVSPLIP)&
 & .OR. ANY(YSLDIA_NL(1:NSLDIA)%LVSPLIP)&
 & .OR. ANY(YFORC_NL(:)%LVSPLIP)&
 & .OR. ANY(YEZDIAG_NL(:)%LVSPLIP)&
 & .OR. ANY(YEXT_NL(:)%LVSPLIP)&
 & .OR. ANY(YCRM_NL(:)%LVSPLIP)&
 & .OR. ANY(YLIMA_NL(:)%LVSPLIP) ) THEN
  CALL ABOR1('SUCTRL_GFLATTR, CALL ABOR1: LVSPLIP can only be used with YO3')
ENDIF

IF (YO3_NL%LVSPLIP .AND. (YO3_NL%LCOMAD.OR.YO3_NL%LSLHD.OR.YO3_NL%LQM.OR.YO3_NL%LQMH.OR.YO3_NL%LQM3D&
 & .OR. YO3_NL%LHV) ) THEN
  CALL ABOR1('SUCTRL_GFLATTR: if YO3_NL%LVSPLIP == .T., all others YO3_NL interpolation descriptors must be .F.!')
ENDIF

YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR. (YQ_NL%LVSPLIP .OR.&
 & YA_NL%LVSPLIP .OR.&
 & YI_NL%LVSPLIP .OR.&
 & YL_NL%LVSPLIP .OR.&
 & YLCONV_NL%LVSPLIP .OR.&
 & YICONV_NL%LVSPLIP .OR.&
 & YRCONV_NL%LVSPLIP .OR.&
 & YSCONV_NL%LVSPLIP .OR.&
 & YIRAD_NL%LVSPLIP .OR.&
 & YLRAD_NL%LVSPLIP .OR.&
 & YR_NL%LVSPLIP .OR.&
 & YS_NL%LVSPLIP .OR.&
 & YG_NL%LVSPLIP .OR.&
 & YH_NL%LVSPLIP .OR.&
 & YTKE_NL%LVSPLIP .OR.&
 & YEFB1_NL%LVSPLIP .OR.&
 & YEFB2_NL%LVSPLIP .OR.&
 & YEFB3_NL%LVSPLIP .OR.&
 & YSRC_NL%LVSPLIP .OR.&
 & YO3_NL%LVSPLIP .OR.&
 & YCPF_NL%LVSPLIP .OR.&
 & YSPF_NL%LVSPLIP .OR.&
 & YCVGQ_NL%LVSPLIP.OR.&
 & YQVA_NL%LVSPLIP.OR.&
 & YSDSAT_NL%LVSPLIP.OR.&
 & YCVV_NL%LVSPLIP.OR.&
 & YUOM_NL%LVSPLIP.OR.&
 & YUAL_NL%LVSPLIP.OR.&
 & YDOM_NL%LVSPLIP.OR.&
 & YDAL_NL%LVSPLIP.OR.&
 & YUEN_NL%LVSPLIP.OR.&
 & YUNEBH_NL%LVSPLIP.OR.&
 & YTTE_NL%LVSPLIP.OR.&
 & YMXL_NL%LVSPLIP.OR.&
 & YSHTUR_NL%LVSPLIP.OR.&
 & YFQTUR_NL%LVSPLIP.OR.&
 & YFSTUR_NL%LVSPLIP.OR.&
 & YRKTH_NL%LVSPLIP.OR.&
 & YRKTQV_NL%LVSPLIP.OR.&
 & YRKTQC_NL%LVSPLIP.OR.&
 & YLRCH4_NL%LVSPLIP.OR. &
 & YFSD_NL%LVSPLIP)

DO JGFL=1,JPGHG
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YGHG_NL(JGFL)%LVSPLIP)
ENDDO

DO JGFL=1,JPCHEM
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YCHEM_NL(JGFL)%LVSPLIP)
ENDDO

DO JGFL=1,JPAERO
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YAERO_NL(JGFL)%LVSPLIP)
ENDDO

DO JGFL=1,JPERA40
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YERA40_NL(JGFL)%LVSPLIP)
ENDDO

DO JGFL=1,JPNOGW
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YNOGW_NL(JGFL)%LVSPLIP)
ENDDO

DO JGFL=1,JPEDRP
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YEDRP_NL(JGFL)%LVSPLIP)
ENDDO

DO JGFL=1,JPUVP
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YUVP_NL(JGFL)%LVSPLIP)
ENDDO

DO JGFL=1,NPAERAOT
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YAERAOT_NL(JGFL)%LVSPLIP)
ENDDO

DO JGFL=1,NPAERLISI_VAR
  DO JWVL=1,NPAERLISI_WVL
    YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YAERLISI_NL(JWVL,JGFL)%LVSPLIP)
  ENDDO
ENDDO

DO JGFL=1,JPAEROUT
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YAEROUT_NL(JGFL)%LVSPLIP)
ENDDO

DO JGFL=1,NSLDIA
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YSLDIA_NL(JGFL)%LVSPLIP)
ENDDO

DO JGFL=1,JPFORC
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YFORC_NL(JGFL)%LVSPLIP)
ENDDO

DO JGFL=1,JPEZDIAG
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YEZDIAG_NL(JGFL)%LVSPLIP)
ENDDO

DO JGFL=1,SIZE(YEXT_NL)
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YEXT_NL(JGFL)%LVSPLIP)
ENDDO

DO JGFL=1,JPCRM
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YCRM_NL(JGFL)%LVSPLIP)
ENDDO

DO JGFL=1,JPLIMA
  YRDYNA%LVSPLIP = YRDYNA%LVSPLIP.OR.(YLIMA_NL(JGFL)%LVSPLIP)
ENDDO

!        1.2    Attribute LHV:

! * Attribute LHV: is currently coded only for ozone O3.
!   If LHV=T, semi-Lagrangian interpolations cannot be spline or SLHD interp.
!   LHV=T is currently not coded for plane geometry.

IF (YQ_NL%LHV .OR. YA_NL%LHV .OR. YI_NL%LHV .OR. YL_NL%LHV&
 & .OR. YLCONV_NL%LHV .OR. YICONV_NL%LHV .OR. YRCONV_NL%LHV .OR. YSCONV_NL%LHV&
 & .OR. YIRAD_NL%LHV .OR. YLRAD_NL%LHV&
 & .OR. YR_NL%LHV .OR. YS_NL%LHV .OR. YG_NL%LHV .OR. YH_NL%LHV&
 & .OR. YTKE_NL%LHV .OR. YEFB1_NL%LHV .OR. YEFB2_NL%LHV .OR. YEFB3_NL%LHV&
 & .OR. YSRC_NL%LHV .OR. YCPF_NL%LHV&
 & .OR. YSPF_NL%LHV .OR. YCVGQ_NL%LHV .OR. YQVA_NL%LHV&
 & .OR. YSDSAT_NL%LHV .OR. YCVV_NL%LHV&
 & .OR. YUOM_NL%LHV .OR. YUAL_NL%LHV&
 & .OR. YDOM_NL%LHV .OR. YDAL_NL%LHV&
 & .OR. YUEN_NL%LHV .OR. YUNEBH_NL%LHV&
 & .OR. YTTE_NL%LHV .OR. YMXL_NL%LHV&
 & .OR. YSHTUR_NL%LHV .OR. YFQTUR_NL%LHV .OR. YFSTUR_NL%LHV&
 & .OR. YRKTH_NL%LHV .OR. YRKTQV_NL%LHV .OR. YRKTQC_NL%LHV&
 & .OR. YLRCH4_NL%LHV .OR. YFSD_NL%LHV&
 & .OR. ANY(YGHG_NL(:)%LHV)&
 & .OR. ANY(YCHEM_NL(:)%LHV)&
 & .OR. ANY(YAERO_NL(:)%LHV)&
 & .OR. ANY(YERA40_NL(:)%LHV)&
 & .OR. ANY(YNOGW_NL(:)%LHV)&
 & .OR. ANY(YUVP_NL(:)%LHV)&
 & .OR. ANY(YAERAOT_NL(:)%LHV)&
 & .OR. ANY(YAERLISI_NL(:,:)%LHV)&
 & .OR. ANY(YAEROUT_NL(:)%LHV)&
 & .OR. ANY(YSLDIA_NL(1:NSLDIA)%LHV)&
 & .OR. ANY(YFORC_NL(:)%LHV)&
 & .OR. ANY(YEZDIAG_NL(:)%LHV)&
 & .OR. ANY(YEXT_NL(:)%LHV)&
 & .OR. ANY(YCRM_NL(:)%LHV)&
 & .OR. ANY(YLIMA_NL(:)%LHV) ) THEN
  CALL ABOR1('SUCTRL_GFLATTR, CALL ABOR1: LHV can only be used with YO3')
ENDIF

IF (YO3_NL%LHV .AND. (YO3_NL%LSLHD .OR. YO3_NL%LCOMAD) ) THEN
  CALL ABOR1('SUCTRL_GFLATTR CALL ABOR1: if YO3_NL%LHV == .T., YO3_NL%LSLHD or YO3_NL%LCOMAD  can not be .T.!')
ENDIF

IF (YO3_NL%LHV.AND.LRPLANE) THEN
  WRITE(NULERR,*) 'YO3_NL%LHV=T NOT CODED FOR PLANE GEOMETRY.'
  CALL ABOR1(' SUCTRL_GFLATTR 1.2 (no YO3_NL%LHV for LRPLANE)')
ENDIF

!        1.3    Attribute LSLHD:

! * Attribute LSLHD: variable LLSLHD_GFL is set to .TRUE. if the attribute LSLHD
!   is .TRUE. for at least one of the GFL variables.
!   Consistency checking is done for LLSLHD_GFL and LSLHD_GFL (both should have the same value).

LLSLHD_GFL = (YQ_NL%LSLHD .OR.&
 & YA_NL%LSLHD .OR.&
 & YI_NL%LSLHD .OR.&
 & YL_NL%LSLHD .OR.&
 & YLCONV_NL%LSLHD .OR.&
 & YICONV_NL%LSLHD .OR.&
 & YRCONV_NL%LSLHD .OR.&
 & YSCONV_NL%LSLHD .OR.&
 & YIRAD_NL%LSLHD .OR.&
 & YLRAD_NL%LSLHD .OR.&
 & YR_NL%LSLHD .OR.&
 & YS_NL%LSLHD .OR.&
 & YG_NL%LSLHD .OR.&
 & YH_NL%LSLHD .OR.&
 & YTKE_NL%LSLHD .OR.&
 & YEFB1_NL%LSLHD .OR.&
 & YEFB2_NL%LSLHD .OR.&
 & YEFB3_NL%LSLHD .OR.&
 & YSRC_NL%LSLHD .OR.&
 & YO3_NL%LSLHD .OR.&
 & YCPF_NL%LSLHD .OR.&
 & YSPF_NL%LSLHD .OR.&
 & YCVGQ_NL%LSLHD.OR.&
 & YQVA_NL%LSLHD.OR.&
 & YSDSAT_NL%LSLHD.OR.&
 & YCVV_NL%LSLHD.OR.&
 & YUOM_NL%LSLHD.OR.&
 & YUAL_NL%LSLHD.OR.&
 & YDOM_NL%LSLHD.OR.&
 & YDAL_NL%LSLHD.OR.&
 & YUEN_NL%LSLHD.OR.&
 & YUNEBH_NL%LSLHD.OR.&
 & YTTE_NL%LSLHD.OR.&
 & YMXL_NL%LSLHD.OR.&
 & YSHTUR_NL%LSLHD.OR.&
 & YFQTUR_NL%LSLHD.OR.&
 & YFSTUR_NL%LSLHD.OR.&
 & YRKTH_NL%LSLHD.OR.&
 & YRKTQV_NL%LSLHD.OR.&
 & YRKTQC_NL%LSLHD.OR.&
 & YLRCH4_NL%LSLHD.OR. &
 & YFSD_NL%LSLHD)

DO JGFL=1,JPGHG
  LLSLHD_GFL = LLSLHD_GFL.OR.(YGHG_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPCHEM
  LLSLHD_GFL = LLSLHD_GFL.OR.(YCHEM_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPAERO
  LLSLHD_GFL = LLSLHD_GFL.OR.(YAERO_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPERA40
  LLSLHD_GFL = LLSLHD_GFL.OR.(YERA40_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPNOGW
  LLSLHD_GFL = LLSLHD_GFL.OR.(YNOGW_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPUVP
  LLSLHD_GFL = LLSLHD_GFL.OR.(YUVP_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NPAERAOT
  LLSLHD_GFL = LLSLHD_GFL.OR.(YAERAOT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NPAERLISI_VAR
  DO JWVL=1,NPAERLISI_WVL
    LLSLHD_GFL = LLSLHD_GFL.OR.(YAERLISI_NL(JWVL,JGFL)%LSLHD)
  ENDDO
ENDDO

DO JGFL=1,JPAEROUT
  LLSLHD_GFL = LLSLHD_GFL.OR.(YAEROUT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NSLDIA
  LLSLHD_GFL = LLSLHD_GFL.OR.(YSLDIA_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPFORC
  LLSLHD_GFL = LLSLHD_GFL.OR.(YFORC_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPEZDIAG
  LLSLHD_GFL = LLSLHD_GFL.OR.(YEZDIAG_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,SIZE(YEXT_NL)
  LLSLHD_GFL = LLSLHD_GFL.OR.(YEXT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPCRM
  LLSLHD_GFL = LLSLHD_GFL.OR.(YCRM_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPLIMA
  LLSLHD_GFL = LLSLHD_GFL.OR.(YLIMA_NL(JGFL)%LSLHD)
ENDDO

IF (LLSLHD_GFL .NEQV. YRDYNA%LSLHD_GFL) THEN
  WRITE(NULERR,*) ' INCONSISTENCY BETWEEN LSLHD_GFL AND GFL ATTRIBUTE LSLHD.'
  CALL ABOR1(' SUCTRL_GFLATTR: 1.3')
ENDIF

! * Attributes LSLHD and LHV cannot both be true at the same time:
LLSLDHV = (YQ_NL%LHV .AND. YQ_NL%LSLHD) .OR.&
 & (YA_NL%LHV .AND.YA_NL%LSLHD) .OR.&
 & (YI_NL%LHV .AND.YI_NL%LSLHD) .OR.&
 & (YL_NL%LHV .AND. YL_NL%LSLHD) .OR.&
 & (YLCONV_NL%LHV .AND. YLCONV_NL%LSLHD) .OR.&
 & (YICONV_NL%LHV .AND.YICONV_NL%LSLHD) .OR.&
 & (YRCONV_NL%LHV .AND.YRCONV_NL%LSLHD) .OR.&
 & (YSCONV_NL%LHV .AND.YSCONV_NL%LSLHD) .OR.&
 & (YIRAD_NL%LHV .AND. YIRAD_NL%LSLHD) .OR.&
 & (YLRAD_NL%LHV .AND. YLRAD_NL%LSLHD) .OR.&
 & (YR_NL%LHV .AND. YR_NL%LSLHD) .OR.&
 & (YS_NL%LHV .AND. YS_NL%LSLHD) .OR.&
 & (YG_NL%LHV .AND.YG_NL%LSLHD) .OR.&
 & (YH_NL%LHV .AND. YH_NL%LSLHD) .OR.&
 & (YTKE_NL%LHV .AND. YTKE_NL%LSLHD) .OR.&
 & (YEFB1_NL%LHV .AND. YEFB1_NL%LSLHD) .OR.&
 & (YEFB2_NL%LHV .AND. YEFB2_NL%LSLHD) .OR.&
 & (YEFB3_NL%LHV .AND. YEFB3_NL%LSLHD) .OR.&
 & (YSRC_NL%LHV .AND. YSRC_NL%LSLHD) .OR.&
 & (YO3_NL%LHV .AND. YO3_NL%LSLHD) .OR.&
 & (YCPF_NL%LHV .AND. YCPF_NL%LSLHD) .OR.&
 & (YSPF_NL%LHV .AND. YSPF_NL%LSLHD) .OR.&
 & (YCVGQ_NL%LHV .AND. YCVGQ_NL%LSLHD).OR.&
 & (YQVA_NL%LHV .AND. YQVA_NL%LSLHD).OR.&
 & (YSDSAT_NL%LHV .AND. YSDSAT_NL%LSLHD).OR.&
 & (YCVV_NL%LHV .AND. YCVV_NL%LSLHD).OR.&
 & (YUOM_NL%LHV .AND. YUOM_NL%LSLHD).OR.&
 & (YUAL_NL%LHV .AND. YUAL_NL%LSLHD).OR.&
 & (YDOM_NL%LHV .AND. YDOM_NL%LSLHD).OR.&
 & (YDAL_NL%LHV .AND. YDAL_NL%LSLHD).OR.&
 & (YUEN_NL%LHV .AND. YUEN_NL%LSLHD).OR.&
 & (YUNEBH_NL%LHV .AND. YUNEBH_NL%LSLHD).OR.&
 & (YTTE_NL%LHV .AND. YTTE_NL%LSLHD).OR.&
 & (YMXL_NL%LHV .AND. YMXL_NL%LSLHD).OR.&
 & (YRKTH_NL%LHV .AND. YRKTH_NL%LSLHD).OR.&
 & (YRKTQV_NL%LHV .AND. YRKTQV_NL%LSLHD).OR.&
 & (YRKTQC_NL%LHV .AND. YRKTQC_NL%LSLHD).OR.&
 & (YLRCH4_NL%LHV .AND. YLRCH4_NL%LSLHD).OR. &
 & (YFSD_NL%LHV .AND. YFSD_NL%LSLHD)

DO JGFL=1,JPGHG
  LLSLDHV = LLSLDHV.OR.(YGHG_NL(JGFL)%LHV .AND. YGHG_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPCHEM
  LLSLDHV = LLSLDHV.OR.(YCHEM_NL(JGFL)%LHV .AND.YCHEM_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPAERO
  LLSLDHV = LLSLDHV.OR.(YAERO_NL(JGFL)%LHV .AND. YAERO_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPERA40
  LLSLDHV = LLSLDHV.OR.(YERA40_NL(JGFL)%LHV .AND. YERA40_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPNOGW
  LLSLDHV = LLSLDHV.OR.(YNOGW_NL(JGFL)%LHV .AND. YNOGW_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPUVP
  LLSLDHV = LLSLDHV.OR.(YUVP_NL(JGFL)%LHV .AND. YUVP_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NPAERAOT
  LLSLDHV = LLSLDHV.OR.(YAERAOT_NL(JGFL)%LHV .AND. YAERAOT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NPAERLISI_VAR
  DO JWVL=1,NPAERLISI_WVL
    LLSLDHV = LLSLDHV.OR.(YAERLISI_NL(JWVL,JGFL)%LHV .AND. YAERLISI_NL(JWVL,JGFL)%LSLHD)
  ENDDO
ENDDO

DO JGFL=1,JPAEROUT
  LLSLDHV = LLSLDHV.OR.(YAEROUT_NL(JGFL)%LHV .AND. YAEROUT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NSLDIA
  LLSLDHV = LLSLDHV.OR.(YSLDIA_NL(JGFL)%LHV .AND. YSLDIA_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPFORC
  LLSLDHV = LLSLDHV.OR.(YFORC_NL(JGFL)%LHV .AND. YFORC_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPEZDIAG
  LLSLDHV = LLSLDHV.OR.(YEZDIAG_NL(JGFL)%LHV .AND. YEZDIAG_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,SIZE(YEXT_NL)
  LLSLDHV = LLSLDHV.OR.(YEXT_NL(JGFL)%LHV .AND. YEXT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPCRM
  LLSLDHV = LLSLDHV.OR.(YCRM_NL(JGFL)%LHV .AND. YCRM_NL(JGFL)%LSLHD)
ENDDO


DO JGFL=1,JPLIMA
  LLSLDHV = LLSLDHV.OR.(YLIMA_NL(JGFL)%LHV .AND. YLIMA_NL(JGFL)%LSLHD)
ENDDO

IF (LLSLDHV) THEN
  WRITE(NULERR,*) '(at least one) INCONSISTENCY BETWEEN LHV and LSLHD ATTRIBUTEs '
  CALL ABOR1(' SUCTRL_GFLATTR: 1.3b')
ENDIF

! * Attributes LSLHD and LINTLIN cannot both be true at the same time:
LLSLDLIN = (YQ_NL%LINTLIN .AND. YQ_NL%LSLHD) .OR.&
 & (YA_NL%LINTLIN .AND.YA_NL%LSLHD) .OR.&
 & (YI_NL%LINTLIN .AND.YI_NL%LSLHD) .OR.&
 & (YL_NL%LINTLIN .AND. YL_NL%LSLHD) .OR.&
 & (YLCONV_NL%LINTLIN .AND. YLCONV_NL%LSLHD) .OR.&
 & (YICONV_NL%LINTLIN .AND.YICONV_NL%LSLHD) .OR.&
 & (YRCONV_NL%LINTLIN .AND.YRCONV_NL%LSLHD) .OR.&
 & (YSCONV_NL%LINTLIN .AND.YSCONV_NL%LSLHD) .OR.&
 & (YIRAD_NL%LINTLIN .AND. YIRAD_NL%LSLHD) .OR.&
 & (YLRAD_NL%LINTLIN .AND. YLRAD_NL%LSLHD) .OR.&
 & (YR_NL%LINTLIN .AND. YR_NL%LSLHD) .OR.&
 & (YS_NL%LINTLIN .AND. YS_NL%LSLHD) .OR.&
 & (YG_NL%LINTLIN .AND.YG_NL%LSLHD) .OR.&
 & (YH_NL%LINTLIN .AND. YH_NL%LSLHD) .OR.&
 & (YTKE_NL%LINTLIN .AND. YTKE_NL%LSLHD) .OR.&
 & (YEFB1_NL%LINTLIN .AND. YEFB1_NL%LSLHD) .OR.&
 & (YEFB2_NL%LINTLIN .AND. YEFB2_NL%LSLHD) .OR.&
 & (YEFB3_NL%LINTLIN .AND. YEFB3_NL%LSLHD) .OR.&
 & (YSRC_NL%LINTLIN .AND. YSRC_NL%LSLHD) .OR.&
 & (YO3_NL%LINTLIN .AND. YO3_NL%LSLHD) .OR.&
 & (YCPF_NL%LINTLIN .AND. YCPF_NL%LSLHD) .OR.&
 & (YSPF_NL%LINTLIN .AND. YSPF_NL%LSLHD) .OR.&
 & (YCVGQ_NL%LINTLIN .AND. YCVGQ_NL%LSLHD).OR.&
 & (YQVA_NL%LINTLIN .AND. YQVA_NL%LSLHD).OR.&
 & (YSDSAT_NL%LINTLIN .AND. YSDSAT_NL%LSLHD).OR.&
 & (YCVV_NL%LINTLIN .AND. YCVV_NL%LSLHD).OR.&
 & (YUOM_NL%LINTLIN .AND. YUOM_NL%LSLHD).OR.&
 & (YUAL_NL%LINTLIN .AND. YUAL_NL%LSLHD).OR.&
 & (YDOM_NL%LINTLIN .AND. YDOM_NL%LSLHD).OR.&
 & (YDAL_NL%LINTLIN .AND. YDAL_NL%LSLHD).OR.&
 & (YUEN_NL%LINTLIN .AND. YUEN_NL%LSLHD).OR.&
 & (YUNEBH_NL%LINTLIN .AND. YUNEBH_NL%LSLHD).OR.&
 & (YTTE_NL%LINTLIN .AND. YTTE_NL%LSLHD).OR.&
 & (YMXL_NL%LINTLIN .AND. YMXL_NL%LSLHD).OR.&
 & (YRKTH_NL%LINTLIN .AND. YRKTH_NL%LSLHD).OR.&
 & (YRKTQV_NL%LINTLIN .AND. YRKTQV_NL%LSLHD).OR.&
 & (YRKTQC_NL%LINTLIN .AND. YRKTQC_NL%LSLHD).OR.&
 & (YLRCH4_NL%LINTLIN .AND. YLRCH4_NL%LSLHD).OR. &
 & (YFSD_NL%LINTLIN .AND. YFSD_NL%LSLHD)

DO JGFL=1,JPGHG
  LLSLDLIN = LLSLDLIN.OR.(YGHG_NL(JGFL)%LINTLIN .AND. YGHG_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPCHEM
  LLSLDLIN = LLSLDLIN.OR.(YCHEM_NL(JGFL)%LINTLIN .AND.YCHEM_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPAERO
  LLSLDLIN = LLSLDLIN.OR.(YAERO_NL(JGFL)%LINTLIN .AND. YAERO_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPERA40
  LLSLDLIN = LLSLDLIN.OR.(YERA40_NL(JGFL)%LINTLIN .AND. YERA40_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPNOGW
  LLSLDLIN = LLSLDLIN.OR.(YNOGW_NL(JGFL)%LINTLIN .AND. YNOGW_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPEDRP
  LLSLDLIN = LLSLDLIN.OR.(YEDRP_NL(JGFL)%LINTLIN .AND. YEDRP_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPUVP
  LLSLDLIN = LLSLDLIN.OR.(YUVP_NL(JGFL)%LINTLIN .AND. YUVP_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NPAERAOT
  LLSLDLIN = LLSLDLIN.OR.(YAERAOT_NL(JGFL)%LINTLIN .AND. YAERAOT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NPAERLISI_VAR
  DO JWVL=1,NPAERLISI_WVL
    LLSLDLIN = LLSLDLIN.OR.(YAERLISI_NL(JWVL,JGFL)%LINTLIN .AND. YAERLISI_NL(JWVL,JGFL)%LSLHD)
  ENDDO
ENDDO

DO JGFL=1,JPAEROUT
  LLSLDLIN = LLSLDLIN.OR.(YAEROUT_NL(JGFL)%LINTLIN .AND. YAEROUT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NSLDIA
  LLSLDLIN = LLSLDLIN.OR.(YSLDIA_NL(JGFL)%LINTLIN .AND. YSLDIA_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPFORC
  LLSLDLIN = LLSLDLIN.OR.(YFORC_NL(JGFL)%LINTLIN .AND. YFORC_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPEZDIAG
  LLSLDLIN = LLSLDLIN.OR.(YEZDIAG_NL(JGFL)%LINTLIN .AND. YEZDIAG_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,SIZE(YEXT_NL)
  LLSLDLIN = LLSLDLIN.OR.(YEXT_NL(JGFL)%LINTLIN .AND. YEXT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPCRM
  LLSLDLIN = LLSLDLIN.OR.(YCRM_NL(JGFL)%LINTLIN .AND. YCRM_NL(JGFL)%LSLHD)
ENDDO


DO JGFL=1,JPLIMA
  LLSLDLIN = LLSLDLIN.OR.(YLIMA_NL(JGFL)%LINTLIN .AND. YLIMA_NL(JGFL)%LSLHD)
ENDDO


IF (LLSLDLIN) THEN
  WRITE(NULERR,*) '(at least one) INCONSISTENCY BETWEEN LINTLIN and LSLHD ATTRIBUTEs '
  CALL ABOR1(' SUCTRL_GFLATTR: 1.3c')
ENDIF

!        1.3e   Attribute LVWENO:

! * Attribute LVWENO: variable LRHSVWENO must be set to .TRUE. if the attribute LVWENO
!   is .TRUE. for at least one of the GFL variables.
!   Consistency checking is done for LLRHSVWENO_GFL and LRHSVWENO (when the formal one 
!     is TRUE the later must not be FALSE). 

LLRHSVWENO_GFL = (YQ_NL%LVWENO .OR.&
 & YA_NL%LVWENO .OR.&
 & YI_NL%LVWENO .OR.&
 & YL_NL%LVWENO .OR.&
 & YLCONV_NL%LVWENO .OR.&
 & YICONV_NL%LVWENO .OR.&
 & YRCONV_NL%LVWENO .OR.&
 & YSCONV_NL%LVWENO .OR.&
 & YIRAD_NL%LVWENO .OR.&
 & YLRAD_NL%LVWENO .OR.&
 & YR_NL%LVWENO .OR.&
 & YS_NL%LVWENO .OR.&
 & YG_NL%LVWENO .OR.&
 & YH_NL%LVWENO .OR.&
 & YTKE_NL%LVWENO .OR.&
 & YEFB1_NL%LVWENO .OR.&
 & YEFB2_NL%LVWENO .OR.&
 & YEFB3_NL%LVWENO .OR.&
 & YSRC_NL%LVWENO .OR.&
 & YO3_NL%LVWENO .OR.&
 & YCPF_NL%LVWENO .OR.&
 & YSPF_NL%LVWENO .OR.&
 & YCVGQ_NL%LVWENO.OR.&
 & YQVA_NL%LVWENO.OR.&
 & YSDSAT_NL%LVWENO.OR.&
 & YCVV_NL%LVWENO.OR.&
 & YUOM_NL%LVWENO.OR.&
 & YUAL_NL%LVWENO.OR.&
 & YDOM_NL%LVWENO.OR.&
 & YDAL_NL%LVWENO.OR.&
 & YUEN_NL%LVWENO.OR.&
 & YUNEBH_NL%LVWENO.OR.&
 & YTTE_NL%LVWENO.OR.&
 & YMXL_NL%LVWENO.OR.&
 & YSHTUR_NL%LVWENO.OR.&
 & YFQTUR_NL%LVWENO.OR.&
 & YFSTUR_NL%LVWENO.OR.&
 & YRKTH_NL%LVWENO.OR.&
 & YRKTQV_NL%LVWENO.OR.&
 & YRKTQC_NL%LVWENO.OR.&
 & YLRCH4_NL%LVWENO.OR.&
 & YFSD_NL%LVWENO)

DO JGFL=1,JPGHG
  LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YGHG_NL(JGFL)%LVWENO) 
ENDDO

DO JGFL=1,JPCHEM
  LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YCHEM_NL(JGFL)%LVWENO)
ENDDO

DO JGFL=1,JPAERO
  LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YAERO_NL(JGFL)%LVWENO) 
ENDDO

DO JGFL=1,JPERA40
  LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YERA40_NL(JGFL)%LVWENO) 
ENDDO

DO JGFL=1,JPNOGW
  LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YNOGW_NL(JGFL)%LVWENO)
ENDDO

DO JGFL=1,JPUVP
  LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YUVP_NL(JGFL)%LVWENO)
ENDDO

DO JGFL=1,NPAERAOT
  LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YAERAOT_NL(JGFL)%LVWENO)
ENDDO

DO JGFL=1,NPAERLISI_VAR
  DO JWVL=1,NPAERLISI_WVL
    LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YAERLISI_NL(JWVL,JGFL)%LVWENO)
  ENDDO
ENDDO

DO JGFL=1,JPAEROUT
  LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YAEROUT_NL(JGFL)%LVWENO)
ENDDO

DO JGFL=1,NSLDIA
  LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YSLDIA_NL(JGFL)%LVWENO)
ENDDO

DO JGFL=1,JPFORC
  LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YFORC_NL(JGFL)%LVWENO)
ENDDO

DO JGFL=1,JPEZDIAG
  LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YEZDIAG_NL(JGFL)%LVWENO)
ENDDO

DO JGFL=1,SIZE(YEXT_NL)
  LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YEXT_NL(JGFL)%LVWENO)
ENDDO

DO JGFL=1,JPCRM
  LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YCRM_NL(JGFL)%LVWENO)
ENDDO

DO JGFL=1,JPLIMA
  LLRHSVWENO_GFL = LLRHSVWENO_GFL.OR.(YLIMA_NL(JGFL)%LVWENO)
ENDDO

IF (LLRHSVWENO_GFL .AND. (.NOT.YRDYNA%LRHSVWENO)) THEN
  WRITE(NULERR,*) ' INCONSISTENCY BETWEEN LRHSVWENO AND GFL ATTRIBUTE LVWENO.'
  CALL ABOR1(' SUCTRL_GFLATTR: 1.3e')
ENDIF



! * Attributes LSLHD and LVWENO cannot both be true at the same time:
LLSLDHV = (YQ_NL%LVWENO .AND. YQ_NL%LSLHD) .OR.&
 & (YA_NL%LVWENO .AND.YA_NL%LSLHD) .OR.&
 & (YI_NL%LVWENO .AND.YI_NL%LSLHD) .OR.&
 & (YL_NL%LVWENO .AND. YL_NL%LSLHD) .OR.&
 & (YLCONV_NL%LVWENO .AND. YLCONV_NL%LSLHD) .OR.&
 & (YICONV_NL%LVWENO .AND.YICONV_NL%LSLHD) .OR.&
 & (YRCONV_NL%LVWENO .AND.YRCONV_NL%LSLHD) .OR.&
 & (YSCONV_NL%LVWENO .AND.YSCONV_NL%LSLHD) .OR.&
 & (YIRAD_NL%LVWENO .AND. YIRAD_NL%LSLHD) .OR.&
 & (YLRAD_NL%LVWENO .AND. YLRAD_NL%LSLHD) .OR.&
 & (YR_NL%LVWENO .AND. YR_NL%LSLHD) .OR.&
 & (YS_NL%LVWENO .AND. YS_NL%LSLHD) .OR.&
 & (YG_NL%LVWENO .AND.YG_NL%LSLHD) .OR.&
 & (YH_NL%LVWENO .AND. YH_NL%LSLHD) .OR.&
 & (YTKE_NL%LVWENO .AND. YTKE_NL%LSLHD) .OR.&
 & (YEFB1_NL%LVWENO .AND. YEFB1_NL%LSLHD) .OR.&
 & (YEFB2_NL%LVWENO .AND. YEFB2_NL%LSLHD) .OR.&
 & (YEFB3_NL%LVWENO .AND. YEFB3_NL%LSLHD) .OR.&
 & (YSRC_NL%LVWENO .AND. YSRC_NL%LSLHD) .OR.&
 & (YO3_NL%LVWENO .AND. YO3_NL%LSLHD) .OR.&
 & (YCPF_NL%LVWENO .AND. YCPF_NL%LSLHD) .OR.&
 & (YSPF_NL%LVWENO .AND. YSPF_NL%LSLHD) .OR.&
 & (YCVGQ_NL%LVWENO .AND. YCVGQ_NL%LSLHD).OR.&
 & (YQVA_NL%LVWENO .AND. YQVA_NL%LSLHD).OR.&
 & (YSDSAT_NL%LVWENO .AND. YSDSAT_NL%LSLHD).OR.&
 & (YCVV_NL%LVWENO .AND. YCVV_NL%LSLHD).OR.&
 & (YUOM_NL%LVWENO .AND. YUOM_NL%LSLHD).OR.&
 & (YUAL_NL%LVWENO .AND. YUAL_NL%LSLHD).OR.&
 & (YDOM_NL%LVWENO .AND. YDOM_NL%LSLHD).OR.&
 & (YDAL_NL%LVWENO .AND. YDAL_NL%LSLHD).OR.&
 & (YUEN_NL%LVWENO .AND. YUEN_NL%LSLHD).OR.&
 & (YUNEBH_NL%LVWENO .AND. YUNEBH_NL%LSLHD).OR.&
 & (YTTE_NL%LVWENO .AND. YTTE_NL%LSLHD).OR.&
 & (YMXL_NL%LVWENO .AND. YMXL_NL%LSLHD).OR.&
 & (YRKTH_NL%LVWENO .AND. YRKTH_NL%LSLHD).OR.&
 & (YRKTQV_NL%LVWENO .AND. YRKTQV_NL%LSLHD).OR.&
 & (YRKTQC_NL%LVWENO .AND. YRKTQC_NL%LSLHD).OR.&
 & (YLRCH4_NL%LVWENO .AND. YLRCH4_NL%LSLHD).OR.&
 & (YFSD_NL%LVWENO .AND. YFSD_NL%LSLHD)

DO JGFL=1,JPGHG
  LLSLDHV = LLSLDHV.OR.(YGHG_NL(JGFL)%LVWENO .AND. YGHG_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPCHEM
  LLSLDHV = LLSLDHV.OR.(YCHEM_NL(JGFL)%LVWENO .AND.YCHEM_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPAERO
  LLSLDHV = LLSLDHV.OR.(YAERO_NL(JGFL)%LVWENO .AND. YAERO_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPERA40
  LLSLDHV = LLSLDHV.OR.(YERA40_NL(JGFL)%LVWENO .AND. YERA40_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPNOGW
  LLSLDHV = LLSLDHV.OR.(YNOGW_NL(JGFL)%LVWENO .AND. YNOGW_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPUVP
  LLSLDHV = LLSLDHV.OR.(YUVP_NL(JGFL)%LVWENO .AND. YUVP_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NPAERAOT
  LLSLDHV = LLSLDHV.OR.(YAERAOT_NL(JGFL)%LVWENO .AND. YAERAOT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NPAERLISI_VAR
  DO JWVL=1,NPAERLISI_WVL
    LLSLDHV = LLSLDHV.OR.(YAERLISI_NL(JWVL,JGFL)%LVWENO .AND. YAERLISI_NL(JWVL,JGFL)%LSLHD)
  ENDDO
ENDDO

DO JGFL=1,JPAEROUT
  LLSLDHV = LLSLDHV.OR.(YAEROUT_NL(JGFL)%LVWENO .AND. YAEROUT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NSLDIA
  LLSLDHV = LLSLDHV.OR.(YSLDIA_NL(JGFL)%LVWENO .AND. YSLDIA_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPFORC
  LLSLDHV = LLSLDHV.OR.(YFORC_NL(JGFL)%LVWENO .AND. YFORC_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPEZDIAG
  LLSLDHV = LLSLDHV.OR.(YEZDIAG_NL(JGFL)%LVWENO .AND. YEZDIAG_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,SIZE(YEXT_NL)
  LLSLDHV = LLSLDHV.OR.(YEXT_NL(JGFL)%LVWENO .AND. YEXT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPCRM
  LLSLDHV = LLSLDHV.OR.(YCRM_NL(JGFL)%LVWENO .AND. YCRM_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPLIMA
  LLSLDHV = LLSLDHV.OR.(YLIMA_NL(JGFL)%LVWENO .AND. YLIMA_NL(JGFL)%LSLHD)
ENDDO

IF (LLSLDHV) THEN
  WRITE(NULERR,*) '(at least one) INCONSISTENCY BETWEEN LVWENO and LSLHD ATTRIBUTEs '
  CALL ABOR1(' SUCTRL_GFLATTR: 1.3d')
ENDIF

!        1.4    Attribute LGP:

! * Attribute LGP should be reset to .T. for CPF and SPF in some cases:
IF (.NOT.LECMWF .AND. (LR3D .OR. NCONF == 701) .AND. (LMPHYS.OR.LSIMPH)) THEN
  IF(LRRGUST) THEN
    YCPF_NL%LGP=.TRUE.
    YSPF_NL%LGP=.TRUE.
    WRITE(NULOUT,*) ' SUCTRL_GFLATTR: YCPF_NL%LGP and YSPF_NL%LGP reset to T!'
  ELSEIF((LNEBN.OR.LNEBR).AND.(.NOT.LRRGUST)) THEN
    YCPF_NL%LGP=.TRUE.
    WRITE(NULOUT,*) ' SUCTRL_GFLATTR: YCPF_NL%LGP reset to T!'
  ENDIF

  IF (LSIMPH) THEN
    YCPF_NL%LGP=.TRUE.
  ENDIF
ENDIF


! * For some of the GFL, and if YRRIP%NSTOP > 0, the attribute LGP can be .T.
!   only if LSLAG=T.
!   (but there are probably some other GFL variables which are also problematic
!   about this topic, ABOR1 to be added later when relevant).
IF(YO3_NL%LGP.AND..NOT.LSLAG.AND.NSTOP > 0) THEN
  WRITE(NULERR,*) ' YO3_NL%LGP=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.4_O3')
ENDIF
DO JGFL=1,NAERO
  IF(YAERO_NL(JGFL)%LGP.AND..NOT.LSLAG.AND.NSTOP > 0) THEN
    WRITE(NULERR,*) ' GRIDPOINT AEROSOLS NOT ALLOWED IN EULERIAN.'
!    CALL ABOR1(' SUCTRL_GFLATTR: 1.4_AERO')
  ENDIF
ENDDO
DO JGFL=1,NGHG
  IF(YGHG_NL(JGFL)%LGP.AND..NOT.LSLAG.AND.NSTOP > 0) THEN
    WRITE(NULERR,*) ' GRIDPOINT GREENHOUSE GASES NOT ALLOWED IN EULERIAN.'
!    CALL ABOR1(' SUCTRL_GFLATTR: 1.4_GHG')
  ENDIF
ENDDO
DO JGFL=1,NCHEM
  IF(YCHEM_NL(JGFL)%LGP.AND..NOT.LSLAG.AND.NSTOP > 0) THEN
    WRITE(NULERR,*) ' GRIDPOINT CHEM NOT ALLOWED IN EULERIAN.'
!    CALL ABOR1(' SUCTRL_GFLATTR: 1.4_CHEM')
  ENDIF
ENDDO
IF(NGHG > 0) THEN
  IF(YLRCH4_NL%LGP .AND. .NOT.LSLAG.AND.NSTOP > 0) THEN
    WRITE(NULERR,*) ' GRIDPOINT METHANE LOSS RATE NOT ALLOWED IN EULERIAN.'
!    CALL ABOR1(' SUCTRL_GFLATTR: 1.4_LRCH4')
  ENDIF
ENDIF

DO JGFL=1,NSLDIA
  IF(YSLDIA_NL(JGFL)%LGP.AND..NOT.LSLAG.AND.NSTOP > 0) THEN
    WRITE(NULERR,*) ' GRIDPOINT LSLDIA DIAGNOSTICS NOT ALLOWED IN EULERIAN.'
    CALL ABOR1(' SUCTRL_GFLATTR: 1.4_SLDIA')
  ENDIF
ENDDO

!        1.5    Attribute LADV:

! * Attribute LADV:
!   For some of the GFL variables, LADV can be set to .T. only if LSLAG=T.
!   (but there are probably some other GFL variables which are also problematic
!   about this topic, ABOR1 to be added later when relevant).

IF(YI_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YI_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_I')
ENDIF
IF(YL_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YL_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_L')
ENDIF
IF(YLCONV_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YLCONV_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_LCONV')
ENDIF
IF(YICONV_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YICONV_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_ICONV')
ENDIF
IF(YRCONV_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YRCONV_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_RCONV')
ENDIF
IF(YSCONV_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YSCONV_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_SCONV')
ENDIF
IF(YIRAD_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YIRAD_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_IRAD')
ENDIF
IF(YLRAD_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YLRAD_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_LRAD')
ENDIF
IF(YA_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YA_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_A')
ENDIF
IF(YS_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YS_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_S')
ENDIF
IF(YG_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YG_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_G')
ENDIF
IF(YH_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YH_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_G')
ENDIF
IF(YR_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YR_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_R')
ENDIF
IF(YTKE_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YTKE_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_TKE')
ENDIF
IF(YEFB1_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YEFB1_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_EFB1')
ENDIF
IF(YEFB2_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YEFB2_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_EFB2')
ENDIF
IF(YEFB3_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YEFB3_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_EFB3')
ENDIF
IF(YSRC_NL%LADV.AND..NOT.LSLAG) THEN
  WRITE(NULERR,*) ' YSRC_NL%LADV=TRUE NOT ALLOWED IN EULERIAN.'
!  CALL ABOR1(' SUCTRL_GFLATTR: 1.5_SRC')
ENDIF

!        1.6    Attribute LCOMAD:

! * Attribute LCOMAD: variable LLCOMAD_GFL is set to .TRUE. 
!   if the attribute LCOMAD is .TRUE. 
!   for at least one of the GFL variables.
!   Consistency checking is done for LLCOMAD_GFL and LCOMAD_GFL

LLCOMAD_GFL = (YQ_NL%LCOMAD .OR.&
 & YA_NL%LCOMAD .OR.&
 & YI_NL%LCOMAD .OR.&
 & YL_NL%LCOMAD .OR.&
 & YLCONV_NL%LCOMAD .OR.&
 & YICONV_NL%LCOMAD .OR.&
 & YRCONV_NL%LCOMAD .OR.&
 & YSCONV_NL%LCOMAD .OR.&
 & YIRAD_NL%LCOMAD .OR.&
 & YLRAD_NL%LCOMAD .OR.&
 & YR_NL%LCOMAD .OR.&
 & YS_NL%LCOMAD .OR.&
 & YG_NL%LCOMAD .OR.&
 & YH_NL%LCOMAD .OR.&
 & YTKE_NL%LCOMAD .OR.&
 & YEFB1_NL%LCOMAD .OR.&
 & YEFB2_NL%LCOMAD .OR.&
 & YEFB3_NL%LCOMAD .OR.&
 & YSRC_NL%LCOMAD .OR.&
 & YO3_NL%LCOMAD .OR.&
 & YCPF_NL%LCOMAD .OR.&
 & YSPF_NL%LCOMAD .OR.&
 & YCVGQ_NL%LCOMAD.OR.&
 & YQVA_NL%LCOMAD.OR.&
 & YSDSAT_NL%LCOMAD.OR.&
 & YCVV_NL%LCOMAD.OR.&
 & YUOM_NL%LCOMAD.OR.&
 & YUAL_NL%LCOMAD.OR.&
 & YDOM_NL%LCOMAD.OR.&
 & YDAL_NL%LCOMAD.OR.&
 & YUEN_NL%LCOMAD.OR.&
 & YUNEBH_NL%LCOMAD.OR.&
 & YTTE_NL%LCOMAD.OR.&
 & YMXL_NL%LCOMAD.OR.&
 & YSHTUR_NL%LCOMAD.OR.&
 & YFQTUR_NL%LCOMAD.OR.&
 & YFSTUR_NL%LCOMAD.OR.&
 & YRKTH_NL%LCOMAD.OR.&
 & YRKTQV_NL%LCOMAD.OR.&
 & YRKTQC_NL%LCOMAD.OR.&
 & YLRCH4_NL%LCOMAD.OR. &
 & YFSD_NL%LCOMAD)

DO JGFL=1,JPGHG
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YGHG_NL(JGFL)%LCOMAD) 
ENDDO

DO JGFL=1,JPCHEM
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YCHEM_NL(JGFL)%LCOMAD)
ENDDO

DO JGFL=1,JPAERO
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YAERO_NL(JGFL)%LCOMAD) 
ENDDO

DO JGFL=1,JPERA40
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YERA40_NL(JGFL)%LCOMAD) 
ENDDO

DO JGFL=1,JPNOGW
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YNOGW_NL(JGFL)%LCOMAD)
ENDDO

DO JGFL=1,JPEDRP
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YEDRP_NL(JGFL)%LCOMAD)
ENDDO

DO JGFL=1,JPUVP
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YUVP_NL(JGFL)%LCOMAD)
ENDDO

DO JGFL=1,NPAERAOT
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YAERAOT_NL(JGFL)%LCOMAD)
ENDDO

DO JGFL=1,NPAERLISI_VAR
  DO JWVL=1,NPAERLISI_WVL
    LLCOMAD_GFL = LLCOMAD_GFL.OR.(YAERLISI_NL(JWVL,JGFL)%LCOMAD)
  ENDDO
ENDDO

DO JGFL=1,JPAEROUT
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YAEROUT_NL(JGFL)%LCOMAD)
ENDDO

DO JGFL=1,NSLDIA
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YSLDIA_NL(JGFL)%LCOMAD)
ENDDO

DO JGFL=1,JPFORC
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YFORC_NL(JGFL)%LCOMAD)
ENDDO

DO JGFL=1,JPEZDIAG
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YEZDIAG_NL(JGFL)%LCOMAD)
ENDDO

DO JGFL=1,SIZE(YEXT_NL)
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YEXT_NL(JGFL)%LCOMAD)
ENDDO

DO JGFL=1,JPCRM
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YCRM_NL(JGFL)%LCOMAD)
ENDDO


DO JGFL=1,JPLIMA
  LLCOMAD_GFL = LLCOMAD_GFL.OR.(YLIMA_NL(JGFL)%LCOMAD)
ENDDO


IF (LLCOMAD_GFL .NEQV. YRDYNA%LCOMAD_GFL) THEN
  WRITE(NULERR,*) ' INCONSISTENCY BETWEEN LCOMAD_GFL AND GFL ATTRIBUTE LCOMAD.'
  CALL ABOR1(' SUCTRL_GFLATTR: 1.6a')
ENDIF

! * Attributes LCOMAD and LSLHD cannot both be true at the same time:
LLSLDMAD = (YQ_NL%LCOMAD .AND. YQ_NL%LSLHD) .OR.&
 & (YA_NL%LCOMAD .AND.YA_NL%LSLHD) .OR.&
 & (YI_NL%LCOMAD .AND.YI_NL%LSLHD) .OR.&
 & (YL_NL%LCOMAD .AND. YL_NL%LSLHD) .OR.&
 & (YLCONV_NL%LCOMAD .AND. YLCONV_NL%LSLHD) .OR.&
 & (YICONV_NL%LCOMAD .AND.YICONV_NL%LSLHD) .OR.&
 & (YRCONV_NL%LCOMAD .AND.YRCONV_NL%LSLHD) .OR.&
 & (YSCONV_NL%LCOMAD .AND.YSCONV_NL%LSLHD) .OR.&
 & (YIRAD_NL%LCOMAD .AND. YIRAD_NL%LSLHD) .OR.&
 & (YLRAD_NL%LCOMAD .AND. YLRAD_NL%LSLHD) .OR.&
 & (YR_NL%LCOMAD .AND. YR_NL%LSLHD) .OR.&
 & (YS_NL%LCOMAD .AND. YS_NL%LSLHD) .OR.&
 & (YG_NL%LCOMAD .AND.YG_NL%LSLHD) .OR.&
 & (YH_NL%LCOMAD .AND. YH_NL%LSLHD) .OR.&
 & (YTKE_NL%LCOMAD .AND. YTKE_NL%LSLHD) .OR.&
 & (YEFB1_NL%LCOMAD .AND. YEFB1_NL%LSLHD) .OR.&
 & (YEFB2_NL%LCOMAD .AND. YEFB2_NL%LSLHD) .OR.&
 & (YEFB3_NL%LCOMAD .AND. YEFB3_NL%LSLHD) .OR.&
 & (YSRC_NL%LCOMAD .AND. YSRC_NL%LSLHD) .OR.&
 & (YO3_NL%LCOMAD .AND. YO3_NL%LSLHD) .OR.&
 & (YCPF_NL%LCOMAD .AND. YCPF_NL%LSLHD) .OR.&
 & (YSPF_NL%LCOMAD .AND. YSPF_NL%LSLHD) .OR.&
 & (YCVGQ_NL%LCOMAD .AND. YCVGQ_NL%LSLHD).OR.&
 & (YQVA_NL%LCOMAD .AND. YQVA_NL%LSLHD).OR.&
 & (YSDSAT_NL%LCOMAD .AND. YSDSAT_NL%LSLHD).OR.&
 & (YCVV_NL%LCOMAD .AND. YCVV_NL%LSLHD).OR.&
 & (YUOM_NL%LCOMAD .AND. YUOM_NL%LSLHD).OR.&
 & (YUAL_NL%LCOMAD .AND. YUAL_NL%LSLHD).OR.&
 & (YDOM_NL%LCOMAD .AND. YDOM_NL%LSLHD).OR.&
 & (YDAL_NL%LCOMAD .AND. YDAL_NL%LSLHD).OR.&
 & (YUEN_NL%LCOMAD .AND. YUEN_NL%LSLHD).OR.&
 & (YUNEBH_NL%LCOMAD .AND. YUNEBH_NL%LSLHD).OR.&
 & (YTTE_NL%LCOMAD .AND. YTTE_NL%LSLHD).OR.&
 & (YMXL_NL%LCOMAD .AND. YMXL_NL%LSLHD).OR.&
 & (YSHTUR_NL%LCOMAD .AND. YSHTUR_NL%LSLHD).OR.&
 & (YFQTUR_NL%LCOMAD .AND. YFQTUR_NL%LSLHD).OR.&
 & (YFSTUR_NL%LCOMAD .AND. YFSTUR_NL%LSLHD).OR.&
 & (YRKTH_NL%LCOMAD .AND. YRKTH_NL%LSLHD).OR.&
 & (YRKTQV_NL%LCOMAD .AND. YRKTQV_NL%LSLHD).OR.&
 & (YRKTQC_NL%LCOMAD .AND. YRKTQC_NL%LSLHD).OR.&
 & (YLRCH4_NL%LCOMAD .AND. YLRCH4_NL%LSLHD).OR. &
 & (YFSD_NL%LCOMAD .AND. YFSD_NL%LSLHD)

DO JGFL=1,JPGHG
  LLSLDMAD = LLSLDMAD.OR.(YGHG_NL(JGFL)%LCOMAD .AND. YGHG_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPCHEM
  LLSLDMAD = LLSLDMAD.OR.(YCHEM_NL(JGFL)%LCOMAD .AND.YCHEM_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPAERO
  LLSLDMAD = LLSLDMAD.OR.(YAERO_NL(JGFL)%LCOMAD .AND. YAERO_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPERA40
  LLSLDMAD = LLSLDMAD.OR.(YERA40_NL(JGFL)%LCOMAD .AND. YERA40_NL(JGFL)%LSLHD) 
ENDDO

DO JGFL=1,JPNOGW
  LLSLDMAD = LLSLDMAD.OR.(YNOGW_NL(JGFL)%LCOMAD .AND. YNOGW_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPEDRP
  LLSLDMAD = LLSLDMAD.OR.(YEDRP_NL(JGFL)%LCOMAD .AND. YEDRP_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPUVP
  LLSLDMAD = LLSLDMAD.OR.(YUVP_NL(JGFL)%LCOMAD .AND. YUVP_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NPAERAOT
  LLSLDMAD = LLSLDMAD.OR.(YAERAOT_NL(JGFL)%LCOMAD .AND. YAERAOT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NPAERLISI_VAR
  DO JWVL=1,NPAERLISI_WVL
    LLSLDMAD = LLSLDMAD.OR.(YAERLISI_NL(JWVL,JGFL)%LCOMAD .AND. YAERLISI_NL(JWVL,JGFL)%LSLHD)
  ENDDO
ENDDO

DO JGFL=1,JPAEROUT
  LLSLDMAD = LLSLDMAD.OR.(YAEROUT_NL(JGFL)%LCOMAD .AND. YAEROUT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,NSLDIA
  LLSLDMAD = LLSLDMAD.OR.(YSLDIA_NL(JGFL)%LCOMAD .AND. YSLDIA_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPFORC
  LLSLDMAD = LLSLDMAD.OR.(YFORC_NL(JGFL)%LCOMAD .AND. YFORC_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPEZDIAG
  LLSLDMAD = LLSLDMAD.OR.(YEZDIAG_NL(JGFL)%LCOMAD .AND. YEZDIAG_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,SIZE(YEXT_NL)
  LLSLDMAD = LLSLDMAD.OR.(YEXT_NL(JGFL)%LCOMAD .AND. YEXT_NL(JGFL)%LSLHD)
ENDDO

DO JGFL=1,JPCRM
  LLSLDMAD = LLSLDMAD.OR.(YCRM_NL(JGFL)%LCOMAD .AND. YCRM_NL(JGFL)%LSLHD)
ENDDO


DO JGFL=1,JPLIMA
  LLSLDMAD = LLSLDMAD.OR.(YLIMA_NL(JGFL)%LCOMAD .AND. YLIMA_NL(JGFL)%LSLHD)
ENDDO

IF (LLSLDMAD) THEN
  WRITE(NULERR,*) '(at least one) INCONSISTENCY BETWEEN LCOMAD and LSLHD ATTRIBUTEs '
  CALL ABOR1(' SUCTRL_GFLATTR: 1.6b')
ENDIF

!     ------------------------------------------------------------------

!*       2.     Some consistency checks for GFL GRIB codes.
!               -------------------------------------------

IF (NGRIBFILE == 1) THEN

  ! Set default values for grib codes and names of GFL extra fields 
  ! in case they were not given in the namelist.

  DO JGFL=1,NGFL_EXT
    IF(YEXT_NL(JGFL)%IGRBCODE == 999) CALL ABOR1&
     & (' SUCTRL_GFLATTR: THE GRIB CODES OF THE GFL EXTRA FIELDS MUST BE GIVEN')
    IF(YEXT_NL(JGFL)%CNAME == 'XXXXXXXXXXXXXXX') CALL ABOR1&
     & (' SUCTRL_GFLATTR: THE NAMES OF THE GFL EXTRA FIELDS MUST BE GIVEN')
  ENDDO

ENDIF

!     ------------------------------------------------------------------

!*       3.     Reset the GFL attributes LSP and LGP for configurations
!               where there is no GFL at all.
!               -------------------------------------------------------

IF(LR2D .OR. ANY(SPREAD(NCONF,1,4) == (/923,931,932,933/))) THEN  
  ! * reset the LSP attribute to .FALSE. for all GFL variables.
  !   (there are no GFL variables for such configurations).
  YQ_NL%LSP = .FALSE.
  YL_NL%LSP = .FALSE.
  YI_NL%LSP = .FALSE.
  YLCONV_NL%LSP = .FALSE.
  YICONV_NL%LSP = .FALSE.
  YRCONV_NL%LSP = .FALSE.
  YSCONV_NL%LSP = .FALSE.
  YLRAD_NL%LSP = .FALSE.
  YIRAD_NL%LSP = .FALSE.
  YS_NL%LSP = .FALSE.
  YR_NL%LSP = .FALSE.
  YG_NL%LSP = .FALSE.
  YH_NL%LSP = .FALSE.
  YTKE_NL%LSP = .FALSE.
  YEFB1_NL%LSP = .FALSE.
  YEFB2_NL%LSP = .FALSE.
  YEFB3_NL%LSP = .FALSE.
  YA_NL%LSP = .FALSE.
  YSRC_NL%LSP= .FALSE.
  YO3_NL%LSP= .FALSE.
  YCPF_NL%LSP= .FALSE.
  YSPF_NL%LSP= .FALSE.
  YCVGQ_NL%LSP= .FALSE.
  YQVA_NL%LSP= .FALSE.
  YSDSAT_NL%LSP= .FALSE.
  YCVV_NL%LSP= .FALSE.
  YUOM_NL%LSP= .FALSE.
  YUAL_NL%LSP= .FALSE.
  YDOM_NL%LSP= .FALSE.
  YDAL_NL%LSP= .FALSE.
  YUEN_NL%LSP= .FALSE.
  YUNEBH_NL%LSP= .FALSE.
  YTTE_NL%LSP= .FALSE.
  YMXL_NL%LSP= .FALSE.
  YSHTUR_NL%LSP= .FALSE.
  YFQTUR_NL%LSP= .FALSE.
  YFSTUR_NL%LSP= .FALSE.
  YRKTH_NL%LSP= .FALSE.
  YRKTQV_NL%LSP= .FALSE.
  YRKTQC_NL%LSP= .FALSE.
  YGHG_NL(:)%LSP= .FALSE.
  YCHEM_NL(:)%LSP= .FALSE.
  YAERO_NL(:)%LSP= .FALSE.
  YLRCH4_NL%LSP= .FALSE.
  YFSD_NL%LSP= .FALSE.
  YERA40_NL(:)%LSP= .FALSE.
  YNOGW_NL(:)%LSP= .FALSE.
  YEDRP_NL(:)%LSP= .FALSE.
  YUVP_NL(:)%LSP= .FALSE.
  YAERAOT_NL(:)%LSP= .FALSE.
  YAERLISI_NL(:,:)%LSP= .FALSE.
  YAEROUT_NL(:)%LSP= .FALSE.
  YSLDIA_NL(:)%LSP= .FALSE.
  YFORC_NL(:)%LSP= .FALSE.
  YEZDIAG_NL(:)%LSP= .FALSE.
  YEXT_NL(:)%LSP= .FALSE.
  YCRM_NL(:)%LSP= .FALSE.

  YLIMA_NL(:)%LSP = .FALSE.
  ! * reset the LGP attribute for all GFL variables.
  !   (there are no GFL variables for such configurations).
  YQ_NL%LGP = .FALSE.
  YL_NL%LGP = .FALSE.
  YI_NL%LGP = .FALSE.
  YLCONV_NL%LGP = .FALSE.
  YICONV_NL%LGP = .FALSE.
  YRCONV_NL%LGP = .FALSE.
  YSCONV_NL%LGP = .FALSE.
  YLRAD_NL%LGP = .FALSE.
  YIRAD_NL%LGP = .FALSE.
  YS_NL%LGP = .FALSE.
  YR_NL%LGP = .FALSE.
  YG_NL%LGP = .FALSE.
  YH_NL%LGP = .FALSE.
  YTKE_NL%LGP = .FALSE.
  YEFB1_NL%LGP = .FALSE.
  YEFB2_NL%LGP = .FALSE.
  YEFB3_NL%LGP = .FALSE.
  YA_NL%LGP = .FALSE.
  YSRC_NL%LGP= .FALSE.
  YO3_NL%LGP= .FALSE.
  YCPF_NL%LGP= .FALSE.
  YSPF_NL%LGP= .FALSE.
  YCVGQ_NL%LGP= .FALSE.
  YQVA_NL%LGP= .FALSE.
  YSDSAT_NL%LGP= .FALSE.
  YCVV_NL%LGP= .FALSE.
  YUOM_NL%LGP= .FALSE.
  YUAL_NL%LGP= .FALSE.
  YDOM_NL%LGP= .FALSE.
  YDAL_NL%LGP= .FALSE.
  YUEN_NL%LGP= .FALSE.
  YUNEBH_NL%LGP= .FALSE.
  YTTE_NL%LGP= .FALSE.
  YMXL_NL%LGP= .FALSE.
  YSHTUR_NL%LGP= .FALSE.
  YFQTUR_NL%LGP= .FALSE.
  YFSTUR_NL%LGP= .FALSE.
  YRKTH_NL%LGP= .FALSE.
  YRKTQV_NL%LGP= .FALSE.
  YRKTQC_NL%LGP= .FALSE.
  YGHG_NL(:)%LGP= .FALSE.
  YCHEM_NL(:)%LGP= .FALSE.
  YAERO_NL(:)%LGP= .FALSE.
  YLRCH4_NL%LGP= .FALSE.
  YFSD_NL%LGP= .FALSE.
  YERA40_NL(:)%LGP= .FALSE.
  YNOGW_NL(:)%LGP= .FALSE.
  YEDRP_NL(:)%LGP= .FALSE.
  YUVP_NL(:)%LGP= .FALSE.
  YAERAOT_NL(:)%LGP= .FALSE.
  YAERLISI_NL(:,:)%LGP= .FALSE.
  YAEROUT_NL(:)%LGP= .FALSE.
  YSLDIA_NL(:)%LGP= .FALSE.
  YFORC_NL(:)%LGP= .FALSE.
  YEZDIAG_NL(:)%LGP= .FALSE.
  YEXT_NL(:)%LGP= .FALSE.
  YCRM_NL(:)%LGP= .FALSE.

  YLIMA_NL(:)%LGP = .FALSE.
ENDIF

!     ------------------------------------------------------------------

!*       4.     Check representation for GFL fields.
!               ------------------------------------

!*       4.1    check for all GFL that LGP and LSP are not both TRUE.

IF(YQ_NL%LGP.AND.YQ_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YQ_NL%LGP AND YQ_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_Q ')
ENDIF
IF(YO3_NL%LGP.AND.YO3_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YO3_NL%LGP AND YO3_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_O3')
ENDIF
IF(YL_NL%LGP.AND.YL_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YL_NL%LGP AND YL_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_L')
ENDIF
IF(YI_NL%LGP.AND.YI_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YI_NL%LGP AND YI_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_I')
ENDIF
IF(YLCONV_NL%LGP.AND.YLCONV_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YLCONV_NL%LGP AND YLCONV_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_LCONV')
ENDIF
IF(YICONV_NL%LGP.AND.YICONV_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YICONV_NL%LGP AND YICONV_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_ICONV')
ENDIF
IF(YRCONV_NL%LGP.AND.YRCONV_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YRCONV_NL%LGP AND YRCONV_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_RCONV')
ENDIF
IF(YSCONV_NL%LGP.AND.YSCONV_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YSCONV_NL%LGP AND YSCONV_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_SCONV')
ENDIF
IF(YLRAD_NL%LGP.AND.YLRAD_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YLRAD_NL%LGP AND YLRAD_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_LRAD')
ENDIF
IF(YIRAD_NL%LGP.AND.YIRAD_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YIRAD_NL%LGP AND YIRAD_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_IRAD')
ENDIF
IF(YA_NL%LGP.AND.YA_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YA_NL%LGP AND YA_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_A')
ENDIF
IF(YR_NL%LGP.AND.YR_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YR_NL%LGP AND YR_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_R')
ENDIF
IF(YS_NL%LGP.AND.YS_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YS_NL%LGP AND YS_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_S')
ENDIF
IF(YG_NL%LGP.AND.YG_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YG_NL%LGP AND YG_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_G')
ENDIF
IF(YH_NL%LGP.AND.YH_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YH_NL%LGP AND YH_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_H')
ENDIF
IF(YTKE_NL%LGP.AND.YTKE_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YTKE_NL%LGP AND YTKE_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_TKE')
ENDIF
IF(YEFB1_NL%LGP.AND.YEFB1_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YEFB1_NL%LGP AND YEFB1_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_EFB1')
ENDIF
IF(YEFB2_NL%LGP.AND.YEFB2_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YEFB2_NL%LGP AND YEFB2_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_EFB2')
ENDIF
IF(YEFB3_NL%LGP.AND.YEFB3_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YEFB3_NL%LGP AND YEFB3_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_EFB3')
ENDIF
IF(YSRC_NL%LGP.AND.YSRC_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YSRC_NL%LGP AND YSRC_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_SRC')
ENDIF
IF(YCPF_NL%LGP.AND.YCPF_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YCPF_NL%LGP AND YCPF_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_CPF')
ENDIF
IF(YSPF_NL%LGP.AND.YSPF_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YSPF_NL%LGP AND YSPF_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_SPF')
ENDIF
IF(YCVGQ_NL%LGP.AND.YCVGQ_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YCVGQ_NL%LGP AND YCVGQ_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_CVGQ')
ENDIF
IF(YQVA_NL%LGP.AND.YQVA_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YQVA_NL%LGP AND YQVA_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_QVA')
ENDIF
IF(YSDSAT_NL%LGP.AND.YSDSAT_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YSDSAT_NL%LGP AND YSDSAT_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_SDSAT')
ENDIF
IF(YCVV_NL%LGP.AND.YCVV_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YCVV_NL%LGP AND YCVV_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_CVV')
ENDIF
IF(YUOM_NL%LGP.AND.YUOM_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YUOM_NL%LGP AND YUOM_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_UOM')
ENDIF
IF(YUAL_NL%LGP.AND.YUAL_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YUAL_NL%LGP AND YUAL_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_UAL')
ENDIF
IF(YDOM_NL%LGP.AND.YDOM_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YDOM_NL%LGP AND YDOM_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_DOM')
ENDIF
IF(YDAL_NL%LGP.AND.YDAL_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YDAL_NL%LGP AND YDAL_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_DAL')
ENDIF
IF(YUEN_NL%LGP.AND.YUEN_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YUEN_NL%LGP AND YUEN_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_UEN')
ENDIF
IF(YUNEBH_NL%LGP.AND.YUNEBH_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YUNEBH_NL%LGP AND YUNEBH_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_UNEBH')
ENDIF
IF(YTTE_NL%LGP.AND.YTTE_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YTTE_NL%LGP AND YTTE_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_TTE')
ENDIF
IF(YMXL_NL%LGP.AND.YMXL_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YMXL_NL%LGP AND YMXL_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_MXL')
ENDIF
IF(YSHTUR_NL%LGP.AND.YSHTUR_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YSHTUR_NL%LGP AND YSHTUR_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_SHTUR')
ENDIF
IF(YFQTUR_NL%LGP.AND.YFQTUR_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YFQTUR_NL%LGP AND YFQTUR_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_FQTUR')
ENDIF
IF(YFSTUR_NL%LGP.AND.YFSTUR_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YFSTUR_NL%LGP AND YFSTUR_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_FSTUR')
ENDIF
IF(YRKTH_NL%LGP.AND.YRKTH_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YRKTH_NL%LGP AND YRKTH_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_RKTH')
ENDIF
IF(YRKTQV_NL%LGP.AND.YRKTQV_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YRKTQV_NL%LGP AND YRKTQV_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_RKTQV')
ENDIF
IF(YRKTQC_NL%LGP.AND.YRKTQC_NL%LSP) THEN
  WRITE(NULERR,'(''BOTH YRKTQC_NL%LGP AND YRKTQC_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_RKTQC')
ENDIF

DO JGFL=1,JPGHG
  IF(YGHG_NL(JGFL)%LGP.AND.YGHG_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For greenhouse gas number',JGFL
    WRITE(NULERR,'(''BOTH YGHG_NL%LGP AND YGHG_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_GHG')
  ENDIF
ENDDO

IF(YLRCH4_NL%LGP.AND.YLRCH4_NL%LSP) THEN
  WRITE(NULERR,'(A,I3)') ' For CH4 loss rate'
  WRITE(NULERR,'(''BOTH YLRCH4_NL%LGP AND YLRCH4_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_LRCH4')
ENDIF

IF(YFSD_NL%LGP.AND.YFSD_NL%LSP) THEN
  WRITE(NULERR,'(A,I3)') ' For cloud heterogeneity FSD'
  WRITE(NULERR,'(''BOTH YFSD_NL%LGP AND YFSD_NL%LSP TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.1_FSD')
ENDIF

DO JGFL=1,JPCHEM
  IF(YCHEM_NL(JGFL)%LGP.AND.YCHEM_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For chemical species number',JGFL
    WRITE(NULERR,'(''BOTH YCHEM_NL%LGP AND YCHEM_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_CHEM')
  ENDIF
ENDDO

DO JGFL=1,JPAERO
  IF(YAERO_NL(JGFL)%LGP.AND.YAERO_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For aerosol number',JGFL
    WRITE(NULERR,'(''BOTH YAERO_NL%LGP AND YAERO_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_AERO')
  ENDIF
ENDDO

DO JGFL=1,JPERA40
  IF(YERA40_NL(JGFL)%LGP.AND.YERA40_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For ERA40 field number',JGFL
    WRITE(NULERR,'(''BOTH YERA40_NL%LGP AND YERA40_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_ERA40')
  ENDIF
ENDDO

DO JGFL=1,JPNOGW
  IF(YNOGW_NL(JGFL)%LGP.AND.YNOGW_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For NOGW field number',JGFL
    WRITE(NULERR,'(''BOTH YNOGW_NL%LGP AND YNOGW_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_NOGW')
  ENDIF
ENDDO

DO JGFL=1,JPEDRP
  IF(YEDRP_NL(JGFL)%LGP.AND.YEDRP_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For EDR field number',JGFL
    WRITE(NULERR,'(''BOTH YEDRP_NL%LGP AND YEDRP_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_EDRP')
  ENDIF
ENDDO

DO JGFL=1,JPUVP
  IF(YUVP_NL(JGFL)%LGP.AND.YUVP_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For UVP field number',JGFL
    WRITE(NULERR,'(''BOTH YUVP_NL%LGP AND YUVP_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_UVP')
  ENDIF
ENDDO

DO JGFL=1,NPAERAOT
  IF(YAERAOT_NL(JGFL)%LGP.AND.YAERAOT_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For AERAOT field number',JGFL
    WRITE(NULERR,'(''BOTH YAERAOT_NL%LGP AND YAERAOT_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_AERAOT')
  ENDIF
ENDDO

DO JGFL=1,NPAERLISI_VAR
  DO JWVL=1,NPAERLISI_WVL
    IF(YAERLISI_NL(JWVL,JGFL)%LGP.AND.YAERLISI_NL(JWVL,JGFL)%LSP) THEN
      WRITE(NULERR,'(A,I3,I3)') ' For AERLISI field number',JWVL,JGFL
      WRITE(NULERR,'(''BOTH YAERLISI_NL%LGP AND YAERLISI_NL%LSP TRUE'')')
      CALL ABOR1(' SUCTRL_GFLATTR 4.1_AERLISI')
    ENDIF
  ENDDO
ENDDO

DO JGFL=1,JPAEROUT
  IF(YAEROUT_NL(JGFL)%LGP.AND.YAEROUT_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For AEROUT field number',JGFL
    WRITE(NULERR,'(''BOTH YAEROUT_NL%LGP AND YAEROUT_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_AEROUT')
  ENDIF
ENDDO

DO JGFL=1,NSLDIA
  IF(YSLDIA_NL(JGFL)%LGP.AND.YSLDIA_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For SLDIA field number',JGFL
    WRITE(NULERR,'(''BOTH YSLDIA_NL%LGP AND YSLDIA_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_SLDIA')
  ENDIF
ENDDO

DO JGFL=1,JPFORC
  IF(YFORC_NL(JGFL)%LGP.AND.YFORC_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For forcing number',JGFL
    WRITE(NULERR,'(''BOTH YFORC_NL%LGP AND YFORC_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_FORC')
  ENDIF
ENDDO

DO JGFL=1,JPEZDIAG
  IF(YEZDIAG_NL(JGFL)%LGP.AND.YEZDIAG_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For easy diagnostic number',JGFL
    WRITE(NULERR,'(''BOTH YEZDIAG_NL%LGP AND YEZDIAG_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_EZDIAG')
  ENDIF
ENDDO

DO JGFL=1,SIZE(YEXT_NL)
  IF(YEXT_NL(JGFL)%LGP.AND.YEXT_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For extra-GFL number',JGFL
    WRITE(NULERR,'(''BOTH YEXT_NL%LGP AND YEXT_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_EXT')
  ENDIF
ENDDO

DO JGFL=1,JPCRM
  IF(YCRM_NL(JGFL)%LGP.AND.YCRM_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For CRM field number',JGFL
    WRITE(NULERR,'(''BOTH YCRM_NL%LGP AND YCRM_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_CRM')
  ENDIF
ENDDO


DO JGFL=1,JPLIMA
  IF(YLIMA_NL(JGFL)%LGP.AND.YLIMA_NL(JGFL)%LSP) THEN
    WRITE(NULERR,'(A,I3)') ' For LIMA field number',JGFL
    WRITE(NULERR,'(''BOTH YLIMA_NL%LGP AND YLIMA_NL%LSP TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.1_CRM')
  ENDIF
ENDDO


!*       4.2    Check that LGP is TRUE for ql,qi,qs,qr,qg,TKE when the AROME
!               physics is activated.

IF(LMPA) THEN
  IF(.NOT.(YL_NL%LGP.AND.YI_NL%LGP.AND.YS_NL%LGP.AND.YR_NL%LGP.AND.&
   & YG_NL%LGP.AND.YTKE_NL%LGP)) THEN
    WRITE(NULERR,'('' AROME REQUIRES YL YI YS YR YG YTKE_NL%LGP'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.2')
  ENDIF
ENDIF


IF(NLIMA > 0) THEN
   LLTESTLIMA=YL_NL%LGP.AND.YI_NL%LGP.AND.YS_NL%LGP.AND.YR_NL%LGP.AND.&
        & YG_NL%LGP.AND.YTKE_NL%LGP
   DO JGFL=1,JPLIMA
      LLTESTLIMA=LLTESTLIMA.AND.YLIMA_NL(JGFL)%LGP
   ENDDO
   IF(.NOT.LLTESTLIMA) THEN
      WRITE(NULERR,'('' LIMA REQUIRES YL YI YS YR YG YTKE_NL LIMA(:)%LGP'')')
      CALL ABOR1(' SUCTRL_GFLATTR 4.2')
   ENDIF
ENDIF

!*       4.3    Checkings for ALARO prognostic convection variables

IF(L3MT) THEN
  ! * UAL and UOM should be both spectral or both grid-point when required.
  IF ((YUAL_NL%LGP.AND..NOT.YUOM_NL%LGP).OR.&
   &(YUOM_NL%LGP.AND..NOT.YUAL_NL%LGP)) THEN
    WRITE(NULERR,'(''YUOM_NL%LGP AND YUAL_NL%LGP MUST BE EQUAL'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.3_UAL_UOM_LGP')
  ENDIF
  IF ((YUAL_NL%LSP.AND..NOT.YUOM_NL%LSP).OR.&
   &(YUOM_NL%LSP.AND..NOT.YUAL_NL%LSP)) THEN
    WRITE(NULERR,'(''YUOM_NL%LSP AND YUAL_NL%LSP MUST BE EQUAL'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.3_UAL_UOM_LSP')
  ENDIF

  ! * DAL and DOM should be both spectral or both grid-point when required.
  IF ((YDAL_NL%LGP.AND..NOT.YDOM_NL%LGP).OR.&
   &(YDOM_NL%LGP.AND..NOT.YDAL_NL%LGP)) THEN
    WRITE(NULERR,'(''YDOM_NL%LGP AND YDAL_NL%LGP MUST BE EQUAL'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.3_DAL_DOM_LGP')
  ENDIF
  IF ((YDAL_NL%LSP.AND..NOT.YDOM_NL%LSP).OR.&
   &(YDOM_NL%LSP.AND..NOT.YDAL_NL%LSP)) THEN
    WRITE(NULERR,'(''YDOM_NL%LSP AND YDAL_NL%LSP MUST BE EQUAL'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.3_DAL_DOM_LSP')
  ENDIF
ENDIF

! * If LCVRA, DOM and UOM should be both spectral or both grid-point.
IF (LCVRA) THEN ! Prognostic dd but not PLIC
  IF (YDOM_NL%LGP.AND. .NOT. YUOM_NL%LGP) THEN
    WRITE(NULERR,'(''UNDER LCVRA, YDOM_NL%LGP REQUIRES YUOM_NL%LGP'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.3_LCVRA_LGP')
  ENDIF
  IF (YDOM_NL%LSP.AND. .NOT. YUOM_NL%LSP) THEN
    WRITE(NULERR,'(''UNDER LCVRA, YDOM_NL%LSP REQUIRES YUOM_NL%LSP'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.3_LCVRA_LSP')
  ENDIF
ENDIF

! * If L3MT or LSTRAPRO, LGP should be .TRUE. for ql,qi,qr,qs.
IF (L3MT.OR.LSTRAPRO) THEN
  IF (.NOT. (YL_NL%LGP.AND.YI_NL%LGP.AND.YR_NL%LGP.AND.YS_NL%LGP)) THEN
    WRITE(NULERR,'(''L3MT AND LSTRAPRO REQUIRE ALL YL_NL%LGP AND&
     & YI_NL%LGP AND YR_NL%LGP AND YS_NL%LGP'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.3_L3MT_LGP_1 ')
  ENDIF
ENDIF

! * If L3MT, LGP should be .TRUE. for historic cloudiness UNEBH.
IF (L3MT) THEN
  IF (.NOT. YUNEBH_NL%LGP) THEN
    WRITE(NULERR,'(''L3MT REQUIRES YUNEBH_NL%LGP'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.3_L3MT_LGP_2 ')
  ENDIF
ENDIF

! * If LCVPRO, LGP should be .TRUE. for updraft variables UOM and UAL.
IF (LCVPRO) THEN
  IF (.NOT. (YUOM_NL%LGP.AND.YUAL_NL%LGP)) THEN
    WRITE(NULERR,'(''LCVPRO REQUIRES ALL YUOM_NL%LGP AND YUAL_NL%LGP'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.3_LCVPRO_LGP ')
  ENDIF
ENDIF

! * If LCDDPRO, LGP should be .TRUE. for downdraft variables DOM and DAL.
IF (LCDDPRO) THEN
  IF (.NOT. (YDOM_NL%LGP.AND.YDAL_NL%LGP)) THEN
    WRITE(NULERR,'(''LCVPRO REQUIRES ALL YDOM_NL%LGP AND YDAL_NL%LGP'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.3_LCDDPRO_LGP ')
  ENDIF
ENDIF

! * If LENTCH, LGP should be .TRUE. for historic entrainment UEN.
IF (LENTCH) THEN
  IF (.NOT.YUEN_NL%LGP) THEN
    WRITE(NULERR,'(''LENTCH REQUIRES YUEN_NL%LGP'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.3_LENTCH_LGP ')
  ENDIF
ENDIF

! * If LRKCDEV, LGP should be .TRUE. for GFL RK tendencies
IF (LRKCDEV) THEN
  IF (.NOT.YRKTH_NL%LGP .OR. .NOT.YRKTQV_NL%LGP .OR. .NOT.YRKTQC_NL%LGP) THEN
    WRITE(NULERR,'(''LRKCDEV REQUIRES RK tendencies'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.3_LRKCDEV_LGP ')
  ENDIF
ENDIF

!*       4.3b   Checkings for LGPCMT option in convection scheme.

! * If LGPCMT, LGP should be .TRUE. for qlconv,qiconv,qrconv,qsconv (CONV. PART).
IF (LGPCMT) THEN
  IF (.NOT. (YLCONV_NL%LGP.AND.YICONV_NL%LGP.AND.YRCONV_NL%LGP.AND.YSCONV_NL%LGP)) THEN
    WRITE(NULERR,'(''LGPCMT REQUIRES ALL GFL YLCONV_NL%LGP AND&
     & YICONV_NL%LGP AND YRCONV_NL%LGP AND YSCONV_NL%LGP'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.3b_LGPCMT_LGP ')
  ENDIF
ENDIF

!*       4.4    Attribute LTDIABLIN

! LTDIABLIN has only meaning for non passive GFLs advected by SL.
!  (Not sure the list here is complete...)

IF(YQ_NL%LTDIABLIN.AND.(.NOT.YQ_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YQ_NL%LTDIABLIN=.T., YQ_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_Q ')
ENDIF
IF(YO3_NL%LTDIABLIN.AND.(.NOT.YO3_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YO3_NL%LTDIABLIN=.T., YO3_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_O3')
ENDIF
IF(YL_NL%LTDIABLIN.AND.(.NOT.YL_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YL_NL%LTDIABLIN=.T., YL_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_L')
ENDIF
IF(YI_NL%LTDIABLIN.AND.(.NOT.YI_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YI_NL%LTDIABLIN=.T., YI_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_I')
ENDIF
IF(YLCONV_NL%LTDIABLIN.AND.(.NOT.YLCONV_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YLCONV_NL%LTDIABLIN=.T., YLCONV_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_LCONV')
ENDIF
IF(YICONV_NL%LTDIABLIN.AND.(.NOT.YICONV_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YICONV_NL%LTDIABLIN=.T., YICONV_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_ICONV')
ENDIF
IF(YRCONV_NL%LTDIABLIN.AND.(.NOT.YRCONV_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YRCONV_NL%LTDIABLIN=.T., YRCONV_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_RCONV')
ENDIF
IF(YSCONV_NL%LTDIABLIN.AND.(.NOT.YSCONV_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YSCONV_NL%LTDIABLIN=.T., YSCONV_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_SCONV')
ENDIF
IF(YLRAD_NL%LTDIABLIN.AND.(.NOT.YLRAD_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YLRAD_NL%LTDIABLIN=.T., YLRAD_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_LRAD')
ENDIF
IF(YIRAD_NL%LTDIABLIN.AND.(.NOT.YIRAD_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YIRAD_NL%LTDIABLIN=.T., YIRAD_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_IRAD')
ENDIF
IF(YA_NL%LTDIABLIN.AND.(.NOT.YA_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YA_NL%LTDIABLIN=.T., YA_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_A')
ENDIF
IF(YR_NL%LTDIABLIN.AND.(.NOT.YR_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YR_NL%LTDIABLIN=.T., YR_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_R')
ENDIF
IF(YS_NL%LTDIABLIN.AND.(.NOT.YS_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YS_NL%LTDIABLIN=.T., YS_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_S')
ENDIF
IF(YG_NL%LTDIABLIN.AND.(.NOT.YG_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YG_NL%LTDIABLIN=.T., YG_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_G')
ENDIF
IF(YH_NL%LTDIABLIN.AND.(.NOT.YH_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YH_NL%LTDIABLIN=.T., YH_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_H')
ENDIF
IF(YTKE_NL%LTDIABLIN.AND.(.NOT.YTKE_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YTKE_NL%LTDIABLIN=.T., YTKE_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_TKE')
ENDIF
IF(YEFB1_NL%LTDIABLIN.AND.(.NOT.YEFB1_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YEFB1_NL%LTDIABLIN=.T., YEFB1_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_EFB1')
ENDIF
IF(YEFB2_NL%LTDIABLIN.AND.(.NOT.YEFB2_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YEFB2_NL%LTDIABLIN=.T., YEFB2_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_EFB2')
ENDIF
IF(YEFB3_NL%LTDIABLIN.AND.(.NOT.YEFB3_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YEFB3_NL%LTDIABLIN=.T., YEFB3_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_EFB3')
ENDIF
IF(YSRC_NL%LTDIABLIN.AND.(.NOT.YSRC_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YSRC_NL%LTDIABLIN=.T., YSRC_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_SRC')
ENDIF
IF(YCVGQ_NL%LTDIABLIN.AND.(.NOT.YCVGQ_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YCVGQ_NL%LTDIABLIN=.T., YCVGQ_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_CVGQ')
ENDIF
IF(YSDSAT_NL%LTDIABLIN.AND.(.NOT.YSDSAT_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YSDSAT_NL%LTDIABLIN=.T., YSDSAT_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_SDSAT')
ENDIF
IF(YCVV_NL%LTDIABLIN.AND.(.NOT.YCVV_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YCVV_NL%LTDIABLIN=.T., YCVV_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_CVV')
ENDIF
IF(YUOM_NL%LTDIABLIN.AND.(.NOT.YUOM_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YUOM_NL%LTDIABLIN=.T., YUOM_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_UOM')
ENDIF
IF(YUAL_NL%LTDIABLIN.AND.(.NOT.YUAL_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YUAL_NL%LTDIABLIN=.T., YUAL_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_UAL')
ENDIF
IF(YDOM_NL%LTDIABLIN.AND.(.NOT.YDOM_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YDOM_NL%LTDIABLIN=.T., YDOM_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_DOM')
ENDIF
IF(YDAL_NL%LTDIABLIN.AND.(.NOT.YDAL_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YDAL_NL%LTDIABLIN=.T., YDAL_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_DAL')
ENDIF
IF(YUEN_NL%LTDIABLIN.AND.(.NOT.YUEN_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YUEN_NL%LTDIABLIN=.T., YUEN_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_UEN')
ENDIF
IF(YUNEBH_NL%LTDIABLIN.AND.(.NOT.YUNEBH_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YUNEBH_NL%LTDIABLIN=.T., YUNEBH_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_UNEBH')
ENDIF
IF(YTTE_NL%LTDIABLIN.AND.(.NOT.YTTE_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YTTE_NL%LTDIABLIN=.T., YTTE_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_TTE')
ENDIF
IF(YMXL_NL%LTDIABLIN.AND.(.NOT.YMXL_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YMXL_NL%LTDIABLIN=.T., YMXL_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_MXL')
ENDIF
IF(YSHTUR_NL%LTDIABLIN.AND.(.NOT.YSHTUR_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YSHTUR_NL%LTDIABLIN=.T., YSHTUR_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_SHTUR')
ENDIF
IF(YFQTUR_NL%LTDIABLIN.AND.(.NOT.YFQTUR_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YFQTUR_NL%LTDIABLIN=.T., YFQTUR_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_FQTUR')
ENDIF
IF(YFSTUR_NL%LTDIABLIN.AND.(.NOT.YFSTUR_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YFSTUR_NL%LTDIABLIN=.T., YFSTUR_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_FSTUR')
ENDIF
IF(YRKTH_NL%LTDIABLIN.AND.(.NOT.YRKTH_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YRKTH_NL%LTDIABLIN=.T., YRKTH_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_RKTH')
ENDIF
IF(YRKTQV_NL%LTDIABLIN.AND.(.NOT.YRKTQV_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YRKTQV_NL%LTDIABLIN=.T., YRKTQV_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_RKTQV')
ENDIF
IF(YRKTQC_NL%LTDIABLIN.AND.(.NOT.YRKTQC_NL%LADV)) THEN
  WRITE(NULERR,'(''WHEN YRKTQC_NL%LTDIABLIN=.T., YRKTQC_NL%LADV MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_RKTQC')
ENDIF

DO JGFL=1,SIZE(YEXT_NL)
  IF(YEXT_NL(JGFL)%LTDIABLIN.AND.(.NOT.YEXT_NL(JGFL)%LADV)) THEN
    WRITE(NULERR,'(A,I3)') ' For extra-GFL number',JGFL
    WRITE(NULERR,'(''WHEN YEXT_NL%LTDIABLIN=.T., YEXT_NL%LADV SHOULD BE ALSO .T.'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.4_EXT')
  ENDIF
ENDDO


DO JGFL=1,SIZE(YLIMA_NL)
  IF(YLIMA_NL(JGFL)%LTDIABLIN.AND.(.NOT.YLIMA_NL(JGFL)%LADV)) THEN
    WRITE(NULERR,'(A,I3)') ' For LIMA var number',JGFL
    WRITE(NULERR,'(''WHEN YLIMA_NL%LTDIABLIN=.T., YLIMA_NL%LADV SHOULD BE ALSO .T.'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.4_EXT')
  ENDIF
ENDDO

IF(YCVGQ_NL%LTDIABLIN.AND.(.NOT.YQ_NL%LTDIABLIN)) THEN
  WRITE(NULERR,'(''WHEN YCVGQ_NL%LTDIABLIN=.T., YQ_NL%LTDIABLIN MUST BE TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.4_CVGQ+Q')
ENDIF

!*       4.5    Attribute LHORTURB

! LHORTURB has only meaning for non passive GFLs advected by SL.
! The main key L3DTURB (activating the physical part of the 3D turbulence)
! needs to be also TRUE.
!  (Not sure the list here is complete...)

IF(YQ_NL%LHORTURB.AND.(.NOT.YQ_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YQ_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_Q ')
ENDIF
IF(YO3_NL%LHORTURB.AND.(.NOT.YO3_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YO3_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_O3')
ENDIF
IF(YL_NL%LHORTURB.AND.(.NOT.YL_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YL_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_L')
ENDIF
IF(YI_NL%LHORTURB.AND.(.NOT.YI_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YI_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_I')
ENDIF
IF(YLCONV_NL%LHORTURB.AND.(.NOT.YLCONV_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YLCONV_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_LCONV')
ENDIF
IF(YICONV_NL%LHORTURB.AND.(.NOT.YICONV_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YICONV_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_ICONV')
ENDIF
IF(YRCONV_NL%LHORTURB.AND.(.NOT.YRCONV_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YRCONV_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_RCONV')
ENDIF
IF(YSCONV_NL%LHORTURB.AND.(.NOT.YSCONV_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YSCONV_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_SCONV')
ENDIF
IF(YLRAD_NL%LHORTURB.AND.(.NOT.YLRAD_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YLRAD_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_LRAD')
ENDIF
IF(YIRAD_NL%LHORTURB.AND.(.NOT.YIRAD_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YIRAD_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_IRAD')
ENDIF
IF(YA_NL%LHORTURB.AND.(.NOT.YA_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YA_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_A')
ENDIF
IF(YR_NL%LHORTURB.AND.(.NOT.YR_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YR_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_R')
ENDIF
IF(YS_NL%LHORTURB.AND.(.NOT.YS_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YS_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_S')
ENDIF
IF(YG_NL%LHORTURB.AND.(.NOT.YG_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YG_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_G')
ENDIF
IF(YH_NL%LHORTURB.AND.(.NOT.YH_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YH_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_H')
ENDIF
IF(YTKE_NL%LHORTURB.AND.(.NOT.YTKE_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YTKE_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_TKE')
ENDIF
IF(YEFB1_NL%LHORTURB.AND.(.NOT.YEFB1_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YEFB1_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_EFB1')
ENDIF
IF(YEFB2_NL%LHORTURB.AND.(.NOT.YEFB2_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YEFB2_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_EFB2')
ENDIF
IF(YEFB3_NL%LHORTURB.AND.(.NOT.YEFB3_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YEFB3_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_EFB3')
ENDIF
IF(YSRC_NL%LHORTURB.AND.(.NOT.YSRC_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YSRC_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_SRC')
ENDIF
IF(YCVGQ_NL%LHORTURB.AND.(.NOT.YCVGQ_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YCVGQ_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_CVGQ')
ENDIF
IF(YSDSAT_NL%LHORTURB.AND.(.NOT.YSDSAT_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YSDSAT_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_SDSAT')
ENDIF
IF(YCVV_NL%LHORTURB.AND.(.NOT.YCVV_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YCVV_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_CVV')
ENDIF
IF(YUOM_NL%LHORTURB.AND.(.NOT.YUOM_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YUOM_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_UOM')
ENDIF
IF(YUAL_NL%LHORTURB.AND.(.NOT.YUAL_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YUAL_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_UAL')
ENDIF
IF(YDOM_NL%LHORTURB.AND.(.NOT.YDOM_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YDOM_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_DOM')
ENDIF
IF(YDAL_NL%LHORTURB.AND.(.NOT.YDAL_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YDAL_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_DAL')
ENDIF
IF(YUEN_NL%LHORTURB.AND.(.NOT.YUEN_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YUEN_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_UEN')
ENDIF
IF(YUNEBH_NL%LHORTURB.AND.(.NOT.YUNEBH_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YUNEBH_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_UNEBH')
ENDIF
IF(YTTE_NL%LHORTURB.AND.(.NOT.YTTE_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YTTE_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_TTE')
ENDIF
IF(YMXL_NL%LHORTURB.AND.(.NOT.YMXL_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YMXL_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_MXL')
ENDIF
IF(YSHTUR_NL%LHORTURB.AND.(.NOT.YSHTUR_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YSHTUR_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_SHTUR')
ENDIF
IF(YFQTUR_NL%LHORTURB.AND.(.NOT.YFQTUR_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YFQTUR_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_FQTUR')
ENDIF
IF(YFSTUR_NL%LHORTURB.AND.(.NOT.YFSTUR_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YFSTUR_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_FSTUR')
ENDIF
IF(YRKTH_NL%LHORTURB.AND.(.NOT.YRKTH_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YRKTH_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_RKTH')
ENDIF
IF(YRKTQV_NL%LHORTURB.AND.(.NOT.YRKTQV_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YRKTQV_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_RKTQV')
ENDIF
IF(YRKTQC_NL%LHORTURB.AND.(.NOT.YRKTQC_NL%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
  WRITE(NULERR,'(''WRONG SETTING FOR YRKTQC_NL%LHORTURB=.T.'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.5_RKTQC')
ENDIF

DO JGFL=1,SIZE(YEXT_NL)
  IF(YEXT_NL(JGFL)%LHORTURB.AND.(.NOT.YEXT_NL(JGFL)%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
    WRITE(NULERR,'(A,I3)') ' For extra-GFL number',JGFL
    WRITE(NULERR,'(''WRONG SETTING FOR YEXT_NL%LHORTURB=.T.'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.5_EXT')
  ENDIF
ENDDO


DO JGFL=1,SIZE(YLIMA_NL)
  IF(YLIMA_NL(JGFL)%LHORTURB.AND.(.NOT.YLIMA_NL(JGFL)%LADV).AND.(.NOT.YRDYNA%L3DTURB)) THEN
    WRITE(NULERR,'(A,I3)') ' For LIMA var number',JGFL
    WRITE(NULERR,'(''WRONG SETTING FOR YLIMA_NL%LHORTURB=.T.'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.5_EXT')
  ENDIF
ENDDO

!*       4.6    Attribute LPHY

! ky: Missing tests here:
!     attribute LPHY cannot be T if LSLPHY=F.

!*       4.7    additional checkings

IF(LMPHYS.AND.(LNEBN.OR.LNEBR.OR.LRRGUST).AND.(.NOT.YCPF_NL%LGP)) THEN
  WRITE(NULERR,'(''WHEN MF PHYSICS IS ACTIVATED'')')
  WRITE(NULERR,'(''LNEBN.OR.LNEBR.OR.LRRGUST REQUIRES YCPF_NL%LGP'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.8_CPF')
ENDIF
IF(LMPHYS.AND.LRRGUST.AND.(.NOT.YSPF_NL%LGP)) THEN
  WRITE(NULERR,'(''WHEN MF PHYSICS IS ACTIVATED'')')
  WRITE(NULERR,'(''LRRGUST REQUIRES YSPF_NL%LGP'')')
  CALL ABOR1(' SUCTRL_GFLATTR 4.8_SPF')
ENDIF
IF(LEPHYS.AND.LEPCLD) THEN
  IF(.NOT.(YL_NL%LGP.AND.YI_NL%LGP.AND.YA_NL%LGP)) THEN
    WRITE(NULERR,'(''WHEN ECMWF PHYSICS IS ACTIVATED'')')
    WRITE(NULERR,'(''LEPCLD REQUIRES YL_NL%LGP.AND.YI_NL%LGP.AND.YA_NL%LGP'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.8_A')
  ENDIF
ENDIF
IF(LMPHYS.AND.LPROCLD) THEN
  IF(.NOT.(YL_NL%LGP.AND.YI_NL%LGP.AND.YR_NL%LGP.AND.YS_NL%LGP)) THEN
    WRITE(NULERR,'(''WHEN FRENCH PHYSICS IS ACTIVATED'')')
    WRITE(NULERR,'(''LPROCLD REQUIRES YL_NL%LGP.AND.YI_NL%LGP.AND.YR_NL%LGP.AND.YS_NL%LGP'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.8_L_I_R_S')
  ENDIF
ENDIF
IF (LMPHYS.AND.LECT) THEN
   IF(.NOT.(YTKE_NL%LGP)) THEN
     WRITE(NULERR,'(''WHEN FRENCH PHYSICS IS ACTIVATED'')')
     WRITE(NULERR,'(''LECT REQUIRES YTKE_NL%LGP'')')
     CALL ABOR1(' SUCTRL_GFLATTR 4.8_TKE')
   ENDIF
ENDIF    
IF (LMPHYS.AND.LNORGWD) THEN
   IF(.NOT.(YNOGW_NL(1)%LGP)) THEN
     WRITE(NULERR,'(''WHEN FRENCH PHYSICS IS ACTIVATED'')')
     WRITE(NULERR,'(''LNORGWD REQUIRES YNOGW_NL(1)%LGP'')')
     CALL ABOR1(' SUCTRL_GFLATTR 4.8_NOGWU')
   ENDIF
ENDIF
IF (LMPHYS.AND.LNORGWD) THEN
   IF(.NOT.(YNOGW_NL(2)%LGP)) THEN
     WRITE(NULERR,'(''WHEN FRENCH PHYSICS IS ACTIVATED'')')
     WRITE(NULERR,'(''LNORGWD REQUIRES YNOGW_NL(2)%LGP'')')
     CALL ABOR1(' SUCTRL_GFLATTR 4.8_NOGWV')
   ENDIF
ENDIF

! ky: definition of this local variable must be the same everywhere in the code.
LLCOMPUTE_CVGQ=LMPHYS.AND.(.NOT.LMPA)
IF (LLCOMPUTE_CVGQ) THEN
  IF (YQ_NL%LGP .AND. .NOT. (YCVGQ_NL%LGP .OR. YCVGQ_NL%LSP)&
   & .AND. (NSTOP>0.OR.LDFI)) THEN
    WRITE(NULERR,'(''WHEN NON-AROME FRENCH PHYSICS IS ACTIVATED'')')
    WRITE(NULERR,'(''YQ GRID POINT REQUIRES YCVGQ ACTIVE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 4.8_CVGQ')
  ENDIF
ENDIF      

! * Use LSPRT=T and grid-point "q" with an Eulerian advection scheme?
!   LSPRT=T with LSLAG=F can be used only if one of the following
!    conditions is realized:
!    - LSFORC=T (in this case horizontal advections are zero).
!    - NCONF >=900
!    - NSTOP=0
!    - no advected grid-point humidity
IF (LSPRT.AND.(.NOT.LSLAG)) THEN
  IF((.NOT.LSFORC).AND.(NCONF<900 .OR.NCONF==904).AND.(NSTOP>0)&
   & .AND.(YQ_NL%LGP).AND.(YQ_NL%LADV)) THEN
    WRITE (NULERR,*)&
     & 'SUCTRL_GFLATTR: case where LSPRT=T cannot be used with an EUL scheme'
    CALL ABOR1('SUCTRL_GFLATTR: 4.8 No LSPRT in EUL')
  ENDIF
ENDIF

! if LEO3CH, O3 must be active (and grid-point)
IF ((LEO3CH.AND..NOT.YO3_NL%LGP) .AND. (LEO3CH .AND. NCHEM == 0)) THEN
  WRITE(NULERR,'('' CHEMISTRY CALLED BUT O3 NOT ADVECTED '')')
  CALL ABOR1('SUCTRL_GFLATTR: 4.8 CHEMISTRY CALLED BUT O3 NOT ADVECTED')
ENDIF

!     ------------------------------------------------------------------

!*       5.     CHECK for some GFL that N[GFL class] < or = JP[GFL class]
!               ---------------------------------------------------------

!* Check aerosols.
IF(NAERO > JPAERO) THEN
  WRITE(NULERR,*)' Too many aerosols have been asked for&
   &!',' Increase parameter JPAERO in yom_ygfl.F90',&
   &' and JPOSAERO in parfpos.F90 to at least NAERO.' 
  CALL ABOR1('SUCTRL_GFLATTR 5_AERO')
ENDIF

!* Check greenhouse gases.
IF(NGHG > JPGHG) THEN
  WRITE(NULERR,*)' Too many greenhouse gases have been asked for&
   &!',' Increase parameter JPGHG in yom_ygfl.F90',&
   &' and JPOSGHG in parfpos.F90 to at least NGHG.' 
  CALL ABOR1('SUCTRL_GFLATTR 5_GHG')
ENDIF

!* Check chemical species.
IF(NCHEM > JPCHEM) THEN
  WRITE(NULERR,*)' Too many chemical species have been asked for&
   &!',' Increase parameter JPCHEM in yom_ygfl.F90',&
   &' and JPOSCHEM in parfpos.F90 to at least NCHEM.'
  CALL ABOR1('SUCTRL_GFLATTR 5_CHEM')
ENDIF

!* Check forcings.
IF(NGFL_FORC > JPFORC) THEN
  WRITE(NULERR,*)' Too many forcings have been asked for&
   &!',' Increase parameter JPFORC in yom_ygfl.F90',&
   &' and JPOSFORC in parfpos.F90 to at least NGFL_FORC.'
  CALL ABOR1('SUCTRL_GFLATTR 5_FORC')
ENDIF

!* Check easy diagnostics.
IF(NGFL_EZDIAG > JPEZDIAG) THEN
  WRITE(NULERR,*)' Too many easy diagnostics have been asked for&
   &!',' Increase parameter JPEZDIAG in yom_ygfl.F90',&
   &' and JPOSEZDIAG in parfpos.F90 to at least NGFL_EZDIAG.'
  CALL ABOR1('SUCTRL_GFLATTR 5_EZDIAG')
ENDIF

!* Check ERA40 fields.
IF(NERA40 > JPERA40) THEN
  WRITE(NULERR,*)' Too many ERA40 GFL fields have been asked for&
   &!',' Increase parameter JPERA40 in yom_ygfl.F90',&
   &' and JPOSERA40 in parfpos.F90 to at least NERA40.'
  CALL ABOR1('SUCTRL_GFLATTR 5_ERA40')
ENDIF
! Additional checking for this class of GFL: currently only NERA40=0 or
!  NERA40=14 is allowed.
IF(NERA40 /= 0 .AND. NERA40 /= 14 .AND. NERA40 /= 4 ) THEN
  WRITE(NULERR,*) ' Allowed values for NERA40 are 0,4,14 '
  CALL ABOR1('SUCTRL_GFLATTR 5b_ERA40')
ENDIF

!* Check NORO GWD SCHEME fields.
IF(NNOGW > JPNOGW) THEN
  WRITE(NULERR,*)' Too many NORO GWD SCHEME fields have been asked for&
   &!',' Increase parameter JPNOGW in yom_ygfl.F90',&
   &' and JPOSNOGW in parfpos.F90 to at least NNOGW.'
  CALL ABOR1('SUCTRL_GFLATTR 5_NOGW')
ENDIF

!* Check Turbulence EDR Parameter diagnostic fields.
IF(NEDRP > JPEDRP) THEN
  WRITE(NULERR,*)' Too many turbulence EDR diagnostic fields have been asked for&
   &!',' Increase parameter JPEDRP in yom_ygfl.F90',&
   &' and JPOSEDR in parfpos.F90 to at least NEDRP.'
  CALL ABOR1('SUCTRL_GFLATTR 5_EDRP')
ENDIF

!* Check UV processor output fields.
IF(NUVP > JPUVP) THEN
  WRITE(NULERR,*)' Too many aerosol output fields have been asked for&
   &!',' Increase parameter JPUVP in yom_ygfl.F90',&
   &' and JPOSUVP in parfpos.F90 to at least NUVP.'
  CALL ABOR1('SUCTRL_GFLATTR 5_UPV')
ENDIF

!* Check aerosol output fields.
IF(NAEROUT > JPAEROUT) THEN
  WRITE(NULERR,*)' Too many AEROUT output fields have been asked for!',&
   &' Increase parameter JPAEROUT in yom_ygfl.F90',&
   &' and JPOSAEROUT in parfpos.F90 to at least NAEROUT.'
  CALL ABOR1('SUCTRL_GFLATTR 5_AEROUT')
ENDIF

!* Check aerosol fields.
IF(NAERO_WVL_DIAG > NPAERO_WVL_DIAG) THEN
  WRITE(NULERR,*)' Too many wavelengths for aerosol optical output have been asked for!',&
   &' Increase parameter NPAERO_WVL_DIAG in yoe_aerodiag.F90',&
   &' and JPOSAERO_WVL_DIAG in parfpos.F90 to at least NAERO_WVL_DIAG.'
  CALL ABOR1('SUCTRL_GFLATTR 5_AERO_WVL_DIAG')
ENDIF
IF(NAERO_WVL_DIAG_TYPES > NPAERO_WVL_DIAG_TYPES) THEN
  WRITE(NULERR,*)' Too many per-wavelength aerosol optical output fields have been asked for!',&
   &' Increase parameter NPAERO_WVL_DIAG_TYPES in yoe_aerodiag.F90',&
   &' and JPOSAERO_WVL_DIAG_TYPES in parfpos.F90 to at least NAERO_WVL_DIAG_TYPES.'
  CALL ABOR1('SUCTRL_GFLATTR 5_AERO_WVL_DIAG_TYPES')
ENDIF

!* Check CRM fields.
IF(NCRM > JPCRM) THEN
  WRITE(NULERR,*)' Too many CRM GFL fields have been asked for&
   &!',' Increase parameter JPCRM in yom_ygfl.F90',&
   &' and JPOSCRM in parfpos.F90 to at least NCRM.'
  CALL ABOR1('SUCTRL_GFLATTR 5_CRM')
ENDIF


!* Check LIMA fields.
IF(NLIMA > JPLIMA) THEN
  WRITE(NULERR,*)' Too many LIMA GFL fields have been asked for&
   &!',' Increase parameter JPLIMA in yom_ygfl.F90',&
   &' and JPOSLIMA in parfpos.F90 to at least NLIMA.'
  CALL ABOR1('SUCTRL_GFLATTR 5_LIMA')
ENDIF

! Additional checking for this class of GFL: currently only
!  NCRM=CRMBUFSIZE is allowed.
IF(NCRM /= CRMBUFSIZE .AND. NCRM /= 0 ) THEN
  WRITE(NULERR,*) ' Allowed values for NCRM are 0 or ',CRMBUFSIZE
  WRITE(NULERR,*) ' while your value of NCRM is ',NCRM
  CALL ABOR1('SUCTRL_GFLATTR 5.CRMb')
ENDIF

!     ------------------------------------------------------------------

!*       6.     CHECK for GFL with mass fixer applied on
!               ----------------------------------------

IF (LTRCMFIX) THEN
  LLTRCMFABOR=(LTRCMFBC.AND.(LTRCMFPR.OR.LTRCMFMG)).OR.&
    &        (LTRCMFPR.AND.(LTRCMFBC.OR.LTRCMFMG)).OR.&
    &        (LTRCMFMG.AND.(LTRCMFBC.OR.LTRCMFPR))
  IF (LLTRCMFABOR) CALL ABOR1('SUCTRL_GFLATTR 6: ONLY ONE MASS FIXER SHOULD BE TURNED ON!')
  IF (LTRCMFBC.AND.((NOPTMFBC<1).OR.(NOPTMFBC>4)))&
    & CALL ABOR1('SUCTRL_GFLATTR 6: INVALID PARAM NOPTMFBC FOR MASS FIXER!')
  IF (LTRCMFPR.AND.((NOPTMFPR<1).OR.(NOPTMFPR>2)))&
    & CALL ABOR1('SUCTRL_GFLATTR 6: INVALID PARAM NOPTMFPR FOR MASS FIXER!')
ENDIF

!     ------------------------------------------------------------------

!*       7.     CHECK that no more than one "monotonic interpolator" key is switched on
!               -----------------------------------------------------------------------

! Attributes are LQM, LQMH and LQM3D.

IF( (YQ_NL%LQM.AND.YQ_NL%LQMH) .OR. (YQ_NL%LQM.AND.YQ_NL%LQM3D) .OR. (YQ_NL%LQMH.AND.YQ_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YQ_NL%LQM, YQ_NL%LQMH and YQ_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_Q ')
ENDIF
IF( (YL_NL%LQM.AND.YL_NL%LQMH) .OR. (YL_NL%LQM.AND.YL_NL%LQM3D) .OR. (YL_NL%LQMH.AND.YL_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YL_NL%LQM, YL_NL%LQMH and YL_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_L ')
ENDIF
IF( (YLCONV_NL%LQM.AND.YLCONV_NL%LQMH) .OR. (YLCONV_NL%LQM.AND.YLCONV_NL%LQM3D) .OR. (YLCONV_NL%LQMH.AND.YLCONV_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YLCONV_NL%LQM, YLCONV_NL%LQMH and YLCONV_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_LCONV ')
ENDIF
IF( (YICONV_NL%LQM.AND.YICONV_NL%LQMH) .OR. (YICONV_NL%LQM.AND.YICONV_NL%LQM3D) .OR. (YICONV_NL%LQMH.AND.YICONV_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YICONV_NL%LQM, YICONV_NL%LQMH and YICONV_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_ICONV ')
ENDIF
IF( (YRCONV_NL%LQM.AND.YRCONV_NL%LQMH) .OR. (YRCONV_NL%LQM.AND.YRCONV_NL%LQM3D) .OR. (YRCONV_NL%LQMH.AND.YRCONV_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YRCONV_NL%LQM, YRCONV_NL%LQMH and YRCONV_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_RCONV ')
ENDIF
IF( (YSCONV_NL%LQM.AND.YSCONV_NL%LQMH) .OR. (YSCONV_NL%LQM.AND.YSCONV_NL%LQM3D) .OR. (YSCONV_NL%LQMH.AND.YSCONV_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YSCONV_NL%LQM, YSCONV_NL%LQMH and YSCONV_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_SCONV ')
ENDIF
IF( (YI_NL%LQM.AND.YI_NL%LQMH) .OR. (YI_NL%LQM.AND.YI_NL%LQM3D) .OR. (YI_NL%LQMH.AND.YI_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YI_NL%LQM, YI_NL%LQMH and YI_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_I ')
ENDIF
IF( (YLRAD_NL%LQM.AND.YLRAD_NL%LQMH) .OR. (YLRAD_NL%LQM.AND.YLRAD_NL%LQM3D) .OR. (YLRAD_NL%LQMH.AND.YLRAD_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YLRAD_NL%LQM, YLRAD_NL%LQMH and YLRAD_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_LRAD ')
ENDIF
IF( (YIRAD_NL%LQM.AND.YIRAD_NL%LQMH) .OR. (YIRAD_NL%LQM.AND.YIRAD_NL%LQM3D) .OR. (YIRAD_NL%LQMH.AND.YIRAD_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YIRAD_NL%LQM, YIRAD_NL%LQMH and YIRAD_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_IRAD ')
ENDIF
IF( (YS_NL%LQM.AND.YS_NL%LQMH) .OR. (YS_NL%LQM.AND.YS_NL%LQM3D) .OR. (YS_NL%LQMH.AND.YS_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YS_NL%LQM, YS_NL%LQMH and YS_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_S ')
ENDIF
IF( (YR_NL%LQM.AND.YR_NL%LQMH) .OR. (YR_NL%LQM.AND.YR_NL%LQM3D) .OR. (YR_NL%LQMH.AND.YR_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YR_NL%LQM, YR_NL%LQMH and YR_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_R ')
ENDIF
IF( (YG_NL%LQM.AND.YG_NL%LQMH) .OR. (YG_NL%LQM.AND.YG_NL%LQM3D) .OR. (YG_NL%LQMH.AND.YG_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YG_NL%LQM, YG_NL%LQMH and YG_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_G ')
ENDIF
IF( (YH_NL%LQM.AND.YH_NL%LQMH) .OR. (YH_NL%LQM.AND.YH_NL%LQM3D) .OR. (YH_NL%LQMH.AND.YH_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YH_NL%LQM, YH_NL%LQMH and YH_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_H ')
ENDIF
IF( (YTKE_NL%LQM.AND.YTKE_NL%LQMH) .OR. (YTKE_NL%LQM.AND.YTKE_NL%LQM3D) .OR. (YTKE_NL%LQMH.AND.YTKE_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YTKE_NL%LQM, YTKE_NL%LQMH and YTKE_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_TKE ')
ENDIF
IF( (YEFB1_NL%LQM.AND.YEFB1_NL%LQMH) .OR. (YEFB1_NL%LQM.AND.YEFB1_NL%LQM3D) .OR. (YEFB1_NL%LQMH.AND.YEFB1_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YEFB1_NL%LQM, YEFB1_NL%LQMH and YEFB1_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_EFB1 ')
ENDIF
IF( (YEFB2_NL%LQM.AND.YEFB2_NL%LQMH) .OR. (YEFB2_NL%LQM.AND.YEFB2_NL%LQM3D) .OR. (YEFB2_NL%LQMH.AND.YEFB2_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YEFB2_NL%LQM, YEFB2_NL%LQMH and YEFB2_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_EFB2 ')
ENDIF
IF( (YEFB3_NL%LQM.AND.YEFB3_NL%LQMH) .OR. (YEFB3_NL%LQM.AND.YEFB3_NL%LQM3D) .OR. (YEFB3_NL%LQMH.AND.YEFB3_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YEFB3_NL%LQM, YEFB3_NL%LQMH and YEFB3_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_EFB3 ')
ENDIF
IF( (YA_NL%LQM.AND.YA_NL%LQMH) .OR. (YA_NL%LQM.AND.YA_NL%LQM3D) .OR. (YA_NL%LQMH.AND.YA_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YA_NL%LQM, YA_NL%LQMH and YA_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_A ')
ENDIF
IF( (YSRC_NL%LQM.AND.YSRC_NL%LQMH) .OR. (YSRC_NL%LQM.AND.YSRC_NL%LQM3D) .OR. (YSRC_NL%LQMH.AND.YSRC_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YSRC_NL%LQM, YSRC_NL%LQMH and YSRC_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_SRC ')
ENDIF
IF( (YO3_NL%LQM.AND.YO3_NL%LQMH) .OR. (YO3_NL%LQM.AND.YO3_NL%LQM3D) .OR. (YO3_NL%LQMH.AND.YO3_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YO3_NL%LQM, YO3_NL%LQMH and YO3_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_O3 ')
ENDIF
IF( (YCPF_NL%LQM.AND.YCPF_NL%LQMH) .OR. (YCPF_NL%LQM.AND.YCPF_NL%LQM3D) .OR. (YCPF_NL%LQMH.AND.YCPF_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YCPF_NL%LQM, YCPF_NL%LQMH and YCPF_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_CPF ')
ENDIF
IF( (YSPF_NL%LQM.AND.YSPF_NL%LQMH) .OR. (YSPF_NL%LQM.AND.YSPF_NL%LQM3D) .OR. (YSPF_NL%LQMH.AND.YSPF_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YSPF_NL%LQM, YSPF_NL%LQMH and YSPF_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_SPF ')
ENDIF
IF( (YCVGQ_NL%LQM.AND.YCVGQ_NL%LQMH) .OR. (YCVGQ_NL%LQM.AND.YCVGQ_NL%LQM3D) .OR. (YCVGQ_NL%LQMH.AND.YCVGQ_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YCVGQ_NL%LQM, YCVGQ_NL%LQMH and YCVGQ_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_CVGQ ')
ENDIF
IF( (YQVA_NL%LQM.AND.YQVA_NL%LQMH) .OR. (YQVA_NL%LQM.AND.YQVA_NL%LQM3D) .OR. (YQVA_NL%LQMH.AND.YQVA_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YQVA_NL%LQM, YQVA_NL%LQMH and YQVA_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_QVA ')
ENDIF
IF( (YSDSAT_NL%LQM.AND.YSDSAT_NL%LQMH) .OR. (YSDSAT_NL%LQM.AND.YSDSAT_NL%LQM3D) .OR. (YSDSAT_NL%LQMH.AND.YSDSAT_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YSDSAT_NL%LQM, YSDSAT_NL%LQMH and YSDSAT_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_SDSAT ')
ENDIF
IF( (YCVV_NL%LQM.AND.YCVV_NL%LQMH) .OR. (YCVV_NL%LQM.AND.YCVV_NL%LQM3D) .OR. (YCVV_NL%LQMH.AND.YCVV_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YCVV_NL%LQM, YCVV_NL%LQMH and YCVV_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_CVV ')
ENDIF
IF( (YUOM_NL%LQM.AND.YUOM_NL%LQMH) .OR. (YUOM_NL%LQM.AND.YUOM_NL%LQM3D) .OR. (YUOM_NL%LQMH.AND.YUOM_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YUOM_NL%LQM, YUOM_NL%LQMH and YUOM_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_UOM ')
ENDIF
IF( (YUAL_NL%LQM.AND.YUAL_NL%LQMH) .OR. (YUAL_NL%LQM.AND.YUAL_NL%LQM3D) .OR. (YUAL_NL%LQMH.AND.YUAL_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YUAL_NL%LQM, YUAL_NL%LQMH and YUAL_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_UAL ')
ENDIF
IF( (YDOM_NL%LQM.AND.YDOM_NL%LQMH) .OR. (YDOM_NL%LQM.AND.YDOM_NL%LQM3D) .OR. (YDOM_NL%LQMH.AND.YDOM_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YDOM_NL%LQM, YDOM_NL%LQMH and YDOM_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_DOM ')
ENDIF
IF( (YDAL_NL%LQM.AND.YDAL_NL%LQMH) .OR. (YDAL_NL%LQM.AND.YDAL_NL%LQM3D) .OR. (YDAL_NL%LQMH.AND.YDAL_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YDAL_NL%LQM, YDAL_NL%LQMH and YDAL_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_DAL ')
ENDIF
IF( (YUEN_NL%LQM.AND.YUEN_NL%LQMH) .OR. (YUEN_NL%LQM.AND.YUEN_NL%LQM3D) .OR. (YUEN_NL%LQMH.AND.YUEN_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YUEN_NL%LQM, YUEN_NL%LQMH and YUEN_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_UEN ')
ENDIF
IF( (YUNEBH_NL%LQM.AND.YUNEBH_NL%LQMH) .OR. (YUNEBH_NL%LQM.AND.YUNEBH_NL%LQM3D) .OR. (YUNEBH_NL%LQMH.AND.YUNEBH_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YUNEBH_NL%LQM, YUNEBH_NL%LQMH and YUNEBH_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_UNEBH ')
ENDIF
IF( (YTTE_NL%LQM.AND.YTTE_NL%LQMH) .OR. (YTTE_NL%LQM.AND.YTTE_NL%LQM3D) .OR. (YTTE_NL%LQMH.AND.YTTE_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YTTE_NL%LQM, YTTE_NL%LQMH and YTTE_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_TTE ')
ENDIF
IF( (YMXL_NL%LQM.AND.YMXL_NL%LQMH) .OR. (YMXL_NL%LQM.AND.YMXL_NL%LQM3D) .OR. (YMXL_NL%LQMH.AND.YMXL_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YMXL_NL%LQM, YMXL_NL%LQMH and YMXL_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_MXL ')
ENDIF
IF( (YSHTUR_NL%LQM.AND.YSHTUR_NL%LQMH) .OR. (YSHTUR_NL%LQM.AND.YSHTUR_NL%LQM3D) .OR. (YSHTUR_NL%LQMH.AND.YSHTUR_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YSHTUR_NL%LQM, YSHTUR_NL%LQMH and YSHTUR_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_SHTUR ')
ENDIF
IF( (YFQTUR_NL%LQM.AND.YFQTUR_NL%LQMH) .OR. (YFQTUR_NL%LQM.AND.YFQTUR_NL%LQM3D) .OR. (YFQTUR_NL%LQMH.AND.YFQTUR_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YFQTUR_NL%LQM, YFQTUR_NL%LQMH and YFQTUR_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_FQTUR ')
ENDIF
IF( (YFSTUR_NL%LQM.AND.YFSTUR_NL%LQMH) .OR. (YFSTUR_NL%LQM.AND.YFSTUR_NL%LQM3D) .OR. (YFSTUR_NL%LQMH.AND.YFSTUR_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YFSTUR_NL%LQM, YFSTUR_NL%LQMH and YFSTUR_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_FSTUR ')
ENDIF
IF( (YRKTH_NL%LQM.AND.YRKTH_NL%LQMH) .OR. (YRKTH_NL%LQM.AND.YRKTH_NL%LQM3D) .OR. (YRKTH_NL%LQMH.AND.YRKTH_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YRKTH_NL%LQM, YRKTH_NL%LQMH and YRKTH_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_RKTH ')
ENDIF
IF( (YRKTQV_NL%LQM.AND.YRKTQV_NL%LQMH) .OR. (YRKTQV_NL%LQM.AND.YRKTQV_NL%LQM3D) .OR. (YRKTQV_NL%LQMH.AND.YRKTQV_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YRKTQV_NL%LQM, YRKTQV_NL%LQMH and YRKTQV_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_RKTQV ')
ENDIF
IF( (YRKTQC_NL%LQM.AND.YRKTQC_NL%LQMH) .OR. (YRKTQC_NL%LQM.AND.YRKTQC_NL%LQM3D) .OR. (YRKTQC_NL%LQMH.AND.YRKTQC_NL%LQM3D) ) THEN
  WRITE(NULERR,'(''No more than one key among YRKTQC_NL%LQM, YRKTQC_NL%LQMH and YRKTQC_NL%LQM3D is allowed to be TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_RKTQC ')
ENDIF

DO JGFL=1,JPGHG
  IF(YGHG_NL(JGFL)%LQM.AND.YGHG_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For greenhouse gas number',JGFL
    WRITE(NULERR,'(''BOTH YGHG_NL%LQM AND YGHG_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_GHG')
  ENDIF
  IF(YGHG_NL(JGFL)%LQM.AND.YGHG_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For greenhouse gas number',JGFL
    WRITE(NULERR,'(''BOTH YGHG_NL%LQM AND YGHG_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_GHG')
  ENDIF
  IF(YGHG_NL(JGFL)%LQMH.AND.YGHG_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For greenhouse gas number',JGFL
    WRITE(NULERR,'(''BOTH YGHG_NL%LQMH AND YGHG_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_GHG')
  ENDIF
ENDDO

IF(YLRCH4_NL%LQM.AND.YLRCH4_NL%LQMH) THEN
  WRITE(NULERR,'(A,I3)') ' For CH4 loss rate'
  WRITE(NULERR,'(''BOTH YLRCH4_NL%LQM AND YLRCH4_NL%LQMH TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_LRCH4')
ENDIF
IF(YLRCH4_NL%LQM.AND.YLRCH4_NL%LQM3D) THEN
  WRITE(NULERR,'(A,I3)') ' For CH4 loss rate'
  WRITE(NULERR,'(''BOTH YLRCH4_NL%LQM AND YLRCH4_NL%LQM3D TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_LRCH4')
ENDIF
IF(YLRCH4_NL%LQMH.AND.YLRCH4_NL%LQM3D) THEN
  WRITE(NULERR,'(A,I3)') ' For CH4 loss rate'
  WRITE(NULERR,'(''BOTH YLRCH4_NL%LQMH AND YLRCH4_NL%LQM3D TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_LRCH4')
ENDIF

IF(YFSD_NL%LQM.AND.YFSD_NL%LQMH) THEN
  WRITE(NULERR,'(A,I3)') ' For cloud heterogeneity FSD'
  WRITE(NULERR,'(''BOTH YFSD_NL%LQM AND YFSD_NL%LQMH TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_FSD')
ENDIF
IF(YFSD_NL%LQM.AND.YFSD_NL%LQM3D) THEN
  WRITE(NULERR,'(A,I3)') '  For cloud heterogeneity FSD'
  WRITE(NULERR,'(''BOTH YFSD_NL%LQM AND YFSD_NL%LQM3D TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_FSD')
ENDIF
IF(YFSD_NL%LQMH.AND.YFSD_NL%LQM3D) THEN
  WRITE(NULERR,'(A,I3)') '  For cloud heterogeneity FSD'
  WRITE(NULERR,'(''BOTH YFSD_NL%LQMH AND YFSD_NL%LQM3D TRUE'')')
  CALL ABOR1(' SUCTRL_GFLATTR 7_FSD')
ENDIF

DO JGFL=1,JPCHEM
  IF(YCHEM_NL(JGFL)%LQM.AND.YCHEM_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For chemical species number',JGFL
    WRITE(NULERR,'(''BOTH YCHEM_NL%LQM AND YCHEM_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_CHEM')
  ENDIF
  IF(YCHEM_NL(JGFL)%LQM.AND.YCHEM_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For chemical species number',JGFL
    WRITE(NULERR,'(''BOTH YCHEM_NL%LQM AND YCHEM_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_CHEM')
  ENDIF
  IF(YCHEM_NL(JGFL)%LQMH.AND.YCHEM_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For chemical species number',JGFL
    WRITE(NULERR,'(''BOTH YCHEM_NL%LQMH AND YCHEM_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_CHEM')
  ENDIF
ENDDO

DO JGFL=1,JPAERO
  IF(YAERO_NL(JGFL)%LQM.AND.YAERO_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For aerosol number',JGFL
    WRITE(NULERR,'(''BOTH YAERO_NL%LQM AND YAERO_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_AERO')
  ENDIF
  IF(YAERO_NL(JGFL)%LQM.AND.YAERO_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For aerosol number',JGFL
    WRITE(NULERR,'(''BOTH YAERO_NL%LQM AND YAERO_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_AERO')
  ENDIF
  IF(YAERO_NL(JGFL)%LQMH.AND.YAERO_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For aerosol number',JGFL
    WRITE(NULERR,'(''BOTH YAERO_NL%LQMH AND YAERO_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_AERO')
  ENDIF
ENDDO

DO JGFL=1,JPERA40
  IF(YERA40_NL(JGFL)%LQM.AND.YERA40_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For ERA40 field number',JGFL
    WRITE(NULERR,'(''BOTH YERA40_NL%LQM AND YERA40_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_ERA40')
  ENDIF
  IF(YERA40_NL(JGFL)%LQM.AND.YERA40_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For ERA40 field number',JGFL
    WRITE(NULERR,'(''BOTH YERA40_NL%LQM AND YERA40_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_ERA40')
  ENDIF
  IF(YERA40_NL(JGFL)%LQMH.AND.YERA40_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For ERA40 field number',JGFL
    WRITE(NULERR,'(''BOTH YERA40_NL%LQMH AND YERA40_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_ERA40')
  ENDIF
ENDDO

DO JGFL=1,JPNOGW
  IF(YNOGW_NL(JGFL)%LQM.AND.YNOGW_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For NOGW field number',JGFL
    WRITE(NULERR,'(''BOTH YNOGW_NL%LQM AND YNOGW_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_NOGW')
  ENDIF
  IF(YNOGW_NL(JGFL)%LQM.AND.YNOGW_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For NOGW field number',JGFL
    WRITE(NULERR,'(''BOTH YNOGW_NL%LQM AND YNOGW_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_NOGW')
  ENDIF
  IF(YNOGW_NL(JGFL)%LQMH.AND.YNOGW_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For NOGW field number',JGFL
    WRITE(NULERR,'(''BOTH YNOGW_NL%LQMH AND YNOGW_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_NOGW')
  ENDIF
ENDDO

DO JGFL=1,JPEDRP
  IF(YEDRP_NL(JGFL)%LQM.AND.YEDRP_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For EDR field number',JGFL
    WRITE(NULERR,'(''BOTH YEDRP_NL%LQM AND YEDRP_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_EDRP')
  ENDIF
  IF(YEDRP_NL(JGFL)%LQM.AND.YEDRP_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For EDR field number',JGFL
    WRITE(NULERR,'(''BOTH YEDRP_NL%LQM AND YEDRP_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_EDRP')
  ENDIF
  IF(YEDRP_NL(JGFL)%LQMH.AND.YEDRP_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For EDR field number',JGFL
    WRITE(NULERR,'(''BOTH YEDRP_NL%LQMH AND YEDRP_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_EDRP')
  ENDIF
ENDDO

DO JGFL=1,JPUVP
  IF(YUVP_NL(JGFL)%LQM.AND.YUVP_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For UVP field number',JGFL
    WRITE(NULERR,'(''BOTH YUVP_NL%LQM AND YUVP_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_UVP')
  ENDIF
  IF(YUVP_NL(JGFL)%LQM.AND.YUVP_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For UVP field number',JGFL
    WRITE(NULERR,'(''BOTH YUVP_NL%LQM AND YUVP_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_UVP')
  ENDIF
  IF(YUVP_NL(JGFL)%LQMH.AND.YUVP_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For UVP field number',JGFL
    WRITE(NULERR,'(''BOTH YUVP_NL%LQMH AND YUVP_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_UVP')
  ENDIF
ENDDO

DO JGFL=1,NPAERAOT
  IF(YAERAOT_NL(JGFL)%LQM.AND.YAERAOT_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For AERAOT field number',JGFL
    WRITE(NULERR,'(''BOTH YAERAOT_NL%LQM AND YAERAOT_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_AERAOT')
  ENDIF
  IF(YAERAOT_NL(JGFL)%LQM.AND.YAERAOT_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For AERAOT field number',JGFL
    WRITE(NULERR,'(''BOTH YAERAOT_NL%LQM AND YAERAOT_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_AERAOT')
  ENDIF
  IF(YAERAOT_NL(JGFL)%LQMH.AND.YAERAOT_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For AERAOT field number',JGFL
    WRITE(NULERR,'(''BOTH YAERAOT_NL%LQMH AND YAERAOT_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_AERAOT')
  ENDIF
ENDDO

DO JGFL=1,NPAERLISI_VAR
  DO JWVL=1,NPAERLISI_WVL
    IF(YAERLISI_NL(JWVL,JGFL)%LQM.AND.YAERLISI_NL(JWVL,JGFL)%LQMH) THEN
      WRITE(NULERR,'(A,I3,I3)') ' For AERLISI field number',JWVL,JGFL
      WRITE(NULERR,'(''BOTH YAERLISI_NL%LQM AND YAERLISI_NL%LQMH TRUE'')')
      CALL ABOR1(' SUCTRL_GFLATTR 7_AERLISI')
    ENDIF
    IF(YAERLISI_NL(JWVL,JGFL)%LQM.AND.YAERLISI_NL(JWVL,JGFL)%LQM3D) THEN
      WRITE(NULERR,'(A,I3,I3)') ' For AERLISI field number',JWVL,JGFL
      WRITE(NULERR,'(''BOTH YAERLISI_NL%LQM AND YAERLISI_NL%LQM3D TRUE'')')
      CALL ABOR1(' SUCTRL_GFLATTR 7_AERLISI')
    ENDIF
    IF(YAERLISI_NL(JWVL,JGFL)%LQMH.AND.YAERLISI_NL(JWVL,JGFL)%LQM3D) THEN
      WRITE(NULERR,'(A,I3,I3)') ' For AERLISI field number',JWVL,JGFL
      WRITE(NULERR,'(''BOTH YAERLISI_NL%LQMH AND YAERLISI_NL%LQM3D TRUE'')')
      CALL ABOR1(' SUCTRL_GFLATTR 7_AERLISI')
    ENDIF
  ENDDO
ENDDO

DO JGFL=1,JPAEROUT
  IF(YAEROUT_NL(JGFL)%LQM.AND.YAEROUT_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For AEROUT field number',JGFL
    WRITE(NULERR,'(''BOTH YAEROUT_NL%LQM AND YAEROUT_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_AEROUT')
  ENDIF
  IF(YAEROUT_NL(JGFL)%LQM.AND.YAEROUT_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For AEROUT field number',JGFL
    WRITE(NULERR,'(''BOTH YAEROUT_NL%LQM AND YAEROUT_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_AEROUT')
  ENDIF
  IF(YAEROUT_NL(JGFL)%LQMH.AND.YAEROUT_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For AEROUT field number',JGFL
    WRITE(NULERR,'(''BOTH YAEROUT_NL%LQMH AND YAEROUT_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_AEROUT')
  ENDIF
ENDDO

DO JGFL=1,NSLDIA
  IF(YSLDIA_NL(JGFL)%LQM.AND.YSLDIA_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For SLDIA field number',JGFL
    WRITE(NULERR,'(''BOTH YSLDIA_NL%LQM AND YSLDIA_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_SLDIA')
  ENDIF
  IF(YSLDIA_NL(JGFL)%LQM.AND.YSLDIA_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For SLDIA field number',JGFL
    WRITE(NULERR,'(''BOTH YSLDIA_NL%LQM AND YSLDIA_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_SLDIA')
  ENDIF
  IF(YSLDIA_NL(JGFL)%LQMH.AND.YSLDIA_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For SLDIA field number',JGFL
    WRITE(NULERR,'(''BOTH YSLDIA_NL%LQMH AND YSLDIA_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_SLDIA')
  ENDIF
ENDDO

DO JGFL=1,JPFORC
  IF(YFORC_NL(JGFL)%LQM.AND.YFORC_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For forcing number',JGFL
    WRITE(NULERR,'(''BOTH YFORC_NL%LQM AND YFORC_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_FORC')
  ENDIF
  IF(YFORC_NL(JGFL)%LQM.AND.YFORC_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For forcing number',JGFL
    WRITE(NULERR,'(''BOTH YFORC_NL%LQM AND YFORC_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_FORC')
  ENDIF
  IF(YFORC_NL(JGFL)%LQMH.AND.YFORC_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For forcing number',JGFL
    WRITE(NULERR,'(''BOTH YFORC_NL%LQMH AND YFORC_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_FORC')
  ENDIF
ENDDO

DO JGFL=1,JPEZDIAG
  IF(YEZDIAG_NL(JGFL)%LQM.AND.YEZDIAG_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For easy diagnostic number',JGFL
    WRITE(NULERR,'(''BOTH YEZDIAG_NL%LQM AND YEZDIAG_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_EZDIAG')
  ENDIF
  IF(YEZDIAG_NL(JGFL)%LQM.AND.YEZDIAG_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For easy diagnostic number',JGFL
    WRITE(NULERR,'(''BOTH YEZDIAG_NL%LQM AND YEZDIAG_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_EZDIAG')
  ENDIF
  IF(YEZDIAG_NL(JGFL)%LQMH.AND.YEZDIAG_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For easy diagnostic number',JGFL
    WRITE(NULERR,'(''BOTH YEZDIAG_NL%LQMH AND YEZDIAG_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_EZDIAG')
  ENDIF
ENDDO

DO JGFL=1,SIZE(YEXT_NL)
  IF(YEXT_NL(JGFL)%LQM.AND.YEXT_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For extra-GFL number',JGFL
    WRITE(NULERR,'(''BOTH YEXT_NL%LQM AND YEXT_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_EXT')
  ENDIF
  IF(YEXT_NL(JGFL)%LQM.AND.YEXT_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For extra-GFL number',JGFL
    WRITE(NULERR,'(''BOTH YEXT_NL%LQM AND YEXT_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_EXT')
  ENDIF
  IF(YEXT_NL(JGFL)%LQMH.AND.YEXT_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For extra-GFL number',JGFL
    WRITE(NULERR,'(''BOTH YEXT_NL%LQMH AND YEXT_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_EXT')
  ENDIF
ENDDO

DO JGFL=1,JPCRM
  IF(YCRM_NL(JGFL)%LQM.AND.YCRM_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For CRM field number',JGFL
    WRITE(NULERR,'(''BOTH YCRM_NL%LQM AND YCRM_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_CRM')
  ENDIF
  IF(YCRM_NL(JGFL)%LQM.AND.YCRM_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For CRM field number',JGFL
    WRITE(NULERR,'(''BOTH YCRM_NL%LQM AND YCRM_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_CRM')
  ENDIF
  IF(YCRM_NL(JGFL)%LQMH.AND.YCRM_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For CRM field number',JGFL
    WRITE(NULERR,'(''BOTH YCRM_NL%LQMH AND YCRM_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_CRM')
  ENDIF
ENDDO


DO JGFL=1,JPLIMA
  IF(YLIMA_NL(JGFL)%LQM.AND.YLIMA_NL(JGFL)%LQMH) THEN
    WRITE(NULERR,'(A,I3)') ' For LIMA var number',JGFL
    WRITE(NULERR,'(''BOTH YLIMA_NL%LQM AND YLIMA_NL%LQMH TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_LIMA')
  ENDIF
  IF(YLIMA_NL(JGFL)%LQM.AND.YLIMA_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For LIMA var number',JGFL
    WRITE(NULERR,'(''BOTH YLIMA_NL%LQM AND YLIMA_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_LIMA')
  ENDIF
  IF(YLIMA_NL(JGFL)%LQMH.AND.YLIMA_NL(JGFL)%LQM3D) THEN
    WRITE(NULERR,'(A,I3)') ' For LIMA var number',JGFL
    WRITE(NULERR,'(''BOTH YLIMA_NL%LQMH AND YLIMA_NL%LQM3D TRUE'')')
    CALL ABOR1(' SUCTRL_GFLATTR 7_LIMA')
  ENDIF
ENDDO

!     ------------------------------------------------------------------

END ASSOCIATE
IF (LHOOK) CALL DR_HOOK('SUCTRL_GFLATTR',1,ZHOOK_HANDLE)
END SUBROUTINE SUCTRL_GFLATTR
