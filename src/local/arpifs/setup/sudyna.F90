#ifdef VPP
!OCL SCALAR
#endif
SUBROUTINE SUDYNA(KULOUT)

!**** *SUDYNA*   - Initialize constants and control for the dynamics: "IFS_INIT" part

!     Purpose.
!     --------
!           Initialize YOMDYNA, a "IFS_INIT" module that controls the dynamics of the model.

!**   Interface.
!     ----------
!        *CALL* *SUDYNA(KULOUT)

!        Explicit arguments :
!        --------------------
!        KULOUT : Logical unit for the output

!        Implicit arguments :
!        --------------------
!        COMMON YOMDYNA

!     Method.
!     -------
!        See documentation

!     Externals.
!     ----------
!     none

!     Called by SU0YOMA.

!     Reference.
!     ----------
!        ECMWF Research Department documentation of the IFS

!     Author.
!     -------
!        K. YESSAD (CNRM/GMAP)
!        Original : September 2002

! Modifications
! -------------
!   K. Yessad (Nov 2009): prune lpc_old.
!   K. Yessad (Dec 2009): LRWSDLW,LRWSDLR,LRWSDLG=T,T,T in NH model for LGWADV=F.
!   F. Vana  22-Feb-2011: option L3DTURB
!   K. Yessad (Nov 2011): introduce LRALTVDISP,LRPRSLTRJ,LCURVW,LRFRICISOTR
!   N. Wedi (Nov 2011): LGRADSP
!   K. Yessad (Sep 2013): final value of LSLHD, and LSLHDQUAD set-up there.
!   P. Smolikova and J. Vivoda (Oct 2013): new options for VFE-NH
!   S. Malardel (Nov 2013): setup COMAD switches and tests
!   K. Yessad (July 2014): Various setup and module refactoring.
!   F. Vana 13-Feb-2014  LSLHDVER
!   K. Yessad (Dec 2016): Prune obsolete options.
!   K. Yessad (June 2017): Introduce NHQE model.
!   F. Vana (21-Nov-2017): Option LHOISLT
!   K. Yessad (Feb 2018): remove deep-layer formulations.
!   K. Yessad (Apr 2018): introduce key L_RDRY_VD (ensure consistent definition of "dver" everywhere).
!   K. Yessad (June 2018): Alternate NHEE SI scheme elimination.
!   K. Yessad (July 2018): Add LNHEE_SVDLAPL_FIRST=T option.
!   J. Vivoda (July 2018): mixed NESC/SETTLS scheme.
!   F. Vana (20-Feb-2019): Option LRHSWENO & better defaults
!   P. Smolikova (Sep 2020): Remove LAPRXPK from VFE.
! End Modifications
!------------------------------------------------------------------

USE PARKIND1 , ONLY : JPIM, JPRB, JPRD
USE YOMHOOK  , ONLY : LHOOK, DR_HOOK
USE YOMMP0   , ONLY : NPRINTLEV
USE YOMCT0   , ONLY : LSLAG, LNHDYN, LTWOTL, LRPLANE, LELAM, LECMWF, LR2D, NCONF, LNHEE, LNHQE
USE YOMCVER  , ONLY : PRT_CVER, SUCVER, LVERTFE, LVFE_GW
USE YOMLUN   , ONLY : NULNAM
USE YOMDYNA  , ONLY : YRDYNA

!------------------------------------------------------------------

IMPLICIT NONE

INTEGER(KIND=JPIM), INTENT(IN)    :: KULOUT

!     ------------------------------------------------------------------

INTEGER(KIND=JPIM) :: IERR
REAL(KIND=JPRB) :: ZHOOK_HANDLE

!     ------------------------------------------------------------------

#include "sudyncore.intfb.h"
#include "abor1.intfb.h"
#include "posnam.intfb.h"

#include "namdyna.nam.h"

INTEGER(KIND=JPIM), POINTER :: ND4SYS, NDLNPR, NGWADVSI, NPDVAR, NVDVAR
LOGICAL, POINTER :: L3DTURB, LAPRXPK, LCOMAD, LCOMAD_GFL, LCOMADH, LCOMAD_SP, LCOMAD_SPD, &
 & LCOMAD_SVD, LCOMAD_T, LCOMADV, LCOMAD_W, LDRY_ECMWF, LELTRA, LGRADGP, LGRADSP, &
 & LGWADV, LHOISLT, LMIXETTLS, LMIXETTLS_PRINT, LNESC, LNESCT, LNESCV, LNHEE_REFINE_GRP, &
 & LNHEE_REFINE_PREH_BBC, LNHEE_REFINE_SILAPL, LNHEE_SVDLAPL_FIRST, LNHQE_C2, LNHQE_SIHYD, &
 & LNHX, LNHXDER, LPC_CHEAP, LPC_CHEAP2, LPC_FULL, LRALTVDISP, LRDBBC, L_RDRY_VD, &
 & LRHSVWENO, LRPRSLTRJ, LRUBC, LSETTLS, LSETTLST, LSETTLSV, LSI_NHEE, LSLDIA, LSLHD, &
 & LSLHD_GFL, LSLHD_OLD, LSLHDQUAD, LSLHD_SPD, LSLHD_STATIC, LSLHD_SVD, LSLHD_T, LSLHDVER, &
 & LSLHD_W, LSLINL, LSLINLC2, LSLTVWENO, LVEREGINT, LVSPLIP
REAL(KIND=JPRB), POINTER :: HOISLTH,  HOISLTV,  REXP_VRAT,  RHYDR0,  RMIXNL_TRH,  SLHDEPSH,  &
 & SLHDEPSV,  SLHDKMAX,  SLHDKMIN,  SLHDKREF


!     ------------------------------------------------------------------

IF (LHOOK) CALL DR_HOOK('SUDYNA',0,ZHOOK_HANDLE)

NPDVAR                 => YRDYNA%NPDVAR
NVDVAR                 => YRDYNA%NVDVAR
ND4SYS                 => YRDYNA%ND4SYS
LNHX                   => YRDYNA%LNHX
LNHXDER                => YRDYNA%LNHXDER
LGWADV                 => YRDYNA%LGWADV
NGWADVSI               => YRDYNA%NGWADVSI
LRDBBC                 => YRDYNA%LRDBBC
LSI_NHEE               => YRDYNA%LSI_NHEE
LNHQE_C2               => YRDYNA%LNHQE_C2
LNHQE_SIHYD            => YRDYNA%LNHQE_SIHYD
LNHEE_SVDLAPL_FIRST    => YRDYNA%LNHEE_SVDLAPL_FIRST
LSLHD                  => YRDYNA%LSLHD
LSLHD_W                => YRDYNA%LSLHD_W
LSLHD_T                => YRDYNA%LSLHD_T
LSLHD_SPD              => YRDYNA%LSLHD_SPD
LSLHD_SVD              => YRDYNA%LSLHD_SVD
LSLHD_GFL              => YRDYNA%LSLHD_GFL
LSLHD_OLD              => YRDYNA%LSLHD_OLD
LSLHD_STATIC           => YRDYNA%LSLHD_STATIC
LSLHDQUAD              => YRDYNA%LSLHDQUAD
LSLHDVER               => YRDYNA%LSLHDVER
SLHDKMIN               => YRDYNA%SLHDKMIN
SLHDKMAX               => YRDYNA%SLHDKMAX
SLHDKREF               => YRDYNA%SLHDKREF
SLHDEPSH               => YRDYNA%SLHDEPSH
SLHDEPSV               => YRDYNA%SLHDEPSV
LGRADSP                => YRDYNA%LGRADSP
LGRADGP                => YRDYNA%LGRADGP
L3DTURB                => YRDYNA%L3DTURB
LSLDIA                 => YRDYNA%LSLDIA
LRPRSLTRJ              => YRDYNA%LRPRSLTRJ
LRALTVDISP             => YRDYNA%LRALTVDISP
LVSPLIP                => YRDYNA%LVSPLIP
LRHSVWENO              => YRDYNA%LRHSVWENO
LCOMAD                 => YRDYNA%LCOMAD
LCOMADH                => YRDYNA%LCOMADH
LCOMADV                => YRDYNA%LCOMADV
LCOMAD_W               => YRDYNA%LCOMAD_W
LCOMAD_T               => YRDYNA%LCOMAD_T
LCOMAD_SPD             => YRDYNA%LCOMAD_SPD
LCOMAD_SVD             => YRDYNA%LCOMAD_SVD
LCOMAD_SP              => YRDYNA%LCOMAD_SP
LCOMAD_GFL             => YRDYNA%LCOMAD_GFL
LNESCT                 => YRDYNA%LNESCT
LNESCV                 => YRDYNA%LNESCV
LNESC                  => YRDYNA%LNESC
LSETTLST               => YRDYNA%LSETTLST
LSETTLSV               => YRDYNA%LSETTLSV
LSETTLS                => YRDYNA%LSETTLS
LELTRA                 => YRDYNA%LELTRA
LSLINLC2               => YRDYNA%LSLINLC2
LSLINL                 => YRDYNA%LSLINL
LHOISLT                => YRDYNA%LHOISLT
HOISLTV                => YRDYNA%HOISLTV
HOISLTH                => YRDYNA%HOISLTH
LSLTVWENO              => YRDYNA%LSLTVWENO
LAPRXPK                => YRDYNA%LAPRXPK
NDLNPR                 => YRDYNA%NDLNPR
RHYDR0                 => YRDYNA%RHYDR0
LRUBC                  => YRDYNA%LRUBC
REXP_VRAT              => YRDYNA%REXP_VRAT
LNHEE_REFINE_SILAPL    => YRDYNA%LNHEE_REFINE_SILAPL
LNHEE_REFINE_GRP       => YRDYNA%LNHEE_REFINE_GRP
LNHEE_REFINE_PREH_BBC  => YRDYNA%LNHEE_REFINE_PREH_BBC
LVEREGINT              => YRDYNA%LVEREGINT
LPC_FULL               => YRDYNA%LPC_FULL
LPC_CHEAP              => YRDYNA%LPC_CHEAP
LPC_CHEAP2             => YRDYNA%LPC_CHEAP2
LMIXETTLS              => YRDYNA%LMIXETTLS
LMIXETTLS_PRINT        => YRDYNA%LMIXETTLS_PRINT
RMIXNL_TRH             => YRDYNA%RMIXNL_TRH
LDRY_ECMWF             => YRDYNA%LDRY_ECMWF
L_RDRY_VD              => YRDYNA%L_RDRY_VD

!     ------------------------------------------------------------------

!*       1.    Set default values.
!              -------------------

YRDYNA%LVSPLIP=.FALSE. ! Provisional value, may be modified via NAMGFL.

YRDYNA%LGWADV=.FALSE.
YRDYNA%NGWADVSI=1
YRDYNA%NPDVAR=2
IF (LNHDYN) THEN
  YRDYNA%NVDVAR=4
  YRDYNA%LRDBBC=LSLAG
ELSE
  YRDYNA%NVDVAR=3
  YRDYNA%LRDBBC=.FALSE.
ENDIF
YRDYNA%LSLHD_SPD =.FALSE.
YRDYNA%LSLHD_SVD =.FALSE.
YRDYNA%LSLHD_GFL =.FALSE.
IF (LECMWF) THEN
  ! IFS specific defaults
  YRDYNA%LSLHD_W   =.FALSE.
  YRDYNA%LSLHD_T   =.FALSE.
  YRDYNA%LSLHD_OLD =.FALSE.
  YRDYNA%SLHDKMAX=6.0_JPRB
ELSE 
  YRDYNA%LSLHD_W   =.FALSE.
  YRDYNA%LSLHD_T   =.FALSE.
  YRDYNA%LSLHD_OLD =.TRUE.
  YRDYNA%SLHDKMAX=1.0_JPRB
ENDIF
YRDYNA%LSLHD_STATIC=.FALSE.
YRDYNA%SLHDKMIN=0.0_JPRB
YRDYNA%SLHDKREF=-999.0_JPRB
YRDYNA%SLHDEPSH=0.0_JPRB
YRDYNA%SLHDEPSV=0.0_JPRB
! LSLHD defaults for GFLs are set in SUDEFO_GFLATTR, before reading NAMGFL!!!
YRDYNA%LCOMAD    =.FALSE.
YRDYNA%LCOMADH   =.FALSE.
YRDYNA%LCOMADV   =.FALSE.
YRDYNA%LCOMAD_W  =.FALSE.
YRDYNA%LCOMAD_T  =.FALSE.
YRDYNA%LCOMAD_SPD=.FALSE.
YRDYNA%LCOMAD_SVD=.FALSE.
YRDYNA%LCOMAD_SP =.FALSE.
YRDYNA%LCOMAD_GFL =.FALSE.
YRDYNA%LSLHDVER=.FALSE.

YRDYNA%LGRADSP=.FALSE.
YRDYNA%LGRADGP=.FALSE.
IF (LECMWF) THEN
  IF (LSLAG) THEN
    YRDYNA%LGRADSP=.TRUE.
  ENDIF
ENDIF
YRDYNA%ND4SYS=2

YRDYNA%LSLDIA=.FALSE.

YRDYNA%L3DTURB=.FALSE.

IF (LECMWF) THEN
  YRDYNA%LAPRXPK=.TRUE.
  YRDYNA%RHYDR0=LOG(2._JPRB)
ELSE
  YRDYNA%LAPRXPK=.FALSE.
  YRDYNA%RHYDR0=1._JPRB
ENDIF
YRDYNA%NDLNPR=0

YRDYNA%LRUBC=.FALSE.

YRDYNA%REXP_VRAT=1._JPRB
YRDYNA%LNHEE_REFINE_SILAPL=.FALSE.
YRDYNA%LNHEE_REFINE_GRP=.FALSE.
YRDYNA%LNHEE_REFINE_PREH_BBC=.FALSE.
YRDYNA%LVEREGINT=.FALSE.

YRDYNA%LRALTVDISP=.FALSE.
IF (LECMWF) THEN
  YRDYNA%LRPRSLTRJ=.TRUE.
ELSE
  YRDYNA%LRPRSLTRJ=(NPRINTLEV > 0)
ENDIF

YRDYNA%LPC_FULL=.FALSE.
YRDYNA%LPC_CHEAP=.FALSE.
YRDYNA%LPC_CHEAP2=.FALSE.

YRDYNA%LNESCT=.FALSE.
YRDYNA%LNESCV=.FALSE.
YRDYNA%LNESC=.FALSE.

YRDYNA%LELTRA=.FALSE.
YRDYNA%LSETTLST=LTWOTL
YRDYNA%LSETTLSV=LTWOTL
YRDYNA%LSETTLS=LTWOTL

YRDYNA%LMIXETTLS =.FALSE.
YRDYNA%LMIXETTLS_PRINT =.FALSE.
YRDYNA%RMIXNL_TRH = 0.5

IF (LECMWF) THEN
  YRDYNA%LDRY_ECMWF=.TRUE.
ELSE
  YRDYNA%LDRY_ECMWF=.FALSE.
ENDIF
YRDYNA%L_RDRY_VD=.NOT.LNHQE

YRDYNA%LNHQE_SIHYD=.FALSE.
YRDYNA%LSI_NHEE=.FALSE.
YRDYNA%LNHEE_SVDLAPL_FIRST=.FALSE.

YRDYNA%LHOISLT=.false.
YRDYNA%HOISLTV=0._JPRB
YRDYNA%HOISLTH=0._JPRB
YRDYNA%LSLTVWENO=.false.
IF (LECMWF) THEN
  YRDYNA%LRHSVWENO=.true.
ELSE
  YRDYNA%LRHSVWENO=.false.
ENDIF

!     ------------------------------------------------------------------

!*       2.    Modify default values.
!              ----------------------

!        2.1   Read namelist.

CALL POSNAM(NULNAM,'NAMDYNA')
READ(NULNAM,NAMDYNA)

!*       2.2   Reset variables and test.

! * NPDVAR, NVDVAR.
IERR=0
IF (LNHEE) THEN
  IF (YRDYNA%NPDVAR /= 2 .OR..NOT.(YRDYNA%NVDVAR==3 .OR. YRDYNA%NVDVAR==4 .OR. YRDYNA%NVDVAR==5)) THEN
    ! such configuration does not exist.
    IERR=IERR+1
    WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
    WRITE(KULOUT,*) ' Not existing configuration for (NPDVAR,NVDVAR)!'
  ENDIF
  IF (YRDYNA%NVDVAR==5 .AND. .NOT.(YRDYNA%LGWADV .OR. YRDYNA%LNHEE_SVDLAPL_FIRST)) THEN
    ! only LGWADV=true coded in this case.
    IERR=IERR+1
    WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
    WRITE(KULOUT,*) ' NVDVAR=5 and LGWADV=F requires LNHEE_SVDLAPL_FIRST=T!'
  ENDIF
  IF (YRDYNA%NVDVAR==5 .AND. LVFE_GW) THEN
     IERR=IERR+1
     WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
     WRITE(KULOUT,*) ' LVFE_GW=T not coded for NVDVAR=5!' 
  ENDIF
ENDIF
IF (LNHQE) THEN
  IF (.NOT.(YRDYNA%NPDVAR == 2 .AND. YRDYNA%NVDVAR==4)) THEN
    ! such configuration does not exist.
    IERR=IERR+1
    WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
    WRITE(KULOUT,*) ' Not existing configuration for (NPDVAR,NVDVAR)!'
  ENDIF
ENDIF
IF (.NOT.LNHDYN) THEN
  ! hydrostatic model.
  ! and in this case,
  !  * (LGWADV,NGWADVSI,LRDBBC) is always (F,1,F,1).
  !  * (NPDVAR,NVDVAR) is always (2,3) for safety.
  !  * (LSLHD_SPD,LSLHD_SVD) is always (F,F).
  YRDYNA%LGWADV=.FALSE.
  YRDYNA%NGWADVSI=1
  YRDYNA%LRDBBC=.FALSE.
  YRDYNA%NPDVAR=2
  YRDYNA%NVDVAR=3
  YRDYNA%LSLHD_SPD = .FALSE.
  YRDYNA%LSLHD_SVD = .FALSE.
ENDIF

! L_RDRY_VD=T not coded in NHQE model (dver always defined with R_moist).
IF (LNHQE) YRDYNA%L_RDRY_VD=.FALSE.

!*       2.3   Final set up of model internal keys LSLHD and COMAD

! LSLHD/LCOMAD SHOULD NOT be modified further, but additional checkings will be required in SUCTRL_GFLATTR.
YRDYNA%LSLHD =YRDYNA%LSLHD_W .OR. YRDYNA%LSLHD_T .OR. YRDYNA%LSLHD_SPD .OR. YRDYNA%LSLHD_SVD .OR. YRDYNA%LSLHD_GFL
YRDYNA%LCOMAD=YRDYNA%LCOMAD_W .OR. YRDYNA%LCOMAD_T .OR. YRDYNA%LCOMAD_SPD .OR. YRDYNA%LCOMAD_SVD .OR. YRDYNA%LCOMAD_SP .OR. YRDYNA%LCOMAD_GFL

!*       2.4   Adjusting of SLHDKMIN and SLHDKREF, set-up LSLHDQUAD

IF ( YRDYNA%LSLHD_OLD.AND.(YRDYNA%SLHDKMIN /= 0.0_JPRB) ) THEN
  YRDYNA%SLHDKMIN=0.0_JPRB
  WRITE(KULOUT,*) 'SUDYNA: Warning!'
  WRITE(KULOUT,*) '  SLHDKMIN reset to zero for LSLHD_OLD.'
ENDIF
IF(YRDYNA%SLHDKREF == -999.0_JPRB) YRDYNA%SLHDKREF = YRDYNA%SLHDKMIN

! WARNING: Using non-zero SLHDKMIN redefines weights for high order
! semi-Lagrangian interpolators (subroutines LAIDDI, LAITRI) for
! all advected fields, even if they are not subject to SLHD scheme.
! Computation of modified interpolation weights uses same auxiliary
! quantities as the new SLHD interpolators. Their initialization
! is controlled by internal key LSLHDQUAD.

YRDYNA%LSLHDQUAD=(YRDYNA%SLHDKMIN /= 0.0_JPRB) .OR. &
 & (YRDYNA%LSLHD.AND.(.NOT.YRDYNA%LSLHD_OLD).AND.(YRDYNA%SLHDKMAX /= 0.0_JPRB))

!*       2.5   Additional settings

YRDYNA%LNHX=LNHDYN.AND.(YRDYNA%NVDVAR==4 .OR. YRDYNA%NVDVAR==5)
YRDYNA%LNHXDER=YRDYNA%LNHX

!*       2.6   Some tests

!* --- Tests on LGWADV ---

IF (YRDYNA%LGWADV.AND.(.NOT.LSLAG)) THEN
  ! * Use Eulerian scheme when LGWADV=true?
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LGWADV=true is not coded in the Eulerian dynamics.'
ENDIF
IF (YRDYNA%LGWADV.AND.LSLAG.AND.(.NOT.LTWOTL)) THEN
  ! * Use SL3TL scheme when LGWADV=true?
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LGWADV=true is not coded in the SL3TL dynamics.'
  ! ky: in this case additional interpolations are required
  !     for the linear terms of "dver" equation, and they are not coded.
ENDIF

IF(YRDYNA%LGWADV .AND. YRDYNA%LRUBC) THEN
  ! * these two options actually can run together on an informatic
  !   point of view, but the current assumptions done with LGWADV=T
  !   are that a particle which is on the top of the atmosphere remains
  !   on the top of the atmosphere;
  !   this is equivalent to assume that "etadot_top" is always zero.
  !   This condition is satisfied when LRUBC=F
  !   but not when LRUBC=T which gives a non-zero value to "etadot_top".
  !   So one forbids combination "LGWADV .AND. LRUBC" which leads
  !   to inconsistencies in the model at the top of the atmosphere.
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LRUBC=true and LGWADV=true are inconsistent.'
ENDIF

!* --- Tests on NGWADVSI ---
IF (YRDYNA%NGWADVSI<1 .OR. YRDYNA%NGWADVSI>2) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' NGWADVSI should be 1 or 2.'
ENDIF

!* --- Tests on LRDBBC ---
IF ( YRDYNA%LRDBBC.AND.YRDYNA%LGWADV ) THEN
  ! * Use of lrdbbc=true with lgwadv=true makes no sense!'
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' Options LGWADV=T and LRDBBC=T make no sense together!'
ENDIF
IF (YRDYNA%LRDBBC.AND.(.NOT.LSLAG)) THEN
  ! * Use Eulerian scheme when LRDBBC=true?
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LRDBBC=true is the S.-L. discretization of BBC'
ENDIF

!* -------- Checkings for LNHEE_REFINE ------
IF (YRDYNA%LNHEE_REFINE_SILAPL.AND.(.NOT.YRDYNA%LSI_NHEE)) THEN
  ! * LNHEE_REFINE_SILAPL=true only when LSI_NHEE=true
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LNHEE_REFINE_SILAPL=true only when LSI_NHEE=true'
ENDIF
IF (YRDYNA%LNHEE_REFINE_SILAPL.AND.LVERTFE) THEN
  ! * LNHEE_REFINE_SILAPL=.T. is coded only for VFD 
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LNHEE_REFINE_SILAPL=.T. is not yet coded for LVERTFE'
ENDIF
IF (YRDYNA%LNHEE_REFINE_GRP .AND. LVERTFE) THEN
  ! * LNHEE_REFINE_GRP=.T. is not yet coded for LVERTFE.
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LNHEE_REFINE_GRP=T coded only for LVERTFE=F!'
ENDIF
IF (YRDYNA%LNHEE_REFINE_PREH_BBC.AND.(.NOT.YRDYNA%LNHEE_REFINE_GRP)) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LNHEE_REFINE_PREH_BBC=T only when LNHEE_REFINE_GRP=T'
ENDIF

!* --- Tests on SLHD variables ---

! Use SLHD scheme with Eulerian advection?
IF (YRDYNA%LSLHD.AND.(.NOT.LSLAG)) THEN
  WRITE(KULOUT,*) ' SUDYNA: Warning!'
  WRITE(KULOUT,*) ' SLHD scheme acts only with SL advection!'
ENDIF

! Use SLHD in Arpege?
IF (YRDYNA%LSLHD.AND.(.NOT.(LELAM.OR.LECMWF))) THEN
  WRITE(KULOUT,*) ' SUDYNA: Warning!'
  WRITE(KULOUT,*) '   The setup of SLHD was never adapted to suite the setup of stretched geometry.'
ENDIF

! Use nonzero SLHDKMIN outside of SLHD scheme?
IF ((.NOT.YRDYNA%LSLHD).AND.(YRDYNA%SLHDKMIN /= 0)) THEN
  WRITE(KULOUT,*) ' SUDYNA: Warning!'
  WRITE(KULOUT,*) '   Nonzero SLHDKMIN redefines high order SL interpolator'
  WRITE(KULOUT,*) '   even if SLHD scheme is off.'
ENDIF

! Use SLHD with SLHDKMIN > SLHDKMAX?
IF ((YRDYNA%LSLHD.AND.(.NOT.YRDYNA%LSLHD_STATIC)).AND.(YRDYNA%SLHDKMIN > YRDYNA%SLHDKMAX)) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' SLHDKMIN must not be greater than SLHDKMAX in diffusion mode!'
ENDIF

! Is SLHDKMIN out of bounds?
IF ((YRDYNA%SLHDKMIN < -2.0_JPRB ).OR.(YRDYNA%SLHDKMIN > 12.0_JPRB)) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' SLHDKMIN is restricted to interval <-2,12>.'
ENDIF

! Is SLHDKMAX, SLHDKREF out of bounds?
IF (YRDYNA%LSLHD_OLD) THEN
  IF ((YRDYNA%SLHDKMAX < 0.0_JPRB ).OR.(YRDYNA%SLHDKMAX > 5.0_JPRB)) THEN
    IERR=IERR+1
    WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
    WRITE(KULOUT,*) ' SLHDKMAX is restricted to interval <0,5>.'
  ENDIF
  IF ((YRDYNA%SLHDKREF < 0.0_JPRB ).OR.(YRDYNA%SLHDKREF > 5.0_JPRB)) THEN
    IERR=IERR+1
    WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
    WRITE(KULOUT,*) ' SLHDKREF is restricted to interval <0,5>.'
  ENDIF
ELSE
  IF ((YRDYNA%SLHDKMAX < -2.0_JPRB ).OR.(YRDYNA%SLHDKMAX > 12.0_JPRB)) THEN
    IERR=IERR+1
    WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
    WRITE(KULOUT,*) ' SLHDKMAX is restricted to interval <-2,12>.'
  ENDIF
  IF (YRDYNA%SLHDKMAX > 6.0_JPRB) THEN
    WRITE(KULOUT,'(1X,A)') ' ! SUDYNA: WARNING !!!'
    WRITE(KULOUT,*) ' SLHDKMAX greater than 6. may influence your model stability.'
  ENDIF
  IF ((YRDYNA%SLHDKREF < -2.0_JPRB ).OR.(YRDYNA%SLHDKREF > 12.0_JPRB)) THEN
    IERR=IERR+1
    WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
    WRITE(KULOUT,*) ' SLHDKREF is restricted to interval <-2,12>.'
  ENDIF
ENDIF

! Is SLHDEPSH out of bounds?
IF ((YRDYNA%SLHDEPSH < 0.0_JPRB ).OR.(YRDYNA%SLHDEPSH > 0.5_JPRB )) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) &
   & ' SLHDEPSH must be within interval <0,0.5>.'
ENDIF

! Is SLHDEPSV out of bounds?
IF ((YRDYNA%SLHDEPSV < 0.0_JPRB ).OR.(YRDYNA%SLHDEPSV > 0.5_JPRB )) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) &
   & ' SLHDEPSV must be within interval <0,0.5>.'
ENDIF

!* --- Tests on COMAD variables ---
! Use LCOMAD with Eulerian advection?
IF (YRDYNA%LCOMAD.AND.(.NOT.LSLAG)) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LCOMAD acts only with SL advection!'
ENDIF
! LCOMADH or LCOMADV has to be .T. if LCOMAD=.T.
IF (YRDYNA%LCOMAD .AND.((.NOT. YRDYNA%LCOMADH) .AND. (.NOT. YRDYNA%LCOMADV)) ) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) 'LCOMADH or LCOMADV has to be .T. if LCOMAD=.T.'
ENDIF
! LCOMADH and LCOMADV must to be .F. if LCOMAD=.F.
IF ((.NOT. YRDYNA%LCOMAD) .AND.(YRDYNA%LCOMADH .OR. YRDYNA%LCOMADV) ) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) 'LCOMADH and LCOMADV have to be .F. if LCOMAD=.F.'
ENDIF
! must not have COMAD_x and SLHD_x together
IF ((YRDYNA%LCOMAD_W .AND. YRDYNA%LSLHD_W).OR.(YRDYNA%LCOMAD_T .AND. YRDYNA%LSLHD_T) &
 & .OR.(YRDYNA%LCOMAD_SPD .AND. YRDYNA%LSLHD_SPD).OR.(YRDYNA%LCOMAD_SVD .AND. YRDYNA%LSLHD_SVD) ) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) 'COMAD and SLHD can not be used at the same time for the same variable'
ENDIF

!* --- Test on WENO ---

IF (YRDYNA%LSLTVWENO .AND. (.NOT.YRDYNA%LHOISLT)) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) 'LSLTVWENO=.T. MAKES ONLY SENSE TO BE USED WITH LHOISLT=T.'
ENDIF
IF (YRDYNA%LSLTVWENO .AND. (YRDYNA%HOISLTV /= 0._JPRB)) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) 'WENO assumes the basic interpolator to be at least of 3rd order accuracy.'
  WRITE(KULOUT,*) 'With LSLTVWENO=.T. only HOISLTV=0. ensures then good results.'
ENDIF
IF ((YRDYNA%LSLTVWENO .OR. YRDYNA%LHOISLT).AND.LRPLANE) THEN
  ! Not yet coded case
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) 'LSLTVWENO OR LHOISLT not yet coded for LRPLANE=.T.'
ENDIF




!* --- Tests on ND4SYS ---
IF ((LSLAG.AND.LNHDYN.AND.(YRDYNA%NVDVAR == 4 .OR. YRDYNA%NVDVAR==5)) .AND. .NOT.(YRDYNA%ND4SYS == 1 .OR. YRDYNA%ND4SYS == 2)) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' Allowed values for ND4SYS are 1 or 2.'
ENDIF

!* --- Tests on LSLDIA ---

IF( YRDYNA%LSLDIA.AND.LRPLANE ) THEN
  ! Not yet coded case.
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LSLDIA is not coded for LRPLANE=T.'
ENDIF

!* --- Tests on LRALTVDISP ---
IF( YRDYNA%LRALTVDISP.AND.(.NOT.LSLAG) ) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LRALTVDISP must be F for Eulerian advection scheme.'
ENDIF

!* --- Tests on SETTLS and NESC keys ---

! * Keys SETTLS.. can be T only for SL2TL advection.
IF ( (YRDYNA%LSETTLST.OR.YRDYNA%LSETTLSV.OR.YRDYNA%LSETTLS).AND..NOT.LTWOTL ) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LTWOTL=F requires LSETTLST=LSETTLSV=LSETTLS=F '
ENDIF

! * Keys NESC.. can be T only for SL2TL advection.
IF ( (YRDYNA%LNESCT.OR.YRDYNA%LNESCV.OR.YRDYNA%LNESC).AND..NOT.LTWOTL ) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LTWOTL=F requires LNESCT=LNESCV=LNESC=F '
ENDIF

! * Keys NESC and SETTLS are exclusive.
IF( YRDYNA%LNESCT.AND.YRDYNA%LSETTLST )THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LNESCT and LSETTLST cannot be both TRUE'
ENDIF
IF( YRDYNA%LNESCV.AND.YRDYNA%LSETTLSV )THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LNESCV and LSETTLSV cannot be both TRUE'
ENDIF
IF( YRDYNA%LNESC.AND.YRDYNA%LSETTLS )THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LNESC and LSETTLS cannot be both TRUE'
ENDIF
  
! * Additional testings.
IF (.NOT.LR2D) THEN
  ! * Use .NOT.(LNESCT.OR.LSETTLST)=T (not coded any more)?
  IF (LSLAG.AND.LTWOTL.AND.(.NOT.(YRDYNA%LNESCT.OR.YRDYNA%LSETTLST))) THEN
    ! * Use SL2TL scheme with LNESCT=F and LSETTLST=F?
    IERR=IERR+1
    WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
    WRITE(KULOUT,*) ' LNESCT or LSETTLST must be T in the SL2TL.'
  ENDIF
  ! * Use .NOT.(LNESCV.OR.LSETTLSV)=T (not coded any more)?
  IF (LSLAG.AND.LTWOTL.AND.(.NOT.(YRDYNA%LNESCV.OR.YRDYNA%LSETTLSV))) THEN
    ! * Use SL2TL scheme with LNESCV=F and LSETTLSV=F?
    IERR=IERR+1
    WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
    WRITE(KULOUT,*) ' LNESCV or LSETTLSV must be T in the SL2TL.'
  ENDIF
  ! * Use .NOT.(LNESC.OR.LSETTLS)=T when not coded?
  IF (YRDYNA%LGWADV.AND.LSLAG.AND.LTWOTL.AND.(.NOT.(YRDYNA%LNESC.OR.YRDYNA%LSETTLS))) THEN
    ! * Use SL2TL scheme with LNESC=F and LSETTLS=F when LGWADV=true?
    IERR=IERR+1
    WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
    WRITE(KULOUT,*) ' LGWADV=T requires LNESC=T or LSETTLS=T in the SL2TL.'
  ENDIF
ENDIF 

!* --- Tests on LPC_FULL and LPC_CHEAP keys ---
  
! *  Use LPC_CHEAP when not available?
IF ( (YRDYNA%LPC_CHEAP.OR.YRDYNA%LPC_CHEAP2).AND..NOT.YRDYNA%LPC_FULL ) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LPC_CHEAP (cheap PC_FULL scheme) HAS MEANING ONLY WITH PC SCHEME LPC_FULL'
ENDIF
IF ( (YRDYNA%LPC_CHEAP.OR.YRDYNA%LPC_CHEAP2).AND..NOT.LSLAG ) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LPC_CHEAP IS CODED ONLY IN THE SL SCHEME'
ENDIF
IF ( YRDYNA%LPC_CHEAP.AND.YRDYNA%LPC_CHEAP2 ) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LPC_CHEAP and LPC_CHEAP2 cannot be both T '
ENDIF

! * Use LPC_FULL for SL3TL (not coded)?
IF ( YRDYNA%LPC_FULL.AND.(.NOT.LTWOTL.AND.LSLAG) ) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LPC_FULL is not yet coded for SL3TL scheme'
ENDIF

! * Use LRUBC=T without LPC_FULL (not allowed)?
IF ( YRDYNA%LRUBC .AND. .NOT.YRDYNA%LPC_FULL ) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' When LRUBC=true, LPC_FULL must be T'
ENDIF

!* --- Tests on LRUBC ---

! * Use LRUBC in spherical geometry (not allowed)?
IF (YRDYNA%LRUBC .AND. .NOT.LELAM) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LRUBC=T can be used with LAM models only'
ENDIF

! * Use LRUBC with improper options for vertical discretisations?
IF ( YRDYNA%LRUBC .AND. (LVERTFE .OR. YRDYNA%NDLNPR /= 1) ) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' LRUBC=T requires FD vertical discretisation and NDLNPR=1 '
ENDIF

!* --- Tests on L3DTURB ---

IF (YRDYNA%L3DTURB.AND.(.NOT.LSLAG)) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' L3DTURB=.T. works only with SL advection!'
ENDIF
IF (YRDYNA%L3DTURB.AND.(NCONF /= 1)) THEN
  IERR=IERR+1
  WRITE(KULOUT,'(1X,A,I3,A)') ' ! SUDYNA: ERROR NR ',IERR,' !!!'
  WRITE(KULOUT,*) ' L3DTURB=.T. works only with configuration 001'
ENDIF


IF (IERR >= 1) THEN
  CALL FLUSH(KULOUT)
  CALL ABOR1(' SUDYNA: ABOR1 CALLED')
ENDIF

!*      2.7   dynamical core setup 

CALL SUDYNCORE

!*      2.8   YOMCVER setup (VFE keys)

CALL SUCVER

! * NDLNPR reset to 0 if LVERTFE=T
IF (LVERTFE) THEN
  YRDYNA%NDLNPR=0
  WRITE(KULOUT,'(A)') ' SUDYNA: VFE => NDLNPR reset to 0.'
ENDIF

!*      2.9   LSLINL.. keys

! Separate linear from other terms in continuity equation
YRDYNA%LSLINLC2=LNHDYN.AND.(LTWOTL.AND.YRDYNA%LGWADV.AND.YRDYNA%LSETTLS)
! Separate linear from other terms in other equations
YRDYNA%LSLINL=LNHDYN.AND.(LTWOTL.AND.YRDYNA%LGWADV.AND.YRDYNA%LSETTLS)

!*      2.10   LMIXETTLS for restricted choices

IF (YRDYNA%LMIXETTLS) THEN
  IF (.NOT.LELAM) THEN
    CALL ABOR1(' SUDYNA: LMIXETTLS CODED ONLY FOR LELAM = .TRUE.')
  ENDIF
  IF (.NOT.LNHEE) THEN
    CALL ABOR1(' SUDYNA: LMIXETTLS CODED ONLY FOR LNHEE = .TRUE.')
  ENDIF
  IF (YRDYNA%ND4SYS /= 2) THEN
    CALL ABOR1(' SUDYNA: LMIXETTLS CODED ONLY FOR ND4SYS = 2')
  ENDIF
  IF (.NOT.YRDYNA%LGWADV) THEN
    CALL ABOR1(' SUDYNA: LMIXETTLS CODED ONLY FOR LGWADV = .TRUE.')
  ENDIF
  IF (.NOT.YRDYNA%LSETTLS) THEN
    CALL ABOR1(' SUDYNA: LMIXETTLS REQUIRES LSETTLS = .TRUE.')
  ENDIF
ENDIF

!*      2.11   LNHQE_C2

! Is constraint C2 matched for NHQE model?
YRDYNA%LNHQE_C2=LNHQE.AND.(.NOT.LVERTFE).AND.(YRDYNA%NDLNPR==2)

!*      2.12   LNHQE_SIHYD

IF (.NOT.LNHQE) YRDYNA%LNHQE_SIHYD=.FALSE.

!     ------------------------------------------------------------------

!*       3.    Print final values.
!              -------------------
IF(JPRB==JPRD)THEN
   WRITE(UNIT=KULOUT,FMT='('' The model is using double precision. '')') 
ELSE
   WRITE(UNIT=KULOUT,FMT='('' The model is using single precision. '')') 
ENDIF
WRITE(UNIT=KULOUT,FMT='('' Printings of YOMDYNA/NAMDYNA variables '')')
WRITE(UNIT=KULOUT,FMT='('' LGWADV = '',L2)') YRDYNA%LGWADV
WRITE(UNIT=KULOUT,FMT='('' NGWADVSI = '',I2)') YRDYNA%NGWADVSI
WRITE(UNIT=KULOUT,FMT='('' LRDBBC = '',L2)') YRDYNA%LRDBBC
WRITE(UNIT=KULOUT,FMT='('' NPDVAR = '',I2)') YRDYNA%NPDVAR
WRITE(UNIT=KULOUT,FMT='('' NVDVAR = '',I2)') YRDYNA%NVDVAR
WRITE(UNIT=KULOUT,FMT='('' LSLHD_W       = '',L2)') YRDYNA%LSLHD_W
WRITE(UNIT=KULOUT,FMT='('' LSLHD_T       = '',L2)') YRDYNA%LSLHD_T
WRITE(UNIT=KULOUT,FMT='('' LSLHD_SPD     = '',L2)') YRDYNA%LSLHD_SPD
WRITE(UNIT=KULOUT,FMT='('' LSLHD_SVD     = '',L2)') YRDYNA%LSLHD_SVD
WRITE(UNIT=KULOUT,FMT='('' LSLHD_GFL     = '',L2)') YRDYNA%LSLHD_GFL
WRITE(UNIT=KULOUT,FMT='('' LSLHD         = '',L2)') YRDYNA%LSLHD
WRITE(UNIT=KULOUT,FMT='('' LSLHDQUAD     = '',L2)') YRDYNA%LSLHDQUAD
WRITE(UNIT=KULOUT,FMT='('' LSLHD_OLD     = '',L2)') YRDYNA%LSLHD_OLD
WRITE(UNIT=KULOUT,FMT='('' LSLHD_STATIC  = '',L2)') YRDYNA%LSLHD_STATIC
WRITE(UNIT=KULOUT,FMT='('' SLHDKMIN      = '',G0)') YRDYNA%SLHDKMIN
WRITE(UNIT=KULOUT,FMT='('' SLHDKMAX      = '',G0)') YRDYNA%SLHDKMAX
WRITE(UNIT=KULOUT,FMT='('' SLHDKREF      = '',G0)') YRDYNA%SLHDKREF
WRITE(UNIT=KULOUT,FMT='('' SLHDEPSH      = '',G0)') YRDYNA%SLHDEPSH
WRITE(UNIT=KULOUT,FMT='('' SLHDEPSV      = '',G0)') YRDYNA%SLHDEPSV
WRITE(UNIT=KULOUT,FMT='('' LCOMAD        = '',L2)') YRDYNA%LCOMAD
WRITE(UNIT=KULOUT,FMT='('' LCOMADH       = '',L2)') YRDYNA%LCOMADH
WRITE(UNIT=KULOUT,FMT='('' LCOMADV       = '',L2)') YRDYNA%LCOMADV
WRITE(UNIT=KULOUT,FMT='('' LCOMAD_W      = '',L2)') YRDYNA%LCOMAD_W
WRITE(UNIT=KULOUT,FMT='('' LCOMAD_T      = '',L2)') YRDYNA%LCOMAD_T
WRITE(UNIT=KULOUT,FMT='('' LCOMAD_SPD    = '',L2)') YRDYNA%LCOMAD_SPD
WRITE(UNIT=KULOUT,FMT='('' LCOMAD_SVD    = '',L2)') YRDYNA%LCOMAD_SVD
WRITE(UNIT=KULOUT,FMT='('' LCOMAD_SP     = '',L2)') YRDYNA%LCOMAD_SP 
WRITE(UNIT=KULOUT,FMT='('' LCOMAD_GFL    = '',L2)') YRDYNA%LCOMAD_GFL
WRITE(UNIT=KULOUT,FMT='('' ND4SYS = '',I1)') YRDYNA%ND4SYS
WRITE(UNIT=KULOUT,FMT='('' LNHX = '',L2)') YRDYNA%LNHX
WRITE(UNIT=KULOUT,FMT='('' LNHXDER = '',L2)') YRDYNA%LNHXDER
WRITE(UNIT=KULOUT,FMT='('' LSLDIA = '',L2)') YRDYNA%LSLDIA
WRITE(UNIT=KULOUT,FMT='('' LGRADSP = '',L2)') YRDYNA%LGRADSP
WRITE(UNIT=KULOUT,FMT='('' LGRADGP = '',L2)') YRDYNA%LGRADGP
WRITE(UNIT=KULOUT,FMT='('' L3DTURB = '',L2)') YRDYNA%L3DTURB
WRITE(UNIT=KULOUT,FMT='('' LHOISLT = '',L2)') YRDYNA%LHOISLT
WRITE(UNIT=KULOUT,FMT='('' HOISLTH = '',G0,'' HOISLTV = '',G0)') &
 & YRDYNA%HOISLTH,YRDYNA%HOISLTV
WRITE(UNIT=KULOUT,FMT='('' LSLTVWENO = '',L2)') YRDYNA%LSLTVWENO
WRITE(UNIT=KULOUT,FMT='('' LRHSVWENO = '',L2)') YRDYNA%LRHSVWENO
WRITE(UNIT=KULOUT,FMT='('' LAPRXPK = '',L2,'' NDLNPR = '',I2,'' RHYDR0 = '',G0)') &
 & YRDYNA%LAPRXPK,YRDYNA%NDLNPR,YRDYNA%RHYDR0
WRITE(UNIT=KULOUT,FMT='('' LRUBC = '',L2)') YRDYNA%LRUBC
WRITE(UNIT=KULOUT,FMT='('' LRALTVDISP = '',L2)') YRDYNA%LRALTVDISP
WRITE(UNIT=KULOUT,FMT='('' LRPRSLTRJ = '',L2)') YRDYNA%LRPRSLTRJ
WRITE(UNIT=KULOUT,FMT='('' LPC_FULL = '',L2)') YRDYNA%LPC_FULL
WRITE(UNIT=KULOUT,FMT='('' LPC_CHEAP = '',L2)') YRDYNA%LPC_CHEAP
WRITE(UNIT=KULOUT,FMT='('' LPC_CHEAP2 = '',L2)') YRDYNA%LPC_CHEAP2
WRITE(UNIT=KULOUT,FMT='('' LNESCT = '',L2)') YRDYNA%LNESCT
WRITE(UNIT=KULOUT,FMT='('' LNESCV = '',L2)') YRDYNA%LNESCV
WRITE(UNIT=KULOUT,FMT='('' LNESC = '',L2)') YRDYNA%LNESC
WRITE(UNIT=KULOUT,FMT='('' LSETTLST = '',L2)') YRDYNA%LSETTLST
WRITE(UNIT=KULOUT,FMT='('' LSETTLSV = '',L2)') YRDYNA%LSETTLSV
WRITE(UNIT=KULOUT,FMT='('' LSETTLS = '',L2)') YRDYNA%LSETTLS
WRITE(UNIT=KULOUT,FMT='('' LELTRA = '',L2)') YRDYNA%LELTRA
WRITE(UNIT=KULOUT,FMT='('' LSLINLC2 = '',L2)') YRDYNA%LSLINLC2
WRITE(UNIT=KULOUT,FMT='('' LSLINL = '',L2)') YRDYNA%LSLINL
WRITE(UNIT=KULOUT,FMT='('' LDRY_ECMWF= '',L2)') YRDYNA%LDRY_ECMWF
WRITE(UNIT=KULOUT,FMT='('' L_RDRY_VD= '',L2)') YRDYNA%L_RDRY_VD
WRITE(UNIT=KULOUT,FMT='('' LNHQE_SIHYD = '',L2)') YRDYNA%LNHQE_SIHYD
WRITE(UNIT=KULOUT,FMT='('' LSI_NHEE = '',L2)') YRDYNA%LSI_NHEE
WRITE(UNIT=KULOUT,FMT='('' LNHEE_SVDLAPL_FIRST = '',L2)') YRDYNA%LNHEE_SVDLAPL_FIRST
WRITE(UNIT=KULOUT,FMT='('' LMIXETTLS    = '',L2)') YRDYNA%LMIXETTLS
WRITE(UNIT=KULOUT,FMT='('' LMIXETTLS_PRINT   = '',L2)') YRDYNA%LMIXETTLS_PRINT
WRITE(UNIT=KULOUT,FMT='('' RMIXNL_TRH  = '',G0)') YRDYNA%RMIXNL_TRH
WRITE(UNIT=KULOUT,FMT='('' REXP_VRAT = '',G0)') YRDYNA%REXP_VRAT
WRITE(UNIT=KULOUT,FMT='('' LVEREGINT = '',L2)') YRDYNA%LVEREGINT
WRITE(UNIT=KULOUT,FMT='('' LNHEE_REFINE_SILAPL = '',L2)') YRDYNA%LNHEE_REFINE_SILAPL
WRITE(UNIT=KULOUT,FMT='('' LNHEE_REFINE_GRP = '',L2)') YRDYNA%LNHEE_REFINE_GRP
WRITE(UNIT=KULOUT,FMT='('' LNHEE_REFINE_PREH_BBC = '',L2)') YRDYNA%LNHEE_REFINE_PREH_BBC

CALL PRT_CVER

!     ------------------------------------------------------------------

!9990 FORMAT(1X,'ARRAY ',A10,' ALLOCATED ',8I8)

!     ------------------------------------------------------------------
IF (LHOOK) CALL DR_HOOK('SUDYNA',1,ZHOOK_HANDLE)
END SUBROUTINE SUDYNA
